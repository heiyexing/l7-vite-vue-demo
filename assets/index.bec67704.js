(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function _x(e,t){const r=Object.create(null),n=e.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return t?i=>!!r[i.toLowerCase()]:i=>!!r[i]}function xx(e){if(Dr(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=Ti(n)?AO(n):xx(n);if(i)for(const a in i)t[a]=i[a]}return t}else{if(Ti(e))return e;if(Kn(e))return e}}const EO=/;(?![^(]*\))/g,bO=/:([^]+)/,CO=/\/\*.*?\*\//gs;function AO(e){const t={};return e.replace(CO,"").split(EO).forEach(r=>{if(r){const n=r.split(bO);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Ex(e){let t="";if(Ti(e))t=e;else if(Dr(e))for(let r=0;r<e.length;r++){const n=Ex(e[r]);n&&(t+=n+" ")}else if(Kn(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const SO="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",TO=_x(SO);function kw(e){return!!e||e===""}const Cn={},dh=[],No=()=>{},wO=()=>!1,MO=/^on[^a-z]/,em=e=>MO.test(e),bx=e=>e.startsWith("onUpdate:"),Fi=Object.assign,Cx=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},RO=Object.prototype.hasOwnProperty,qr=(e,t)=>RO.call(e,t),Dr=Array.isArray,Sd=e=>tm(e)==="[object Map]",OO=e=>tm(e)==="[object Set]",Nr=e=>typeof e=="function",Ti=e=>typeof e=="string",Ax=e=>typeof e=="symbol",Kn=e=>e!==null&&typeof e=="object",Pw=e=>Kn(e)&&Nr(e.then)&&Nr(e.catch),LO=Object.prototype.toString,tm=e=>LO.call(e),FO=e=>tm(e).slice(8,-1),IO=e=>tm(e)==="[object Object]",Sx=e=>Ti(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,sg=_x(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),rm=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},kO=/-(\w)/g,Ch=rm(e=>e.replace(kO,(t,r)=>r?r.toUpperCase():"")),PO=/\B([A-Z])/g,Uh=rm(e=>e.replace(PO,"-$1").toLowerCase()),Dw=rm(e=>e.charAt(0).toUpperCase()+e.slice(1)),zy=rm(e=>e?`on${Dw(e)}`:""),bg=(e,t)=>!Object.is(e,t),$y=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Cg=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Bw=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let b2;const DO=()=>b2||(b2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let su;class BO{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=su,!t&&su&&(this.index=(su.scopes||(su.scopes=[])).push(this)-1)}run(t){if(this.active){const r=su;try{return su=this,t()}finally{su=r}}}on(){su=this}off(){su=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this.active=!1}}}function NO(e,t=su){t&&t.active&&t.effects.push(e)}const Tx=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Nw=e=>(e.w&yl)>0,Uw=e=>(e.n&yl)>0,UO=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=yl},zO=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const i=t[n];Nw(i)&&!Uw(i)?i.delete(e):t[r++]=i,i.w&=~yl,i.n&=~yl}t.length=r}},X_=new WeakMap;let md=0,yl=1;const Y_=30;let Io;const kc=Symbol(""),Z_=Symbol("");class Mx{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,NO(this,n)}run(){if(!this.active)return this.fn();let t=Io,r=pl;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Io,Io=this,pl=!0,yl=1<<++md,md<=Y_?UO(this):C2(this),this.fn()}finally{md<=Y_&&zO(this),yl=1<<--md,Io=this.parent,pl=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Io===this?this.deferStop=!0:this.active&&(C2(this),this.onStop&&this.onStop(),this.active=!1)}}function C2(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let pl=!0;const zw=[];function zh(){zw.push(pl),pl=!1}function $h(){const e=zw.pop();pl=e===void 0?!0:e}function ka(e,t,r){if(pl&&Io){let n=X_.get(e);n||X_.set(e,n=new Map);let i=n.get(r);i||n.set(r,i=Tx()),$w(i)}}function $w(e,t){let r=!1;md<=Y_?Uw(e)||(e.n|=yl,r=!Nw(e)):r=!e.has(Io),r&&(e.add(Io),Io.deps.push(e))}function us(e,t,r,n,i,a){const o=X_.get(e);if(!o)return;let u=[];if(t==="clear")u=[...o.values()];else if(r==="length"&&Dr(e)){const s=Bw(n);o.forEach((l,f)=>{(f==="length"||f>=s)&&u.push(l)})}else switch(r!==void 0&&u.push(o.get(r)),t){case"add":Dr(e)?Sx(r)&&u.push(o.get("length")):(u.push(o.get(kc)),Sd(e)&&u.push(o.get(Z_)));break;case"delete":Dr(e)||(u.push(o.get(kc)),Sd(e)&&u.push(o.get(Z_)));break;case"set":Sd(e)&&u.push(o.get(kc));break}if(u.length===1)u[0]&&q_(u[0]);else{const s=[];for(const l of u)l&&s.push(...l);q_(Tx(s))}}function q_(e,t){const r=Dr(e)?e:[...e];for(const n of r)n.computed&&A2(n);for(const n of r)n.computed||A2(n)}function A2(e,t){(e!==Io||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const $O=_x("__proto__,__v_isRef,__isVue"),Gw=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ax)),GO=Rx(),HO=Rx(!1,!0),VO=Rx(!0),S2=jO();function jO(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=cn(this);for(let a=0,o=this.length;a<o;a++)ka(n,"get",a+"");const i=n[t](...r);return i===-1||i===!1?n[t](...r.map(cn)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){zh();const n=cn(this)[t].apply(this,r);return $h(),n}}),e}function Rx(e=!1,t=!1){return function(n,i,a){if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return t;if(i==="__v_raw"&&a===(e?t?uL:Xw:t?Ww:jw).get(n))return n;const o=Dr(n);if(!e&&o&&qr(S2,i))return Reflect.get(S2,i,a);const u=Reflect.get(n,i,a);return(Ax(i)?Gw.has(i):$O(i))||(e||ka(n,"get",i),t)?u:Hi(u)?o&&Sx(i)?u:u.value:Kn(u)?e?Yw(u):Fx(u):u}}const WO=Hw(),XO=Hw(!0);function Hw(e=!1){return function(r,n,i,a){let o=r[n];if(Bd(o)&&Hi(o)&&!Hi(i))return!1;if(!e&&(!K_(i)&&!Bd(i)&&(o=cn(o),i=cn(i)),!Dr(r)&&Hi(o)&&!Hi(i)))return o.value=i,!0;const u=Dr(r)&&Sx(n)?Number(n)<r.length:qr(r,n),s=Reflect.set(r,n,i,a);return r===cn(a)&&(u?bg(i,o)&&us(r,"set",n,i):us(r,"add",n,i)),s}}function YO(e,t){const r=qr(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&us(e,"delete",t,void 0),n}function ZO(e,t){const r=Reflect.has(e,t);return(!Ax(t)||!Gw.has(t))&&ka(e,"has",t),r}function qO(e){return ka(e,"iterate",Dr(e)?"length":kc),Reflect.ownKeys(e)}const Vw={get:GO,set:WO,deleteProperty:YO,has:ZO,ownKeys:qO},KO={get:VO,set(e,t){return!0},deleteProperty(e,t){return!0}},QO=Fi({},Vw,{get:HO,set:XO}),Ox=e=>e,nm=e=>Reflect.getPrototypeOf(e);function Fv(e,t,r=!1,n=!1){e=e.__v_raw;const i=cn(e),a=cn(t);r||(t!==a&&ka(i,"get",t),ka(i,"get",a));const{has:o}=nm(i),u=n?Ox:r?Px:kx;if(o.call(i,t))return u(e.get(t));if(o.call(i,a))return u(e.get(a));e!==i&&e.get(t)}function Iv(e,t=!1){const r=this.__v_raw,n=cn(r),i=cn(e);return t||(e!==i&&ka(n,"has",e),ka(n,"has",i)),e===i?r.has(e):r.has(e)||r.has(i)}function kv(e,t=!1){return e=e.__v_raw,!t&&ka(cn(e),"iterate",kc),Reflect.get(e,"size",e)}function T2(e){e=cn(e);const t=cn(this);return nm(t).has.call(t,e)||(t.add(e),us(t,"add",e,e)),this}function w2(e,t){t=cn(t);const r=cn(this),{has:n,get:i}=nm(r);let a=n.call(r,e);a||(e=cn(e),a=n.call(r,e));const o=i.call(r,e);return r.set(e,t),a?bg(t,o)&&us(r,"set",e,t):us(r,"add",e,t),this}function M2(e){const t=cn(this),{has:r,get:n}=nm(t);let i=r.call(t,e);i||(e=cn(e),i=r.call(t,e)),n&&n.call(t,e);const a=t.delete(e);return i&&us(t,"delete",e,void 0),a}function R2(){const e=cn(this),t=e.size!==0,r=e.clear();return t&&us(e,"clear",void 0,void 0),r}function Pv(e,t){return function(n,i){const a=this,o=a.__v_raw,u=cn(o),s=t?Ox:e?Px:kx;return!e&&ka(u,"iterate",kc),o.forEach((l,f)=>n.call(i,s(l),s(f),a))}}function Dv(e,t,r){return function(...n){const i=this.__v_raw,a=cn(i),o=Sd(a),u=e==="entries"||e===Symbol.iterator&&o,s=e==="keys"&&o,l=i[e](...n),f=r?Ox:t?Px:kx;return!t&&ka(a,"iterate",s?Z_:kc),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:u?[f(h[0]),f(h[1])]:f(h),done:d}},[Symbol.iterator](){return this}}}}function Qs(e){return function(...t){return e==="delete"?!1:this}}function JO(){const e={get(a){return Fv(this,a)},get size(){return kv(this)},has:Iv,add:T2,set:w2,delete:M2,clear:R2,forEach:Pv(!1,!1)},t={get(a){return Fv(this,a,!1,!0)},get size(){return kv(this)},has:Iv,add:T2,set:w2,delete:M2,clear:R2,forEach:Pv(!1,!0)},r={get(a){return Fv(this,a,!0)},get size(){return kv(this,!0)},has(a){return Iv.call(this,a,!0)},add:Qs("add"),set:Qs("set"),delete:Qs("delete"),clear:Qs("clear"),forEach:Pv(!0,!1)},n={get(a){return Fv(this,a,!0,!0)},get size(){return kv(this,!0)},has(a){return Iv.call(this,a,!0)},add:Qs("add"),set:Qs("set"),delete:Qs("delete"),clear:Qs("clear"),forEach:Pv(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=Dv(a,!1,!1),r[a]=Dv(a,!0,!1),t[a]=Dv(a,!1,!0),n[a]=Dv(a,!0,!0)}),[e,r,t,n]}const[eL,tL,rL,nL]=JO();function Lx(e,t){const r=t?e?nL:rL:e?tL:eL;return(n,i,a)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(qr(r,i)&&i in n?r:n,i,a)}const iL={get:Lx(!1,!1)},aL={get:Lx(!1,!0)},oL={get:Lx(!0,!1)},jw=new WeakMap,Ww=new WeakMap,Xw=new WeakMap,uL=new WeakMap;function sL(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function lL(e){return e.__v_skip||!Object.isExtensible(e)?0:sL(FO(e))}function Fx(e){return Bd(e)?e:Ix(e,!1,Vw,iL,jw)}function cL(e){return Ix(e,!1,QO,aL,Ww)}function Yw(e){return Ix(e,!0,KO,oL,Xw)}function Ix(e,t,r,n,i){if(!Kn(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const o=lL(e);if(o===0)return e;const u=new Proxy(e,o===2?n:r);return i.set(e,u),u}function vh(e){return Bd(e)?vh(e.__v_raw):!!(e&&e.__v_isReactive)}function Bd(e){return!!(e&&e.__v_isReadonly)}function K_(e){return!!(e&&e.__v_isShallow)}function Zw(e){return vh(e)||Bd(e)}function cn(e){const t=e&&e.__v_raw;return t?cn(t):e}function qw(e){return Cg(e,"__v_skip",!0),e}const kx=e=>Kn(e)?Fx(e):e,Px=e=>Kn(e)?Yw(e):e;function fL(e){pl&&Io&&(e=cn(e),$w(e.dep||(e.dep=Tx())))}function hL(e,t){e=cn(e),e.dep&&q_(e.dep)}function Hi(e){return!!(e&&e.__v_isRef===!0)}function pL(e){return Hi(e)?e.value:e}const dL={get:(e,t,r)=>pL(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return Hi(i)&&!Hi(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function Kw(e){return vh(e)?e:new Proxy(e,dL)}var Qw;class vL{constructor(t,r,n,i){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Qw]=!1,this._dirty=!0,this.effect=new Mx(t,()=>{this._dirty||(this._dirty=!0,hL(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const t=cn(this);return fL(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Qw="__v_isReadonly";function gL(e,t,r=!1){let n,i;const a=Nr(e);return a?(n=e,i=No):(n=e.get,i=e.set),new vL(n,i,a||!i,r)}function dl(e,t,r,n){let i;try{i=n?e(...n):e()}catch(a){im(a,t,r)}return i}function ao(e,t,r,n){if(Nr(e)){const a=dl(e,t,r,n);return a&&Pw(a)&&a.catch(o=>{im(o,t,r)}),a}const i=[];for(let a=0;a<e.length;a++)i.push(ao(e[a],t,r,n));return i}function im(e,t,r,n=!0){const i=t?t.vnode:null;if(t){let a=t.parent;const o=t.proxy,u=r;for(;a;){const l=a.ec;if(l){for(let f=0;f<l.length;f++)if(l[f](e,o,u)===!1)return}a=a.parent}const s=t.appContext.config.errorHandler;if(s){dl(s,null,10,[e,o,u]);return}}mL(e,r,i,n)}function mL(e,t,r,n=!0){console.error(e)}let Nd=!1,Q_=!1;const Oi=[];let pu=0;const gh=[];let Qu=null,wc=0;const Jw=Promise.resolve();let Dx=null;function yL(e){const t=Dx||Jw;return e?t.then(this?e.bind(this):e):t}function _L(e){let t=pu+1,r=Oi.length;for(;t<r;){const n=t+r>>>1;Ud(Oi[n])<e?t=n+1:r=n}return t}function Bx(e){(!Oi.length||!Oi.includes(e,Nd&&e.allowRecurse?pu+1:pu))&&(e.id==null?Oi.push(e):Oi.splice(_L(e.id),0,e),e4())}function e4(){!Nd&&!Q_&&(Q_=!0,Dx=Jw.then(r4))}function xL(e){const t=Oi.indexOf(e);t>pu&&Oi.splice(t,1)}function EL(e){Dr(e)?gh.push(...e):(!Qu||!Qu.includes(e,e.allowRecurse?wc+1:wc))&&gh.push(e),e4()}function O2(e,t=Nd?pu+1:0){for(;t<Oi.length;t++){const r=Oi[t];r&&r.pre&&(Oi.splice(t,1),t--,r())}}function t4(e){if(gh.length){const t=[...new Set(gh)];if(gh.length=0,Qu){Qu.push(...t);return}for(Qu=t,Qu.sort((r,n)=>Ud(r)-Ud(n)),wc=0;wc<Qu.length;wc++)Qu[wc]();Qu=null,wc=0}}const Ud=e=>e.id==null?1/0:e.id,bL=(e,t)=>{const r=Ud(e)-Ud(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function r4(e){Q_=!1,Nd=!0,Oi.sort(bL);const t=No;try{for(pu=0;pu<Oi.length;pu++){const r=Oi[pu];r&&r.active!==!1&&dl(r,null,14)}}finally{pu=0,Oi.length=0,t4(),Nd=!1,Dx=null,(Oi.length||gh.length)&&r4()}}function CL(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Cn;let i=r;const a=t.startsWith("update:"),o=a&&t.slice(7);if(o&&o in n){const f=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=n[f]||Cn;d&&(i=r.map(v=>Ti(v)?v.trim():v)),h&&(i=r.map(Bw))}let u,s=n[u=zy(t)]||n[u=zy(Ch(t))];!s&&a&&(s=n[u=zy(Uh(t))]),s&&ao(s,e,6,i);const l=n[u+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,ao(l,e,6,i)}}function n4(e,t,r=!1){const n=t.emitsCache,i=n.get(e);if(i!==void 0)return i;const a=e.emits;let o={},u=!1;if(!Nr(e)){const s=l=>{const f=n4(l,t,!0);f&&(u=!0,Fi(o,f))};!r&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}return!a&&!u?(Kn(e)&&n.set(e,null),null):(Dr(a)?a.forEach(s=>o[s]=null):Fi(o,a),Kn(e)&&n.set(e,o),o)}function am(e,t){return!e||!em(t)?!1:(t=t.slice(2).replace(/Once$/,""),qr(e,t[0].toLowerCase()+t.slice(1))||qr(e,Uh(t))||qr(e,t))}let ko=null,i4=null;function Ag(e){const t=ko;return ko=e,i4=e&&e.type.__scopeId||null,t}function AL(e,t=ko,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&U2(-1);const a=Ag(t);let o;try{o=e(...i)}finally{Ag(a),n._d&&U2(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Gy(e){const{type:t,vnode:r,proxy:n,withProxy:i,props:a,propsOptions:[o],slots:u,attrs:s,emit:l,render:f,renderCache:h,data:d,setupState:v,ctx:m,inheritAttrs:y}=e;let _,E;const S=Ag(e);try{if(r.shapeFlag&4){const M=i||n;_=hu(f.call(M,M,h,a,v,d,m)),E=s}else{const M=t;_=hu(M.length>1?M(a,{attrs:s,slots:u,emit:l}):M(a,null)),E=t.props?s:SL(s)}}catch(M){wd.length=0,im(M,e,1),_=Pc(is)}let A=_;if(E&&y!==!1){const M=Object.keys(E),{shapeFlag:O}=A;M.length&&O&7&&(o&&M.some(bx)&&(E=TL(E,o)),A=_l(A,E))}return r.dirs&&(A=_l(A),A.dirs=A.dirs?A.dirs.concat(r.dirs):r.dirs),r.transition&&(A.transition=r.transition),_=A,Ag(S),_}const SL=e=>{let t;for(const r in e)(r==="class"||r==="style"||em(r))&&((t||(t={}))[r]=e[r]);return t},TL=(e,t)=>{const r={};for(const n in e)(!bx(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function wL(e,t,r){const{props:n,children:i,component:a}=e,{props:o,children:u,patchFlag:s}=t,l=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&s>=0){if(s&1024)return!0;if(s&16)return n?L2(n,o,l):!!o;if(s&8){const f=t.dynamicProps;for(let h=0;h<f.length;h++){const d=f[h];if(o[d]!==n[d]&&!am(l,d))return!0}}}else return(i||u)&&(!u||!u.$stable)?!0:n===o?!1:n?o?L2(n,o,l):!0:!!o;return!1}function L2(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const a=n[i];if(t[a]!==e[a]&&!am(r,a))return!0}return!1}function ML({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const RL=e=>e.__isSuspense;function OL(e,t){t&&t.pendingBranch?Dr(e)?t.effects.push(...e):t.effects.push(e):EL(e)}function LL(e,t){if(Si){let r=Si.provides;const n=Si.parent&&Si.parent.provides;n===r&&(r=Si.provides=Object.create(n)),r[e]=t}}function lg(e,t,r=!1){const n=Si||ko;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return r&&Nr(t)?t.call(n.proxy):t}}const Bv={};function Hy(e,t,r){return a4(e,t,r)}function a4(e,t,{immediate:r,deep:n,flush:i,onTrack:a,onTrigger:o}=Cn){const u=Si;let s,l=!1,f=!1;if(Hi(e)?(s=()=>e.value,l=K_(e)):vh(e)?(s=()=>e,n=!0):Dr(e)?(f=!0,l=e.some(A=>vh(A)||K_(A)),s=()=>e.map(A=>{if(Hi(A))return A.value;if(vh(A))return ch(A);if(Nr(A))return dl(A,u,2)})):Nr(e)?t?s=()=>dl(e,u,2):s=()=>{if(!(u&&u.isUnmounted))return h&&h(),ao(e,u,3,[d])}:s=No,t&&n){const A=s;s=()=>ch(A())}let h,d=A=>{h=E.onStop=()=>{dl(A,u,4)}},v;if($d)if(d=No,t?r&&ao(t,u,3,[s(),f?[]:void 0,d]):s(),i==="sync"){const A=LF();v=A.__watcherHandles||(A.__watcherHandles=[])}else return No;let m=f?new Array(e.length).fill(Bv):Bv;const y=()=>{if(!!E.active)if(t){const A=E.run();(n||l||(f?A.some((M,O)=>bg(M,m[O])):bg(A,m)))&&(h&&h(),ao(t,u,3,[A,m===Bv?void 0:f&&m[0]===Bv?[]:m,d]),m=A)}else E.run()};y.allowRecurse=!!t;let _;i==="sync"?_=y:i==="post"?_=()=>ua(y,u&&u.suspense):(y.pre=!0,u&&(y.id=u.uid),_=()=>Bx(y));const E=new Mx(s,_);t?r?y():m=E.run():i==="post"?ua(E.run.bind(E),u&&u.suspense):E.run();const S=()=>{E.stop(),u&&u.scope&&Cx(u.scope.effects,E)};return v&&v.push(S),S}function FL(e,t,r){const n=this.proxy,i=Ti(e)?e.includes(".")?o4(n,e):()=>n[e]:e.bind(n,n);let a;Nr(t)?a=t:(a=t.handler,r=t);const o=Si;Ah(this);const u=a4(i,a.bind(n),r);return o?Ah(o):Dc(),u}function o4(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}function ch(e,t){if(!Kn(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Hi(e))ch(e.value,t);else if(Dr(e))for(let r=0;r<e.length;r++)ch(e[r],t);else if(OO(e)||Sd(e))e.forEach(r=>{ch(r,t)});else if(IO(e))for(const r in e)ch(e[r],t);return e}function IL(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return c4(()=>{e.isMounted=!0}),f4(()=>{e.isUnmounting=!0}),e}const Za=[Function,Array],kL={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Za,onEnter:Za,onAfterEnter:Za,onEnterCancelled:Za,onBeforeLeave:Za,onLeave:Za,onAfterLeave:Za,onLeaveCancelled:Za,onBeforeAppear:Za,onAppear:Za,onAfterAppear:Za,onAppearCancelled:Za},setup(e,{slots:t}){const r=CF(),n=IL();let i;return()=>{const a=t.default&&s4(t.default(),!0);if(!a||!a.length)return;let o=a[0];if(a.length>1){for(const y of a)if(y.type!==is){o=y;break}}const u=cn(e),{mode:s}=u;if(n.isLeaving)return Vy(o);const l=F2(o);if(!l)return Vy(o);const f=J_(l,u,n,r);e1(l,f);const h=r.subTree,d=h&&F2(h);let v=!1;const{getTransitionKey:m}=l.type;if(m){const y=m();i===void 0?i=y:y!==i&&(i=y,v=!0)}if(d&&d.type!==is&&(!Mc(l,d)||v)){const y=J_(d,u,n,r);if(e1(d,y),s==="out-in")return n.isLeaving=!0,y.afterLeave=()=>{n.isLeaving=!1,r.update.active!==!1&&r.update()},Vy(o);s==="in-out"&&l.type!==is&&(y.delayLeave=(_,E,S)=>{const A=u4(n,d);A[String(d.key)]=d,_._leaveCb=()=>{E(),_._leaveCb=void 0,delete f.delayedLeave},f.delayedLeave=S})}return o}}},PL=kL;function u4(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function J_(e,t,r,n){const{appear:i,mode:a,persisted:o=!1,onBeforeEnter:u,onEnter:s,onAfterEnter:l,onEnterCancelled:f,onBeforeLeave:h,onLeave:d,onAfterLeave:v,onLeaveCancelled:m,onBeforeAppear:y,onAppear:_,onAfterAppear:E,onAppearCancelled:S}=t,A=String(e.key),M=u4(r,e),O=(Y,ne)=>{Y&&ao(Y,n,9,ne)},j=(Y,ne)=>{const X=ne[1];O(Y,ne),Dr(Y)?Y.every($=>$.length<=1)&&X():Y.length<=1&&X()},q={mode:a,persisted:o,beforeEnter(Y){let ne=u;if(!r.isMounted)if(i)ne=y||u;else return;Y._leaveCb&&Y._leaveCb(!0);const X=M[A];X&&Mc(e,X)&&X.el._leaveCb&&X.el._leaveCb(),O(ne,[Y])},enter(Y){let ne=s,X=l,$=f;if(!r.isMounted)if(i)ne=_||s,X=E||l,$=S||f;else return;let K=!1;const ue=Y._enterCb=de=>{K||(K=!0,de?O($,[Y]):O(X,[Y]),q.delayedLeave&&q.delayedLeave(),Y._enterCb=void 0)};ne?j(ne,[Y,ue]):ue()},leave(Y,ne){const X=String(e.key);if(Y._enterCb&&Y._enterCb(!0),r.isUnmounting)return ne();O(h,[Y]);let $=!1;const K=Y._leaveCb=ue=>{$||($=!0,ne(),ue?O(m,[Y]):O(v,[Y]),Y._leaveCb=void 0,M[X]===e&&delete M[X])};M[X]=e,d?j(d,[Y,K]):K()},clone(Y){return J_(Y,t,r,n)}};return q}function Vy(e){if(om(e))return e=_l(e),e.children=null,e}function F2(e){return om(e)?e.children?e.children[0]:void 0:e}function e1(e,t){e.shapeFlag&6&&e.component?e1(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function s4(e,t=!1,r){let n=[],i=0;for(let a=0;a<e.length;a++){let o=e[a];const u=r==null?o.key:String(r)+String(o.key!=null?o.key:a);o.type===fu?(o.patchFlag&128&&i++,n=n.concat(s4(o.children,t,u))):(t||o.type!==is)&&n.push(u!=null?_l(o,{key:u}):o)}if(i>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}function DL(e){return Nr(e)?{setup:e,name:e.name}:e}const cg=e=>!!e.type.__asyncLoader,om=e=>e.type.__isKeepAlive;function BL(e,t){l4(e,"a",t)}function NL(e,t){l4(e,"da",t)}function l4(e,t,r=Si){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(um(t,n,r),r){let i=r.parent;for(;i&&i.parent;)om(i.parent.vnode)&&UL(n,t,r,i),i=i.parent}}function UL(e,t,r,n){const i=um(t,e,n,!0);h4(()=>{Cx(n[t],i)},r)}function um(e,t,r=Si,n=!1){if(r){const i=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...o)=>{if(r.isUnmounted)return;zh(),Ah(r);const u=ao(t,r,e,o);return Dc(),$h(),u});return n?i.unshift(a):i.push(a),a}}const ls=e=>(t,r=Si)=>(!$d||e==="sp")&&um(e,(...n)=>t(...n),r),zL=ls("bm"),c4=ls("m"),$L=ls("bu"),GL=ls("u"),f4=ls("bum"),h4=ls("um"),HL=ls("sp"),VL=ls("rtg"),jL=ls("rtc");function WL(e,t=Si){um("ec",e,t)}function vc(e,t,r,n){const i=e.dirs,a=t&&t.dirs;for(let o=0;o<i.length;o++){const u=i[o];a&&(u.oldValue=a[o].value);let s=u.dir[n];s&&(zh(),ao(s,r,8,[e.el,u,e,t]),$h())}}const XL=Symbol(),t1=e=>e?C4(e)?$x(e)||e.proxy:t1(e.parent):null,Td=Fi(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>t1(e.parent),$root:e=>t1(e.root),$emit:e=>e.emit,$options:e=>Nx(e),$forceUpdate:e=>e.f||(e.f=()=>Bx(e.update)),$nextTick:e=>e.n||(e.n=yL.bind(e.proxy)),$watch:e=>FL.bind(e)}),jy=(e,t)=>e!==Cn&&!e.__isScriptSetup&&qr(e,t),YL={get({_:e},t){const{ctx:r,setupState:n,data:i,props:a,accessCache:o,type:u,appContext:s}=e;let l;if(t[0]!=="$"){const v=o[t];if(v!==void 0)switch(v){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return a[t]}else{if(jy(n,t))return o[t]=1,n[t];if(i!==Cn&&qr(i,t))return o[t]=2,i[t];if((l=e.propsOptions[0])&&qr(l,t))return o[t]=3,a[t];if(r!==Cn&&qr(r,t))return o[t]=4,r[t];r1&&(o[t]=0)}}const f=Td[t];let h,d;if(f)return t==="$attrs"&&ka(e,"get",t),f(e);if((h=u.__cssModules)&&(h=h[t]))return h;if(r!==Cn&&qr(r,t))return o[t]=4,r[t];if(d=s.config.globalProperties,qr(d,t))return d[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:a}=e;return jy(i,t)?(i[t]=r,!0):n!==Cn&&qr(n,t)?(n[t]=r,!0):qr(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,propsOptions:a}},o){let u;return!!r[o]||e!==Cn&&qr(e,o)||jy(t,o)||(u=a[0])&&qr(u,o)||qr(n,o)||qr(Td,o)||qr(i.config.globalProperties,o)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:qr(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let r1=!0;function ZL(e){const t=Nx(e),r=e.proxy,n=e.ctx;r1=!1,t.beforeCreate&&I2(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:o,watch:u,provide:s,inject:l,created:f,beforeMount:h,mounted:d,beforeUpdate:v,updated:m,activated:y,deactivated:_,beforeDestroy:E,beforeUnmount:S,destroyed:A,unmounted:M,render:O,renderTracked:j,renderTriggered:q,errorCaptured:Y,serverPrefetch:ne,expose:X,inheritAttrs:$,components:K,directives:ue,filters:de}=t;if(l&&qL(l,n,null,e.appContext.config.unwrapInjectedRef),o)for(const ve in o){const Me=o[ve];Nr(Me)&&(n[ve]=Me.bind(r))}if(i){const ve=i.call(r,r);Kn(ve)&&(e.data=Fx(ve))}if(r1=!0,a)for(const ve in a){const Me=a[ve],Ne=Nr(Me)?Me.bind(r,r):Nr(Me.get)?Me.get.bind(r,r):No,Xe=!Nr(Me)&&Nr(Me.set)?Me.set.bind(r):No,ct=RF({get:Ne,set:Xe});Object.defineProperty(n,ve,{enumerable:!0,configurable:!0,get:()=>ct.value,set:$t=>ct.value=$t})}if(u)for(const ve in u)p4(u[ve],n,r,ve);if(s){const ve=Nr(s)?s.call(r):s;Reflect.ownKeys(ve).forEach(Me=>{LL(Me,ve[Me])})}f&&I2(f,e,"c");function le(ve,Me){Dr(Me)?Me.forEach(Ne=>ve(Ne.bind(r))):Me&&ve(Me.bind(r))}if(le(zL,h),le(c4,d),le($L,v),le(GL,m),le(BL,y),le(NL,_),le(WL,Y),le(jL,j),le(VL,q),le(f4,S),le(h4,M),le(HL,ne),Dr(X))if(X.length){const ve=e.exposed||(e.exposed={});X.forEach(Me=>{Object.defineProperty(ve,Me,{get:()=>r[Me],set:Ne=>r[Me]=Ne})})}else e.exposed||(e.exposed={});O&&e.render===No&&(e.render=O),$!=null&&(e.inheritAttrs=$),K&&(e.components=K),ue&&(e.directives=ue)}function qL(e,t,r=No,n=!1){Dr(e)&&(e=n1(e));for(const i in e){const a=e[i];let o;Kn(a)?"default"in a?o=lg(a.from||i,a.default,!0):o=lg(a.from||i):o=lg(a),Hi(o)&&n?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:u=>o.value=u}):t[i]=o}}function I2(e,t,r){ao(Dr(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function p4(e,t,r,n){const i=n.includes(".")?o4(r,n):()=>r[n];if(Ti(e)){const a=t[e];Nr(a)&&Hy(i,a)}else if(Nr(e))Hy(i,e.bind(r));else if(Kn(e))if(Dr(e))e.forEach(a=>p4(a,t,r,n));else{const a=Nr(e.handler)?e.handler.bind(r):t[e.handler];Nr(a)&&Hy(i,a,e)}}function Nx(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,u=a.get(t);let s;return u?s=u:!i.length&&!r&&!n?s=t:(s={},i.length&&i.forEach(l=>Sg(s,l,o,!0)),Sg(s,t,o)),Kn(t)&&a.set(t,s),s}function Sg(e,t,r,n=!1){const{mixins:i,extends:a}=t;a&&Sg(e,a,r,!0),i&&i.forEach(o=>Sg(e,o,r,!0));for(const o in t)if(!(n&&o==="expose")){const u=KL[o]||r&&r[o];e[o]=u?u(e[o],t[o]):t[o]}return e}const KL={data:k2,props:Tc,emits:Tc,methods:Tc,computed:Tc,beforeCreate:Gi,created:Gi,beforeMount:Gi,mounted:Gi,beforeUpdate:Gi,updated:Gi,beforeDestroy:Gi,beforeUnmount:Gi,destroyed:Gi,unmounted:Gi,activated:Gi,deactivated:Gi,errorCaptured:Gi,serverPrefetch:Gi,components:Tc,directives:Tc,watch:JL,provide:k2,inject:QL};function k2(e,t){return t?e?function(){return Fi(Nr(e)?e.call(this,this):e,Nr(t)?t.call(this,this):t)}:t:e}function QL(e,t){return Tc(n1(e),n1(t))}function n1(e){if(Dr(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Gi(e,t){return e?[...new Set([].concat(e,t))]:t}function Tc(e,t){return e?Fi(Fi(Object.create(null),e),t):t}function JL(e,t){if(!e)return t;if(!t)return e;const r=Fi(Object.create(null),e);for(const n in t)r[n]=Gi(e[n],t[n]);return r}function eF(e,t,r,n=!1){const i={},a={};Cg(a,lm,1),e.propsDefaults=Object.create(null),d4(e,t,i,a);for(const o in e.propsOptions[0])o in i||(i[o]=void 0);r?e.props=n?i:cL(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function tF(e,t,r,n){const{props:i,attrs:a,vnode:{patchFlag:o}}=e,u=cn(i),[s]=e.propsOptions;let l=!1;if((n||o>0)&&!(o&16)){if(o&8){const f=e.vnode.dynamicProps;for(let h=0;h<f.length;h++){let d=f[h];if(am(e.emitsOptions,d))continue;const v=t[d];if(s)if(qr(a,d))v!==a[d]&&(a[d]=v,l=!0);else{const m=Ch(d);i[m]=i1(s,u,m,v,e,!1)}else v!==a[d]&&(a[d]=v,l=!0)}}}else{d4(e,t,i,a)&&(l=!0);let f;for(const h in u)(!t||!qr(t,h)&&((f=Uh(h))===h||!qr(t,f)))&&(s?r&&(r[h]!==void 0||r[f]!==void 0)&&(i[h]=i1(s,u,h,void 0,e,!0)):delete i[h]);if(a!==u)for(const h in a)(!t||!qr(t,h)&&!0)&&(delete a[h],l=!0)}l&&us(e,"set","$attrs")}function d4(e,t,r,n){const[i,a]=e.propsOptions;let o=!1,u;if(t)for(let s in t){if(sg(s))continue;const l=t[s];let f;i&&qr(i,f=Ch(s))?!a||!a.includes(f)?r[f]=l:(u||(u={}))[f]=l:am(e.emitsOptions,s)||(!(s in n)||l!==n[s])&&(n[s]=l,o=!0)}if(a){const s=cn(r),l=u||Cn;for(let f=0;f<a.length;f++){const h=a[f];r[h]=i1(i,s,h,l[h],e,!qr(l,h))}}return o}function i1(e,t,r,n,i,a){const o=e[r];if(o!=null){const u=qr(o,"default");if(u&&n===void 0){const s=o.default;if(o.type!==Function&&Nr(s)){const{propsDefaults:l}=i;r in l?n=l[r]:(Ah(i),n=l[r]=s.call(null,t),Dc())}else n=s}o[0]&&(a&&!u?n=!1:o[1]&&(n===""||n===Uh(r))&&(n=!0))}return n}function v4(e,t,r=!1){const n=t.propsCache,i=n.get(e);if(i)return i;const a=e.props,o={},u=[];let s=!1;if(!Nr(e)){const f=h=>{s=!0;const[d,v]=v4(h,t,!0);Fi(o,d),v&&u.push(...v)};!r&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!s)return Kn(e)&&n.set(e,dh),dh;if(Dr(a))for(let f=0;f<a.length;f++){const h=Ch(a[f]);P2(h)&&(o[h]=Cn)}else if(a)for(const f in a){const h=Ch(f);if(P2(h)){const d=a[f],v=o[h]=Dr(d)||Nr(d)?{type:d}:Object.assign({},d);if(v){const m=N2(Boolean,v.type),y=N2(String,v.type);v[0]=m>-1,v[1]=y<0||m<y,(m>-1||qr(v,"default"))&&u.push(h)}}}const l=[o,u];return Kn(e)&&n.set(e,l),l}function P2(e){return e[0]!=="$"}function D2(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function B2(e,t){return D2(e)===D2(t)}function N2(e,t){return Dr(t)?t.findIndex(r=>B2(r,e)):Nr(t)&&B2(t,e)?0:-1}const g4=e=>e[0]==="_"||e==="$stable",Ux=e=>Dr(e)?e.map(hu):[hu(e)],rF=(e,t,r)=>{if(t._n)return t;const n=AL((...i)=>Ux(t(...i)),r);return n._c=!1,n},m4=(e,t,r)=>{const n=e._ctx;for(const i in e){if(g4(i))continue;const a=e[i];if(Nr(a))t[i]=rF(i,a,n);else if(a!=null){const o=Ux(a);t[i]=()=>o}}},y4=(e,t)=>{const r=Ux(t);e.slots.default=()=>r},nF=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=cn(t),Cg(t,"_",r)):m4(t,e.slots={})}else e.slots={},t&&y4(e,t);Cg(e.slots,lm,1)},iF=(e,t,r)=>{const{vnode:n,slots:i}=e;let a=!0,o=Cn;if(n.shapeFlag&32){const u=t._;u?r&&u===1?a=!1:(Fi(i,t),!r&&u===1&&delete i._):(a=!t.$stable,m4(t,i)),o=t}else t&&(y4(e,t),o={default:1});if(a)for(const u in i)!g4(u)&&!(u in o)&&delete i[u]};function _4(){return{app:null,config:{isNativeTag:wO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let aF=0;function oF(e,t){return function(n,i=null){Nr(n)||(n=Object.assign({},n)),i!=null&&!Kn(i)&&(i=null);const a=_4(),o=new Set;let u=!1;const s=a.app={_uid:aF++,_component:n,_props:i,_container:null,_context:a,_instance:null,version:FF,get config(){return a.config},set config(l){},use(l,...f){return o.has(l)||(l&&Nr(l.install)?(o.add(l),l.install(s,...f)):Nr(l)&&(o.add(l),l(s,...f))),s},mixin(l){return a.mixins.includes(l)||a.mixins.push(l),s},component(l,f){return f?(a.components[l]=f,s):a.components[l]},directive(l,f){return f?(a.directives[l]=f,s):a.directives[l]},mount(l,f,h){if(!u){const d=Pc(n,i);return d.appContext=a,f&&t?t(d,l):e(d,l,h),u=!0,s._container=l,l.__vue_app__=s,$x(d.component)||d.component.proxy}},unmount(){u&&(e(null,s._container),delete s._container.__vue_app__)},provide(l,f){return a.provides[l]=f,s}};return s}}function a1(e,t,r,n,i=!1){if(Dr(e)){e.forEach((d,v)=>a1(d,t&&(Dr(t)?t[v]:t),r,n,i));return}if(cg(n)&&!i)return;const a=n.shapeFlag&4?$x(n.component)||n.component.proxy:n.el,o=i?null:a,{i:u,r:s}=e,l=t&&t.r,f=u.refs===Cn?u.refs={}:u.refs,h=u.setupState;if(l!=null&&l!==s&&(Ti(l)?(f[l]=null,qr(h,l)&&(h[l]=null)):Hi(l)&&(l.value=null)),Nr(s))dl(s,u,12,[o,f]);else{const d=Ti(s),v=Hi(s);if(d||v){const m=()=>{if(e.f){const y=d?qr(h,s)?h[s]:f[s]:s.value;i?Dr(y)&&Cx(y,a):Dr(y)?y.includes(a)||y.push(a):d?(f[s]=[a],qr(h,s)&&(h[s]=f[s])):(s.value=[a],e.k&&(f[e.k]=s.value))}else d?(f[s]=o,qr(h,s)&&(h[s]=o)):v&&(s.value=o,e.k&&(f[e.k]=o))};o?(m.id=-1,ua(m,r)):m()}}}const ua=OL;function uF(e){return sF(e)}function sF(e,t){const r=DO();r.__VUE__=!0;const{insert:n,remove:i,patchProp:a,createElement:o,createText:u,createComment:s,setText:l,setElementText:f,parentNode:h,nextSibling:d,setScopeId:v=No,insertStaticContent:m}=e,y=(k,ae,_e,Ge=null,je=null,Qe=null,Ot=!1,Je=null,yt=!!ae.dynamicChildren)=>{if(k===ae)return;k&&!Mc(k,ae)&&(Ge=gn(k),$t(k,je,Qe,!0),k=null),ae.patchFlag===-2&&(yt=!1,ae.dynamicChildren=null);const{type:et,ref:Wt,shapeFlag:Gt}=ae;switch(et){case sm:_(k,ae,_e,Ge);break;case is:E(k,ae,_e,Ge);break;case Wy:k==null&&S(ae,_e,Ge,Ot);break;case fu:K(k,ae,_e,Ge,je,Qe,Ot,Je,yt);break;default:Gt&1?O(k,ae,_e,Ge,je,Qe,Ot,Je,yt):Gt&6?ue(k,ae,_e,Ge,je,Qe,Ot,Je,yt):(Gt&64||Gt&128)&&et.process(k,ae,_e,Ge,je,Qe,Ot,Je,yt,Mt)}Wt!=null&&je&&a1(Wt,k&&k.ref,Qe,ae||k,!ae)},_=(k,ae,_e,Ge)=>{if(k==null)n(ae.el=u(ae.children),_e,Ge);else{const je=ae.el=k.el;ae.children!==k.children&&l(je,ae.children)}},E=(k,ae,_e,Ge)=>{k==null?n(ae.el=s(ae.children||""),_e,Ge):ae.el=k.el},S=(k,ae,_e,Ge)=>{[k.el,k.anchor]=m(k.children,ae,_e,Ge,k.el,k.anchor)},A=({el:k,anchor:ae},_e,Ge)=>{let je;for(;k&&k!==ae;)je=d(k),n(k,_e,Ge),k=je;n(ae,_e,Ge)},M=({el:k,anchor:ae})=>{let _e;for(;k&&k!==ae;)_e=d(k),i(k),k=_e;i(ae)},O=(k,ae,_e,Ge,je,Qe,Ot,Je,yt)=>{Ot=Ot||ae.type==="svg",k==null?j(ae,_e,Ge,je,Qe,Ot,Je,yt):ne(k,ae,je,Qe,Ot,Je,yt)},j=(k,ae,_e,Ge,je,Qe,Ot,Je)=>{let yt,et;const{type:Wt,props:Gt,shapeFlag:C,transition:Se,dirs:$e}=k;if(yt=k.el=o(k.type,Qe,Gt&&Gt.is,Gt),C&8?f(yt,k.children):C&16&&Y(k.children,yt,null,Ge,je,Qe&&Wt!=="foreignObject",Ot,Je),$e&&vc(k,null,Ge,"created"),Gt){for(const St in Gt)St!=="value"&&!sg(St)&&a(yt,St,null,Gt[St],Qe,k.children,Ge,je,Cr);"value"in Gt&&a(yt,"value",null,Gt.value),(et=Gt.onVnodeBeforeMount)&&nu(et,Ge,k)}q(yt,k,k.scopeId,Ot,Ge),$e&&vc(k,null,Ge,"beforeMount");const ft=(!je||je&&!je.pendingBranch)&&Se&&!Se.persisted;ft&&Se.beforeEnter(yt),n(yt,ae,_e),((et=Gt&&Gt.onVnodeMounted)||ft||$e)&&ua(()=>{et&&nu(et,Ge,k),ft&&Se.enter(yt),$e&&vc(k,null,Ge,"mounted")},je)},q=(k,ae,_e,Ge,je)=>{if(_e&&v(k,_e),Ge)for(let Qe=0;Qe<Ge.length;Qe++)v(k,Ge[Qe]);if(je){let Qe=je.subTree;if(ae===Qe){const Ot=je.vnode;q(k,Ot,Ot.scopeId,Ot.slotScopeIds,je.parent)}}},Y=(k,ae,_e,Ge,je,Qe,Ot,Je,yt=0)=>{for(let et=yt;et<k.length;et++){const Wt=k[et]=Je?ul(k[et]):hu(k[et]);y(null,Wt,ae,_e,Ge,je,Qe,Ot,Je)}},ne=(k,ae,_e,Ge,je,Qe,Ot)=>{const Je=ae.el=k.el;let{patchFlag:yt,dynamicChildren:et,dirs:Wt}=ae;yt|=k.patchFlag&16;const Gt=k.props||Cn,C=ae.props||Cn;let Se;_e&&gc(_e,!1),(Se=C.onVnodeBeforeUpdate)&&nu(Se,_e,ae,k),Wt&&vc(ae,k,_e,"beforeUpdate"),_e&&gc(_e,!0);const $e=je&&ae.type!=="foreignObject";if(et?X(k.dynamicChildren,et,Je,_e,Ge,$e,Qe):Ot||Me(k,ae,Je,null,_e,Ge,$e,Qe,!1),yt>0){if(yt&16)$(Je,ae,Gt,C,_e,Ge,je);else if(yt&2&&Gt.class!==C.class&&a(Je,"class",null,C.class,je),yt&4&&a(Je,"style",Gt.style,C.style,je),yt&8){const ft=ae.dynamicProps;for(let St=0;St<ft.length;St++){const pr=ft[St],rr=Gt[pr],sr=C[pr];(sr!==rr||pr==="value")&&a(Je,pr,rr,sr,je,k.children,_e,Ge,Cr)}}yt&1&&k.children!==ae.children&&f(Je,ae.children)}else!Ot&&et==null&&$(Je,ae,Gt,C,_e,Ge,je);((Se=C.onVnodeUpdated)||Wt)&&ua(()=>{Se&&nu(Se,_e,ae,k),Wt&&vc(ae,k,_e,"updated")},Ge)},X=(k,ae,_e,Ge,je,Qe,Ot)=>{for(let Je=0;Je<ae.length;Je++){const yt=k[Je],et=ae[Je],Wt=yt.el&&(yt.type===fu||!Mc(yt,et)||yt.shapeFlag&70)?h(yt.el):_e;y(yt,et,Wt,null,Ge,je,Qe,Ot,!0)}},$=(k,ae,_e,Ge,je,Qe,Ot)=>{if(_e!==Ge){if(_e!==Cn)for(const Je in _e)!sg(Je)&&!(Je in Ge)&&a(k,Je,_e[Je],null,Ot,ae.children,je,Qe,Cr);for(const Je in Ge){if(sg(Je))continue;const yt=Ge[Je],et=_e[Je];yt!==et&&Je!=="value"&&a(k,Je,et,yt,Ot,ae.children,je,Qe,Cr)}"value"in Ge&&a(k,"value",_e.value,Ge.value)}},K=(k,ae,_e,Ge,je,Qe,Ot,Je,yt)=>{const et=ae.el=k?k.el:u(""),Wt=ae.anchor=k?k.anchor:u("");let{patchFlag:Gt,dynamicChildren:C,slotScopeIds:Se}=ae;Se&&(Je=Je?Je.concat(Se):Se),k==null?(n(et,_e,Ge),n(Wt,_e,Ge),Y(ae.children,_e,Wt,je,Qe,Ot,Je,yt)):Gt>0&&Gt&64&&C&&k.dynamicChildren?(X(k.dynamicChildren,C,_e,je,Qe,Ot,Je),(ae.key!=null||je&&ae===je.subTree)&&x4(k,ae,!0)):Me(k,ae,_e,Wt,je,Qe,Ot,Je,yt)},ue=(k,ae,_e,Ge,je,Qe,Ot,Je,yt)=>{ae.slotScopeIds=Je,k==null?ae.shapeFlag&512?je.ctx.activate(ae,_e,Ge,Ot,yt):de(ae,_e,Ge,je,Qe,Ot,yt):pe(k,ae,yt)},de=(k,ae,_e,Ge,je,Qe,Ot)=>{const Je=k.component=bF(k,Ge,je);if(om(k)&&(Je.ctx.renderer=Mt),AF(Je),Je.asyncDep){if(je&&je.registerDep(Je,le),!k.el){const yt=Je.subTree=Pc(is);E(null,yt,ae,_e)}return}le(Je,k,ae,_e,je,Qe,Ot)},pe=(k,ae,_e)=>{const Ge=ae.component=k.component;if(wL(k,ae,_e))if(Ge.asyncDep&&!Ge.asyncResolved){ve(Ge,ae,_e);return}else Ge.next=ae,xL(Ge.update),Ge.update();else ae.el=k.el,Ge.vnode=ae},le=(k,ae,_e,Ge,je,Qe,Ot)=>{const Je=()=>{if(k.isMounted){let{next:Wt,bu:Gt,u:C,parent:Se,vnode:$e}=k,ft=Wt,St;gc(k,!1),Wt?(Wt.el=$e.el,ve(k,Wt,Ot)):Wt=$e,Gt&&$y(Gt),(St=Wt.props&&Wt.props.onVnodeBeforeUpdate)&&nu(St,Se,Wt,$e),gc(k,!0);const pr=Gy(k),rr=k.subTree;k.subTree=pr,y(rr,pr,h(rr.el),gn(rr),k,je,Qe),Wt.el=pr.el,ft===null&&ML(k,pr.el),C&&ua(C,je),(St=Wt.props&&Wt.props.onVnodeUpdated)&&ua(()=>nu(St,Se,Wt,$e),je)}else{let Wt;const{el:Gt,props:C}=ae,{bm:Se,m:$e,parent:ft}=k,St=cg(ae);if(gc(k,!1),Se&&$y(Se),!St&&(Wt=C&&C.onVnodeBeforeMount)&&nu(Wt,ft,ae),gc(k,!0),Gt&&ar){const pr=()=>{k.subTree=Gy(k),ar(Gt,k.subTree,k,je,null)};St?ae.type.__asyncLoader().then(()=>!k.isUnmounted&&pr()):pr()}else{const pr=k.subTree=Gy(k);y(null,pr,_e,Ge,k,je,Qe),ae.el=pr.el}if($e&&ua($e,je),!St&&(Wt=C&&C.onVnodeMounted)){const pr=ae;ua(()=>nu(Wt,ft,pr),je)}(ae.shapeFlag&256||ft&&cg(ft.vnode)&&ft.vnode.shapeFlag&256)&&k.a&&ua(k.a,je),k.isMounted=!0,ae=_e=Ge=null}},yt=k.effect=new Mx(Je,()=>Bx(et),k.scope),et=k.update=()=>yt.run();et.id=k.uid,gc(k,!0),et()},ve=(k,ae,_e)=>{ae.component=k;const Ge=k.vnode.props;k.vnode=ae,k.next=null,tF(k,ae.props,Ge,_e),iF(k,ae.children,_e),zh(),O2(),$h()},Me=(k,ae,_e,Ge,je,Qe,Ot,Je,yt=!1)=>{const et=k&&k.children,Wt=k?k.shapeFlag:0,Gt=ae.children,{patchFlag:C,shapeFlag:Se}=ae;if(C>0){if(C&128){Xe(et,Gt,_e,Ge,je,Qe,Ot,Je,yt);return}else if(C&256){Ne(et,Gt,_e,Ge,je,Qe,Ot,Je,yt);return}}Se&8?(Wt&16&&Cr(et,je,Qe),Gt!==et&&f(_e,Gt)):Wt&16?Se&16?Xe(et,Gt,_e,Ge,je,Qe,Ot,Je,yt):Cr(et,je,Qe,!0):(Wt&8&&f(_e,""),Se&16&&Y(Gt,_e,Ge,je,Qe,Ot,Je,yt))},Ne=(k,ae,_e,Ge,je,Qe,Ot,Je,yt)=>{k=k||dh,ae=ae||dh;const et=k.length,Wt=ae.length,Gt=Math.min(et,Wt);let C;for(C=0;C<Gt;C++){const Se=ae[C]=yt?ul(ae[C]):hu(ae[C]);y(k[C],Se,_e,null,je,Qe,Ot,Je,yt)}et>Wt?Cr(k,je,Qe,!0,!1,Gt):Y(ae,_e,Ge,je,Qe,Ot,Je,yt,Gt)},Xe=(k,ae,_e,Ge,je,Qe,Ot,Je,yt)=>{let et=0;const Wt=ae.length;let Gt=k.length-1,C=Wt-1;for(;et<=Gt&&et<=C;){const Se=k[et],$e=ae[et]=yt?ul(ae[et]):hu(ae[et]);if(Mc(Se,$e))y(Se,$e,_e,null,je,Qe,Ot,Je,yt);else break;et++}for(;et<=Gt&&et<=C;){const Se=k[Gt],$e=ae[C]=yt?ul(ae[C]):hu(ae[C]);if(Mc(Se,$e))y(Se,$e,_e,null,je,Qe,Ot,Je,yt);else break;Gt--,C--}if(et>Gt){if(et<=C){const Se=C+1,$e=Se<Wt?ae[Se].el:Ge;for(;et<=C;)y(null,ae[et]=yt?ul(ae[et]):hu(ae[et]),_e,$e,je,Qe,Ot,Je,yt),et++}}else if(et>C)for(;et<=Gt;)$t(k[et],je,Qe,!0),et++;else{const Se=et,$e=et,ft=new Map;for(et=$e;et<=C;et++){const Yr=ae[et]=yt?ul(ae[et]):hu(ae[et]);Yr.key!=null&&ft.set(Yr.key,et)}let St,pr=0;const rr=C-$e+1;let sr=!1,Jt=0;const Er=new Array(rr);for(et=0;et<rr;et++)Er[et]=0;for(et=Se;et<=Gt;et++){const Yr=k[et];if(pr>=rr){$t(Yr,je,Qe,!0);continue}let Zr;if(Yr.key!=null)Zr=ft.get(Yr.key);else for(St=$e;St<=C;St++)if(Er[St-$e]===0&&Mc(Yr,ae[St])){Zr=St;break}Zr===void 0?$t(Yr,je,Qe,!0):(Er[Zr-$e]=et+1,Zr>=Jt?Jt=Zr:sr=!0,y(Yr,ae[Zr],_e,null,je,Qe,Ot,Je,yt),pr++)}const Ar=sr?lF(Er):dh;for(St=Ar.length-1,et=rr-1;et>=0;et--){const Yr=$e+et,Zr=ae[Yr],Da=Yr+1<Wt?ae[Yr+1].el:Ge;Er[et]===0?y(null,Zr,_e,Da,je,Qe,Ot,Je,yt):sr&&(St<0||et!==Ar[St]?ct(Zr,_e,Da,2):St--)}}},ct=(k,ae,_e,Ge,je=null)=>{const{el:Qe,type:Ot,transition:Je,children:yt,shapeFlag:et}=k;if(et&6){ct(k.component.subTree,ae,_e,Ge);return}if(et&128){k.suspense.move(ae,_e,Ge);return}if(et&64){Ot.move(k,ae,_e,Mt);return}if(Ot===fu){n(Qe,ae,_e);for(let Gt=0;Gt<yt.length;Gt++)ct(yt[Gt],ae,_e,Ge);n(k.anchor,ae,_e);return}if(Ot===Wy){A(k,ae,_e);return}if(Ge!==2&&et&1&&Je)if(Ge===0)Je.beforeEnter(Qe),n(Qe,ae,_e),ua(()=>Je.enter(Qe),je);else{const{leave:Gt,delayLeave:C,afterLeave:Se}=Je,$e=()=>n(Qe,ae,_e),ft=()=>{Gt(Qe,()=>{$e(),Se&&Se()})};C?C(Qe,$e,ft):ft()}else n(Qe,ae,_e)},$t=(k,ae,_e,Ge=!1,je=!1)=>{const{type:Qe,props:Ot,ref:Je,children:yt,dynamicChildren:et,shapeFlag:Wt,patchFlag:Gt,dirs:C}=k;if(Je!=null&&a1(Je,null,_e,k,!0),Wt&256){ae.ctx.deactivate(k);return}const Se=Wt&1&&C,$e=!cg(k);let ft;if($e&&(ft=Ot&&Ot.onVnodeBeforeUnmount)&&nu(ft,ae,k),Wt&6)jt(k.component,_e,Ge);else{if(Wt&128){k.suspense.unmount(_e,Ge);return}Se&&vc(k,null,ae,"beforeUnmount"),Wt&64?k.type.remove(k,ae,_e,je,Mt,Ge):et&&(Qe!==fu||Gt>0&&Gt&64)?Cr(et,ae,_e,!1,!0):(Qe===fu&&Gt&384||!je&&Wt&16)&&Cr(yt,ae,_e),Ge&&Qt(k)}($e&&(ft=Ot&&Ot.onVnodeUnmounted)||Se)&&ua(()=>{ft&&nu(ft,ae,k),Se&&vc(k,null,ae,"unmounted")},_e)},Qt=k=>{const{type:ae,el:_e,anchor:Ge,transition:je}=k;if(ae===fu){Zt(_e,Ge);return}if(ae===Wy){M(k);return}const Qe=()=>{i(_e),je&&!je.persisted&&je.afterLeave&&je.afterLeave()};if(k.shapeFlag&1&&je&&!je.persisted){const{leave:Ot,delayLeave:Je}=je,yt=()=>Ot(_e,Qe);Je?Je(k.el,Qe,yt):yt()}else Qe()},Zt=(k,ae)=>{let _e;for(;k!==ae;)_e=d(k),i(k),k=_e;i(ae)},jt=(k,ae,_e)=>{const{bum:Ge,scope:je,update:Qe,subTree:Ot,um:Je}=k;Ge&&$y(Ge),je.stop(),Qe&&(Qe.active=!1,$t(Ot,k,ae,_e)),Je&&ua(Je,ae),ua(()=>{k.isUnmounted=!0},ae),ae&&ae.pendingBranch&&!ae.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===ae.pendingId&&(ae.deps--,ae.deps===0&&ae.resolve())},Cr=(k,ae,_e,Ge=!1,je=!1,Qe=0)=>{for(let Ot=Qe;Ot<k.length;Ot++)$t(k[Ot],ae,_e,Ge,je)},gn=k=>k.shapeFlag&6?gn(k.component.subTree):k.shapeFlag&128?k.suspense.next():d(k.anchor||k.el),ii=(k,ae,_e)=>{k==null?ae._vnode&&$t(ae._vnode,null,null,!0):y(ae._vnode||null,k,ae,null,null,null,_e),O2(),t4(),ae._vnode=k},Mt={p:y,um:$t,m:ct,r:Qt,mt:de,mc:Y,pc:Me,pbc:X,n:gn,o:e};let qt,ar;return t&&([qt,ar]=t(Mt)),{render:ii,hydrate:qt,createApp:oF(ii,qt)}}function gc({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function x4(e,t,r=!1){const n=e.children,i=t.children;if(Dr(n)&&Dr(i))for(let a=0;a<n.length;a++){const o=n[a];let u=i[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=i[a]=ul(i[a]),u.el=o.el),r||x4(o,u)),u.type===sm&&(u.el=o.el)}}function lF(e){const t=e.slice(),r=[0];let n,i,a,o,u;const s=e.length;for(n=0;n<s;n++){const l=e[n];if(l!==0){if(i=r[r.length-1],e[i]<l){t[n]=i,r.push(n);continue}for(a=0,o=r.length-1;a<o;)u=a+o>>1,e[r[u]]<l?a=u+1:o=u;l<e[r[a]]&&(a>0&&(t[n]=r[a-1]),r[a]=n)}}for(a=r.length,o=r[a-1];a-- >0;)r[a]=o,o=t[o];return r}const cF=e=>e.__isTeleport,fu=Symbol(void 0),sm=Symbol(void 0),is=Symbol(void 0),Wy=Symbol(void 0),wd=[];let Po=null;function fF(e=!1){wd.push(Po=e?null:[])}function hF(){wd.pop(),Po=wd[wd.length-1]||null}let zd=1;function U2(e){zd+=e}function pF(e){return e.dynamicChildren=zd>0?Po||dh:null,hF(),zd>0&&Po&&Po.push(e),e}function dF(e,t,r,n,i,a){return pF(b4(e,t,r,n,i,a,!0))}function vF(e){return e?e.__v_isVNode===!0:!1}function Mc(e,t){return e.type===t.type&&e.key===t.key}const lm="__vInternal",E4=({key:e})=>e!=null?e:null,fg=({ref:e,ref_key:t,ref_for:r})=>e!=null?Ti(e)||Hi(e)||Nr(e)?{i:ko,r:e,k:t,f:!!r}:e:null;function b4(e,t=null,r=null,n=0,i=null,a=e===fu?0:1,o=!1,u=!1){const s={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&E4(t),ref:t&&fg(t),scopeId:i4,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:ko};return u?(zx(s,r),a&128&&e.normalize(s)):r&&(s.shapeFlag|=Ti(r)?8:16),zd>0&&!o&&Po&&(s.patchFlag>0||a&6)&&s.patchFlag!==32&&Po.push(s),s}const Pc=gF;function gF(e,t=null,r=null,n=0,i=null,a=!1){if((!e||e===XL)&&(e=is),vF(e)){const u=_l(e,t,!0);return r&&zx(u,r),zd>0&&!a&&Po&&(u.shapeFlag&6?Po[Po.indexOf(e)]=u:Po.push(u)),u.patchFlag|=-2,u}if(MF(e)&&(e=e.__vccOpts),t){t=mF(t);let{class:u,style:s}=t;u&&!Ti(u)&&(t.class=Ex(u)),Kn(s)&&(Zw(s)&&!Dr(s)&&(s=Fi({},s)),t.style=xx(s))}const o=Ti(e)?1:RL(e)?128:cF(e)?64:Kn(e)?4:Nr(e)?2:0;return b4(e,t,r,n,i,o,a,!0)}function mF(e){return e?Zw(e)||lm in e?Fi({},e):e:null}function _l(e,t,r=!1){const{props:n,ref:i,patchFlag:a,children:o}=e,u=t?_F(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&E4(u),ref:t&&t.ref?r&&i?Dr(i)?i.concat(fg(t)):[i,fg(t)]:fg(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==fu?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&_l(e.ssContent),ssFallback:e.ssFallback&&_l(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function yF(e=" ",t=0){return Pc(sm,null,e,t)}function hu(e){return e==null||typeof e=="boolean"?Pc(is):Dr(e)?Pc(fu,null,e.slice()):typeof e=="object"?ul(e):Pc(sm,null,String(e))}function ul(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:_l(e)}function zx(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Dr(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),zx(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!(lm in t)?t._ctx=ko:i===3&&ko&&(ko.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Nr(t)?(t={default:t,_ctx:ko},r=32):(t=String(t),n&64?(r=16,t=[yF(t)]):r=8);e.children=t,e.shapeFlag|=r}function _F(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=Ex([t.class,n.class]));else if(i==="style")t.style=xx([t.style,n.style]);else if(em(i)){const a=t[i],o=n[i];o&&a!==o&&!(Dr(a)&&a.includes(o))&&(t[i]=a?[].concat(a,o):o)}else i!==""&&(t[i]=n[i])}return t}function nu(e,t,r,n=null){ao(e,t,7,[r,n])}const xF=_4();let EF=0;function bF(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||xF,a={uid:EF++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new BO(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:v4(n,i),emitsOptions:n4(n,i),emit:null,emitted:null,propsDefaults:Cn,inheritAttrs:n.inheritAttrs,ctx:Cn,data:Cn,props:Cn,attrs:Cn,slots:Cn,refs:Cn,setupState:Cn,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=CL.bind(null,a),e.ce&&e.ce(a),a}let Si=null;const CF=()=>Si||ko,Ah=e=>{Si=e,e.scope.on()},Dc=()=>{Si&&Si.scope.off(),Si=null};function C4(e){return e.vnode.shapeFlag&4}let $d=!1;function AF(e,t=!1){$d=t;const{props:r,children:n}=e.vnode,i=C4(e);eF(e,r,i,t),nF(e,n);const a=i?SF(e,t):void 0;return $d=!1,a}function SF(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=qw(new Proxy(e.ctx,YL));const{setup:n}=r;if(n){const i=e.setupContext=n.length>1?wF(e):null;Ah(e),zh();const a=dl(n,e,0,[e.props,i]);if($h(),Dc(),Pw(a)){if(a.then(Dc,Dc),t)return a.then(o=>{z2(e,o,t)}).catch(o=>{im(o,e,0)});e.asyncDep=a}else z2(e,a,t)}else A4(e,t)}function z2(e,t,r){Nr(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Kn(t)&&(e.setupState=Kw(t)),A4(e,r)}let $2;function A4(e,t,r){const n=e.type;if(!e.render){if(!t&&$2&&!n.render){const i=n.template||Nx(e).template;if(i){const{isCustomElement:a,compilerOptions:o}=e.appContext.config,{delimiters:u,compilerOptions:s}=n,l=Fi(Fi({isCustomElement:a,delimiters:u},o),s);n.render=$2(i,l)}}e.render=n.render||No}Ah(e),zh(),ZL(e),$h(),Dc()}function TF(e){return new Proxy(e.attrs,{get(t,r){return ka(e,"get","$attrs"),t[r]}})}function wF(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=TF(e))},slots:e.slots,emit:e.emit,expose:t}}function $x(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Kw(qw(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Td)return Td[r](e)},has(t,r){return r in t||r in Td}}))}function MF(e){return Nr(e)&&"__vccOpts"in e}const RF=(e,t)=>gL(e,t,$d),OF=Symbol(""),LF=()=>lg(OF),FF="3.2.45",IF="http://www.w3.org/2000/svg",Rc=typeof document<"u"?document:null,G2=Rc&&Rc.createElement("template"),kF={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t?Rc.createElementNS(IF,e):Rc.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>Rc.createTextNode(e),createComment:e=>Rc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Rc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,i,a){const o=r?r.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===a||!(i=i.nextSibling)););else{G2.innerHTML=n?`<svg>${e}</svg>`:e;const u=G2.content;if(n){const s=u.firstChild;for(;s.firstChild;)u.appendChild(s.firstChild);u.removeChild(s)}t.insertBefore(u,r)}return[o?o.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function PF(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function DF(e,t,r){const n=e.style,i=Ti(r);if(r&&!i){for(const a in r)o1(n,a,r[a]);if(t&&!Ti(t))for(const a in t)r[a]==null&&o1(n,a,"")}else{const a=n.display;i?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=a)}}const H2=/\s*!important$/;function o1(e,t,r){if(Dr(r))r.forEach(n=>o1(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=BF(e,t);H2.test(r)?e.setProperty(Uh(n),r.replace(H2,""),"important"):e[n]=r}}const V2=["Webkit","Moz","ms"],Xy={};function BF(e,t){const r=Xy[t];if(r)return r;let n=Ch(t);if(n!=="filter"&&n in e)return Xy[t]=n;n=Dw(n);for(let i=0;i<V2.length;i++){const a=V2[i]+n;if(a in e)return Xy[t]=a}return t}const j2="http://www.w3.org/1999/xlink";function NF(e,t,r,n,i){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(j2,t.slice(6,t.length)):e.setAttributeNS(j2,t,r);else{const a=TO(t);r==null||a&&!kw(r)?e.removeAttribute(t):e.setAttribute(t,a?"":r)}}function UF(e,t,r,n,i,a,o){if(t==="innerHTML"||t==="textContent"){n&&o(n,i,a),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const s=r==null?"":r;(e.value!==s||e.tagName==="OPTION")&&(e.value=s),r==null&&e.removeAttribute(t);return}let u=!1;if(r===""||r==null){const s=typeof e[t];s==="boolean"?r=kw(r):r==null&&s==="string"?(r="",u=!0):s==="number"&&(r=0,u=!0)}try{e[t]=r}catch{}u&&e.removeAttribute(t)}function zF(e,t,r,n){e.addEventListener(t,r,n)}function $F(e,t,r,n){e.removeEventListener(t,r,n)}function GF(e,t,r,n,i=null){const a=e._vei||(e._vei={}),o=a[t];if(n&&o)o.value=n;else{const[u,s]=HF(t);if(n){const l=a[t]=WF(n,i);zF(e,u,l,s)}else o&&($F(e,u,o,s),a[t]=void 0)}}const W2=/(?:Once|Passive|Capture)$/;function HF(e){let t;if(W2.test(e)){t={};let n;for(;n=e.match(W2);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Uh(e.slice(2)),t]}let Yy=0;const VF=Promise.resolve(),jF=()=>Yy||(VF.then(()=>Yy=0),Yy=Date.now());function WF(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;ao(XF(n,r.value),t,5,[n])};return r.value=e,r.attached=jF(),r}function XF(e,t){if(Dr(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const X2=/^on[a-z]/,YF=(e,t,r,n,i=!1,a,o,u,s)=>{t==="class"?PF(e,n,i):t==="style"?DF(e,r,n):em(t)?bx(t)||GF(e,t,r,n,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):ZF(e,t,n,i))?UF(e,t,n,a,o,u,s):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),NF(e,t,n,i))};function ZF(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&X2.test(t)&&Nr(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||X2.test(t)&&Ti(r)?!1:t in e}const qF={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};PL.props;const KF=Fi({patchProp:YF},kF);let Y2;function QF(){return Y2||(Y2=uF(KF))}const JF=(...e)=>{const t=QF().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=eI(n);if(!i)return;const a=t._component;!Nr(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const o=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t};function eI(e){return Ti(e)?document.querySelector(e):e}var S4={},T4={},Z2=function(t){return T4[t]},bu=function(t,r){T4[t]=r},tI=function(t){return S4[t]},Gh=function(t,r){S4[t]=r},q2={},Zy={},qy=34,Qp=10,Ky=13;function w4(e){return new Function("d","return {"+e.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function rI(e,t){var r=w4(e);return function(n,i){return t(r(n),i,e)}}function K2(e){var t=Object.create(null),r=[];return e.forEach(function(n){for(var i in n)i in t||r.push(t[i]=i)}),r}function sa(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function nI(e){return e<0?"-"+sa(-e,6):e>9999?"+"+sa(e,6):sa(e,4)}function iI(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":nI(e.getUTCFullYear())+"-"+sa(e.getUTCMonth()+1,2)+"-"+sa(e.getUTCDate(),2)+(i?"T"+sa(t,2)+":"+sa(r,2)+":"+sa(n,2)+"."+sa(i,3)+"Z":n?"T"+sa(t,2)+":"+sa(r,2)+":"+sa(n,2)+"Z":r||t?"T"+sa(t,2)+":"+sa(r,2)+"Z":"")}function aI(e){var t=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function n(h,d){var v,m,y=i(h,function(_,E){if(v)return v(_,E-1);m=_,v=d?rI(_,d):w4(_)});return y.columns=m||[],y}function i(h,d){var v=[],m=h.length,y=0,_=0,E,S=m<=0,A=!1;h.charCodeAt(m-1)===Qp&&--m,h.charCodeAt(m-1)===Ky&&--m;function M(){if(S)return Zy;if(A)return A=!1,q2;var j,q=y,Y;if(h.charCodeAt(q)===qy){for(;y++<m&&h.charCodeAt(y)!==qy||h.charCodeAt(++y)===qy;);return(j=y)>=m?S=!0:(Y=h.charCodeAt(y++))===Qp?A=!0:Y===Ky&&(A=!0,h.charCodeAt(y)===Qp&&++y),h.slice(q+1,j-1).replace(/""/g,'"')}for(;y<m;){if((Y=h.charCodeAt(j=y++))===Qp)A=!0;else if(Y===Ky)A=!0,h.charCodeAt(y)===Qp&&++y;else if(Y!==r)continue;return h.slice(q,j)}return S=!0,h.slice(q,m)}for(;(E=M())!==Zy;){for(var O=[];E!==q2&&E!==Zy;)O.push(E),E=M();d&&(O=d(O,_++))==null||v.push(O)}return v}function a(h,d){return h.map(function(v){return d.map(function(m){return f(v[m])}).join(e)})}function o(h,d){return d==null&&(d=K2(h)),[d.map(f).join(e)].concat(a(h,d)).join(`
`)}function u(h,d){return d==null&&(d=K2(h)),a(h,d).join(`
`)}function s(h){return h.map(l).join(`
`)}function l(h){return h.map(f).join(e)}function f(h){return h==null?"":h instanceof Date?iI(h):t.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:n,parseRows:i,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:f}}var oI=aI(","),uI=oI.parse;function u1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sI(e){if(Array.isArray(e))return u1(e)}function lI(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function M4(e,t){if(!!e){if(typeof e=="string")return u1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u1(e,t)}}function cI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function It(e){return sI(e)||lI(e)||M4(e)||cI()}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q2(Object(r),!0).forEach(function(n){T(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fI(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var s1=hg;function hg(e,t){var r=e&&e.type,n;if(r==="FeatureCollection")for(n=0;n<e.features.length;n++)hg(e.features[n],t);else if(r==="GeometryCollection")for(n=0;n<e.geometries.length;n++)hg(e.geometries[n],t);else if(r==="Feature")hg(e.geometry,t);else if(r==="Polygon")J2(e.coordinates,t);else if(r==="MultiPolygon")for(n=0;n<e.coordinates.length;n++)J2(e.coordinates[n],t);return e}function J2(e,t){if(e.length!==0){eb(e[0],t);for(var r=1;r<e.length;r++)eb(e[r],!t)}}function eb(e,t){for(var r=0,n=0,i=0,a=e.length,o=a-1;i<a;o=i++){var u=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),s=r+u;n+=Math.abs(r)>=Math.abs(u)?r-s+u:u-s+r,r=s}r+n>=0!=!!t&&e.reverse()}var ia=63710088e-1,hI={centimeters:ia*100,centimetres:ia*100,degrees:ia/111325,feet:ia*3.28084,inches:ia*39.37,kilometers:ia/1e3,kilometres:ia/1e3,meters:ia,metres:ia,miles:ia/1609.344,millimeters:ia*1e3,millimetres:ia*1e3,nauticalmiles:ia/1852,radians:1,yards:ia*1.0936};function Sh(e,t,r){r===void 0&&(r={});var n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function l1(e,t,r){if(r===void 0&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!rb(e[0])||!rb(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return Sh(n,t,r)}function cm(e,t,r){r===void 0&&(r={});for(var n=0,i=e;n<i.length;n++){var a=i[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:e};return Sh(u,t,r)}function pI(e,t,r){if(r===void 0&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return Sh(n,t,r)}function pg(e,t){t===void 0&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function dI(e,t,r){r===void 0&&(r={});var n={type:"MultiPolygon",coordinates:e};return Sh(n,t,r)}function vI(e,t){t===void 0&&(t="kilometers");var r=hI[t];if(!r)throw new Error(t+" units is invalid");return e/r}function tb(e){var t=e%(2*Math.PI);return t*180/Math.PI}function Qy(e){var t=e%360;return t*Math.PI/180}function rb(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function gI(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function R4(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function nb(e){return e.type==="Feature"?e.geometry:e}function O4(e,t,r){if(e!==null)for(var n,i,a,o,u,s,l,f=0,h=0,d,v=e.type,m=v==="FeatureCollection",y=v==="Feature",_=m?e.features.length:1,E=0;E<_;E++){l=m?e.features[E].geometry:y?e.geometry:e,d=l?l.type==="GeometryCollection":!1,u=d?l.geometries.length:1;for(var S=0;S<u;S++){var A=0,M=0;if(o=d?l.geometries[S]:l,o!==null){s=o.coordinates;var O=o.type;switch(f=r&&(O==="Polygon"||O==="MultiPolygon")?1:0,O){case null:break;case"Point":if(t(s,h,E,A,M)===!1)return!1;h++,A++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(t(s[n],h,E,A,M)===!1)return!1;h++,O==="MultiPoint"&&A++}O==="LineString"&&A++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(i=0;i<s[n].length-f;i++){if(t(s[n][i],h,E,A,M)===!1)return!1;h++}O==="MultiLineString"&&A++,O==="Polygon"&&M++}O==="Polygon"&&A++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(M=0,i=0;i<s[n].length;i++){for(a=0;a<s[n][i].length-f;a++){if(t(s[n][i][a],h,E,A,M)===!1)return!1;h++}M++}A++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(O4(o.geometries[n],t,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function mI(e,t){var r,n,i,a,o,u,s,l,f,h,d=0,v=e.type==="FeatureCollection",m=e.type==="Feature",y=v?e.features.length:1;for(r=0;r<y;r++){for(u=v?e.features[r].geometry:m?e.geometry:e,l=v?e.features[r].properties:m?e.properties:{},f=v?e.features[r].bbox:m?e.bbox:void 0,h=v?e.features[r].id:m?e.id:void 0,s=u?u.type==="GeometryCollection":!1,o=s?u.geometries.length:1,i=0;i<o;i++){if(a=s?u.geometries[i]:u,a===null){if(t(null,d,l,f,h)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,d,l,f,h)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(t(a.geometries[n],d,l,f,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}function L4(e,t){mI(e,function(r,n,i,a,o){var u=r===null?null:r.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return t(Sh(r,i,{bbox:a,id:o}),n,0)===!1?!1:void 0}var s;switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var l=0;l<r.coordinates.length;l++){var f=r.coordinates[l],h={type:s,coordinates:f};if(t(Sh(h,i),n,l)===!1)return!1}})}function F4(e,t){var r=t.x,n=t.y,i=t.x1,a=t.y1,o=t.coordinates,u=t.geometry,s=[];if(!Array.isArray(e))return{dataArray:[]};if(u)return e.filter(function(E){return E[u]&&E[u].type&&E[u].coordinates&&E[u].coordinates.length>0}).forEach(function(E,S){var A=s1(be({},E[u]),!0);L4(A,function(M){var O=R4(M),j=be(be({},E),{},{_id:S,coordinates:O});s.push(j)})}),{dataArray:s};for(var l=0;l<e.length;l++){var f=e[l],h=[];if(o){var d="Polygon";Array.isArray(o[0])||(d="Point"),Array.isArray(o[0])&&!Array.isArray(o[0][0])&&(d="LineString");var v=s1({type:d,coordinates:It(f[o])},!0);h=v.coordinates}else if(r&&n&&i&&a){var m=[parseFloat(f[r]),parseFloat(f[n])],y=[parseFloat(f[i]),parseFloat(f[a])];h=[m,y]}else r&&n&&(h=[parseFloat(f[r]),parseFloat(f[n])]);var _=be(be({},f),{},{_id:l,coordinates:h});s.push(_)}return{dataArray:s}}function yI(e,t){var r=uI(e);return F4(r,t)}function _I(e){for(var t=e.toString(),r=5381,n=t.length;n;)r=r*33^t.charCodeAt(--n);return r>>>0}function xI(e,t){return t===void 0?null:e.properties[t]?e.properties[t]:e.properties&&e.properties[t]?_I(e.properties[t]+"")%1000019:null}function EI(e,t){var r=[],n={};return e.features?(e.features=e.features.filter(function(i){var a=i.geometry;return i!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),s1(e,!0),e.features.length===0?{dataArray:[],featureKeys:n}:(L4(e,function(i,a){var o=xI(i,t==null?void 0:t.featureId);o===null&&(o=a);var u=o,s=R4(i),l=be(be({},i.properties),{},{coordinates:s,_id:u});r.push(l)}),{dataArray:r,featureKeys:n})):(e.features=[],{dataArray:[]})}function bI(e){if(Array.isArray(e))return e}function CI(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],i=!0,a=!1,o,u;try{for(r=r.call(e);!(i=(o=r.next()).done)&&(n.push(o.value),!(t&&n.length===t));i=!0);}catch(s){a=!0,u=s}finally{try{!i&&r.return!=null&&r.return()}finally{if(a)throw u}}return n}}function AI(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ir(e,t){return bI(e)||CI(e,t)||M4(e,t)||AI()}var tt={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,t){(function(){var r,n="4.17.21",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",u="Invalid `variable` option passed into `_.template`",s="__lodash_hash_undefined__",l=500,f="__lodash_placeholder__",h=1,d=2,v=4,m=1,y=2,_=1,E=2,S=4,A=8,M=16,O=32,j=64,q=128,Y=256,ne=512,X=30,$="...",K=800,ue=16,de=1,pe=2,le=3,ve=1/0,Me=9007199254740991,Ne=17976931348623157e292,Xe=0/0,ct=4294967295,$t=ct-1,Qt=ct>>>1,Zt=[["ary",q],["bind",_],["bindKey",E],["curry",A],["curryRight",M],["flip",ne],["partial",O],["partialRight",j],["rearg",Y]],jt="[object Arguments]",Cr="[object Array]",gn="[object AsyncFunction]",ii="[object Boolean]",Mt="[object Date]",qt="[object DOMException]",ar="[object Error]",k="[object Function]",ae="[object GeneratorFunction]",_e="[object Map]",Ge="[object Number]",je="[object Null]",Qe="[object Object]",Ot="[object Promise]",Je="[object Proxy]",yt="[object RegExp]",et="[object Set]",Wt="[object String]",Gt="[object Symbol]",C="[object Undefined]",Se="[object WeakMap]",$e="[object WeakSet]",ft="[object ArrayBuffer]",St="[object DataView]",pr="[object Float32Array]",rr="[object Float64Array]",sr="[object Int8Array]",Jt="[object Int16Array]",Er="[object Int32Array]",Ar="[object Uint8Array]",Yr="[object Uint8ClampedArray]",Zr="[object Uint16Array]",Da="[object Uint32Array]",Wh=/\b__p \+= '';/g,Jc=/\b(__p \+=) '' \+/g,Xh=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Au=/&(?:amp|lt|gt|quot|#39);/g,ef=/[&<>"']/g,Yh=RegExp(Au.source),tf=RegExp(ef.source),wl=/<%-([\s\S]+?)%>/g,ps=/<%([\s\S]+?)%>/g,rf=/<%=([\s\S]+?)%>/g,Zh=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pi=/^\w*$/,nf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ml=/[\\^$.*+?()[\]{}|]/g,qh=RegExp(Ml.source),Rl=/^\s+/,ds=/\s/,Kh=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qh=/\{\n\/\* \[wrapped with (.+)\] \*/,af=/,? & /,vs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,of=/[()=,{}\[\]\/\s]/,fn=/\\(\\)?/g,Jh=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ol=/\w*$/,uf=/^[-+]0x[0-9a-f]+$/i,sf=/^0b[01]+$/i,lf=/^\[object .+?Constructor\]$/,Ll=/^0o[0-7]+$/i,co=/^(?:0|[1-9]\d*)$/,Su=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ba=/($^)/,gs=/['\n\r\u2028\u2029\\]/g,zo="\\ud800-\\udfff",ep="\\u0300-\\u036f",tp="\\ufe20-\\ufe2f",ms="\\u20d0-\\u20ff",di=ep+tp+ms,fo="\\u2700-\\u27bf",ha="a-z\\xdf-\\xf6\\xf8-\\xff",pa="\\xac\\xb1\\xd7\\xf7",Tu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xi="\\u2000-\\u206f",da=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fl="A-Z\\xc0-\\xd6\\xd8-\\xde",Il="\\ufe0e\\ufe0f",wu=pa+Tu+Xi+da,vi="['\u2019]",ys="["+zo+"]",_s="["+wu+"]",va="["+di+"]",Mu="\\d+",kl="["+fo+"]",Ru="["+ha+"]",ai="[^"+zo+wu+Mu+fo+ha+Fl+"]",Ou="\\ud83c[\\udffb-\\udfff]",Pl="(?:"+va+"|"+Ou+")",$o="[^"+zo+"]",xs="(?:\\ud83c[\\udde6-\\uddff]){2}",Dl="[\\ud800-\\udbff][\\udc00-\\udfff]",Go="["+Fl+"]",F="\\u200d",B="(?:"+Ru+"|"+ai+")",te="(?:"+Go+"|"+ai+")",Le="(?:"+vi+"(?:d|ll|m|re|s|t|ve))?",vt="(?:"+vi+"(?:D|LL|M|RE|S|T|VE))?",Vt=Pl+"?",Sr="["+Il+"]?",An="(?:"+F+"(?:"+[$o,xs,Dl].join("|")+")"+Sr+Vt+")*",Dn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Jn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",gi=Sr+Vt+An,Bm="(?:"+[kl,xs,Dl].join("|")+")"+gi,Nm="(?:"+[$o+va+"?",va,xs,Dl,ys].join("|")+")",Um=RegExp(vi,"g"),zm=RegExp(va,"g"),rp=RegExp(Ou+"(?="+Ou+")|"+Nm+gi,"g"),$m=RegExp([Go+"?"+Ru+"+"+Le+"(?="+[_s,Go,"$"].join("|")+")",te+"+"+vt+"(?="+[_s,Go+B,"$"].join("|")+")",Go+"?"+B+"+"+Le,Go+"+"+vt,Jn,Dn,Mu,Bm].join("|"),"g"),Gm=RegExp("["+F+zo+di+Il+"]"),Hm=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Lu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Vm=-1,hn={};hn[pr]=hn[rr]=hn[sr]=hn[Jt]=hn[Er]=hn[Ar]=hn[Yr]=hn[Zr]=hn[Da]=!0,hn[jt]=hn[Cr]=hn[ft]=hn[ii]=hn[St]=hn[Mt]=hn[ar]=hn[k]=hn[_e]=hn[Ge]=hn[Qe]=hn[yt]=hn[et]=hn[Wt]=hn[Se]=!1;var nn={};nn[jt]=nn[Cr]=nn[ft]=nn[St]=nn[ii]=nn[Mt]=nn[pr]=nn[rr]=nn[sr]=nn[Jt]=nn[Er]=nn[_e]=nn[Ge]=nn[Qe]=nn[yt]=nn[et]=nn[Wt]=nn[Gt]=nn[Ar]=nn[Yr]=nn[Zr]=nn[Da]=!0,nn[ar]=nn[k]=nn[Se]=!1;var np={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},x0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},E0={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},jm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ip=parseFloat,ap=parseInt,ho=typeof du=="object"&&du&&du.Object===Object&&du,cf=typeof self=="object"&&self&&self.Object===Object&&self,Xn=ho||cf||Function("return this")(),ff=t&&!t.nodeType&&t,Fu=ff&&!0&&e&&!e.nodeType&&e,b0=Fu&&Fu.exports===ff,op=b0&&ho.process,Yi=function(){try{var ge=Fu&&Fu.require&&Fu.require("util").types;return ge||op&&op.binding&&op.binding("util")}catch{}}(),C0=Yi&&Yi.isArrayBuffer,A0=Yi&&Yi.isDate,S0=Yi&&Yi.isMap,po=Yi&&Yi.isRegExp,T0=Yi&&Yi.isSet,w0=Yi&&Yi.isTypedArray;function ei(ge,Ye,De){switch(De.length){case 0:return ge.call(Ye);case 1:return ge.call(Ye,De[0]);case 2:return ge.call(Ye,De[0],De[1]);case 3:return ge.call(Ye,De[0],De[1],De[2])}return ge.apply(Ye,De)}function Wm(ge,Ye,De,Xt){for(var yr=-1,jr=ge==null?0:ge.length;++yr<jr;){var Fn=ge[yr];Ye(Xt,Fn,De(Fn),ge)}return Xt}function ti(ge,Ye){for(var De=-1,Xt=ge==null?0:ge.length;++De<Xt&&Ye(ge[De],De,ge)!==!1;);return ge}function M0(ge,Ye){for(var De=ge==null?0:ge.length;De--&&Ye(ge[De],De,ge)!==!1;);return ge}function Iu(ge,Ye){for(var De=-1,Xt=ge==null?0:ge.length;++De<Xt;)if(!Ye(ge[De],De,ge))return!1;return!0}function vo(ge,Ye){for(var De=-1,Xt=ge==null?0:ge.length,yr=0,jr=[];++De<Xt;){var Fn=ge[De];Ye(Fn,De,ge)&&(jr[yr++]=Fn)}return jr}function Na(ge,Ye){var De=ge==null?0:ge.length;return!!De&&mi(ge,Ye,0)>-1}function Bl(ge,Ye,De){for(var Xt=-1,yr=ge==null?0:ge.length;++Xt<yr;)if(De(Ye,ge[Xt]))return!0;return!1}function dn(ge,Ye){for(var De=-1,Xt=ge==null?0:ge.length,yr=Array(Xt);++De<Xt;)yr[De]=Ye(ge[De],De,ge);return yr}function Ho(ge,Ye){for(var De=-1,Xt=Ye.length,yr=ge.length;++De<Xt;)ge[yr+De]=Ye[De];return ge}function up(ge,Ye,De,Xt){var yr=-1,jr=ge==null?0:ge.length;for(Xt&&jr&&(De=ge[++yr]);++yr<jr;)De=Ye(De,ge[yr],yr,ge);return De}function R0(ge,Ye,De,Xt){var yr=ge==null?0:ge.length;for(Xt&&yr&&(De=ge[--yr]);yr--;)De=Ye(De,ge[yr],yr,ge);return De}function sp(ge,Ye){for(var De=-1,Xt=ge==null?0:ge.length;++De<Xt;)if(Ye(ge[De],De,ge))return!0;return!1}var Xm=Ul("length");function O0(ge){return ge.split("")}function mn(ge){return ge.match(vs)||[]}function lp(ge,Ye,De){var Xt;return De(ge,function(yr,jr,Fn){if(Ye(yr,jr,Fn))return Xt=jr,!1}),Xt}function hf(ge,Ye,De,Xt){for(var yr=ge.length,jr=De+(Xt?1:-1);Xt?jr--:++jr<yr;)if(Ye(ge[jr],jr,ge))return jr;return-1}function mi(ge,Ye,De){return Ye===Ye?P0(ge,Ye,De):hf(ge,Nl,De)}function cp(ge,Ye,De,Xt){for(var yr=De-1,jr=ge.length;++yr<jr;)if(Xt(ge[yr],Ye))return yr;return-1}function Nl(ge){return ge!==ge}function Vo(ge,Ye){var De=ge==null?0:ge.length;return De?df(ge,Ye)/De:Xe}function Ul(ge){return function(Ye){return Ye==null?r:Ye[ge]}}function Es(ge){return function(Ye){return ge==null?r:ge[Ye]}}function bs(ge,Ye,De,Xt,yr){return yr(ge,function(jr,Fn,an){De=Xt?(Xt=!1,jr):Ye(De,jr,Fn,an)}),De}function pf(ge,Ye){var De=ge.length;for(ge.sort(Ye);De--;)ge[De]=ge[De].value;return ge}function df(ge,Ye){for(var De,Xt=-1,yr=ge.length;++Xt<yr;){var jr=Ye(ge[Xt]);jr!==r&&(De=De===r?jr:De+jr)}return De}function zl(ge,Ye){for(var De=-1,Xt=Array(ge);++De<ge;)Xt[De]=Ye(De);return Xt}function L0(ge,Ye){return dn(Ye,function(De){return[De,ge[De]]})}function F0(ge){return ge&&ge.slice(0,mf(ge)+1).replace(Rl,"")}function ki(ge){return function(Ye){return ge(Ye)}}function fp(ge,Ye){return dn(Ye,function(De){return ge[De]})}function $l(ge,Ye){return ge.has(Ye)}function vf(ge,Ye){for(var De=-1,Xt=ge.length;++De<Xt&&mi(Ye,ge[De],0)>-1;);return De}function Gl(ge,Ye){for(var De=ge.length;De--&&mi(Ye,ge[De],0)>-1;);return De}function hp(ge,Ye){for(var De=ge.length,Xt=0;De--;)ge[De]===Ye&&++Xt;return Xt}var pp=Es(np),Cs=Es(x0);function dp(ge){return"\\"+jm[ge]}function vp(ge,Ye){return ge==null?r:ge[Ye]}function jo(ge){return Gm.test(ge)}function gp(ge){return Hm.test(ge)}function I0(ge){for(var Ye,De=[];!(Ye=ge.next()).done;)De.push(Ye.value);return De}function gf(ge){var Ye=-1,De=Array(ge.size);return ge.forEach(function(Xt,yr){De[++Ye]=[yr,Xt]}),De}function mp(ge,Ye){return function(De){return ge(Ye(De))}}function go(ge,Ye){for(var De=-1,Xt=ge.length,yr=0,jr=[];++De<Xt;){var Fn=ge[De];(Fn===Ye||Fn===f)&&(ge[De]=f,jr[yr++]=De)}return jr}function Hl(ge){var Ye=-1,De=Array(ge.size);return ge.forEach(function(Xt){De[++Ye]=Xt}),De}function k0(ge){var Ye=-1,De=Array(ge.size);return ge.forEach(function(Xt){De[++Ye]=[Xt,Xt]}),De}function P0(ge,Ye,De){for(var Xt=De-1,yr=ge.length;++Xt<yr;)if(ge[Xt]===Ye)return Xt;return-1}function D0(ge,Ye,De){for(var Xt=De+1;Xt--;)if(ge[Xt]===Ye)return Xt;return Xt}function ga(ge){return jo(ge)?Ym(ge):Xm(ge)}function Pi(ge){return jo(ge)?Zm(ge):O0(ge)}function mf(ge){for(var Ye=ge.length;Ye--&&ds.test(ge.charAt(Ye)););return Ye}var Vl=Es(E0);function Ym(ge){for(var Ye=rp.lastIndex=0;rp.test(ge);)++Ye;return Ye}function Zm(ge){return ge.match(rp)||[]}function qm(ge){return ge.match($m)||[]}var yp=function ge(Ye){Ye=Ye==null?Xn:As.defaults(Xn.Object(),Ye,As.pick(Xn,Lu));var De=Ye.Array,Xt=Ye.Date,yr=Ye.Error,jr=Ye.Function,Fn=Ye.Math,an=Ye.Object,_p=Ye.RegExp,yf=Ye.String,Zi=Ye.TypeError,_f=De.prototype,Km=jr.prototype,Ss=an.prototype,xf=Ye["__core-js_shared__"],Ef=Km.toString,on=Ss.hasOwnProperty,B0=0,Ts=function(){var c=/[^.]+$/.exec(xf&&xf.keys&&xf.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),bf=Ss.toString,Cf=Ef.call(an),qi=Xn._,ws=_p("^"+Ef.call(on).replace(Ml,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jl=b0?Ye.Buffer:r,mo=Ye.Symbol,Wl=Ye.Uint8Array,xp=jl?jl.allocUnsafe:r,Xl=mp(an.getPrototypeOf,an),Ep=an.create,N0=Ss.propertyIsEnumerable,yo=_f.splice,Bn=mo?mo.isConcatSpreadable:r,Ms=mo?mo.iterator:r,Wo=mo?mo.toStringTag:r,Ua=function(){try{var c=ru(an,"defineProperty");return c({},"",{}),c}catch{}}(),U0=Ye.clearTimeout!==Xn.clearTimeout&&Ye.clearTimeout,z0=Xt&&Xt.now!==Xn.Date.now&&Xt.now,Qm=Ye.setTimeout!==Xn.setTimeout&&Ye.setTimeout,Af=Fn.ceil,Sf=Fn.floor,bp=an.getOwnPropertySymbols,Cp=jl?jl.isBuffer:r,Ap=Ye.isFinite,Sp=_f.join,$0=mp(an.keys,an),Nn=Fn.max,ri=Fn.min,G0=Xt.now,Jm=Ye.parseInt,Yl=Fn.random,ey=_f.reverse,za=ru(Ye,"DataView"),Xo=ru(Ye,"Map"),Tf=ru(Ye,"Promise"),ku=ru(Ye,"Set"),Rs=ru(Ye,"WeakMap"),Os=ru(an,"create"),Zl=Rs&&new Rs,Pu={},H0=Wr(za),V0=Wr(Xo),j0=Wr(Tf),ma=Wr(ku),W0=Wr(Rs),wf=mo?mo.prototype:r,Di=wf?wf.valueOf:r,Mf=wf?wf.toString:r;function I(c){if(kn(c)&&!Tr(c)&&!(c instanceof Ir)){if(c instanceof Bi)return c;if(on.call(c,"__wrapped__"))return _r(c)}return new Bi(c)}var _o=function(){function c(){}return function(p){if(!Mn(p))return{};if(Ep)return Ep(p);c.prototype=p;var g=new c;return c.prototype=r,g}}();function ql(){}function Bi(c,p){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=r}I.templateSettings={escape:wl,evaluate:ps,interpolate:rf,variable:"",imports:{_:I}},I.prototype=ql.prototype,I.prototype.constructor=I,Bi.prototype=_o(ql.prototype),Bi.prototype.constructor=Bi;function Ir(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ct,this.__views__=[]}function X0(){var c=new Ir(this.__wrapped__);return c.__actions__=oi(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=oi(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=oi(this.__views__),c}function Y0(){if(this.__filtered__){var c=new Ir(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function ty(){var c=this.__wrapped__.value(),p=this.__dir__,g=Tr(c),x=p<0,R=g?c.length:0,N=Ae(0,R,this.__views__),J=N.start,se=N.end,xe=se-J,at=x?se:J-1,ut=this.__iteratees__,gt=ut.length,Ht=0,or=ri(xe,this.__takeCount__);if(!g||!x&&R==xe&&or==xe)return dv(c,this.__actions__);var vr=[];e:for(;xe--&&Ht<or;){at+=p;for(var Fr=-1,gr=c[at];++Fr<gt;){var zr=ut[Fr],Hr=zr.iteratee,Aa=zr.type,$i=Hr(gr);if(Aa==pe)gr=$i;else if(!$i){if(Aa==de)continue e;break e}}vr[Ht++]=gr}return vr}Ir.prototype=_o(ql.prototype),Ir.prototype.constructor=Ir;function Du(c){var p=-1,g=c==null?0:c.length;for(this.clear();++p<g;){var x=c[p];this.set(x[0],x[1])}}function ry(){this.__data__=Os?Os(null):{},this.size=0}function ny(c){var p=this.has(c)&&delete this.__data__[c];return this.size-=p?1:0,p}function iy(c){var p=this.__data__;if(Os){var g=p[c];return g===s?r:g}return on.call(p,c)?p[c]:r}function ay(c){var p=this.__data__;return Os?p[c]!==r:on.call(p,c)}function oy(c,p){var g=this.__data__;return this.size+=this.has(c)?0:1,g[c]=Os&&p===r?s:p,this}Du.prototype.clear=ry,Du.prototype.delete=ny,Du.prototype.get=iy,Du.prototype.has=ay,Du.prototype.set=oy;function $a(c){var p=-1,g=c==null?0:c.length;for(this.clear();++p<g;){var x=c[p];this.set(x[0],x[1])}}function Z0(){this.__data__=[],this.size=0}function uy(c){var p=this.__data__,g=Lf(p,c);if(g<0)return!1;var x=p.length-1;return g==x?p.pop():yo.call(p,g,1),--this.size,!0}function sy(c){var p=this.__data__,g=Lf(p,c);return g<0?r:p[g][1]}function Tp(c){return Lf(this.__data__,c)>-1}function Rf(c,p){var g=this.__data__,x=Lf(g,c);return x<0?(++this.size,g.push([c,p])):g[x][1]=p,this}$a.prototype.clear=Z0,$a.prototype.delete=uy,$a.prototype.get=sy,$a.prototype.has=Tp,$a.prototype.set=Rf;function xo(c){var p=-1,g=c==null?0:c.length;for(this.clear();++p<g;){var x=c[p];this.set(x[0],x[1])}}function ly(){this.size=0,this.__data__={hash:new Du,map:new(Xo||$a),string:new Du}}function cy(c){var p=Wf(this,c).delete(c);return this.size-=p?1:0,p}function fy(c){return Wf(this,c).get(c)}function hy(c){return Wf(this,c).has(c)}function q0(c,p){var g=Wf(this,c),x=g.size;return g.set(c,p),this.size+=g.size==x?0:1,this}xo.prototype.clear=ly,xo.prototype.delete=cy,xo.prototype.get=fy,xo.prototype.has=hy,xo.prototype.set=q0;function Bu(c){var p=-1,g=c==null?0:c.length;for(this.__data__=new xo;++p<g;)this.add(c[p])}function py(c){return this.__data__.set(c,s),this}function dy(c){return this.__data__.has(c)}Bu.prototype.add=Bu.prototype.push=py,Bu.prototype.has=dy;function ya(c){var p=this.__data__=new $a(c);this.size=p.size}function vy(){this.__data__=new $a,this.size=0}function Ls(c){var p=this.__data__,g=p.delete(c);return this.size=p.size,g}function gy(c){return this.__data__.get(c)}function yy(c){return this.__data__.has(c)}function K0(c,p){var g=this.__data__;if(g instanceof $a){var x=g.__data__;if(!Xo||x.length<i-1)return x.push([c,p]),this.size=++g.size,this;g=this.__data__=new xo(x)}return g.set(c,p),this.size=g.size,this}ya.prototype.clear=vy,ya.prototype.delete=Ls,ya.prototype.get=gy,ya.prototype.has=yy,ya.prototype.set=K0;function Kl(c,p){var g=Tr(c),x=!g&&dc(c),R=!g&&!x&&Ks(c),N=!g&&!x&&!R&&Yf(c),J=g||x||R||N,se=J?zl(c.length,yf):[],xe=se.length;for(var at in c)(p||on.call(c,at))&&!(J&&(at=="length"||R&&(at=="offset"||at=="parent")||N&&(at=="buffer"||at=="byteLength"||at=="byteOffset")||Ke(at,xe)))&&se.push(at);return se}function wp(c){var p=c.length;return p?c[Jo(0,p-1)]:r}function Mp(c,p){return Kt(oi(c),Ga(p,0,c.length))}function _y(c){return Kt(oi(c))}function Of(c,p,g){(g!==r&&!Mo(c[p],g)||g===r&&!(p in c))&&Ni(c,p,g)}function Ql(c,p,g){var x=c[p];(!(on.call(c,p)&&Mo(x,g))||g===r&&!(p in c))&&Ni(c,p,g)}function Lf(c,p){for(var g=c.length;g--;)if(Mo(c[g][0],p))return g;return-1}function xy(c,p,g,x){return Eo(c,function(R,N,J){p(x,R,g(R),J)}),x}function Q0(c,p){return c&&Mi(p,si(p),c)}function Ey(c,p){return c&&Mi(p,ra(p),c)}function Ni(c,p,g){p=="__proto__"&&Ua?Ua(c,p,{configurable:!0,enumerable:!0,value:g,writable:!0}):c[p]=g}function Rp(c,p){for(var g=-1,x=p.length,R=De(x),N=c==null;++g<x;)R[g]=N?r:Ly(c,p[g]);return R}function Ga(c,p,g){return c===c&&(g!==r&&(c=c<=g?c:g),p!==r&&(c=c>=p?c:p)),c}function Ki(c,p,g,x,R,N){var J,se=p&h,xe=p&d,at=p&v;if(g&&(J=R?g(c,x,R,N):g(c)),J!==r)return J;if(!Mn(c))return c;var ut=Tr(c);if(ut){if(J=Fe(c),!se)return oi(c,J)}else{var gt=W(c),Ht=gt==k||gt==ae;if(Ks(c))return uc(c,se);if(gt==Qe||gt==jt||Ht&&!R){if(J=xe||Ht?{}:He(c),!se)return xe?vv(c,Ey(J,c)):Gu(c,Q0(J,c))}else{if(!nn[gt])return R?c:{};J=qe(c,gt,se)}}N||(N=new ya);var or=N.get(c);if(or)return or;N.set(c,J),u2(c)?c.forEach(function(gr){J.add(Ki(gr,p,g,gr,c,N))}):a2(c)&&c.forEach(function(gr,zr){J.set(zr,Ki(gr,p,g,zr,c,N))});var vr=at?xe?Yp:Xp:xe?ra:si,Fr=ut?r:vr(c);return ti(Fr||c,function(gr,zr){Fr&&(zr=gr,gr=c[zr]),Ql(J,zr,Ki(gr,p,g,zr,c,N))}),J}function Fs(c){var p=si(c);return function(g){return Nu(g,c,p)}}function Nu(c,p,g){var x=g.length;if(c==null)return!x;for(c=an(c);x--;){var R=g[x],N=p[R],J=c[R];if(J===r&&!(R in c)||!N(J))return!1}return!0}function J0(c,p,g){if(typeof c!="function")throw new Zi(o);return ur(function(){c.apply(r,g)},p)}function Ha(c,p,g,x){var R=-1,N=Na,J=!0,se=c.length,xe=[],at=p.length;if(!se)return xe;g&&(p=dn(p,ki(g))),x?(N=Bl,J=!1):p.length>=i&&(N=$l,J=!1,p=new Bu(p));e:for(;++R<se;){var ut=c[R],gt=g==null?ut:g(ut);if(ut=x||ut!==0?ut:0,J&&gt===gt){for(var Ht=at;Ht--;)if(p[Ht]===gt)continue e;xe.push(ut)}else N(p,gt,x)||xe.push(ut)}return xe}var Eo=gv(_a),Uu=gv(If,!0);function Op(c,p){var g=!0;return Eo(c,function(x,R,N){return g=!!p(x,R,N),g}),g}function Is(c,p,g){for(var x=-1,R=c.length;++x<R;){var N=c[x],J=p(N);if(J!=null&&(se===r?J===J&&!Ca(J):g(J,se)))var se=J,xe=N}return xe}function Lp(c,p,g,x){var R=c.length;for(g=Lr(g),g<0&&(g=-g>R?0:R+g),x=x===r||x>R?R:Lr(x),x<0&&(x+=R),x=g>x?0:l2(x);g<x;)c[g++]=p;return c}function Ff(c,p){var g=[];return Eo(c,function(x,R,N){p(x,R,N)&&g.push(x)}),g}function Un(c,p,g,x,R){var N=-1,J=c.length;for(g||(g=lt),R||(R=[]);++N<J;){var se=c[N];p>0&&g(se)?p>1?Un(se,p-1,g,x,R):Ho(R,se):x||(R[R.length]=se)}return R}var ks=mv(),Fp=mv(!0);function _a(c,p){return c&&ks(c,p,si)}function If(c,p){return c&&Fp(c,p,si)}function Jl(c,p){return vo(p,function(g){return ju(c[g])})}function Yo(c,p){p=Ea(p,c);for(var g=0,x=p.length;c!=null&&g<x;)c=c[cr(p[g++])];return g&&g==x?c:r}function kf(c,p,g){var x=p(c);return Tr(c)?x:Ho(x,g(c))}function ni(c){return c==null?c===r?C:je:Wo&&Wo in an(c)?Ty(c):Be(c)}function Pf(c,p){return c>p}function ev(c,p){return c!=null&&on.call(c,p)}function tv(c,p){return c!=null&&p in an(c)}function rv(c,p,g){return c>=ri(p,g)&&c<Nn(p,g)}function ec(c,p,g){for(var x=g?Bl:Na,R=c[0].length,N=c.length,J=N,se=De(N),xe=1/0,at=[];J--;){var ut=c[J];J&&p&&(ut=dn(ut,ki(p))),xe=ri(ut.length,xe),se[J]=!g&&(p||R>=120&&ut.length>=120)?new Bu(J&&ut):r}ut=c[0];var gt=-1,Ht=se[0];e:for(;++gt<R&&at.length<xe;){var or=ut[gt],vr=p?p(or):or;if(or=g||or!==0?or:0,!(Ht?$l(Ht,vr):x(at,vr,g))){for(J=N;--J;){var Fr=se[J];if(!(Fr?$l(Fr,vr):x(c[J],vr,g)))continue e}Ht&&Ht.push(vr),at.push(or)}}return at}function nv(c,p,g,x){return _a(c,function(R,N,J){p(x,g(R),N,J)}),x}function Ps(c,p,g){p=Ea(p,c),c=mt(c,p);var x=c==null?c:c[cr(Z(p))];return x==null?r:ei(x,c,g)}function Df(c){return kn(c)&&ni(c)==jt}function Ip(c){return kn(c)&&ni(c)==ft}function iv(c){return kn(c)&&ni(c)==Mt}function zu(c,p,g,x,R){return c===p?!0:c==null||p==null||!kn(c)&&!kn(p)?c!==c&&p!==p:av(c,p,g,x,zu,R)}function av(c,p,g,x,R,N){var J=Tr(c),se=Tr(p),xe=J?Cr:W(c),at=se?Cr:W(p);xe=xe==jt?Qe:xe,at=at==jt?Qe:at;var ut=xe==Qe,gt=at==Qe,Ht=xe==at;if(Ht&&Ks(c)){if(!Ks(p))return!1;J=!0,ut=!1}if(Ht&&!ut)return N||(N=new ya),J||Yf(c)?Ev(c,p,g,x,R,N):bv(c,p,xe,g,x,R,N);if(!(g&m)){var or=ut&&on.call(c,"__wrapped__"),vr=gt&&on.call(p,"__wrapped__");if(or||vr){var Fr=or?c.value():c,gr=vr?p.value():p;return N||(N=new ya),R(Fr,gr,g,x,N)}}return Ht?(N||(N=new ya),Sy(c,p,g,x,R,N)):!1}function ov(c){return kn(c)&&W(c)==_e}function tc(c,p,g,x){var R=g.length,N=R,J=!x;if(c==null)return!N;for(c=an(c);R--;){var se=g[R];if(J&&se[2]?se[1]!==c[se[0]]:!(se[0]in c))return!1}for(;++R<N;){se=g[R];var xe=se[0],at=c[xe],ut=se[1];if(J&&se[2]){if(at===r&&!(xe in c))return!1}else{var gt=new ya;if(x)var Ht=x(at,ut,xe,c,p,gt);if(!(Ht===r?zu(ut,at,m|y,x,gt):Ht))return!1}}return!0}function kp(c){if(!Mn(c)||Re(c))return!1;var p=ju(c)?ws:lf;return p.test(Wr(c))}function uv(c){return kn(c)&&ni(c)==yt}function Pp(c){return kn(c)&&W(c)==et}function Dp(c){return kn(c)&&Rv(c.length)&&!!hn[ni(c)]}function Ds(c){return typeof c=="function"?c:c==null?na:typeof c=="object"?Tr(c)?Ns(c[0],c[1]):Zo(c):x2(c)}function Bf(c){if(!bt(c))return $0(c);var p=[];for(var g in an(c))on.call(c,g)&&g!="constructor"&&p.push(g);return p}function Nf(c){if(!Mn(c))return ze(c);var p=bt(c),g=[];for(var x in c)x=="constructor"&&(p||!on.call(c,x))||g.push(x);return g}function xa(c,p){return c<p}function Bs(c,p){var g=-1,x=ta(c)?De(c.length):[];return Eo(c,function(R,N,J){x[++g]=p(R,N,J)}),x}function Zo(c){var p=qp(c);return p.length==1&&p[0][2]?Tt(p[0][0],p[0][1]):function(g){return g===c||tc(g,c,p)}}function Ns(c,p){return Ze(c)&&We(p)?Tt(cr(c),p):function(g){var x=Ly(g,c);return x===r&&x===p?Fy(g,c):zu(p,x,m|y)}}function qo(c,p,g,x,R){c!==p&&ks(p,function(N,J){if(R||(R=new ya),Mn(N))$u(c,p,J,g,qo,x,R);else{var se=x?x(_t(c,J),N,J+"",c,p,R):r;se===r&&(se=N),Of(c,J,se)}},ra)}function $u(c,p,g,x,R,N,J){var se=_t(c,g),xe=_t(p,g),at=J.get(xe);if(at){Of(c,g,at);return}var ut=N?N(se,xe,g+"",c,p,J):r,gt=ut===r;if(gt){var Ht=Tr(xe),or=!Ht&&Ks(xe),vr=!Ht&&!or&&Yf(xe);ut=xe,Ht||or||vr?Tr(se)?ut=se:Vn(se)?ut=oi(se):or?(gt=!1,ut=uc(xe,!0)):vr?(gt=!1,ut=Vs(xe,!0)):ut=[]:Kp(xe)||dc(xe)?(ut=se,dc(se)?ut=c2(se):(!Mn(se)||ju(se))&&(ut=He(xe))):gt=!1}gt&&(J.set(xe,ut),R(ut,xe,x,N,J),J.delete(xe)),Of(c,g,ut)}function Ko(c,p){var g=c.length;if(!!g)return p+=p<0?g:0,Ke(p,g)?c[p]:r}function Qo(c,p,g){p.length?p=dn(p,function(N){return Tr(N)?function(J){return Yo(J,N.length===1?N[0]:N)}:N}):p=[na];var x=-1;p=dn(p,ki(fr()));var R=Bs(c,function(N,J,se){var xe=dn(p,function(at){return at(N)});return{criteria:xe,index:++x,value:N}});return pf(R,function(N,J){return lc(N,J,g)})}function Uf(c,p){return rc(c,p,function(g,x){return Fy(c,x)})}function rc(c,p,g){for(var x=-1,R=p.length,N={};++x<R;){var J=p[x],se=Yo(c,J);g(se,J)&&zs(N,Ea(J,c),se)}return N}function nc(c){return function(p){return Yo(p,c)}}function ic(c,p,g,x){var R=x?cp:mi,N=-1,J=p.length,se=c;for(c===p&&(p=oi(p)),g&&(se=dn(c,ki(g)));++N<J;)for(var xe=0,at=p[N],ut=g?g(at):at;(xe=R(se,ut,xe,x))>-1;)se!==c&&yo.call(se,xe,1),yo.call(c,xe,1);return c}function zf(c,p){for(var g=c?p.length:0,x=g-1;g--;){var R=p[g];if(g==x||R!==N){var N=R;Ke(R)?yo.call(c,R,1):zp(c,R)}}return c}function Jo(c,p){return c+Sf(Yl()*(p-c+1))}function Us(c,p,g,x){for(var R=-1,N=Nn(Af((p-c)/(g||1)),0),J=De(N);N--;)J[x?N:++R]=c,c+=g;return J}function Bp(c,p){var g="";if(!c||p<1||p>Me)return g;do p%2&&(g+=c),p=Sf(p/2),p&&(c+=c);while(p);return g}function Or(c,p){return nr(kt(c,p,na),c+"")}function sv(c){return wp(Zf(c))}function lv(c,p){var g=Zf(c);return Kt(g,Ga(p,0,g.length))}function zs(c,p,g,x){if(!Mn(c))return c;p=Ea(p,c);for(var R=-1,N=p.length,J=N-1,se=c;se!=null&&++R<N;){var xe=cr(p[R]),at=g;if(xe==="__proto__"||xe==="constructor"||xe==="prototype")return c;if(R!=J){var ut=se[xe];at=x?x(ut,xe,se):r,at===r&&(at=Mn(ut)?ut:Ke(p[R+1])?[]:{})}Ql(se,xe,at),se=se[xe]}return c}var cv=Zl?function(c,p){return Zl.set(c,p),c}:na,$s=Ua?function(c,p){return Ua(c,"toString",{configurable:!0,enumerable:!1,value:ky(p),writable:!0})}:na;function Np(c){return Kt(Zf(c))}function Qi(c,p,g){var x=-1,R=c.length;p<0&&(p=-p>R?0:R+p),g=g>R?R:g,g<0&&(g+=R),R=p>g?0:g-p>>>0,p>>>=0;for(var N=De(R);++x<R;)N[x]=c[x+p];return N}function by(c,p){var g;return Eo(c,function(x,R,N){return g=p(x,R,N),!g}),!!g}function ac(c,p,g){var x=0,R=c==null?x:c.length;if(typeof p=="number"&&p===p&&R<=Qt){for(;x<R;){var N=x+R>>>1,J=c[N];J!==null&&!Ca(J)&&(g?J<=p:J<p)?x=N+1:R=N}return R}return Up(c,p,na,g)}function Up(c,p,g,x){var R=0,N=c==null?0:c.length;if(N===0)return 0;p=g(p);for(var J=p!==p,se=p===null,xe=Ca(p),at=p===r;R<N;){var ut=Sf((R+N)/2),gt=g(c[ut]),Ht=gt!==r,or=gt===null,vr=gt===gt,Fr=Ca(gt);if(J)var gr=x||vr;else at?gr=vr&&(x||Ht):se?gr=vr&&Ht&&(x||!or):xe?gr=vr&&Ht&&!or&&(x||!Fr):or||Fr?gr=!1:gr=x?gt<=p:gt<p;gr?R=ut+1:N=ut}return ri(N,$t)}function fv(c,p){for(var g=-1,x=c.length,R=0,N=[];++g<x;){var J=c[g],se=p?p(J):J;if(!g||!Mo(se,xe)){var xe=se;N[R++]=J===0?0:J}}return N}function hv(c){return typeof c=="number"?c:Ca(c)?Xe:+c}function Ui(c){if(typeof c=="string")return c;if(Tr(c))return dn(c,Ui)+"";if(Ca(c))return Mf?Mf.call(c):"";var p=c+"";return p=="0"&&1/c==-ve?"-0":p}function eu(c,p,g){var x=-1,R=Na,N=c.length,J=!0,se=[],xe=se;if(g)J=!1,R=Bl;else if(N>=i){var at=p?null:xn(c);if(at)return Hl(at);J=!1,R=$l,xe=new Bu}else xe=p?[]:se;e:for(;++x<N;){var ut=c[x],gt=p?p(ut):ut;if(ut=g||ut!==0?ut:0,J&&gt===gt){for(var Ht=xe.length;Ht--;)if(xe[Ht]===gt)continue e;p&&xe.push(gt),se.push(ut)}else R(xe,gt,g)||(xe!==se&&xe.push(gt),se.push(ut))}return se}function zp(c,p){return p=Ea(p,c),c=mt(c,p),c==null||delete c[cr(Z(p))]}function pv(c,p,g,x){return zs(c,p,g(Yo(c,p)),x)}function $f(c,p,g,x){for(var R=c.length,N=x?R:-1;(x?N--:++N<R)&&p(c[N],N,c););return g?Qi(c,x?0:N,x?N+1:R):Qi(c,x?N+1:0,x?R:N)}function dv(c,p){var g=c;return g instanceof Ir&&(g=g.value()),up(p,function(x,R){return R.func.apply(R.thisArg,Ho([x],R.args))},g)}function $p(c,p,g){var x=c.length;if(x<2)return x?eu(c[0]):[];for(var R=-1,N=De(x);++R<x;)for(var J=c[R],se=-1;++se<x;)se!=R&&(N[R]=Ha(N[R]||J,c[se],p,g));return eu(Un(N,1),p,g)}function Gf(c,p,g){for(var x=-1,R=c.length,N=p.length,J={};++x<R;){var se=x<N?p[x]:r;g(J,c[x],se)}return J}function Gs(c){return Vn(c)?c:[]}function Hs(c){return typeof c=="function"?c:na}function Ea(c,p){return Tr(c)?c:Ze(c,p)?[c]:lr(ln(c))}var Gp=Or;function ba(c,p,g){var x=c.length;return g=g===r?x:g,!p&&g>=x?c:Qi(c,p,g)}var oc=U0||function(c){return Xn.clearTimeout(c)};function uc(c,p){if(p)return c.slice();var g=c.length,x=xp?xp(g):new c.constructor(g);return c.copy(x),x}function sc(c){var p=new c.constructor(c.byteLength);return new Wl(p).set(new Wl(c)),p}function Hf(c,p){var g=p?sc(c.buffer):c.buffer;return new c.constructor(g,c.byteOffset,c.byteLength)}function Vf(c){var p=new c.constructor(c.source,Ol.exec(c));return p.lastIndex=c.lastIndex,p}function jf(c){return Di?an(Di.call(c)):{}}function Vs(c,p){var g=p?sc(c.buffer):c.buffer;return new c.constructor(g,c.byteOffset,c.length)}function js(c,p){if(c!==p){var g=c!==r,x=c===null,R=c===c,N=Ca(c),J=p!==r,se=p===null,xe=p===p,at=Ca(p);if(!se&&!at&&!N&&c>p||N&&J&&xe&&!se&&!at||x&&J&&xe||!g&&xe||!R)return 1;if(!x&&!N&&!at&&c<p||at&&g&&R&&!x&&!N||se&&g&&R||!J&&R||!xe)return-1}return 0}function lc(c,p,g){for(var x=-1,R=c.criteria,N=p.criteria,J=R.length,se=g.length;++x<J;){var xe=js(R[x],N[x]);if(xe){if(x>=se)return xe;var at=g[x];return xe*(at=="desc"?-1:1)}}return c.index-p.index}function Ws(c,p,g,x){for(var R=-1,N=c.length,J=g.length,se=-1,xe=p.length,at=Nn(N-J,0),ut=De(xe+at),gt=!x;++se<xe;)ut[se]=p[se];for(;++R<J;)(gt||R<N)&&(ut[g[R]]=c[R]);for(;at--;)ut[se++]=c[R++];return ut}function Xs(c,p,g,x){for(var R=-1,N=c.length,J=-1,se=g.length,xe=-1,at=p.length,ut=Nn(N-se,0),gt=De(ut+at),Ht=!x;++R<ut;)gt[R]=c[R];for(var or=R;++xe<at;)gt[or+xe]=p[xe];for(;++J<se;)(Ht||R<N)&&(gt[or+g[J]]=c[R++]);return gt}function oi(c,p){var g=-1,x=c.length;for(p||(p=De(x));++g<x;)p[g]=c[g];return p}function Mi(c,p,g,x){var R=!g;g||(g={});for(var N=-1,J=p.length;++N<J;){var se=p[N],xe=x?x(g[se],c[se],se,g,c):r;xe===r&&(xe=c[se]),R?Ni(g,se,xe):Ql(g,se,xe)}return g}function Gu(c,p){return Mi(c,b(c),p)}function vv(c,p){return Mi(c,P(c),p)}function Ys(c,p){return function(g,x){var R=Tr(g)?Wm:xy,N=p?p():{};return R(g,c,fr(x,2),N)}}function Zs(c){return Or(function(p,g){var x=-1,R=g.length,N=R>1?g[R-1]:r,J=R>2?g[2]:r;for(N=c.length>3&&typeof N=="function"?(R--,N):r,J&&rt(g[0],g[1],J)&&(N=R<3?r:N,R=1),p=an(p);++x<R;){var se=g[x];se&&c(p,se,x,N)}return p})}function gv(c,p){return function(g,x){if(g==null)return g;if(!ta(g))return c(g,x);for(var R=g.length,N=p?R:-1,J=an(g);(p?N--:++N<R)&&x(J[N],N,J)!==!1;);return g}}function mv(c){return function(p,g,x){for(var R=-1,N=an(p),J=x(p),se=J.length;se--;){var xe=J[c?se:++R];if(g(N[xe],xe,N)===!1)break}return p}}function tu(c,p,g){var x=p&_,R=qs(c);function N(){var J=this&&this!==Xn&&this instanceof N?R:c;return J.apply(x?g:this,arguments)}return N}function Hp(c){return function(p){p=ln(p);var g=jo(p)?Pi(p):r,x=g?g[0]:p.charAt(0),R=g?ba(g,1).join(""):p.slice(1);return x[c]()+R}}function Hu(c){return function(p){return up(y2(m2(p).replace(Um,"")),c,"")}}function qs(c){return function(){var p=arguments;switch(p.length){case 0:return new c;case 1:return new c(p[0]);case 2:return new c(p[0],p[1]);case 3:return new c(p[0],p[1],p[2]);case 4:return new c(p[0],p[1],p[2],p[3]);case 5:return new c(p[0],p[1],p[2],p[3],p[4]);case 6:return new c(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new c(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var g=_o(c.prototype),x=c.apply(g,p);return Mn(x)?x:g}}function Cy(c,p,g){var x=qs(c);function R(){for(var N=arguments.length,J=De(N),se=N,xe=Vu(R);se--;)J[se]=arguments[se];var at=N<3&&J[0]!==xe&&J[N-1]!==xe?[]:go(J,xe);if(N-=at.length,N<g)return Sn(c,p,zi,R.placeholder,r,J,at,r,r,g-N);var ut=this&&this!==Xn&&this instanceof R?x:c;return ei(ut,this,J)}return R}function Vp(c){return function(p,g,x){var R=an(p);if(!ta(p)){var N=fr(g,3);p=si(p),g=function(se){return N(R[se],se,R)}}var J=c(p,g,x);return J>-1?R[N?p[J]:J]:r}}function yv(c){return Co(function(p){var g=p.length,x=g,R=Bi.prototype.thru;for(c&&p.reverse();x--;){var N=p[x];if(typeof N!="function")throw new Zi(o);if(R&&!J&&pc(N)=="wrapper")var J=new Bi([],!0)}for(x=J?x:g;++x<g;){N=p[x];var se=pc(N),xe=se=="wrapper"?Zp(N):r;xe&&ce(xe[0])&&xe[1]==(q|A|O|Y)&&!xe[4].length&&xe[9]==1?J=J[pc(xe[0])].apply(J,xe[3]):J=N.length==1&&ce(N)?J[se]():J.thru(N)}return function(){var at=arguments,ut=at[0];if(J&&at.length==1&&Tr(ut))return J.plant(ut).value();for(var gt=0,Ht=g?p[gt].apply(this,at):ut;++gt<g;)Ht=p[gt].call(this,Ht);return Ht}})}function zi(c,p,g,x,R,N,J,se,xe,at){var ut=p&q,gt=p&_,Ht=p&E,or=p&(A|M),vr=p&ne,Fr=Ht?r:qs(c);function gr(){for(var zr=arguments.length,Hr=De(zr),Aa=zr;Aa--;)Hr[Aa]=arguments[Aa];if(or)var $i=Vu(gr),Sa=hp(Hr,$i);if(x&&(Hr=Ws(Hr,x,R,or)),N&&(Hr=Xs(Hr,N,J,or)),zr-=Sa,or&&zr<at){var jn=go(Hr,$i);return Sn(c,p,zi,gr.placeholder,g,Hr,jn,se,xe,at-zr)}var Ro=gt?g:this,Xu=Ht?Ro[c]:c;return zr=Hr.length,se?Hr=nt(Hr,se):vr&&zr>1&&Hr.reverse(),ut&&xe<zr&&(Hr.length=xe),this&&this!==Xn&&this instanceof gr&&(Xu=Fr||qs(Xu)),Xu.apply(Ro,Hr)}return gr}function jp(c,p){return function(g,x){return nv(g,c,p(x),{})}}function bo(c,p){return function(g,x){var R;if(g===r&&x===r)return p;if(g!==r&&(R=g),x!==r){if(R===r)return x;typeof g=="string"||typeof x=="string"?(g=Ui(g),x=Ui(x)):(g=hv(g),x=hv(x)),R=c(g,x)}return R}}function Va(c){return Co(function(p){return p=dn(p,ki(fr())),Or(function(g){var x=this;return c(p,function(R){return ei(R,x,g)})})})}function cc(c,p){p=p===r?" ":Ui(p);var g=p.length;if(g<2)return g?Bp(p,c):p;var x=Bp(p,Af(c/ga(p)));return jo(p)?ba(Pi(x),0,c).join(""):x.slice(0,c)}function Wp(c,p,g,x){var R=p&_,N=qs(c);function J(){for(var se=-1,xe=arguments.length,at=-1,ut=x.length,gt=De(ut+xe),Ht=this&&this!==Xn&&this instanceof J?N:c;++at<ut;)gt[at]=x[at];for(;xe--;)gt[at++]=arguments[++se];return ei(Ht,R?g:this,gt)}return J}function fc(c){return function(p,g,x){return x&&typeof x!="number"&&rt(p,g,x)&&(g=x=r),p=Wu(p),g===r?(g=p,p=0):g=Wu(g),x=x===r?p<g?1:-1:Wu(x),Us(p,g,x,c)}}function hc(c){return function(p,g){return typeof p=="string"&&typeof g=="string"||(p=Ya(p),g=Ya(g)),c(p,g)}}function Sn(c,p,g,x,R,N,J,se,xe,at){var ut=p&A,gt=ut?J:r,Ht=ut?r:J,or=ut?N:r,vr=ut?r:N;p|=ut?O:j,p&=~(ut?j:O),p&S||(p&=~(_|E));var Fr=[c,p,R,or,gt,vr,Ht,se,xe,at],gr=g.apply(r,Fr);return ce(c)&&xt(gr,Fr),gr.placeholder=x,Et(gr,c,p)}function ja(c){var p=Fn[c];return function(g,x){if(g=Ya(g),x=x==null?0:ri(Lr(x),292),x&&Ap(g)){var R=(ln(g)+"e").split("e"),N=p(R[0]+"e"+(+R[1]+x));return R=(ln(N)+"e").split("e"),+(R[0]+"e"+(+R[1]-x))}return p(g)}}var xn=ku&&1/Hl(new ku([,-0]))[1]==ve?function(c){return new ku(c)}:By;function yi(c){return function(p){var g=W(p);return g==_e?gf(p):g==et?k0(p):L0(p,c(p))}}function Wa(c,p,g,x,R,N,J,se){var xe=p&E;if(!xe&&typeof c!="function")throw new Zi(o);var at=x?x.length:0;if(at||(p&=~(O|j),x=R=r),J=J===r?J:Nn(Lr(J),0),se=se===r?se:Lr(se),at-=R?R.length:0,p&j){var ut=x,gt=R;x=R=r}var Ht=xe?r:Zp(c),or=[c,p,g,x,R,ut,gt,N,J,se];if(Ht&&Yt(or,Ht),c=or[0],p=or[1],g=or[2],x=or[3],R=or[4],se=or[9]=or[9]===r?xe?0:c.length:Nn(or[9]-at,0),!se&&p&(A|M)&&(p&=~(A|M)),!p||p==_)var vr=tu(c,p,g);else p==A||p==M?vr=Cy(c,p,se):(p==O||p==(_|O))&&!R.length?vr=Wp(c,p,g,x):vr=zi.apply(r,or);var Fr=Ht?cv:xt;return Et(Fr(vr,or),c,p)}function _v(c,p,g,x){return c===r||Mo(c,Ss[g])&&!on.call(x,g)?p:c}function xv(c,p,g,x,R,N){return Mn(c)&&Mn(p)&&(N.set(p,c),qo(c,p,r,xv,N),N.delete(p)),c}function Ay(c){return Kp(c)?r:c}function Ev(c,p,g,x,R,N){var J=g&m,se=c.length,xe=p.length;if(se!=xe&&!(J&&xe>se))return!1;var at=N.get(c),ut=N.get(p);if(at&&ut)return at==p&&ut==c;var gt=-1,Ht=!0,or=g&y?new Bu:r;for(N.set(c,p),N.set(p,c);++gt<se;){var vr=c[gt],Fr=p[gt];if(x)var gr=J?x(Fr,vr,gt,p,c,N):x(vr,Fr,gt,c,p,N);if(gr!==r){if(gr)continue;Ht=!1;break}if(or){if(!sp(p,function(zr,Hr){if(!$l(or,Hr)&&(vr===zr||R(vr,zr,g,x,N)))return or.push(Hr)})){Ht=!1;break}}else if(!(vr===Fr||R(vr,Fr,g,x,N))){Ht=!1;break}}return N.delete(c),N.delete(p),Ht}function bv(c,p,g,x,R,N,J){switch(g){case St:if(c.byteLength!=p.byteLength||c.byteOffset!=p.byteOffset)return!1;c=c.buffer,p=p.buffer;case ft:return!(c.byteLength!=p.byteLength||!N(new Wl(c),new Wl(p)));case ii:case Mt:case Ge:return Mo(+c,+p);case ar:return c.name==p.name&&c.message==p.message;case yt:case Wt:return c==p+"";case _e:var se=gf;case et:var xe=x&m;if(se||(se=Hl),c.size!=p.size&&!xe)return!1;var at=J.get(c);if(at)return at==p;x|=y,J.set(c,p);var ut=Ev(se(c),se(p),x,R,N,J);return J.delete(c),ut;case Gt:if(Di)return Di.call(c)==Di.call(p)}return!1}function Sy(c,p,g,x,R,N){var J=g&m,se=Xp(c),xe=se.length,at=Xp(p),ut=at.length;if(xe!=ut&&!J)return!1;for(var gt=xe;gt--;){var Ht=se[gt];if(!(J?Ht in p:on.call(p,Ht)))return!1}var or=N.get(c),vr=N.get(p);if(or&&vr)return or==p&&vr==c;var Fr=!0;N.set(c,p),N.set(p,c);for(var gr=J;++gt<xe;){Ht=se[gt];var zr=c[Ht],Hr=p[Ht];if(x)var Aa=J?x(Hr,zr,Ht,p,c,N):x(zr,Hr,Ht,c,p,N);if(!(Aa===r?zr===Hr||R(zr,Hr,g,x,N):Aa)){Fr=!1;break}gr||(gr=Ht=="constructor")}if(Fr&&!gr){var $i=c.constructor,Sa=p.constructor;$i!=Sa&&"constructor"in c&&"constructor"in p&&!(typeof $i=="function"&&$i instanceof $i&&typeof Sa=="function"&&Sa instanceof Sa)&&(Fr=!1)}return N.delete(c),N.delete(p),Fr}function Co(c){return nr(kt(c,r,mr),c+"")}function Xp(c){return kf(c,si,b)}function Yp(c){return kf(c,ra,P)}var Zp=Zl?function(c){return Zl.get(c)}:By;function pc(c){for(var p=c.name+"",g=Pu[p],x=on.call(Pu,p)?g.length:0;x--;){var R=g[x],N=R.func;if(N==null||N==c)return R.name}return p}function Vu(c){var p=on.call(I,"placeholder")?I:c;return p.placeholder}function fr(){var c=I.iteratee||Py;return c=c===Py?Ds:c,arguments.length?c(arguments[0],arguments[1]):c}function Wf(c,p){var g=c.__data__;return st(p)?g[typeof p=="string"?"string":"hash"]:g.map}function qp(c){for(var p=si(c),g=p.length;g--;){var x=p[g],R=c[x];p[g]=[x,R,We(R)]}return p}function ru(c,p){var g=vp(c,p);return kp(g)?g:r}function Ty(c){var p=on.call(c,Wo),g=c[Wo];try{c[Wo]=r;var x=!0}catch{}var R=bf.call(c);return x&&(p?c[Wo]=g:delete c[Wo]),R}var b=bp?function(c){return c==null?[]:(c=an(c),vo(bp(c),function(p){return N0.call(c,p)}))}:Ny,P=bp?function(c){for(var p=[];c;)Ho(p,b(c)),c=Xl(c);return p}:Ny,W=ni;(za&&W(new za(new ArrayBuffer(1)))!=St||Xo&&W(new Xo)!=_e||Tf&&W(Tf.resolve())!=Ot||ku&&W(new ku)!=et||Rs&&W(new Rs)!=Se)&&(W=function(c){var p=ni(c),g=p==Qe?c.constructor:r,x=g?Wr(g):"";if(x)switch(x){case H0:return St;case V0:return _e;case j0:return Ot;case ma:return et;case W0:return Se}return p});function Ae(c,p,g){for(var x=-1,R=g.length;++x<R;){var N=g[x],J=N.size;switch(N.type){case"drop":c+=J;break;case"dropRight":p-=J;break;case"take":p=ri(p,c+J);break;case"takeRight":c=Nn(c,p-J);break}}return{start:c,end:p}}function Ue(c){var p=c.match(Qh);return p?p[1].split(af):[]}function Ee(c,p,g){p=Ea(p,c);for(var x=-1,R=p.length,N=!1;++x<R;){var J=cr(p[x]);if(!(N=c!=null&&g(c,J)))break;c=c[J]}return N||++x!=R?N:(R=c==null?0:c.length,!!R&&Rv(R)&&Ke(J,R)&&(Tr(c)||dc(c)))}function Fe(c){var p=c.length,g=new c.constructor(p);return p&&typeof c[0]=="string"&&on.call(c,"index")&&(g.index=c.index,g.input=c.input),g}function He(c){return typeof c.constructor=="function"&&!bt(c)?_o(Xl(c)):{}}function qe(c,p,g){var x=c.constructor;switch(p){case ft:return sc(c);case ii:case Mt:return new x(+c);case St:return Hf(c,g);case pr:case rr:case sr:case Jt:case Er:case Ar:case Yr:case Zr:case Da:return Vs(c,g);case _e:return new x;case Ge:case Wt:return new x(c);case yt:return Vf(c);case et:return new x;case Gt:return jf(c)}}function ot(c,p){var g=p.length;if(!g)return c;var x=g-1;return p[x]=(g>1?"& ":"")+p[x],p=p.join(g>2?", ":" "),c.replace(Kh,`{
/* [wrapped with `+p+`] */
`)}function lt(c){return Tr(c)||dc(c)||!!(Bn&&c&&c[Bn])}function Ke(c,p){var g=typeof c;return p=p==null?Me:p,!!p&&(g=="number"||g!="symbol"&&co.test(c))&&c>-1&&c%1==0&&c<p}function rt(c,p,g){if(!Mn(g))return!1;var x=typeof p;return(x=="number"?ta(g)&&Ke(p,g.length):x=="string"&&p in g)?Mo(g[p],c):!1}function Ze(c,p){if(Tr(c))return!1;var g=typeof c;return g=="number"||g=="symbol"||g=="boolean"||c==null||Ca(c)?!0:pi.test(c)||!Zh.test(c)||p!=null&&c in an(p)}function st(c){var p=typeof c;return p=="string"||p=="number"||p=="symbol"||p=="boolean"?c!=="__proto__":c===null}function ce(c){var p=pc(c),g=I[p];if(typeof g!="function"||!(p in Ir.prototype))return!1;if(c===g)return!0;var x=Zp(g);return!!x&&c===x[0]}function Re(c){return!!Ts&&Ts in c}var it=xf?ju:Uy;function bt(c){var p=c&&c.constructor,g=typeof p=="function"&&p.prototype||Ss;return c===g}function We(c){return c===c&&!Mn(c)}function Tt(c,p){return function(g){return g==null?!1:g[c]===p&&(p!==r||c in an(g))}}function Ct(c){var p=wv(c,function(x){return g.size===l&&g.clear(),x}),g=p.cache;return p}function Yt(c,p){var g=c[1],x=p[1],R=g|x,N=R<(_|E|q),J=x==q&&g==A||x==q&&g==Y&&c[7].length<=p[8]||x==(q|Y)&&p[7].length<=p[8]&&g==A;if(!(N||J))return c;x&_&&(c[2]=p[2],R|=g&_?0:S);var se=p[3];if(se){var xe=c[3];c[3]=xe?Ws(xe,se,p[4]):se,c[4]=xe?go(c[3],f):p[4]}return se=p[5],se&&(xe=c[5],c[5]=xe?Xs(xe,se,p[6]):se,c[6]=xe?go(c[5],f):p[6]),se=p[7],se&&(c[7]=se),x&q&&(c[8]=c[8]==null?p[8]:ri(c[8],p[8])),c[9]==null&&(c[9]=p[9]),c[0]=p[0],c[1]=R,c}function ze(c){var p=[];if(c!=null)for(var g in an(c))p.push(g);return p}function Be(c){return bf.call(c)}function kt(c,p,g){return p=Nn(p===r?c.length-1:p,0),function(){for(var x=arguments,R=-1,N=Nn(x.length-p,0),J=De(N);++R<N;)J[R]=x[p+R];R=-1;for(var se=De(p+1);++R<p;)se[R]=x[R];return se[p]=g(J),ei(c,this,se)}}function mt(c,p){return p.length<2?c:Yo(c,Qi(p,0,-1))}function nt(c,p){for(var g=c.length,x=ri(p.length,g),R=oi(c);x--;){var N=p[x];c[x]=Ke(N,g)?R[N]:r}return c}function _t(c,p){if(!(p==="constructor"&&typeof c[p]=="function")&&p!="__proto__")return c[p]}var xt=wt(cv),ur=Qm||function(c,p){return Xn.setTimeout(c,p)},nr=wt($s);function Et(c,p,g){var x=p+"";return nr(c,ot(x,pn(Ue(x),g)))}function wt(c){var p=0,g=0;return function(){var x=G0(),R=ue-(x-g);if(g=x,R>0){if(++p>=K)return arguments[0]}else p=0;return c.apply(r,arguments)}}function Kt(c,p){var g=-1,x=c.length,R=x-1;for(p=p===r?x:p;++g<p;){var N=Jo(g,R),J=c[N];c[N]=c[g],c[g]=J}return c.length=p,c}var lr=Ct(function(c){var p=[];return c.charCodeAt(0)===46&&p.push(""),c.replace(nf,function(g,x,R,N){p.push(R?N.replace(fn,"$1"):x||g)}),p});function cr(c){if(typeof c=="string"||Ca(c))return c;var p=c+"";return p=="0"&&1/c==-ve?"-0":p}function Wr(c){if(c!=null){try{return Ef.call(c)}catch{}try{return c+""}catch{}}return""}function pn(c,p){return ti(Zt,function(g){var x="_."+g[0];p&g[1]&&!Na(c,x)&&c.push(x)}),c.sort()}function _r(c){if(c instanceof Ir)return c.clone();var p=new Bi(c.__wrapped__,c.__chain__);return p.__actions__=oi(c.__actions__),p.__index__=c.__index__,p.__values__=c.__values__,p}function zn(c,p,g){(g?rt(c,p,g):p===r)?p=1:p=Nn(Lr(p),0);var x=c==null?0:c.length;if(!x||p<1)return[];for(var R=0,N=0,J=De(Af(x/p));R<x;)J[N++]=Qi(c,R,R+=p);return J}function un(c){for(var p=-1,g=c==null?0:c.length,x=0,R=[];++p<g;){var N=c[p];N&&(R[x++]=N)}return R}function Tn(){var c=arguments.length;if(!c)return[];for(var p=De(c-1),g=arguments[0],x=c;x--;)p[x-1]=arguments[x];return Ho(Tr(g)?oi(g):[g],Un(p,1))}var yn=Or(function(c,p){return Vn(c)?Ha(c,Un(p,1,Vn,!0)):[]}),In=Or(function(c,p){var g=Z(p);return Vn(g)&&(g=r),Vn(c)?Ha(c,Un(p,1,Vn,!0),fr(g,2)):[]}),$n=Or(function(c,p){var g=Z(p);return Vn(g)&&(g=r),Vn(c)?Ha(c,Un(p,1,Vn,!0),r,g):[]});function Yn(c,p,g){var x=c==null?0:c.length;return x?(p=g||p===r?1:Lr(p),Qi(c,p<0?0:p,x)):[]}function _n(c,p,g){var x=c==null?0:c.length;return x?(p=g||p===r?1:Lr(p),p=x-p,Qi(c,0,p<0?0:p)):[]}function dr(c,p){return c&&c.length?$f(c,fr(p,3),!0,!0):[]}function Gn(c,p){return c&&c.length?$f(c,fr(p,3),!0):[]}function Ur(c,p,g,x){var R=c==null?0:c.length;return R?(g&&typeof g!="number"&&rt(c,p,g)&&(g=0,x=R),Lp(c,p,g,x)):[]}function wn(c,p,g){var x=c==null?0:c.length;if(!x)return-1;var R=g==null?0:Lr(g);return R<0&&(R=Nn(x+R,0)),hf(c,fr(p,3),R)}function er(c,p,g){var x=c==null?0:c.length;if(!x)return-1;var R=x-1;return g!==r&&(R=Lr(g),R=g<0?Nn(x+R,0):ri(R,x-1)),hf(c,fr(p,3),R,!0)}function mr(c){var p=c==null?0:c.length;return p?Un(c,1):[]}function Xr(c){var p=c==null?0:c.length;return p?Un(c,ve):[]}function En(c,p){var g=c==null?0:c.length;return g?(p=p===r?1:Lr(p),Un(c,p)):[]}function Ao(c){for(var p=-1,g=c==null?0:c.length,x={};++p<g;){var R=c[p];x[R[0]]=R[1]}return x}function V(c){return c&&c.length?c[0]:r}function we(c,p,g){var x=c==null?0:c.length;if(!x)return-1;var R=g==null?0:Lr(g);return R<0&&(R=Nn(x+R,0)),mi(c,p,R)}function ye(c){var p=c==null?0:c.length;return p?Qi(c,0,-1):[]}var Lt=Or(function(c){var p=dn(c,Gs);return p.length&&p[0]===c[0]?ec(p):[]}),br=Or(function(c){var p=Z(c),g=dn(c,Gs);return p===Z(g)?p=r:g.pop(),g.length&&g[0]===c[0]?ec(g,fr(p,2)):[]}),z=Or(function(c){var p=Z(c),g=dn(c,Gs);return p=typeof p=="function"?p:r,p&&g.pop(),g.length&&g[0]===c[0]?ec(g,r,p):[]});function L(c,p){return c==null?"":Sp.call(c,p)}function Z(c){var p=c==null?0:c.length;return p?c[p-1]:r}function he(c,p,g){var x=c==null?0:c.length;if(!x)return-1;var R=x;return g!==r&&(R=Lr(g),R=R<0?Nn(x+R,0):ri(R,x-1)),p===p?D0(c,p,R):hf(c,Nl,R,!0)}function Te(c,p){return c&&c.length?Ko(c,Lr(p)):r}var ie=Or(ee);function ee(c,p){return c&&c.length&&p&&p.length?ic(c,p):c}function oe(c,p,g){return c&&c.length&&p&&p.length?ic(c,p,fr(g,2)):c}function D(c,p,g){return c&&c.length&&p&&p.length?ic(c,p,r,g):c}var Q=Co(function(c,p){var g=c==null?0:c.length,x=Rp(c,p);return zf(c,dn(p,function(R){return Ke(R,g)?+R:R}).sort(js)),x});function G(c,p){var g=[];if(!(c&&c.length))return g;var x=-1,R=[],N=c.length;for(p=fr(p,3);++x<N;){var J=c[x];p(J,x,c)&&(g.push(J),R.push(x))}return zf(c,R),g}function fe(c){return c==null?c:ey.call(c)}function me(c,p,g){var x=c==null?0:c.length;return x?(g&&typeof g!="number"&&rt(c,p,g)?(p=0,g=x):(p=p==null?0:Lr(p),g=g===r?x:Lr(g)),Qi(c,p,g)):[]}function Ve(c,p){return ac(c,p)}function pt(c,p,g){return Up(c,p,fr(g,2))}function dt(c,p){var g=c==null?0:c.length;if(g){var x=ac(c,p);if(x<g&&Mo(c[x],p))return x}return-1}function At(c,p){return ac(c,p,!0)}function ht(c,p,g){return Up(c,p,fr(g,2),!0)}function Bt(c,p){var g=c==null?0:c.length;if(g){var x=ac(c,p,!0)-1;if(Mo(c[x],p))return x}return-1}function Rt(c){return c&&c.length?fv(c):[]}function Pt(c,p){return c&&c.length?fv(c,fr(p,2)):[]}function Dt(c){var p=c==null?0:c.length;return p?Qi(c,1,p):[]}function Nt(c,p,g){return c&&c.length?(p=g||p===r?1:Lr(p),Qi(c,0,p<0?0:p)):[]}function tr(c,p,g){var x=c==null?0:c.length;return x?(p=g||p===r?1:Lr(p),p=x-p,Qi(c,p<0?0:p,x)):[]}function Kr(c,p){return c&&c.length?$f(c,fr(p,3),!1,!0):[]}function Hn(c,p){return c&&c.length?$f(c,fr(p,3)):[]}var So=Or(function(c){return eu(Un(c,1,Vn,!0))}),To=Or(function(c){var p=Z(c);return Vn(p)&&(p=r),eu(Un(c,1,Vn,!0),fr(p,2))}),wo=Or(function(c){var p=Z(c);return p=typeof p=="function"?p:r,eu(Un(c,1,Vn,!0),r,p)});function ui(c){return c&&c.length?eu(c):[]}function Xa(c,p){return c&&c.length?eu(c,fr(p,2)):[]}function Ji(c,p){return p=typeof p=="function"?p:r,c&&c.length?eu(c,r,p):[]}function Xf(c){if(!(c&&c.length))return[];var p=0;return c=vo(c,function(g){if(Vn(g))return p=Nn(g.length,p),!0}),zl(p,function(g){return dn(c,Ul(g))})}function ea(c,p){if(!(c&&c.length))return[];var g=Xf(c);return p==null?g:dn(g,function(x){return ei(p,r,x)})}var Cv=Or(function(c,p){return Vn(c)?Ha(c,p):[]}),n6=Or(function(c){return $p(vo(c,Vn))}),i6=Or(function(c){var p=Z(c);return Vn(p)&&(p=r),$p(vo(c,Vn),fr(p,2))}),a6=Or(function(c){var p=Z(c);return p=typeof p=="function"?p:r,$p(vo(c,Vn),r,p)}),o6=Or(Xf);function u6(c,p){return Gf(c||[],p||[],Ql)}function s6(c,p){return Gf(c||[],p||[],zs)}var l6=Or(function(c){var p=c.length,g=p>1?c[p-1]:r;return g=typeof g=="function"?(c.pop(),g):r,ea(c,g)});function YE(c){var p=I(c);return p.__chain__=!0,p}function c6(c,p){return p(c),c}function Av(c,p){return p(c)}var f6=Co(function(c){var p=c.length,g=p?c[0]:0,x=this.__wrapped__,R=function(N){return Rp(N,c)};return p>1||this.__actions__.length||!(x instanceof Ir)||!Ke(g)?this.thru(R):(x=x.slice(g,+g+(p?1:0)),x.__actions__.push({func:Av,args:[R],thisArg:r}),new Bi(x,this.__chain__).thru(function(N){return p&&!N.length&&N.push(r),N}))});function h6(){return YE(this)}function p6(){return new Bi(this.value(),this.__chain__)}function d6(){this.__values__===r&&(this.__values__=s2(this.value()));var c=this.__index__>=this.__values__.length,p=c?r:this.__values__[this.__index__++];return{done:c,value:p}}function v6(){return this}function g6(c){for(var p,g=this;g instanceof ql;){var x=_r(g);x.__index__=0,x.__values__=r,p?R.__wrapped__=x:p=x;var R=x;g=g.__wrapped__}return R.__wrapped__=c,p}function m6(){var c=this.__wrapped__;if(c instanceof Ir){var p=c;return this.__actions__.length&&(p=new Ir(this)),p=p.reverse(),p.__actions__.push({func:Av,args:[fe],thisArg:r}),new Bi(p,this.__chain__)}return this.thru(fe)}function y6(){return dv(this.__wrapped__,this.__actions__)}var _6=Ys(function(c,p,g){on.call(c,g)?++c[g]:Ni(c,g,1)});function x6(c,p,g){var x=Tr(c)?Iu:Op;return g&&rt(c,p,g)&&(p=r),x(c,fr(p,3))}function E6(c,p){var g=Tr(c)?vo:Ff;return g(c,fr(p,3))}var b6=Vp(wn),C6=Vp(er);function A6(c,p){return Un(Sv(c,p),1)}function S6(c,p){return Un(Sv(c,p),ve)}function T6(c,p,g){return g=g===r?1:Lr(g),Un(Sv(c,p),g)}function ZE(c,p){var g=Tr(c)?ti:Eo;return g(c,fr(p,3))}function qE(c,p){var g=Tr(c)?M0:Uu;return g(c,fr(p,3))}var w6=Ys(function(c,p,g){on.call(c,g)?c[g].push(p):Ni(c,g,[p])});function M6(c,p,g,x){c=ta(c)?c:Zf(c),g=g&&!x?Lr(g):0;var R=c.length;return g<0&&(g=Nn(R+g,0)),Ov(c)?g<=R&&c.indexOf(p,g)>-1:!!R&&mi(c,p,g)>-1}var R6=Or(function(c,p,g){var x=-1,R=typeof p=="function",N=ta(c)?De(c.length):[];return Eo(c,function(J){N[++x]=R?ei(p,J,g):Ps(J,p,g)}),N}),O6=Ys(function(c,p,g){Ni(c,g,p)});function Sv(c,p){var g=Tr(c)?dn:Bs;return g(c,fr(p,3))}function L6(c,p,g,x){return c==null?[]:(Tr(p)||(p=p==null?[]:[p]),g=x?r:g,Tr(g)||(g=g==null?[]:[g]),Qo(c,p,g))}var F6=Ys(function(c,p,g){c[g?0:1].push(p)},function(){return[[],[]]});function I6(c,p,g){var x=Tr(c)?up:bs,R=arguments.length<3;return x(c,fr(p,4),g,R,Eo)}function k6(c,p,g){var x=Tr(c)?R0:bs,R=arguments.length<3;return x(c,fr(p,4),g,R,Uu)}function P6(c,p){var g=Tr(c)?vo:Ff;return g(c,Mv(fr(p,3)))}function D6(c){var p=Tr(c)?wp:sv;return p(c)}function B6(c,p,g){(g?rt(c,p,g):p===r)?p=1:p=Lr(p);var x=Tr(c)?Mp:lv;return x(c,p)}function N6(c){var p=Tr(c)?_y:Np;return p(c)}function U6(c){if(c==null)return 0;if(ta(c))return Ov(c)?ga(c):c.length;var p=W(c);return p==_e||p==et?c.size:Bf(c).length}function z6(c,p,g){var x=Tr(c)?sp:by;return g&&rt(c,p,g)&&(p=r),x(c,fr(p,3))}var $6=Or(function(c,p){if(c==null)return[];var g=p.length;return g>1&&rt(c,p[0],p[1])?p=[]:g>2&&rt(p[0],p[1],p[2])&&(p=[p[0]]),Qo(c,Un(p,1),[])}),Tv=z0||function(){return Xn.Date.now()};function G6(c,p){if(typeof p!="function")throw new Zi(o);return c=Lr(c),function(){if(--c<1)return p.apply(this,arguments)}}function KE(c,p,g){return p=g?r:p,p=c&&p==null?c.length:p,Wa(c,q,r,r,r,r,p)}function QE(c,p){var g;if(typeof p!="function")throw new Zi(o);return c=Lr(c),function(){return--c>0&&(g=p.apply(this,arguments)),c<=1&&(p=r),g}}var wy=Or(function(c,p,g){var x=_;if(g.length){var R=go(g,Vu(wy));x|=O}return Wa(c,x,p,g,R)}),JE=Or(function(c,p,g){var x=_|E;if(g.length){var R=go(g,Vu(JE));x|=O}return Wa(p,x,c,g,R)});function e2(c,p,g){p=g?r:p;var x=Wa(c,A,r,r,r,r,r,p);return x.placeholder=e2.placeholder,x}function t2(c,p,g){p=g?r:p;var x=Wa(c,M,r,r,r,r,r,p);return x.placeholder=t2.placeholder,x}function r2(c,p,g){var x,R,N,J,se,xe,at=0,ut=!1,gt=!1,Ht=!0;if(typeof c!="function")throw new Zi(o);p=Ya(p)||0,Mn(g)&&(ut=!!g.leading,gt="maxWait"in g,N=gt?Nn(Ya(g.maxWait)||0,p):N,Ht="trailing"in g?!!g.trailing:Ht);function or(jn){var Ro=x,Xu=R;return x=R=r,at=jn,J=c.apply(Xu,Ro),J}function vr(jn){return at=jn,se=ur(zr,p),ut?or(jn):J}function Fr(jn){var Ro=jn-xe,Xu=jn-at,E2=p-Ro;return gt?ri(E2,N-Xu):E2}function gr(jn){var Ro=jn-xe,Xu=jn-at;return xe===r||Ro>=p||Ro<0||gt&&Xu>=N}function zr(){var jn=Tv();if(gr(jn))return Hr(jn);se=ur(zr,Fr(jn))}function Hr(jn){return se=r,Ht&&x?or(jn):(x=R=r,J)}function Aa(){se!==r&&oc(se),at=0,x=xe=R=se=r}function $i(){return se===r?J:Hr(Tv())}function Sa(){var jn=Tv(),Ro=gr(jn);if(x=arguments,R=this,xe=jn,Ro){if(se===r)return vr(xe);if(gt)return oc(se),se=ur(zr,p),or(xe)}return se===r&&(se=ur(zr,p)),J}return Sa.cancel=Aa,Sa.flush=$i,Sa}var H6=Or(function(c,p){return J0(c,1,p)}),V6=Or(function(c,p,g){return J0(c,Ya(p)||0,g)});function j6(c){return Wa(c,ne)}function wv(c,p){if(typeof c!="function"||p!=null&&typeof p!="function")throw new Zi(o);var g=function(){var x=arguments,R=p?p.apply(this,x):x[0],N=g.cache;if(N.has(R))return N.get(R);var J=c.apply(this,x);return g.cache=N.set(R,J)||N,J};return g.cache=new(wv.Cache||xo),g}wv.Cache=xo;function Mv(c){if(typeof c!="function")throw new Zi(o);return function(){var p=arguments;switch(p.length){case 0:return!c.call(this);case 1:return!c.call(this,p[0]);case 2:return!c.call(this,p[0],p[1]);case 3:return!c.call(this,p[0],p[1],p[2])}return!c.apply(this,p)}}function W6(c){return QE(2,c)}var X6=Gp(function(c,p){p=p.length==1&&Tr(p[0])?dn(p[0],ki(fr())):dn(Un(p,1),ki(fr()));var g=p.length;return Or(function(x){for(var R=-1,N=ri(x.length,g);++R<N;)x[R]=p[R].call(this,x[R]);return ei(c,this,x)})}),My=Or(function(c,p){var g=go(p,Vu(My));return Wa(c,O,r,p,g)}),n2=Or(function(c,p){var g=go(p,Vu(n2));return Wa(c,j,r,p,g)}),Y6=Co(function(c,p){return Wa(c,Y,r,r,r,p)});function Z6(c,p){if(typeof c!="function")throw new Zi(o);return p=p===r?p:Lr(p),Or(c,p)}function q6(c,p){if(typeof c!="function")throw new Zi(o);return p=p==null?0:Nn(Lr(p),0),Or(function(g){var x=g[p],R=ba(g,0,p);return x&&Ho(R,x),ei(c,this,R)})}function K6(c,p,g){var x=!0,R=!0;if(typeof c!="function")throw new Zi(o);return Mn(g)&&(x="leading"in g?!!g.leading:x,R="trailing"in g?!!g.trailing:R),r2(c,p,{leading:x,maxWait:p,trailing:R})}function Q6(c){return KE(c,1)}function J6(c,p){return My(Hs(p),c)}function e8(){if(!arguments.length)return[];var c=arguments[0];return Tr(c)?c:[c]}function t8(c){return Ki(c,v)}function r8(c,p){return p=typeof p=="function"?p:r,Ki(c,v,p)}function n8(c){return Ki(c,h|v)}function i8(c,p){return p=typeof p=="function"?p:r,Ki(c,h|v,p)}function a8(c,p){return p==null||Nu(c,p,si(p))}function Mo(c,p){return c===p||c!==c&&p!==p}var o8=hc(Pf),u8=hc(function(c,p){return c>=p}),dc=Df(function(){return arguments}())?Df:function(c){return kn(c)&&on.call(c,"callee")&&!N0.call(c,"callee")},Tr=De.isArray,s8=C0?ki(C0):Ip;function ta(c){return c!=null&&Rv(c.length)&&!ju(c)}function Vn(c){return kn(c)&&ta(c)}function l8(c){return c===!0||c===!1||kn(c)&&ni(c)==ii}var Ks=Cp||Uy,c8=A0?ki(A0):iv;function f8(c){return kn(c)&&c.nodeType===1&&!Kp(c)}function h8(c){if(c==null)return!0;if(ta(c)&&(Tr(c)||typeof c=="string"||typeof c.splice=="function"||Ks(c)||Yf(c)||dc(c)))return!c.length;var p=W(c);if(p==_e||p==et)return!c.size;if(bt(c))return!Bf(c).length;for(var g in c)if(on.call(c,g))return!1;return!0}function p8(c,p){return zu(c,p)}function d8(c,p,g){g=typeof g=="function"?g:r;var x=g?g(c,p):r;return x===r?zu(c,p,r,g):!!x}function Ry(c){if(!kn(c))return!1;var p=ni(c);return p==ar||p==qt||typeof c.message=="string"&&typeof c.name=="string"&&!Kp(c)}function v8(c){return typeof c=="number"&&Ap(c)}function ju(c){if(!Mn(c))return!1;var p=ni(c);return p==k||p==ae||p==gn||p==Je}function i2(c){return typeof c=="number"&&c==Lr(c)}function Rv(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=Me}function Mn(c){var p=typeof c;return c!=null&&(p=="object"||p=="function")}function kn(c){return c!=null&&typeof c=="object"}var a2=S0?ki(S0):ov;function g8(c,p){return c===p||tc(c,p,qp(p))}function m8(c,p,g){return g=typeof g=="function"?g:r,tc(c,p,qp(p),g)}function y8(c){return o2(c)&&c!=+c}function _8(c){if(it(c))throw new yr(a);return kp(c)}function x8(c){return c===null}function E8(c){return c==null}function o2(c){return typeof c=="number"||kn(c)&&ni(c)==Ge}function Kp(c){if(!kn(c)||ni(c)!=Qe)return!1;var p=Xl(c);if(p===null)return!0;var g=on.call(p,"constructor")&&p.constructor;return typeof g=="function"&&g instanceof g&&Ef.call(g)==Cf}var Oy=po?ki(po):uv;function b8(c){return i2(c)&&c>=-Me&&c<=Me}var u2=T0?ki(T0):Pp;function Ov(c){return typeof c=="string"||!Tr(c)&&kn(c)&&ni(c)==Wt}function Ca(c){return typeof c=="symbol"||kn(c)&&ni(c)==Gt}var Yf=w0?ki(w0):Dp;function C8(c){return c===r}function A8(c){return kn(c)&&W(c)==Se}function S8(c){return kn(c)&&ni(c)==$e}var T8=hc(xa),w8=hc(function(c,p){return c<=p});function s2(c){if(!c)return[];if(ta(c))return Ov(c)?Pi(c):oi(c);if(Ms&&c[Ms])return I0(c[Ms]());var p=W(c),g=p==_e?gf:p==et?Hl:Zf;return g(c)}function Wu(c){if(!c)return c===0?c:0;if(c=Ya(c),c===ve||c===-ve){var p=c<0?-1:1;return p*Ne}return c===c?c:0}function Lr(c){var p=Wu(c),g=p%1;return p===p?g?p-g:p:0}function l2(c){return c?Ga(Lr(c),0,ct):0}function Ya(c){if(typeof c=="number")return c;if(Ca(c))return Xe;if(Mn(c)){var p=typeof c.valueOf=="function"?c.valueOf():c;c=Mn(p)?p+"":p}if(typeof c!="string")return c===0?c:+c;c=F0(c);var g=sf.test(c);return g||Ll.test(c)?ap(c.slice(2),g?2:8):uf.test(c)?Xe:+c}function c2(c){return Mi(c,ra(c))}function M8(c){return c?Ga(Lr(c),-Me,Me):c===0?c:0}function ln(c){return c==null?"":Ui(c)}var R8=Zs(function(c,p){if(bt(p)||ta(p)){Mi(p,si(p),c);return}for(var g in p)on.call(p,g)&&Ql(c,g,p[g])}),f2=Zs(function(c,p){Mi(p,ra(p),c)}),Lv=Zs(function(c,p,g,x){Mi(p,ra(p),c,x)}),O8=Zs(function(c,p,g,x){Mi(p,si(p),c,x)}),L8=Co(Rp);function F8(c,p){var g=_o(c);return p==null?g:Q0(g,p)}var I8=Or(function(c,p){c=an(c);var g=-1,x=p.length,R=x>2?p[2]:r;for(R&&rt(p[0],p[1],R)&&(x=1);++g<x;)for(var N=p[g],J=ra(N),se=-1,xe=J.length;++se<xe;){var at=J[se],ut=c[at];(ut===r||Mo(ut,Ss[at])&&!on.call(c,at))&&(c[at]=N[at])}return c}),k8=Or(function(c){return c.push(r,xv),ei(h2,r,c)});function P8(c,p){return lp(c,fr(p,3),_a)}function D8(c,p){return lp(c,fr(p,3),If)}function B8(c,p){return c==null?c:ks(c,fr(p,3),ra)}function N8(c,p){return c==null?c:Fp(c,fr(p,3),ra)}function U8(c,p){return c&&_a(c,fr(p,3))}function z8(c,p){return c&&If(c,fr(p,3))}function $8(c){return c==null?[]:Jl(c,si(c))}function G8(c){return c==null?[]:Jl(c,ra(c))}function Ly(c,p,g){var x=c==null?r:Yo(c,p);return x===r?g:x}function H8(c,p){return c!=null&&Ee(c,p,ev)}function Fy(c,p){return c!=null&&Ee(c,p,tv)}var V8=jp(function(c,p,g){p!=null&&typeof p.toString!="function"&&(p=bf.call(p)),c[p]=g},ky(na)),j8=jp(function(c,p,g){p!=null&&typeof p.toString!="function"&&(p=bf.call(p)),on.call(c,p)?c[p].push(g):c[p]=[g]},fr),W8=Or(Ps);function si(c){return ta(c)?Kl(c):Bf(c)}function ra(c){return ta(c)?Kl(c,!0):Nf(c)}function X8(c,p){var g={};return p=fr(p,3),_a(c,function(x,R,N){Ni(g,p(x,R,N),x)}),g}function Y8(c,p){var g={};return p=fr(p,3),_a(c,function(x,R,N){Ni(g,R,p(x,R,N))}),g}var Z8=Zs(function(c,p,g){qo(c,p,g)}),h2=Zs(function(c,p,g,x){qo(c,p,g,x)}),q8=Co(function(c,p){var g={};if(c==null)return g;var x=!1;p=dn(p,function(N){return N=Ea(N,c),x||(x=N.length>1),N}),Mi(c,Yp(c),g),x&&(g=Ki(g,h|d|v,Ay));for(var R=p.length;R--;)zp(g,p[R]);return g});function K8(c,p){return p2(c,Mv(fr(p)))}var Q8=Co(function(c,p){return c==null?{}:Uf(c,p)});function p2(c,p){if(c==null)return{};var g=dn(Yp(c),function(x){return[x]});return p=fr(p),rc(c,g,function(x,R){return p(x,R[0])})}function J8(c,p,g){p=Ea(p,c);var x=-1,R=p.length;for(R||(R=1,c=r);++x<R;){var N=c==null?r:c[cr(p[x])];N===r&&(x=R,N=g),c=ju(N)?N.call(c):N}return c}function eR(c,p,g){return c==null?c:zs(c,p,g)}function tR(c,p,g,x){return x=typeof x=="function"?x:r,c==null?c:zs(c,p,g,x)}var d2=yi(si),v2=yi(ra);function rR(c,p,g){var x=Tr(c),R=x||Ks(c)||Yf(c);if(p=fr(p,4),g==null){var N=c&&c.constructor;R?g=x?new N:[]:Mn(c)?g=ju(N)?_o(Xl(c)):{}:g={}}return(R?ti:_a)(c,function(J,se,xe){return p(g,J,se,xe)}),g}function nR(c,p){return c==null?!0:zp(c,p)}function iR(c,p,g){return c==null?c:pv(c,p,Hs(g))}function aR(c,p,g,x){return x=typeof x=="function"?x:r,c==null?c:pv(c,p,Hs(g),x)}function Zf(c){return c==null?[]:fp(c,si(c))}function oR(c){return c==null?[]:fp(c,ra(c))}function uR(c,p,g){return g===r&&(g=p,p=r),g!==r&&(g=Ya(g),g=g===g?g:0),p!==r&&(p=Ya(p),p=p===p?p:0),Ga(Ya(c),p,g)}function sR(c,p,g){return p=Wu(p),g===r?(g=p,p=0):g=Wu(g),c=Ya(c),rv(c,p,g)}function lR(c,p,g){if(g&&typeof g!="boolean"&&rt(c,p,g)&&(p=g=r),g===r&&(typeof p=="boolean"?(g=p,p=r):typeof c=="boolean"&&(g=c,c=r)),c===r&&p===r?(c=0,p=1):(c=Wu(c),p===r?(p=c,c=0):p=Wu(p)),c>p){var x=c;c=p,p=x}if(g||c%1||p%1){var R=Yl();return ri(c+R*(p-c+ip("1e-"+((R+"").length-1))),p)}return Jo(c,p)}var cR=Hu(function(c,p,g){return p=p.toLowerCase(),c+(g?g2(p):p)});function g2(c){return Iy(ln(c).toLowerCase())}function m2(c){return c=ln(c),c&&c.replace(Su,pp).replace(zm,"")}function fR(c,p,g){c=ln(c),p=Ui(p);var x=c.length;g=g===r?x:Ga(Lr(g),0,x);var R=g;return g-=p.length,g>=0&&c.slice(g,R)==p}function hR(c){return c=ln(c),c&&tf.test(c)?c.replace(ef,Cs):c}function pR(c){return c=ln(c),c&&qh.test(c)?c.replace(Ml,"\\$&"):c}var dR=Hu(function(c,p,g){return c+(g?"-":"")+p.toLowerCase()}),vR=Hu(function(c,p,g){return c+(g?" ":"")+p.toLowerCase()}),gR=Hp("toLowerCase");function mR(c,p,g){c=ln(c),p=Lr(p);var x=p?ga(c):0;if(!p||x>=p)return c;var R=(p-x)/2;return cc(Sf(R),g)+c+cc(Af(R),g)}function yR(c,p,g){c=ln(c),p=Lr(p);var x=p?ga(c):0;return p&&x<p?c+cc(p-x,g):c}function _R(c,p,g){c=ln(c),p=Lr(p);var x=p?ga(c):0;return p&&x<p?cc(p-x,g)+c:c}function xR(c,p,g){return g||p==null?p=0:p&&(p=+p),Jm(ln(c).replace(Rl,""),p||0)}function ER(c,p,g){return(g?rt(c,p,g):p===r)?p=1:p=Lr(p),Bp(ln(c),p)}function bR(){var c=arguments,p=ln(c[0]);return c.length<3?p:p.replace(c[1],c[2])}var CR=Hu(function(c,p,g){return c+(g?"_":"")+p.toLowerCase()});function AR(c,p,g){return g&&typeof g!="number"&&rt(c,p,g)&&(p=g=r),g=g===r?ct:g>>>0,g?(c=ln(c),c&&(typeof p=="string"||p!=null&&!Oy(p))&&(p=Ui(p),!p&&jo(c))?ba(Pi(c),0,g):c.split(p,g)):[]}var SR=Hu(function(c,p,g){return c+(g?" ":"")+Iy(p)});function TR(c,p,g){return c=ln(c),g=g==null?0:Ga(Lr(g),0,c.length),p=Ui(p),c.slice(g,g+p.length)==p}function wR(c,p,g){var x=I.templateSettings;g&&rt(c,p,g)&&(p=r),c=ln(c),p=Lv({},p,x,_v);var R=Lv({},p.imports,x.imports,_v),N=si(R),J=fp(R,N),se,xe,at=0,ut=p.interpolate||Ba,gt="__p += '",Ht=_p((p.escape||Ba).source+"|"+ut.source+"|"+(ut===rf?Jh:Ba).source+"|"+(p.evaluate||Ba).source+"|$","g"),or="//# sourceURL="+(on.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Vm+"]")+`
`;c.replace(Ht,function(gr,zr,Hr,Aa,$i,Sa){return Hr||(Hr=Aa),gt+=c.slice(at,Sa).replace(gs,dp),zr&&(se=!0,gt+=`' +
__e(`+zr+`) +
'`),$i&&(xe=!0,gt+=`';
`+$i+`;
__p += '`),Hr&&(gt+=`' +
((__t = (`+Hr+`)) == null ? '' : __t) +
'`),at=Sa+gr.length,gr}),gt+=`';
`;var vr=on.call(p,"variable")&&p.variable;if(!vr)gt=`with (obj) {
`+gt+`
}
`;else if(of.test(vr))throw new yr(u);gt=(xe?gt.replace(Wh,""):gt).replace(Jc,"$1").replace(Xh,"$1;"),gt="function("+(vr||"obj")+`) {
`+(vr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(se?", __e = _.escape":"")+(xe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+gt+`return __p
}`;var Fr=_2(function(){return jr(N,or+"return "+gt).apply(r,J)});if(Fr.source=gt,Ry(Fr))throw Fr;return Fr}function MR(c){return ln(c).toLowerCase()}function RR(c){return ln(c).toUpperCase()}function OR(c,p,g){if(c=ln(c),c&&(g||p===r))return F0(c);if(!c||!(p=Ui(p)))return c;var x=Pi(c),R=Pi(p),N=vf(x,R),J=Gl(x,R)+1;return ba(x,N,J).join("")}function LR(c,p,g){if(c=ln(c),c&&(g||p===r))return c.slice(0,mf(c)+1);if(!c||!(p=Ui(p)))return c;var x=Pi(c),R=Gl(x,Pi(p))+1;return ba(x,0,R).join("")}function FR(c,p,g){if(c=ln(c),c&&(g||p===r))return c.replace(Rl,"");if(!c||!(p=Ui(p)))return c;var x=Pi(c),R=vf(x,Pi(p));return ba(x,R).join("")}function IR(c,p){var g=X,x=$;if(Mn(p)){var R="separator"in p?p.separator:R;g="length"in p?Lr(p.length):g,x="omission"in p?Ui(p.omission):x}c=ln(c);var N=c.length;if(jo(c)){var J=Pi(c);N=J.length}if(g>=N)return c;var se=g-ga(x);if(se<1)return x;var xe=J?ba(J,0,se).join(""):c.slice(0,se);if(R===r)return xe+x;if(J&&(se+=xe.length-se),Oy(R)){if(c.slice(se).search(R)){var at,ut=xe;for(R.global||(R=_p(R.source,ln(Ol.exec(R))+"g")),R.lastIndex=0;at=R.exec(ut);)var gt=at.index;xe=xe.slice(0,gt===r?se:gt)}}else if(c.indexOf(Ui(R),se)!=se){var Ht=xe.lastIndexOf(R);Ht>-1&&(xe=xe.slice(0,Ht))}return xe+x}function kR(c){return c=ln(c),c&&Yh.test(c)?c.replace(Au,Vl):c}var PR=Hu(function(c,p,g){return c+(g?" ":"")+p.toUpperCase()}),Iy=Hp("toUpperCase");function y2(c,p,g){return c=ln(c),p=g?r:p,p===r?gp(c)?qm(c):mn(c):c.match(p)||[]}var _2=Or(function(c,p){try{return ei(c,r,p)}catch(g){return Ry(g)?g:new yr(g)}}),DR=Co(function(c,p){return ti(p,function(g){g=cr(g),Ni(c,g,wy(c[g],c))}),c});function BR(c){var p=c==null?0:c.length,g=fr();return c=p?dn(c,function(x){if(typeof x[1]!="function")throw new Zi(o);return[g(x[0]),x[1]]}):[],Or(function(x){for(var R=-1;++R<p;){var N=c[R];if(ei(N[0],this,x))return ei(N[1],this,x)}})}function NR(c){return Fs(Ki(c,h))}function ky(c){return function(){return c}}function UR(c,p){return c==null||c!==c?p:c}var zR=yv(),$R=yv(!0);function na(c){return c}function Py(c){return Ds(typeof c=="function"?c:Ki(c,h))}function GR(c){return Zo(Ki(c,h))}function HR(c,p){return Ns(c,Ki(p,h))}var VR=Or(function(c,p){return function(g){return Ps(g,c,p)}}),jR=Or(function(c,p){return function(g){return Ps(c,g,p)}});function Dy(c,p,g){var x=si(p),R=Jl(p,x);g==null&&!(Mn(p)&&(R.length||!x.length))&&(g=p,p=c,c=this,R=Jl(p,si(p)));var N=!(Mn(g)&&"chain"in g)||!!g.chain,J=ju(c);return ti(R,function(se){var xe=p[se];c[se]=xe,J&&(c.prototype[se]=function(){var at=this.__chain__;if(N||at){var ut=c(this.__wrapped__),gt=ut.__actions__=oi(this.__actions__);return gt.push({func:xe,args:arguments,thisArg:c}),ut.__chain__=at,ut}return xe.apply(c,Ho([this.value()],arguments))})}),c}function WR(){return Xn._===this&&(Xn._=qi),this}function By(){}function XR(c){return c=Lr(c),Or(function(p){return Ko(p,c)})}var YR=Va(dn),ZR=Va(Iu),qR=Va(sp);function x2(c){return Ze(c)?Ul(cr(c)):nc(c)}function KR(c){return function(p){return c==null?r:Yo(c,p)}}var QR=fc(),JR=fc(!0);function Ny(){return[]}function Uy(){return!1}function eO(){return{}}function tO(){return""}function rO(){return!0}function nO(c,p){if(c=Lr(c),c<1||c>Me)return[];var g=ct,x=ri(c,ct);p=fr(p),c-=ct;for(var R=zl(x,p);++g<c;)p(g);return R}function iO(c){return Tr(c)?dn(c,cr):Ca(c)?[c]:oi(lr(ln(c)))}function aO(c){var p=++B0;return ln(c)+p}var oO=bo(function(c,p){return c+p},0),uO=ja("ceil"),sO=bo(function(c,p){return c/p},1),lO=ja("floor");function cO(c){return c&&c.length?Is(c,na,Pf):r}function fO(c,p){return c&&c.length?Is(c,fr(p,2),Pf):r}function hO(c){return Vo(c,na)}function pO(c,p){return Vo(c,fr(p,2))}function dO(c){return c&&c.length?Is(c,na,xa):r}function vO(c,p){return c&&c.length?Is(c,fr(p,2),xa):r}var gO=bo(function(c,p){return c*p},1),mO=ja("round"),yO=bo(function(c,p){return c-p},0);function _O(c){return c&&c.length?df(c,na):0}function xO(c,p){return c&&c.length?df(c,fr(p,2)):0}return I.after=G6,I.ary=KE,I.assign=R8,I.assignIn=f2,I.assignInWith=Lv,I.assignWith=O8,I.at=L8,I.before=QE,I.bind=wy,I.bindAll=DR,I.bindKey=JE,I.castArray=e8,I.chain=YE,I.chunk=zn,I.compact=un,I.concat=Tn,I.cond=BR,I.conforms=NR,I.constant=ky,I.countBy=_6,I.create=F8,I.curry=e2,I.curryRight=t2,I.debounce=r2,I.defaults=I8,I.defaultsDeep=k8,I.defer=H6,I.delay=V6,I.difference=yn,I.differenceBy=In,I.differenceWith=$n,I.drop=Yn,I.dropRight=_n,I.dropRightWhile=dr,I.dropWhile=Gn,I.fill=Ur,I.filter=E6,I.flatMap=A6,I.flatMapDeep=S6,I.flatMapDepth=T6,I.flatten=mr,I.flattenDeep=Xr,I.flattenDepth=En,I.flip=j6,I.flow=zR,I.flowRight=$R,I.fromPairs=Ao,I.functions=$8,I.functionsIn=G8,I.groupBy=w6,I.initial=ye,I.intersection=Lt,I.intersectionBy=br,I.intersectionWith=z,I.invert=V8,I.invertBy=j8,I.invokeMap=R6,I.iteratee=Py,I.keyBy=O6,I.keys=si,I.keysIn=ra,I.map=Sv,I.mapKeys=X8,I.mapValues=Y8,I.matches=GR,I.matchesProperty=HR,I.memoize=wv,I.merge=Z8,I.mergeWith=h2,I.method=VR,I.methodOf=jR,I.mixin=Dy,I.negate=Mv,I.nthArg=XR,I.omit=q8,I.omitBy=K8,I.once=W6,I.orderBy=L6,I.over=YR,I.overArgs=X6,I.overEvery=ZR,I.overSome=qR,I.partial=My,I.partialRight=n2,I.partition=F6,I.pick=Q8,I.pickBy=p2,I.property=x2,I.propertyOf=KR,I.pull=ie,I.pullAll=ee,I.pullAllBy=oe,I.pullAllWith=D,I.pullAt=Q,I.range=QR,I.rangeRight=JR,I.rearg=Y6,I.reject=P6,I.remove=G,I.rest=Z6,I.reverse=fe,I.sampleSize=B6,I.set=eR,I.setWith=tR,I.shuffle=N6,I.slice=me,I.sortBy=$6,I.sortedUniq=Rt,I.sortedUniqBy=Pt,I.split=AR,I.spread=q6,I.tail=Dt,I.take=Nt,I.takeRight=tr,I.takeRightWhile=Kr,I.takeWhile=Hn,I.tap=c6,I.throttle=K6,I.thru=Av,I.toArray=s2,I.toPairs=d2,I.toPairsIn=v2,I.toPath=iO,I.toPlainObject=c2,I.transform=rR,I.unary=Q6,I.union=So,I.unionBy=To,I.unionWith=wo,I.uniq=ui,I.uniqBy=Xa,I.uniqWith=Ji,I.unset=nR,I.unzip=Xf,I.unzipWith=ea,I.update=iR,I.updateWith=aR,I.values=Zf,I.valuesIn=oR,I.without=Cv,I.words=y2,I.wrap=J6,I.xor=n6,I.xorBy=i6,I.xorWith=a6,I.zip=o6,I.zipObject=u6,I.zipObjectDeep=s6,I.zipWith=l6,I.entries=d2,I.entriesIn=v2,I.extend=f2,I.extendWith=Lv,Dy(I,I),I.add=oO,I.attempt=_2,I.camelCase=cR,I.capitalize=g2,I.ceil=uO,I.clamp=uR,I.clone=t8,I.cloneDeep=n8,I.cloneDeepWith=i8,I.cloneWith=r8,I.conformsTo=a8,I.deburr=m2,I.defaultTo=UR,I.divide=sO,I.endsWith=fR,I.eq=Mo,I.escape=hR,I.escapeRegExp=pR,I.every=x6,I.find=b6,I.findIndex=wn,I.findKey=P8,I.findLast=C6,I.findLastIndex=er,I.findLastKey=D8,I.floor=lO,I.forEach=ZE,I.forEachRight=qE,I.forIn=B8,I.forInRight=N8,I.forOwn=U8,I.forOwnRight=z8,I.get=Ly,I.gt=o8,I.gte=u8,I.has=H8,I.hasIn=Fy,I.head=V,I.identity=na,I.includes=M6,I.indexOf=we,I.inRange=sR,I.invoke=W8,I.isArguments=dc,I.isArray=Tr,I.isArrayBuffer=s8,I.isArrayLike=ta,I.isArrayLikeObject=Vn,I.isBoolean=l8,I.isBuffer=Ks,I.isDate=c8,I.isElement=f8,I.isEmpty=h8,I.isEqual=p8,I.isEqualWith=d8,I.isError=Ry,I.isFinite=v8,I.isFunction=ju,I.isInteger=i2,I.isLength=Rv,I.isMap=a2,I.isMatch=g8,I.isMatchWith=m8,I.isNaN=y8,I.isNative=_8,I.isNil=E8,I.isNull=x8,I.isNumber=o2,I.isObject=Mn,I.isObjectLike=kn,I.isPlainObject=Kp,I.isRegExp=Oy,I.isSafeInteger=b8,I.isSet=u2,I.isString=Ov,I.isSymbol=Ca,I.isTypedArray=Yf,I.isUndefined=C8,I.isWeakMap=A8,I.isWeakSet=S8,I.join=L,I.kebabCase=dR,I.last=Z,I.lastIndexOf=he,I.lowerCase=vR,I.lowerFirst=gR,I.lt=T8,I.lte=w8,I.max=cO,I.maxBy=fO,I.mean=hO,I.meanBy=pO,I.min=dO,I.minBy=vO,I.stubArray=Ny,I.stubFalse=Uy,I.stubObject=eO,I.stubString=tO,I.stubTrue=rO,I.multiply=gO,I.nth=Te,I.noConflict=WR,I.noop=By,I.now=Tv,I.pad=mR,I.padEnd=yR,I.padStart=_R,I.parseInt=xR,I.random=lR,I.reduce=I6,I.reduceRight=k6,I.repeat=ER,I.replace=bR,I.result=J8,I.round=mO,I.runInContext=ge,I.sample=D6,I.size=U6,I.snakeCase=CR,I.some=z6,I.sortedIndex=Ve,I.sortedIndexBy=pt,I.sortedIndexOf=dt,I.sortedLastIndex=At,I.sortedLastIndexBy=ht,I.sortedLastIndexOf=Bt,I.startCase=SR,I.startsWith=TR,I.subtract=yO,I.sum=_O,I.sumBy=xO,I.template=wR,I.times=nO,I.toFinite=Wu,I.toInteger=Lr,I.toLength=l2,I.toLower=MR,I.toNumber=Ya,I.toSafeInteger=M8,I.toString=ln,I.toUpper=RR,I.trim=OR,I.trimEnd=LR,I.trimStart=FR,I.truncate=IR,I.unescape=kR,I.uniqueId=aO,I.upperCase=PR,I.upperFirst=Iy,I.each=ZE,I.eachRight=qE,I.first=V,Dy(I,function(){var c={};return _a(I,function(p,g){on.call(I.prototype,g)||(c[g]=p)}),c}(),{chain:!1}),I.VERSION=n,ti(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){I[c].placeholder=I}),ti(["drop","take"],function(c,p){Ir.prototype[c]=function(g){g=g===r?1:Nn(Lr(g),0);var x=this.__filtered__&&!p?new Ir(this):this.clone();return x.__filtered__?x.__takeCount__=ri(g,x.__takeCount__):x.__views__.push({size:ri(g,ct),type:c+(x.__dir__<0?"Right":"")}),x},Ir.prototype[c+"Right"]=function(g){return this.reverse()[c](g).reverse()}}),ti(["filter","map","takeWhile"],function(c,p){var g=p+1,x=g==de||g==le;Ir.prototype[c]=function(R){var N=this.clone();return N.__iteratees__.push({iteratee:fr(R,3),type:g}),N.__filtered__=N.__filtered__||x,N}}),ti(["head","last"],function(c,p){var g="take"+(p?"Right":"");Ir.prototype[c]=function(){return this[g](1).value()[0]}}),ti(["initial","tail"],function(c,p){var g="drop"+(p?"":"Right");Ir.prototype[c]=function(){return this.__filtered__?new Ir(this):this[g](1)}}),Ir.prototype.compact=function(){return this.filter(na)},Ir.prototype.find=function(c){return this.filter(c).head()},Ir.prototype.findLast=function(c){return this.reverse().find(c)},Ir.prototype.invokeMap=Or(function(c,p){return typeof c=="function"?new Ir(this):this.map(function(g){return Ps(g,c,p)})}),Ir.prototype.reject=function(c){return this.filter(Mv(fr(c)))},Ir.prototype.slice=function(c,p){c=Lr(c);var g=this;return g.__filtered__&&(c>0||p<0)?new Ir(g):(c<0?g=g.takeRight(-c):c&&(g=g.drop(c)),p!==r&&(p=Lr(p),g=p<0?g.dropRight(-p):g.take(p-c)),g)},Ir.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Ir.prototype.toArray=function(){return this.take(ct)},_a(Ir.prototype,function(c,p){var g=/^(?:filter|find|map|reject)|While$/.test(p),x=/^(?:head|last)$/.test(p),R=I[x?"take"+(p=="last"?"Right":""):p],N=x||/^find/.test(p);!R||(I.prototype[p]=function(){var J=this.__wrapped__,se=x?[1]:arguments,xe=J instanceof Ir,at=se[0],ut=xe||Tr(J),gt=function(zr){var Hr=R.apply(I,Ho([zr],se));return x&&Ht?Hr[0]:Hr};ut&&g&&typeof at=="function"&&at.length!=1&&(xe=ut=!1);var Ht=this.__chain__,or=!!this.__actions__.length,vr=N&&!Ht,Fr=xe&&!or;if(!N&&ut){J=Fr?J:new Ir(this);var gr=c.apply(J,se);return gr.__actions__.push({func:Av,args:[gt],thisArg:r}),new Bi(gr,Ht)}return vr&&Fr?c.apply(this,se):(gr=this.thru(gt),vr?x?gr.value()[0]:gr.value():gr)})}),ti(["pop","push","shift","sort","splice","unshift"],function(c){var p=_f[c],g=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",x=/^(?:pop|shift)$/.test(c);I.prototype[c]=function(){var R=arguments;if(x&&!this.__chain__){var N=this.value();return p.apply(Tr(N)?N:[],R)}return this[g](function(J){return p.apply(Tr(J)?J:[],R)})}}),_a(Ir.prototype,function(c,p){var g=I[p];if(g){var x=g.name+"";on.call(Pu,x)||(Pu[x]=[]),Pu[x].push({name:p,func:g})}}),Pu[zi(r,E).name]=[{name:"wrapper",func:r}],Ir.prototype.clone=X0,Ir.prototype.reverse=Y0,Ir.prototype.value=ty,I.prototype.at=f6,I.prototype.chain=h6,I.prototype.commit=p6,I.prototype.next=d6,I.prototype.plant=g6,I.prototype.reverse=m6,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=y6,I.prototype.first=I.prototype.head,Ms&&(I.prototype[Ms]=v6),I},As=yp();Fu?((Fu.exports=As)._=As,ff._=As):Xn._=As}).call(du)})(tt,tt.exports);var yd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Gx(e){this.message=e}Gx.prototype=new Error;Gx.prototype.name="InvalidCharacterError";function SI(e){var t=String(e).replace(/=+$/,"");if(t.length%4===1)throw new Gx("'atob' failed: The string to be decoded is not correctly encoded.");for(var r="",n=0,i,a,o=0;a=t.charAt(o++);~a&&(i=n%4?i*64+a:a,n++%4)?r+=String.fromCharCode(255&i>>(-2*n&6)):0)a=yd.indexOf(a);return r}function I4(e){e=String(e);for(var t,r,n,i,a="",o=0,u=e.length%3;o<e.length;){if((r=e.charCodeAt(o++))>255||(n=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");t=r<<16|n<<8|i,a+=yd.charAt(t>>18&63)+yd.charAt(t>>12&63)+yd.charAt(t>>6&63)+yd.charAt(t&63)}return u?a.slice(0,u-3)+"===".substring(u):a}function ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ib(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t,r){return t&&ib(e.prototype,t),r&&ib(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var TI=function(){function e(t,r){ke(this,e),this.buffers=t,this.type=r}return Pe(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(r,n,i){throw new Error("not implemented")}}]),e}(),io;typeof window>"u"?io={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,r,n){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,r){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:io=window;var wI=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;const MI=wI?my.getSystemInfoSync().pixelRatio:io.devicePixelRatio;function Gd(e,t){return Gd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Gd(e,t)}function Ut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gd(e,t)}function Th(e){return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(e,t){if(t&&(Th(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return re(e)}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ce(e)}var k4=Pe(function e(t,r){ke(this,e),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=t,this.timeStamp=Date.now()});function RI(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=OI(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function OI(e,t){if(!!e){if(typeof e=="string")return ab(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ab(e,t)}}function ab(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Jp=new WeakMap,Hx=function(){function e(){ke(this,e),Jp.set(this,{})}return Pe(e,[{key:"addEventListener",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=Jp.get(this);a||(a={}),a[r]||(a[r]=[]),a[r].push(n),Jp.set(this,a),i.capture,i.once,i.passive}},{key:"removeEventListener",value:function(r,n){var i=Jp.get(this);if(i){var a=i[r];if(a&&a.length>0){for(var o=a.length;o--;o>0)if(a[o]===n){a.splice(o,1);break}}}}},{key:"dispatchEvent",value:function(r){var n=Jp.get(this)[r.type];if(n){var i=RI(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o(r)}}catch(u){i.e(u)}finally{i.f()}}}}]),e}();function LI(e){var t=FI();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function FI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P4=function(e){Ut(r,e);var t=LI(r);function r(){var n;return ke(this,r),n=t.call(this),n.childNodes=[],n}return Pe(r,[{key:"appendChild",value:function(i){this.childNodes.push(i)}},{key:"cloneNode",value:function(){var i=Object.create(this);return Object.assign(i,this),i}},{key:"removeChild",value:function(i){var a=this.childNodes.findIndex(function(o){return o===i});return a>-1?this.childNodes.splice(a,1):null}}]),r}(Hx);function II(e){var t=kI();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function kI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var D4=function(e){Ut(r,e);var t=II(r);function r(){var n;return ke(this,r),n=t.call(this),n.className="",n.children=[],n}return Pe(r,[{key:"setAttribute",value:function(i,a){this[i]=a}},{key:"getAttribute",value:function(i){return this[i]}},{key:"setAttributeNS",value:function(i,a){this[i]=a}},{key:"getAttributeNS",value:function(i){return this[i]}}]),r}(P4),PI=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,c1,f1,h1,p1;if(PI){var Nv=my.getSystemInfoSync();c1=Nv.screenWidth,f1=Nv.screenHeight,h1=Nv.windowWidth,p1=Nv.windowHeight}else{var ob=io.innerWidth,ub=io.innerHeight;c1=ob,f1=ub,h1=ob,p1=ub}var Md={width:c1,height:f1,availWidth:h1,availHeight:p1,availLeft:0,availTop:0},fm=Md.availWidth,hm=Md.availHeight,sb={style:[]};function B4(e,t){if(!("parentNode"in e)){var r;t===0?r=function(){return null}:t===1?r=function(){return sb}:r=function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:r})}if(!("parentElement"in e)){var n;t===0?n=function(){return null}:t===1?n=function(){return sb}:n=function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:n})}}function DI(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:fm+"px",height:hm+"px",margin:"0px",padding:"0px"})}function BI(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=fm,e.clientHeight=hm),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){var t={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return t})}function NI(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=fm,e.offsetHeight=hm)}function UI(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=fm,e.scrollHeight=hm)}function N4(e){var t=function(){return!0};e.classList=[],e.classList.add=t,e.classList.remove=t,e.classList.contains=t,e.classList.toggle=t}function zI(e){var t=$I();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function $I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qf(){}var Hh=function(e){Ut(r,e);var t=zI(r);function r(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;return ke(this,r),n=t.call(this),n.className="",n.children=[],n.focus=qf,n.blur=qf,n.insertBefore=qf,n.appendChild=qf,n.removeChild=qf,n.remove=qf,n.innerHTML="",n.tagName=i.toUpperCase(),B4(re(n),a),DI(re(n)),N4(re(n)),BI(re(n)),NI(re(n)),UI(re(n)),n}return Pe(r)}(D4);function GI(e){var t=HI();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function HI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var U4=function(e){Ut(r,e);var t=GI(r);function r(n){return ke(this,r),t.call(this,n)}return Pe(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(Hh);function VI(e){var t=jI();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function jI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var z4=function(e){Ut(r,e);var t=VI(r);function r(){return ke(this,r),t.call(this,"video")}return Pe(r)}(U4),WI={};function Vx(){return WI}var $4=Pe(function e(){ke(this,e);var t=Vx(),r=t.createImage&&t.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=e.prototype),B4(r),N4(r),Object.assign(r,{addEventListener:function(i,a){r["on".concat(i)]=a.bind(r)},removeEventListener:function(i){r["on".concat(i)]=null}}),r}),G4={href:"",protocol:"",host:""};function H4(e){var t=XI();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function XI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var YI=function(e){Ut(r,e);var t=H4(r);function r(){return ke(this,r),t.call(this,"body",0)}return Pe(r,[{key:"addEventListener",value:function(i,a){}},{key:"removeEventListener",value:function(i,a,o){}},{key:"dispatchEvent",value:function(i){}}]),r}(Hh),ZI=function(e){Ut(r,e);var t=H4(r);function r(){return ke(this,r),t.call(this,"html",0)}return Pe(r,[{key:"addEventListener",value:function(i,a){}},{key:"removeEventListener",value:function(i,a){}},{key:"dispatchEvent",value:function(i){}}]),r}(Hh),ed={},Fc={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:G4,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return t=t.toLowerCase(),t==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):t==="img"?new $4:t==="video"?new z4:new Hh(t)},createElementNS:function(t,r){return this.createElement(r)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,r){return this.getElementsByTagName(r)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,r,n){ed[t]||(ed[t]=[]),ed[t].push(r)},removeEventListener:function(t,r){var n=ed[t];if(n&&n.length>0){for(var i=n.length;i--;i>0)if(n[i]===r){n.splice(i,1);break}}},dispatchEvent:function(t){var r=t.type,n=ed[r];if(n)for(var i=0;i<n.length;i++)n[i](t);t.target&&typeof t.target["on"+r]=="function"&&t.target["on"+r](t)},createEvent:function(t){return new k4(t)}};Fc.documentElement=new ZI;Fc.head=new Hh("head");Fc.body=new YI;var qI=Object,KI=function(){function e(){ke(this,e);var t=arguments.length;if(t===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else t===3&&Th(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return Pe(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}(),QI=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,d1,aa,Tg;if(QI){var Jy=my.getSystemInfoSync();d1=Jy.system,aa=Jy.platform,Tg=Jy.language}else{var Ta={versions:function(){var e=io.navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)===" qq"}}(),language:(io.navigator.browserLanguage||io.navigator.language).toLowerCase()};Ta.versions.android?aa="android":Ta.versions.trident?aa="IE":Ta.versions.presto?aa="Opera":Ta.versions.webKit?aa="webKit":Ta.versions.gecko?aa="Firefox":Ta.versions.mobile?aa="mobile":Ta.versions.ios?aa="ios":Ta.versions.iPhone?aa="iPhone":Ta.versions.iPad?aa="ipad":Ta.versions.webApp?aa="webApp":Ta.versions.weixin?aa="weixin":Ta.versions.qq&&(aa="qq"),d1=io.navigator.userAgent,Tg=Ta.language}var JI=d1.toLowerCase().indexOf("android")!==-1,V4=JI?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",ek="Mozilla/5.0 (".concat(V4,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(Tg),tk={platform:aa,language:Tg,appVersion:"5.0 (".concat(V4,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:ek},rk={mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,r,n){return{duration:0}},now:function(){}},lb=0,cb=0;function nk(e){var t=Date.now(),r=Math.max(lb+23,t);return cb=setTimeout(function(){e(lb=r)},r-t),cb}function ik(e){var t=Vx();return t.requestAnimationFrame?t.requestAnimationFrame(e):nk(e)}function ak(e){var t=Vx();return t.cancelAnimationFrame?t.cancelAnimationFrame(e):clearTimeout(e)}var ok=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(ke(this,e),t.indexOf("http://")==0||t.indexOf("https://")==0){this.href=t;return}this.href=r+t}return Pe(e,null,[{key:"createObjectURL",value:function(r){var n=r.buffers[0],i=r.type,a=uk(n),o="data:".concat(i,";base64, ");return o+a}}]),e}();function uk(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,i=0;i<n;i++)t+=String.fromCharCode(r[i]);return I4(t)}var sk={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},lk={};function ck(e){var t=fk();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function fk(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var e_=new Map,fb=new Map,hk=new Map,Xc=function(e){Ut(r,e);var t=ck(r);function r(){var n;return ke(this,r),n=t.call(this),n.onabort=null,n.onerror=null,n.onload=null,n.onloadstart=null,n.onprogress=null,n.ontimeout=null,n.onloadend=null,n.onreadystatechange=null,n.readyState=0,n.response=null,n.responseText=null,n._responseType="text",n.responseXML=null,n.status=0,n.statusText="",n.upload={},n.withCredentials=!1,e_.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),n}return Pe(r,[{key:"responseType",set:function(i){this._responseType=i}},{key:"abort",value:function(){var i=hk.get("requestTask");i&&i.abort()}},{key:"getAllResponseHeaders",value:function(){var i=fb.get("responseHeader");return Object.keys(i).map(function(a){return"".concat(a,": ").concat(i[a])}).join(`
`)}},{key:"getResponseHeader",value:function(i){return fb.get("responseHeader")[i]}},{key:"open",value:function(i,a,o){this._method=i,this._url=a}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(i,a){var o=e_.get("requestHeader");o[i]=a,e_.set("requestHeader",o)}},{key:"addEventListener",value:function(i,a){var o=this;typeof a=="function"&&(this["on"+i]=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u.target=u.target||o,a.call(o,u)})}},{key:"removeEventListener",value:function(i,a){this["on"+i]===a&&(this["on"+i]=null)}}]),r}(Hx);Xc.UNSEND=0;Xc.OPENED=1;Xc.HEADERS_RECEIVED=2;Xc.LOADING=3;Xc.DONE=4;var pk=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,dk=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u"),Fa=pk||dk,vk={atob:SI,btoa:I4,devicePixelRatio:MI,Blob:TI,document:Fc,Element:D4,Event:k4,EventTarget:Hx,HTMLCanvasElement:qI,HTMLElement:Hh,HTMLMediaElement:U4,HTMLVideoElement:z4,Image:$4,ImageData:KI,navigator:tk,Node:P4,requestAnimationFrame:ik,cancelAnimationFrame:ak,screen:Md,XMLHttpRequest:Xc,performance:rk,URL:ok,WebGLRenderingContext:sk,WebGL2RenderingContext:lk,addEventListener:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Fc.addEventListener(t,r,n)},removeEventListener:function(t,r,n){Fc.removeEventListener(t,r)},dispatchEvent:function(t){Fc.dispatchEvent(t)},innerWidth:Md.availWidth,innerHeight:Md.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},en=Fa?vk:io,gk=Fa?Xc:io.XMLHttpRequest;Fa||io.location;function mk(e){var t=e;return typeof e=="string"&&(t=en.document.getElementById(e)),t}function j4(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function yk(e){return j4(e).split(/\s+/)}function _k(e){var t,r,n=en==null||(t=en.document)===null||t===void 0||(r=t.documentElement)===null||r===void 0?void 0:r.style;if(!n)return e[0];for(var i in e)if(e[i]&&e[i]in n)return e[i];return e[0]}function ca(e,t,r){var n=en.document.createElement(e);return t&&(n.className=t||""),r&&r.appendChild(n),n}function wg(e){var t=e.parentNode;t&&t.removeChild(e)}function Rd(e,t){if(e.classList!==void 0)for(var r=yk(t),n=0,i=r.length;n<i;n++)e.classList.add(r[n]);else if(!xk(e,t)){var a=jx(e);W4(e,(a?a+" ":"")+t)}}function v1(e,t){e.classList!==void 0?e.classList.remove(t):W4(e,j4((" "+jx(e)+" ").replace(" "+t+" "," ")))}function xk(e,t){if(e.classList!==void 0)return e.classList.contains(t);var r=jx(e);return r.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(r)}function W4(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function jx(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}_k(["transform","WebkitTransform"]);function Ek(){if(typeof Event=="function")en.dispatchEvent(new Event("resize"));else{var e=en.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,en,0),en.dispatchEvent(e)}}function bk(){var e,t=en.document.querySelector('meta[name="viewport"]');if(!t)return 1;var r=(e=t.content)===null||e===void 0?void 0:e.split(","),n=r.find(function(i){var a=i.split("="),o=ir(a,1),u=o[0];return u==="initial-scale"});return n?n.split("=")[1]*1:1}var Rn=bk()<1?1:en.devicePixelRatio;function Ck(e,t){e.setAttribute("style","".concat(e.style.cssText).concat(t))}function Ak(e){return Object.entries(e).map(function(t){var r=ir(t,2),n=r[0],i=r[1];return"".concat(n,": ").concat(i)}).join(";")}function Sk(e,t){return{left:e.left-t.left,top:e.top-t.top,right:t.left+t.width-e.left-e.width,bottom:t.top+t.height-e.top-e.height}}function X4(e){e.innerHTML=""}function Tk(e){e.setAttribute("draggable","false")}function wk(e){if(e.length===0)throw new Error("max requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t*1}function Mk(e){if(e.length===0)throw new Error("min requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t*1}function Y4(e){if(e.length===0)return 0;for(var t=e[0]*1,r=1;r<e.length;r++)t+=e[r]*1;return t}function Rk(e){if(e.length===0)throw new Error("mean requires at least one data point");return Y4(e)/e.length}function Ok(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var t=e[0],r=NaN,n=0,i=1,a=1;a<e.length+1;a++)e[a]!==t?(i>n&&(n=i,r=t),i=1,t=e[a]):i++;return r*1}var Z4={min:Mk,max:wk,mean:Rk,sum:Y4,mode:Ok};function q4(e,t){return e.map(function(r){return r[t]})}function Lk(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Fk(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mh(e,t,r){return Fk()?mh=Reflect.construct.bind():mh=function(i,a,o){var u=[null];u.push.apply(u,a);var s=Function.bind.apply(i,u),l=new s;return o&&Gd(l,o.prototype),l},mh.apply(null,arguments)}function g1(e){var t=typeof Map=="function"?new Map:void 0;return g1=function(n){if(n===null||!Lk(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,i)}function i(){return mh(n,arguments,Ce(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Gd(i,n)},g1(e)}function Ik(e){var t=kk();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function kk(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Pk=function(e){Ut(r,e);var t=Ik(r);function r(n,i,a,o){var u;return ke(this,r),u=t.call(this,"AJAXError: ".concat(i," (").concat(n,"): ").concat(a)),u.status=n,u.statusText=i,u.url=a,u.body=o,u}return Pe(r)}(g1(Error));function K4(e,t){var r=new gk,n=Array.isArray(e.url)?e.url[0]:e.url;r.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(r.responseType="arraybuffer");for(var i in e.headers)e.headers.hasOwnProperty(i)&&r.setRequestHeader(i,e.headers[i]);return e.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=e.credentials==="include",r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){var a=r.response;if(e.type==="json")try{a=JSON.parse(r.response)}catch(u){return t(u)}t(null,a,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"),r)}else{var o=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new Pk(r.status,r.statusText,n.toString(),o))}},r.send(e.body),r}function Dk(e){return new Promise(function(t,r){K4(e,function(n,i,a,o,u){n?r({err:n,data:null,xhr:u}):t({err:null,data:i,cacheControl:a,expires:o,xhr:u})})})}function Bk(e,t){return K4(e,t)}var Wx=function(t,r){return Bk(be(be({},t),{},{type:"arrayBuffer"}),r)},hb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Nk(e,t){var r=new en.Image,n=en.URL||en.webkitURL;r.crossOrigin="anonymous",r.onload=function(){t(null,r),n.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(function(){r.src=hb})},r.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(i):hb}function Uk(e,t){var r=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(r).then(function(n){t(null,n)}).catch(function(n){t(new Error("Could not load image because of ".concat(n.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var m1=function(t,r){return Wx(t,function(n,i){if(n)r(n);else if(i){var a=typeof createImageBitmap=="function";a?Uk(i,r):Nk(i,r)}})};function t_(e){return typeof e=="number"}function y1(e){var t=[1/0,1/0,-1/0,-1/0];return O4(e,function(r){t[0]>r[0]&&(t[0]=r[0]),t[1]>r[1]&&(t[1]=r[1]),t[2]<r[0]&&(t[2]=r[0]),t[3]<r[1]&&(t[3]=r[1])}),t}y1.default=y1;var pb=2*Math.PI*6378137/2;function zk(e,t){var r=ir(t,4),n=r[0],i=r[1],a=r[2],o=r[3];return e.lng>n&&e.lng<=a&&e.lat>i&&e.lat<=o}function $k(e){var t=[1/0,1/0,-1/0,-1/0];return e.forEach(function(r){var n=r.coordinates;Q4(t,n)}),t}function Q4(e,t){return Array.isArray(t[0])?t.forEach(function(r){Q4(e,r)}):(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])),e}function r_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=Vk(e,t);var n=e[0],i=e[1],a=n*pb/180,o=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return o=o*pb/180,r.enable&&(a=Number(a.toFixed(r.decimal)),o=Number(o.toFixed(r.decimal))),e.length===3?[a,o,e[2]]:[a,o]}function Gk(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function Hk(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function Vk(e,t){if(t===!1)return e;var r=Gk(e[0]),n=Hk(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[r,n,e[2]]:[r,n]}function ci(e){var t=85.0511287798,r=Math.max(Math.min(t,e[1]),-t),n=256<<20,i=Math.PI/180,a=e[0]*i,o=r*i;o=Math.log(Math.tan(Math.PI/4+o/2));var u=.5/Math.PI,s=.5,l=-.5/Math.PI;return i=.5,a=n*(u*a+s),o=n*(l*o+i),[Math.floor(a),Math.floor(o)]}function Uv(e,t){var r=85.0511287798,n=Math.PI/180,i=6378137;return t=Math.max(Math.min(r,t),-r),e*=n,t*=n,t=Math.log(Math.tan(Math.PI/4+t/2)),[e*i,t*i]}function pm(e,t){var r=Math.abs(e[1][1]-e[0][1])*t,n=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-n,e[0][1]-r],[e[1][0]+n,e[1][1]+r]]}function J4(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}function Mg(e){return[[e[0],e[1]],[e[2],e[3]]]}function e5(e){var t=jk(e,[0,0]);return[e[0]/t,e[1]/t]}function jk(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function oo(e){if(t_(e[0]))return e;if(t_(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(t_(e[0][0][0])){var t=e,r=0,n=0,i=0;return t.forEach(function(a){a.forEach(function(o){r+=o[0],n+=o[1],i++})}),[r/i,n/i,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Wk(e){for(var t=e[0],r=e[1],n=e[0],i=e[1],a=0,o=0,u=0,s=0;s<e.length;s+=2){var l=e[s],f=e[s+1];l&&f&&(t=Math.max(l,t),r=Math.max(f,r),n=Math.min(l,n),i=Math.min(f,i),a+=l,o+=f,u++)}return{center:[a/u,o/u],radius:Math.sqrt(Math.pow(t-n,2)+Math.pow(r-i,2))/2}}function Xk(e){return y1(pg([pI(e)]))}var Yk=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,r=arguments.length>1?arguments[1]:void 0;ke(this,e),this.limit=t,this.destroy=r||this.defaultDestroy,this.order=[],this.clear()}return Pe(e,[{key:"clear",value:function(){var r=this;this.order.forEach(function(n){r.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(r){var n=this.cache[r];return n&&(this.deleteOrder(r),this.appendOrder(r)),n}},{key:"set",value:function(r,n){this.cache[r]?(this.delete(r),this.cache[r]=n,this.appendOrder(r)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[r]=n,this.appendOrder(r))}},{key:"delete",value:function(r){var n=this.cache[r];n&&(this.deleteCache(r),this.deleteOrder(r),this.destroy(n,r))}},{key:"deleteCache",value:function(r){delete this.cache[r]}},{key:"deleteOrder",value:function(r){var n=this.order.findIndex(function(i){return i===r});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(r){this.order.push(r)}},{key:"defaultDestroy",value:function(r,n){return null}}]),e}();function Xx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function t5(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function p0(){}var Hd=.7,Rg=1/Hd,yh="\\s*([+-]?\\d+)\\s*",Vd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",_u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zk=/^#([0-9a-f]{3,8})$/,qk=new RegExp("^rgb\\("+[yh,yh,yh]+"\\)$"),Kk=new RegExp("^rgb\\("+[_u,_u,_u]+"\\)$"),Qk=new RegExp("^rgba\\("+[yh,yh,yh,Vd]+"\\)$"),Jk=new RegExp("^rgba\\("+[_u,_u,_u,Vd]+"\\)$"),eP=new RegExp("^hsl\\("+[Vd,_u,_u]+"\\)$"),tP=new RegExp("^hsla\\("+[Vd,_u,_u,Vd]+"\\)$"),db={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xx(p0,zc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:vb,formatHex:vb,formatHsl:rP,formatRgb:gb,toString:gb});function vb(){return this.rgb().formatHex()}function rP(){return r5(this).formatHsl()}function gb(){return this.rgb().formatRgb()}function zc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Zk.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?mb(t):r===3?new Ia(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?zv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?zv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qk.exec(e))?new Ia(t[1],t[2],t[3],1):(t=Kk.exec(e))?new Ia(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Qk.exec(e))?zv(t[1],t[2],t[3],t[4]):(t=Jk.exec(e))?zv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eP.exec(e))?xb(t[1],t[2]/100,t[3]/100,1):(t=tP.exec(e))?xb(t[1],t[2]/100,t[3]/100,t[4]):db.hasOwnProperty(e)?mb(db[e]):e==="transparent"?new Ia(NaN,NaN,NaN,0):null}function mb(e){return new Ia(e>>16&255,e>>8&255,e&255,1)}function zv(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ia(e,t,r,n)}function nP(e){return e instanceof p0||(e=zc(e)),e?(e=e.rgb(),new Ia(e.r,e.g,e.b,e.opacity)):new Ia}function Og(e,t,r,n){return arguments.length===1?nP(e):new Ia(e,t,r,n==null?1:n)}function Ia(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Xx(Ia,Og,t5(p0,{brighter:function(e){return e=e==null?Rg:Math.pow(Rg,e),new Ia(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Hd:Math.pow(Hd,e),new Ia(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yb,formatHex:yb,formatRgb:_b,toString:_b}));function yb(){return"#"+n_(this.r)+n_(this.g)+n_(this.b)}function _b(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function n_(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function xb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new vu(e,t,r,n)}function r5(e){if(e instanceof vu)return new vu(e.h,e.s,e.l,e.opacity);if(e instanceof p0||(e=zc(e)),!e)return new vu;if(e instanceof vu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,u=a-i,s=(a+i)/2;return u?(t===a?o=(r-n)/u+(r<n)*6:r===a?o=(n-t)/u+2:o=(t-r)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new vu(o,u,s,e.opacity)}function iP(e,t,r,n){return arguments.length===1?r5(e):new vu(e,t,r,n==null?1:n)}function vu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Xx(vu,iP,t5(p0,{brighter:function(e){return e=e==null?Rg:Math.pow(Rg,e),new vu(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Hd:Math.pow(Hd,e),new vu(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Ia(i_(e>=240?e-240:e+120,i,n),i_(e,i,n),i_(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function i_(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function $r(e){var t=zc(e),r=[0,0,0,0];return t!=null&&(r[0]=t.r/255,r[1]=t.g/255,r[2]=t.b/255,r[3]=t.opacity),r}function Bc(e){var t=e&&e[0],r=e&&e[1],n=e&&e[2],i=t+r*256+n*65536-1;return i}function ss(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Yx(e){var t=en.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;var n=null;if(e.weights){var i=0;e.weights.map(function(d,v){var m=e.colors[v]||"rgba(0, 0, 0, 0)",y=i+d;r.fillStyle=m,r.fillRect(i*256,0,y*256,1),i=y})}else{for(var a=r.createLinearGradient(0,0,256,1),o=e.positions[0],u=e.positions[e.positions.length-1],s=0;s<e.colors.length;++s){var l=(e.positions[s]-o)/(u-o);a.addColorStop(l,e.colors[s])}r.fillStyle=a,r.fillRect(0,0,256,1)}if(Fa)return n=new Uint8ClampedArray(r.getImageData(0,0,256,1).data),t=null,r=null,{data:n,width:256,height:1};n=r.getImageData(0,0,256,1).data;for(var f=r.createImageData(256,1),h=0;h<f.data.length;h+=4)f.data[h+0]=n[h+0],f.data[h+1]=n[h+1],f.data[h+2]=n[h+2],f.data[h+3]=n[h+3];return t=null,r=null,f}var Eb;(function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right"})(Eb||(Eb={}));function vn(e,t){return{enable:e,mask:255,func:{cmp:514,ref:t?1:0,mask:255}}}function bb(e,t,r,n,i,a,o){try{var u=e[a](o),s=u.value}catch(l){r(l);return}u.done?t(s):Promise.resolve(s).then(n,i)}function Ie(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(s){bb(a,n,i,o,u,"next",s)}function u(s){bb(a,n,i,o,u,"throw",s)}o(void 0)})}}var n5={exports:{}},i5={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(i5);(function(e){var t=i5.exports.default;function r(){e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,a=i.hasOwnProperty,o=Object.defineProperty||function(pe,le,ve){pe[le]=ve.value},u=typeof Symbol=="function"?Symbol:{},s=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function h(pe,le,ve){return Object.defineProperty(pe,le,{value:ve,enumerable:!0,configurable:!0,writable:!0}),pe[le]}try{h({},"")}catch{h=function(ve,Me,Ne){return ve[Me]=Ne}}function d(pe,le,ve,Me){var Ne=le&&le.prototype instanceof y?le:y,Xe=Object.create(Ne.prototype),ct=new K(Me||[]);return o(Xe,"_invoke",{value:Y(pe,ve,ct)}),Xe}function v(pe,le,ve){try{return{type:"normal",arg:pe.call(le,ve)}}catch(Me){return{type:"throw",arg:Me}}}n.wrap=d;var m={};function y(){}function _(){}function E(){}var S={};h(S,s,function(){return this});var A=Object.getPrototypeOf,M=A&&A(A(ue([])));M&&M!==i&&a.call(M,s)&&(S=M);var O=E.prototype=y.prototype=Object.create(S);function j(pe){["next","throw","return"].forEach(function(le){h(pe,le,function(ve){return this._invoke(le,ve)})})}function q(pe,le){function ve(Ne,Xe,ct,$t){var Qt=v(pe[Ne],pe,Xe);if(Qt.type!=="throw"){var Zt=Qt.arg,jt=Zt.value;return jt&&t(jt)=="object"&&a.call(jt,"__await")?le.resolve(jt.__await).then(function(Cr){ve("next",Cr,ct,$t)},function(Cr){ve("throw",Cr,ct,$t)}):le.resolve(jt).then(function(Cr){Zt.value=Cr,ct(Zt)},function(Cr){return ve("throw",Cr,ct,$t)})}$t(Qt.arg)}var Me;o(this,"_invoke",{value:function(Xe,ct){function $t(){return new le(function(Qt,Zt){ve(Xe,ct,Qt,Zt)})}return Me=Me?Me.then($t,$t):$t()}})}function Y(pe,le,ve){var Me="suspendedStart";return function(Ne,Xe){if(Me==="executing")throw new Error("Generator is already running");if(Me==="completed"){if(Ne==="throw")throw Xe;return de()}for(ve.method=Ne,ve.arg=Xe;;){var ct=ve.delegate;if(ct){var $t=ne(ct,ve);if($t){if($t===m)continue;return $t}}if(ve.method==="next")ve.sent=ve._sent=ve.arg;else if(ve.method==="throw"){if(Me==="suspendedStart")throw Me="completed",ve.arg;ve.dispatchException(ve.arg)}else ve.method==="return"&&ve.abrupt("return",ve.arg);Me="executing";var Qt=v(pe,le,ve);if(Qt.type==="normal"){if(Me=ve.done?"completed":"suspendedYield",Qt.arg===m)continue;return{value:Qt.arg,done:ve.done}}Qt.type==="throw"&&(Me="completed",ve.method="throw",ve.arg=Qt.arg)}}}function ne(pe,le){var ve=pe.iterator[le.method];if(ve===void 0){if(le.delegate=null,le.method==="throw"){if(pe.iterator.return&&(le.method="return",le.arg=void 0,ne(pe,le),le.method==="throw"))return m;le.method="throw",le.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var Me=v(ve,pe.iterator,le.arg);if(Me.type==="throw")return le.method="throw",le.arg=Me.arg,le.delegate=null,m;var Ne=Me.arg;return Ne?Ne.done?(le[pe.resultName]=Ne.value,le.next=pe.nextLoc,le.method!=="return"&&(le.method="next",le.arg=void 0),le.delegate=null,m):Ne:(le.method="throw",le.arg=new TypeError("iterator result is not an object"),le.delegate=null,m)}function X(pe){var le={tryLoc:pe[0]};1 in pe&&(le.catchLoc=pe[1]),2 in pe&&(le.finallyLoc=pe[2],le.afterLoc=pe[3]),this.tryEntries.push(le)}function $(pe){var le=pe.completion||{};le.type="normal",delete le.arg,pe.completion=le}function K(pe){this.tryEntries=[{tryLoc:"root"}],pe.forEach(X,this),this.reset(!0)}function ue(pe){if(pe){var le=pe[s];if(le)return le.call(pe);if(typeof pe.next=="function")return pe;if(!isNaN(pe.length)){var ve=-1,Me=function Ne(){for(;++ve<pe.length;)if(a.call(pe,ve))return Ne.value=pe[ve],Ne.done=!1,Ne;return Ne.value=void 0,Ne.done=!0,Ne};return Me.next=Me}}return{next:de}}function de(){return{value:void 0,done:!0}}return _.prototype=E,o(O,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:_,configurable:!0}),_.displayName=h(E,f,"GeneratorFunction"),n.isGeneratorFunction=function(pe){var le=typeof pe=="function"&&pe.constructor;return!!le&&(le===_||(le.displayName||le.name)==="GeneratorFunction")},n.mark=function(pe){return Object.setPrototypeOf?Object.setPrototypeOf(pe,E):(pe.__proto__=E,h(pe,f,"GeneratorFunction")),pe.prototype=Object.create(O),pe},n.awrap=function(pe){return{__await:pe}},j(q.prototype),h(q.prototype,l,function(){return this}),n.AsyncIterator=q,n.async=function(pe,le,ve,Me,Ne){Ne===void 0&&(Ne=Promise);var Xe=new q(d(pe,le,ve,Me),Ne);return n.isGeneratorFunction(le)?Xe:Xe.next().then(function(ct){return ct.done?ct.value:Xe.next()})},j(O),h(O,f,"Generator"),h(O,s,function(){return this}),h(O,"toString",function(){return"[object Generator]"}),n.keys=function(pe){var le=Object(pe),ve=[];for(var Me in le)ve.push(Me);return ve.reverse(),function Ne(){for(;ve.length;){var Xe=ve.pop();if(Xe in le)return Ne.value=Xe,Ne.done=!1,Ne}return Ne.done=!0,Ne}},n.values=ue,K.prototype={constructor:K,reset:function(le){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach($),!le)for(var ve in this)ve.charAt(0)==="t"&&a.call(this,ve)&&!isNaN(+ve.slice(1))&&(this[ve]=void 0)},stop:function(){this.done=!0;var le=this.tryEntries[0].completion;if(le.type==="throw")throw le.arg;return this.rval},dispatchException:function(le){if(this.done)throw le;var ve=this;function Me(Zt,jt){return ct.type="throw",ct.arg=le,ve.next=Zt,jt&&(ve.method="next",ve.arg=void 0),!!jt}for(var Ne=this.tryEntries.length-1;Ne>=0;--Ne){var Xe=this.tryEntries[Ne],ct=Xe.completion;if(Xe.tryLoc==="root")return Me("end");if(Xe.tryLoc<=this.prev){var $t=a.call(Xe,"catchLoc"),Qt=a.call(Xe,"finallyLoc");if($t&&Qt){if(this.prev<Xe.catchLoc)return Me(Xe.catchLoc,!0);if(this.prev<Xe.finallyLoc)return Me(Xe.finallyLoc)}else if($t){if(this.prev<Xe.catchLoc)return Me(Xe.catchLoc,!0)}else{if(!Qt)throw new Error("try statement without catch or finally");if(this.prev<Xe.finallyLoc)return Me(Xe.finallyLoc)}}}},abrupt:function(le,ve){for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Ne=this.tryEntries[Me];if(Ne.tryLoc<=this.prev&&a.call(Ne,"finallyLoc")&&this.prev<Ne.finallyLoc){var Xe=Ne;break}}Xe&&(le==="break"||le==="continue")&&Xe.tryLoc<=ve&&ve<=Xe.finallyLoc&&(Xe=null);var ct=Xe?Xe.completion:{};return ct.type=le,ct.arg=ve,Xe?(this.method="next",this.next=Xe.finallyLoc,m):this.complete(ct)},complete:function(le,ve){if(le.type==="throw")throw le.arg;return le.type==="break"||le.type==="continue"?this.next=le.arg:le.type==="return"?(this.rval=this.arg=le.arg,this.method="return",this.next="end"):le.type==="normal"&&ve&&(this.next=ve),m},finish:function(le){for(var ve=this.tryEntries.length-1;ve>=0;--ve){var Me=this.tryEntries[ve];if(Me.finallyLoc===le)return this.complete(Me.completion,Me.afterLoc),$(Me),m}},catch:function(le){for(var ve=this.tryEntries.length-1;ve>=0;--ve){var Me=this.tryEntries[ve];if(Me.tryLoc===le){var Ne=Me.completion;if(Ne.type==="throw"){var Xe=Ne.arg;$(Me)}return Xe}}throw new Error("illegal catch attempt")},delegateYield:function(le,ve,Me){return this.delegate={iterator:ue(le),resultName:ve,nextLoc:Me},this.method==="next"&&(this.arg=void 0),m}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(n5);var dg=n5.exports(),H=dg;try{regeneratorRuntime=dg}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=dg:Function("r","regeneratorRuntime = r")(dg)}function jd(e,t){if(!e)throw new Error(t||"web worker helper assertion failed.")}var aP=typeof window<"u"&&typeof window.orientation<"u",oP=function(){function e(t,r){var n=this;this.name=t,this.workerThread=r,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(i,a){n.resolve=i,n.reject=a})}return e.prototype.postMessage=function(t,r){this.workerThread.postMessage({source:"Main thread",type:t,payload:r})},e.prototype.done=function(t){jd(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},e.prototype.error=function(t){jd(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},e}(),a_=new Map;function uP(e){jd(e.source&&!e.url||!e.source&&e.url);var t=a_.get(e.source||e.url);return t||(e.url&&(t=sP(e.url),a_.set(e.url,t)),e.source&&(t=a5(e.source),a_.set(e.source,t))),jd(t),t}function sP(e){if(!e.startsWith("http"))return e;var t=lP(e);return a5(t)}function a5(e){var t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function lP(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Zx(e,t,r){t===void 0&&(t=!0);var n=r||new Set;if(e){if(Cb(e))n.add(e);else if(Cb(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(var i in e)Zx(e[i],t,n)}}return r===void 0?Array.from(n):[]}function Cb(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}var o_=function(){},o5=function(){function e(t){this.terminated=!1,this.loadableURL="";var r=t.name,n=t.source,i=t.url;jd(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=o_,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker<"u"},e.prototype.destroy=function(){this.onMessage=o_,this.onError=o_,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(t,r){r=r||Zx(t),this.worker.postMessage(t,r)},e.prototype.getErrorFromErrorEvent=function(t){var r="Failed to load ";return r+="worker "+this.name+" from "+this.url+". ",t.message&&(r+=t.message+" in "),t.lineno&&(r+=":"+t.lineno+":"+t.colno),new Error(r)},e.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=uP({source:this.source,url:this.url});var r=new Worker(this.loadableURL,{name:this.name});return r.onmessage=function(n){n.data?t.onMessage(n.data):t.onError(new Error("No data received"))},r.onerror=function(n){t.onError(t.getErrorFromErrorEvent(n)),t.terminated=!0},r.onmessageerror=function(n){return console.error("worker "+t.name+", message error: "+n)},r},e}(),Lg=globalThis&&globalThis.__assign||function(){return Lg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Lg.apply(this,arguments)},Ab=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(f){try{l(n.next(f))}catch(h){o(h)}}function s(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(u,s)}l((n=n.apply(e,t||[])).next())})},Sb=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(f){return s([l,f])}}function s(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},cP=function(){function e(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(t){return t.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(t){this.props=Lg(Lg({},this.props),t),t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)},e.prototype.startJob=function(t,r,n){return r===void 0&&(r=function(i,a,o){return i.done(o)}),n===void 0&&(n=function(i,a){return i.error(a)}),Ab(this,void 0,void 0,function(){var i,a=this;return Sb(this,function(o){switch(o.label){case 0:return i=new Promise(function(u){return a.jobQueue.push({name:t,onMessage:r,onError:n,onStart:u}),a}),this.startQueuedJob(),[4,i];case 1:return[2,o.sent()]}})})},e.prototype.startQueuedJob=function(){return Ab(this,void 0,void 0,function(){var t,r,n;return Sb(this,function(i){switch(i.label){case 0:if(!this.jobQueue.length)return[2];if(t=this.getAvailableWorker(),!t)return[2];if(r=this.jobQueue.shift(),!r)return[3,4];this.onDebug({message:"Starting job",name:r.name,backlog:this.jobQueue.length,workerThread:t}),n=new oP(r.name,t),t.onMessage=function(a){return r.onMessage(n,a.type,a.payload)},t.onError=function(a){return r.onError(n,a)},r.onStart(n),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,n.result];case 2:return i.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(t){var r=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();r?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new o5({name:t,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return aP?this.maxMobileConcurrency:this.maxConcurrency},e}(),Od=globalThis&&globalThis.__assign||function(){return Od=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Od.apply(this,arguments)},Tb=globalThis&&globalThis.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},fP={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},hP=function(){function e(t){this.workerPools=new Map,this.props=Od({},fP),this.setProps(t),this.workerPools=new Map}return e.isSupported=function(){return o5.isSupported()},e.getWorkerFarm=function(t){return t===void 0&&(t={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(t),e.workerFarm},e.prototype.destroy=function(){var t,r;try{for(var n=Tb(this.workerPools.values()),i=n.next();!i.done;i=n.next()){var a=i.value;a.destroy()}}catch(o){t={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.setProps=function(t){var r,n;this.props=Od(Od({},this.props),t);try{for(var i=Tb(this.workerPools.values()),a=i.next();!a.done;a=i.next()){var o=a.value;o.setProps(this.getWorkerPoolProps())}}catch(u){r={error:u}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.getWorkerPool=function(t){var r=t.name,n=t.source,i=t.url,a=this.workerPools.get(r);return a||(a=new cP({name:r,source:n,url:i}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(r,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),u_=new Map,ts=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(t){self.onmessage=function(r){if(!!wb(r)){var n=r.data,i=n.type,a=n.payload;t(i,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(t){var r=u_.get(t);r||(r=function(n){if(!!wb(n)){var i=n.data,a=i.type,o=i.payload;t(a,o)}}),self.addEventListener("message",r)},e.removeEventListener=function(t){var r=u_.get(t);u_.delete(t),self.removeEventListener("message",r)},e.postMessage=function(t,r){if(self){var n={source:"Worker thread",type:t,payload:r},i=Zx(r);self.postMessage(n,i)}},e}();function wb(e){var t=e.type,r=e.data;return t==="message"&&r&&typeof r.source=="string"&&r.source==="Main thread"}globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var pP=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(t){return this.enqueue(t)},e.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var r=this._settlers.shift();t instanceof Error?r.reject(t):r.resolve({value:t})}else this._values.push(t)},e.prototype.close=function(){for(;this._settlers.length>0;){var t=this._settlers.shift();t.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var t=this;if(this._values.length>0){var r=this._values.shift();return r instanceof Error?Promise.reject(r):Promise.resolve({done:!1,value:r})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(n,i){t._settlers.push({resolve:n,reject:i})})},e}(),dP=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(f){try{l(n.next(f))}catch(h){o(h)}}function s(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(u,s)}l((n=n.apply(e,t||[])).next())})},vP=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(f){return s([l,f])}}function s(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},gP=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(o){return new Promise(function(u,s){o=e[a](o),i(u,s,o.done,o.value)})}}function i(a,o,u,s){Promise.resolve(s).then(function(l){a({value:l,done:u})},o)}},mP=0,$v,Mb;function yP(e,t){var r=this;if(!(typeof self>"u")){var n={process:_P};ts.onmessage=function(i,a){return dP(r,void 0,void 0,function(){var o,u,s,l,f,h,d,v,m,y,_;return vP(this,function(E){switch(E.label){case 0:switch(E.trys.push([0,19,,20]),o=i,o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},n)];case 2:return u=E.sent(),ts.postMessage("done",{result:u}),[3,18];case 3:if(!t)throw new Error("Worker does not support batched processing");$v=new pP,Mb=a.options||{},s=t($v,Mb,n),E.label=4;case 4:E.trys.push([4,9,10,15]),l=gP(s),E.label=5;case 5:return[4,l.next()];case 6:if(f=E.sent(),!!f.done)return[3,8];h=f.value,ts.postMessage("output-batch",{result:h}),E.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return d=E.sent(),y={error:d},[3,15];case 10:return E.trys.push([10,,13,14]),f&&!f.done&&(_=l.return)?[4,_.call(l)]:[3,12];case 11:E.sent(),E.label=12;case 12:return[3,14];case 13:if(y)throw y.error;return[7];case 14:return[7];case 15:return ts.postMessage("done",{}),[3,18];case 16:return $v.push(a.input),[3,18];case 17:return $v.close(),[3,18];case 18:return[3,20];case 19:return v=E.sent(),m=v instanceof Error?v.message:"",ts.postMessage("error",{error:m}),[3,20];case 20:return[2]}})})}}}function _P(e,t){return t===void 0&&(t={}),new Promise(function(r,n){var i=mP++,a=function(u,s){if(s.id===i)switch(u){case"done":ts.removeEventListener(a),r(s.result);break;case"error":ts.removeEventListener(a),n(s.error);break}};ts.addEventListener(a);var o={id:i,input:e,options:t};ts.postMessage("process",o)})}globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;function qx(e){var t=e.color;return!t||!t.length?[1,1,1,1]:t}function Kx(e,t,r){return r.length===2?[r[0],r[1],0]:[r[0],r[1],r[2]]}function Qx(e){var t=e.filter;return t?[1]:[0]}function Jx(e,t){return[t]}var Eu={exports:{}};Eu.exports=dm;Eu.exports.default=dm;function dm(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,a=u5(e,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;var u,s,l,f,h,d,v;if(n&&(a=AP(e,t,a,r)),e.length>80*r){u=l=e[0],s=f=e[1];for(var m=r;m<i;m+=r)h=e[m],d=e[m+1],h<u&&(u=h),d<s&&(s=d),h>l&&(l=h),d>f&&(f=d);v=Math.max(l-u,f-s),v=v!==0?32767/v:0}return Wd(a,o,r,u,s,v,0),o}function u5(e,t,r,n,i){var a,o;if(i===E1(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Rb(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Rb(a,e[a],e[a+1],o);return o&&vm(o,o.next)&&(Yd(o),o=o.next),o}function $c(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(vm(r,r.next)||On(r.prev,r,r.next)===0)){if(Yd(r),r=t=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function Wd(e,t,r,n,i,a,o){if(!!e){!o&&a&&RP(e,n,i,a);for(var u=e,s,l;e.prev!==e.next;){if(s=e.prev,l=e.next,a?EP(e,n,i,a):xP(e)){t.push(s.i/r|0),t.push(e.i/r|0),t.push(l.i/r|0),Yd(e),e=l.next,u=l.next;continue}if(e=l,e===u){o?o===1?(e=bP($c(e),t,r),Wd(e,t,r,n,i,a,2)):o===2&&CP(e,t,r,n,i,a):Wd($c(e),t,r,n,i,a,1);break}}}}function xP(e){var t=e.prev,r=e,n=e.next;if(On(t,r,n)>=0)return!1;for(var i=t.x,a=r.x,o=n.x,u=t.y,s=r.y,l=n.y,f=i<a?i<o?i:o:a<o?a:o,h=u<s?u<l?u:l:s<l?s:l,d=i>a?i>o?i:o:a>o?a:o,v=u>s?u>l?u:l:s>l?s:l,m=n.next;m!==t;){if(m.x>=f&&m.x<=d&&m.y>=h&&m.y<=v&&fh(i,u,a,s,o,l,m.x,m.y)&&On(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function EP(e,t,r,n){var i=e.prev,a=e,o=e.next;if(On(i,a,o)>=0)return!1;for(var u=i.x,s=a.x,l=o.x,f=i.y,h=a.y,d=o.y,v=u<s?u<l?u:l:s<l?s:l,m=f<h?f<d?f:d:h<d?h:d,y=u>s?u>l?u:l:s>l?s:l,_=f>h?f>d?f:d:h>d?h:d,E=_1(v,m,t,r,n),S=_1(y,_,t,r,n),A=e.prevZ,M=e.nextZ;A&&A.z>=E&&M&&M.z<=S;){if(A.x>=v&&A.x<=y&&A.y>=m&&A.y<=_&&A!==i&&A!==o&&fh(u,f,s,h,l,d,A.x,A.y)&&On(A.prev,A,A.next)>=0||(A=A.prevZ,M.x>=v&&M.x<=y&&M.y>=m&&M.y<=_&&M!==i&&M!==o&&fh(u,f,s,h,l,d,M.x,M.y)&&On(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;A&&A.z>=E;){if(A.x>=v&&A.x<=y&&A.y>=m&&A.y<=_&&A!==i&&A!==o&&fh(u,f,s,h,l,d,A.x,A.y)&&On(A.prev,A,A.next)>=0)return!1;A=A.prevZ}for(;M&&M.z<=S;){if(M.x>=v&&M.x<=y&&M.y>=m&&M.y<=_&&M!==i&&M!==o&&fh(u,f,s,h,l,d,M.x,M.y)&&On(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function bP(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!vm(i,a)&&s5(i,n,n.next,a)&&Xd(i,a)&&Xd(a,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(a.i/r|0),Yd(n),Yd(n.next),n=e=a),n=n.next}while(n!==e);return $c(n)}function CP(e,t,r,n,i,a){var o=e;do{for(var u=o.next.next;u!==o.prev;){if(o.i!==u.i&&FP(o,u)){var s=l5(o,u);o=$c(o,o.next),s=$c(s,s.next),Wd(o,t,r,n,i,a,0),Wd(s,t,r,n,i,a,0);return}u=u.next}o=o.next}while(o!==e)}function AP(e,t,r,n){var i=[],a,o,u,s,l;for(a=0,o=t.length;a<o;a++)u=t[a]*n,s=a<o-1?t[a+1]*n:e.length,l=u5(e,u,s,n,!1),l===l.next&&(l.steiner=!0),i.push(LP(l));for(i.sort(SP),a=0;a<i.length;a++)r=TP(i[a],r);return r}function SP(e,t){return e.x-t.x}function TP(e,t){var r=wP(e,t);if(!r)return t;var n=l5(r,e);return $c(n,n.next),$c(r,r.next)}function wP(e,t){var r=t,n=e.x,i=e.y,a=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var u=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(u<=n&&u>a&&(a=u,o=r.x<r.next.x?r:r.next,u===n))return o}r=r.next}while(r!==t);if(!o)return null;var s=o,l=o.x,f=o.y,h=1/0,d;r=o;do n>=r.x&&r.x>=l&&n!==r.x&&fh(i<f?n:a,i,l,f,i<f?a:n,i,r.x,r.y)&&(d=Math.abs(i-r.y)/(n-r.x),Xd(r,e)&&(d<h||d===h&&(r.x>o.x||r.x===o.x&&MP(o,r)))&&(o=r,h=d)),r=r.next;while(r!==s);return o}function MP(e,t){return On(e.prev,e,t.prev)<0&&On(t.next,e,e.next)<0}function RP(e,t,r,n){var i=e;do i.z===0&&(i.z=_1(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,OP(i)}function OP(e){var t,r,n,i,a,o,u,s,l=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,u=0,t=0;t<l&&(u++,n=n.nextZ,!!n);t++);for(s=l;u>0||s>0&&n;)u!==0&&(s===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,u--):(i=n,n=n.nextZ,s--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(o>1);return e}function _1(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function LP(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function fh(e,t,r,n,i,a,o,u){return(i-o)*(t-u)>=(e-o)*(a-u)&&(e-o)*(n-u)>=(r-o)*(t-u)&&(r-o)*(a-u)>=(i-o)*(n-u)}function FP(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!IP(e,t)&&(Xd(e,t)&&Xd(t,e)&&kP(e,t)&&(On(e.prev,e,t.prev)||On(e,t.prev,t))||vm(e,t)&&On(e.prev,e,e.next)>0&&On(t.prev,t,t.next)>0)}function On(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function vm(e,t){return e.x===t.x&&e.y===t.y}function s5(e,t,r,n){var i=Hv(On(e,t,r)),a=Hv(On(e,t,n)),o=Hv(On(r,n,e)),u=Hv(On(r,n,t));return!!(i!==a&&o!==u||i===0&&Gv(e,r,t)||a===0&&Gv(e,n,t)||o===0&&Gv(r,e,n)||u===0&&Gv(r,t,n))}function Gv(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Hv(e){return e>0?1:e<0?-1:0}function IP(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&s5(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Xd(e,t){return On(e.prev,e,e.next)<0?On(e,t,e.next)>=0&&On(e,e.prev,t)>=0:On(e,t,e.prev)<0||On(e,e.next,t)<0}function kP(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function l5(e,t){var r=new x1(e.i,e.x,e.y),n=new x1(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Rb(e,t,r,n){var i=new x1(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Yd(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function x1(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}dm.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(E1(e,0,a,r));if(i)for(var u=0,s=t.length;u<s;u++){var l=t[u]*r,f=u<s-1?t[u+1]*r:e.length;o-=Math.abs(E1(e,l,f,r))}var h=0;for(u=0;u<n.length;u+=3){var d=n[u]*r,v=n[u+1]*r,m=n[u+2]*r;h+=Math.abs((e[d]-e[m])*(e[v+1]-e[d+1])-(e[d]-e[v])*(e[m+1]-e[d+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function E1(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}dm.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r};var bn=1e-6,Ii=typeof Float32Array<"u"?Float32Array:Array,Ob=Math.random;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Oa(){var e=new Ii(16);return Ii!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function c5(e){var t=new Ii(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function PP(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function f5(e,t,r,n,i,a,o,u,s,l,f,h,d,v,m,y){var _=new Ii(16);return _[0]=e,_[1]=t,_[2]=r,_[3]=n,_[4]=i,_[5]=a,_[6]=o,_[7]=u,_[8]=s,_[9]=l,_[10]=f,_[11]=h,_[12]=d,_[13]=v,_[14]=m,_[15]=y,_}function DP(e,t,r,n,i,a,o,u,s,l,f,h,d,v,m,y,_){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=u,e[7]=s,e[8]=l,e[9]=f,e[10]=h,e[11]=d,e[12]=v,e[13]=m,e[14]=y,e[15]=_,e}function h5(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function BP(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function eE(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8],h=t[9],d=t[10],v=t[11],m=t[12],y=t[13],_=t[14],E=t[15],S=r*u-n*o,A=r*s-i*o,M=r*l-a*o,O=n*s-i*u,j=n*l-a*u,q=i*l-a*s,Y=f*y-h*m,ne=f*_-d*m,X=f*E-v*m,$=h*_-d*y,K=h*E-v*y,ue=d*E-v*_,de=S*ue-A*K+M*$+O*X-j*ne+q*Y;return de?(de=1/de,e[0]=(u*ue-s*K+l*$)*de,e[1]=(i*K-n*ue-a*$)*de,e[2]=(y*q-_*j+E*O)*de,e[3]=(d*j-h*q-v*O)*de,e[4]=(s*X-o*ue-l*ne)*de,e[5]=(r*ue-i*X+a*ne)*de,e[6]=(_*M-m*q-E*A)*de,e[7]=(f*q-d*M+v*A)*de,e[8]=(o*K-u*X+l*Y)*de,e[9]=(n*X-r*K-a*Y)*de,e[10]=(m*j-y*M+E*S)*de,e[11]=(h*M-f*j-v*S)*de,e[12]=(u*ne-o*$-s*Y)*de,e[13]=(r*$-n*ne+i*Y)*de,e[14]=(y*A-m*O-_*S)*de,e[15]=(f*O-h*A+d*S)*de,e):null}function NP(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8],h=t[9],d=t[10],v=t[11],m=t[12],y=t[13],_=t[14],E=t[15];return e[0]=u*(d*E-v*_)-h*(s*E-l*_)+y*(s*v-l*d),e[1]=-(n*(d*E-v*_)-h*(i*E-a*_)+y*(i*v-a*d)),e[2]=n*(s*E-l*_)-u*(i*E-a*_)+y*(i*l-a*s),e[3]=-(n*(s*v-l*d)-u*(i*v-a*d)+h*(i*l-a*s)),e[4]=-(o*(d*E-v*_)-f*(s*E-l*_)+m*(s*v-l*d)),e[5]=r*(d*E-v*_)-f*(i*E-a*_)+m*(i*v-a*d),e[6]=-(r*(s*E-l*_)-o*(i*E-a*_)+m*(i*l-a*s)),e[7]=r*(s*v-l*d)-o*(i*v-a*d)+f*(i*l-a*s),e[8]=o*(h*E-v*y)-f*(u*E-l*y)+m*(u*v-l*h),e[9]=-(r*(h*E-v*y)-f*(n*E-a*y)+m*(n*v-a*h)),e[10]=r*(u*E-l*y)-o*(n*E-a*y)+m*(n*l-a*u),e[11]=-(r*(u*v-l*h)-o*(n*v-a*h)+f*(n*l-a*u)),e[12]=-(o*(h*_-d*y)-f*(u*_-s*y)+m*(u*d-s*h)),e[13]=r*(h*_-d*y)-f*(n*_-i*y)+m*(n*d-i*h),e[14]=-(r*(u*_-s*y)-o*(n*_-i*y)+m*(n*s-i*u)),e[15]=r*(u*d-s*h)-o*(n*d-i*h)+f*(n*s-i*u),e}function UP(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],u=e[6],s=e[7],l=e[8],f=e[9],h=e[10],d=e[11],v=e[12],m=e[13],y=e[14],_=e[15],E=t*o-r*a,S=t*u-n*a,A=t*s-i*a,M=r*u-n*o,O=r*s-i*o,j=n*s-i*u,q=l*m-f*v,Y=l*y-h*v,ne=l*_-d*v,X=f*y-h*m,$=f*_-d*m,K=h*_-d*y;return E*K-S*$+A*X+M*ne-O*Y+j*q}function uo(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],f=t[7],h=t[8],d=t[9],v=t[10],m=t[11],y=t[12],_=t[13],E=t[14],S=t[15],A=r[0],M=r[1],O=r[2],j=r[3];return e[0]=A*n+M*u+O*h+j*y,e[1]=A*i+M*s+O*d+j*_,e[2]=A*a+M*l+O*v+j*E,e[3]=A*o+M*f+O*m+j*S,A=r[4],M=r[5],O=r[6],j=r[7],e[4]=A*n+M*u+O*h+j*y,e[5]=A*i+M*s+O*d+j*_,e[6]=A*a+M*l+O*v+j*E,e[7]=A*o+M*f+O*m+j*S,A=r[8],M=r[9],O=r[10],j=r[11],e[8]=A*n+M*u+O*h+j*y,e[9]=A*i+M*s+O*d+j*_,e[10]=A*a+M*l+O*v+j*E,e[11]=A*o+M*f+O*m+j*S,A=r[12],M=r[13],O=r[14],j=r[15],e[12]=A*n+M*u+O*h+j*y,e[13]=A*i+M*s+O*d+j*_,e[14]=A*a+M*l+O*v+j*E,e[15]=A*o+M*f+O*m+j*S,e}function Gc(e,t,r){var n=r[0],i=r[1],a=r[2],o,u,s,l,f,h,d,v,m,y,_,E;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],u=t[1],s=t[2],l=t[3],f=t[4],h=t[5],d=t[6],v=t[7],m=t[8],y=t[9],_=t[10],E=t[11],e[0]=o,e[1]=u,e[2]=s,e[3]=l,e[4]=f,e[5]=h,e[6]=d,e[7]=v,e[8]=m,e[9]=y,e[10]=_,e[11]=E,e[12]=o*n+f*i+m*a+t[12],e[13]=u*n+h*i+y*a+t[13],e[14]=s*n+d*i+_*a+t[14],e[15]=l*n+v*i+E*a+t[15]),e}function wh(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function zP(e,t,r,n){var i=n[0],a=n[1],o=n[2],u=Math.hypot(i,a,o),s,l,f,h,d,v,m,y,_,E,S,A,M,O,j,q,Y,ne,X,$,K,ue,de,pe;return u<bn?null:(u=1/u,i*=u,a*=u,o*=u,s=Math.sin(r),l=Math.cos(r),f=1-l,h=t[0],d=t[1],v=t[2],m=t[3],y=t[4],_=t[5],E=t[6],S=t[7],A=t[8],M=t[9],O=t[10],j=t[11],q=i*i*f+l,Y=a*i*f+o*s,ne=o*i*f-a*s,X=i*a*f-o*s,$=a*a*f+l,K=o*a*f+i*s,ue=i*o*f+a*s,de=a*o*f-i*s,pe=o*o*f+l,e[0]=h*q+y*Y+A*ne,e[1]=d*q+_*Y+M*ne,e[2]=v*q+E*Y+O*ne,e[3]=m*q+S*Y+j*ne,e[4]=h*X+y*$+A*K,e[5]=d*X+_*$+M*K,e[6]=v*X+E*$+O*K,e[7]=m*X+S*$+j*K,e[8]=h*ue+y*de+A*pe,e[9]=d*ue+_*de+M*pe,e[10]=v*ue+E*de+O*pe,e[11]=m*ue+S*de+j*pe,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function d0(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],u=t[6],s=t[7],l=t[8],f=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+f*n,e[6]=u*i+h*n,e[7]=s*i+d*n,e[8]=l*i-a*n,e[9]=f*i-o*n,e[10]=h*i-u*n,e[11]=d*i-s*n,e}function gm(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],u=t[2],s=t[3],l=t[8],f=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-f*n,e[2]=u*i-h*n,e[3]=s*i-d*n,e[8]=a*n+l*i,e[9]=o*n+f*i,e[10]=u*n+h*i,e[11]=s*n+d*i,e}function mm(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],u=t[2],s=t[3],l=t[4],f=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+f*n,e[2]=u*i+h*n,e[3]=s*i+d*n,e[4]=l*i-a*n,e[5]=f*i-o*n,e[6]=h*i-u*n,e[7]=d*i-s*n,e}function p5(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function $P(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function GP(e,t,r){var n=r[0],i=r[1],a=r[2],o=Math.hypot(n,i,a),u,s,l;return o<bn?null:(o=1/o,n*=o,i*=o,a*=o,u=Math.sin(t),s=Math.cos(t),l=1-s,e[0]=n*n*l+s,e[1]=i*n*l+a*u,e[2]=a*n*l-i*u,e[3]=0,e[4]=n*i*l-a*u,e[5]=i*i*l+s,e[6]=a*i*l+n*u,e[7]=0,e[8]=n*a*l+i*u,e[9]=i*a*l-n*u,e[10]=a*a*l+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function HP(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function VP(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jP(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function d5(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=n+n,s=i+i,l=a+a,f=n*u,h=n*s,d=n*l,v=i*s,m=i*l,y=a*l,_=o*u,E=o*s,S=o*l;return e[0]=1-(v+y),e[1]=h+S,e[2]=d-E,e[3]=0,e[4]=h-S,e[5]=1-(f+y),e[6]=m+_,e[7]=0,e[8]=d+E,e[9]=m-_,e[10]=1-(f+v),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function WP(e,t){var r=new Ii(3),n=-t[0],i=-t[1],a=-t[2],o=t[3],u=t[4],s=t[5],l=t[6],f=t[7],h=n*n+i*i+a*a+o*o;return h>0?(r[0]=(u*o+f*n+s*a-l*i)*2/h,r[1]=(s*o+f*i+l*n-u*a)*2/h,r[2]=(l*o+f*a+u*i-s*n)*2/h):(r[0]=(u*o+f*n+s*a-l*i)*2,r[1]=(s*o+f*i+l*n-u*a)*2,r[2]=(l*o+f*a+u*i-s*n)*2),d5(e,t,r),e}function XP(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function v5(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],u=t[6],s=t[8],l=t[9],f=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(a,o,u),e[2]=Math.hypot(s,l,f),e}function YP(e,t){var r=new Ii(3);v5(r,t);var n=1/r[0],i=1/r[1],a=1/r[2],o=t[0]*n,u=t[1]*i,s=t[2]*a,l=t[4]*n,f=t[5]*i,h=t[6]*a,d=t[8]*n,v=t[9]*i,m=t[10]*a,y=o+f+m,_=0;return y>0?(_=Math.sqrt(y+1)*2,e[3]=.25*_,e[0]=(h-v)/_,e[1]=(d-s)/_,e[2]=(u-l)/_):o>f&&o>m?(_=Math.sqrt(1+o-f-m)*2,e[3]=(h-v)/_,e[0]=.25*_,e[1]=(u+l)/_,e[2]=(d+s)/_):f>m?(_=Math.sqrt(1+f-o-m)*2,e[3]=(d-s)/_,e[0]=(u+l)/_,e[1]=.25*_,e[2]=(h+v)/_):(_=Math.sqrt(1+m-o-f)*2,e[3]=(u-l)/_,e[0]=(d+s)/_,e[1]=(h+v)/_,e[2]=.25*_),e}function ZP(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=t[3],s=i+i,l=a+a,f=o+o,h=i*s,d=i*l,v=i*f,m=a*l,y=a*f,_=o*f,E=u*s,S=u*l,A=u*f,M=n[0],O=n[1],j=n[2];return e[0]=(1-(m+_))*M,e[1]=(d+A)*M,e[2]=(v-S)*M,e[3]=0,e[4]=(d-A)*O,e[5]=(1-(h+_))*O,e[6]=(y+E)*O,e[7]=0,e[8]=(v+S)*j,e[9]=(y-E)*j,e[10]=(1-(h+m))*j,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function qP(e,t,r,n,i){var a=t[0],o=t[1],u=t[2],s=t[3],l=a+a,f=o+o,h=u+u,d=a*l,v=a*f,m=a*h,y=o*f,_=o*h,E=u*h,S=s*l,A=s*f,M=s*h,O=n[0],j=n[1],q=n[2],Y=i[0],ne=i[1],X=i[2],$=(1-(y+E))*O,K=(v+M)*O,ue=(m-A)*O,de=(v-M)*j,pe=(1-(d+E))*j,le=(_+S)*j,ve=(m+A)*q,Me=(_-S)*q,Ne=(1-(d+y))*q;return e[0]=$,e[1]=K,e[2]=ue,e[3]=0,e[4]=de,e[5]=pe,e[6]=le,e[7]=0,e[8]=ve,e[9]=Me,e[10]=Ne,e[11]=0,e[12]=r[0]+Y-($*Y+de*ne+ve*X),e[13]=r[1]+ne-(K*Y+pe*ne+Me*X),e[14]=r[2]+X-(ue*Y+le*ne+Ne*X),e[15]=1,e}function KP(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,u=n+n,s=i+i,l=r*o,f=n*o,h=n*u,d=i*o,v=i*u,m=i*s,y=a*o,_=a*u,E=a*s;return e[0]=1-h-m,e[1]=f+E,e[2]=d-_,e[3]=0,e[4]=f-E,e[5]=1-l-m,e[6]=v+y,e[7]=0,e[8]=d+_,e[9]=v-y,e[10]=1-l-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function QP(e,t,r,n,i,a,o){var u=1/(r-t),s=1/(i-n),l=1/(a-o);return e[0]=a*2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*s,e[6]=0,e[7]=0,e[8]=(r+t)*u,e[9]=(i+n)*s,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function g5(e,t,r,n,i){var a=1/Math.tan(t/2),o;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e}var tE=g5;function JP(e,t,r,n,i){var a=1/Math.tan(t/2),o;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(n-i),e[10]=i*o,e[14]=i*n*o):(e[10]=-1,e[14]=-n),e}function eD(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(o+u),l=2/(i+a);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((o-u)*s*.5),e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function m5(e,t,r,n,i,a,o){var u=1/(t-r),s=1/(n-i),l=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*u,e[13]=(i+n)*s,e[14]=(o+a)*l,e[15]=1,e}var tD=m5;function rD(e,t,r,n,i,a,o){var u=1/(t-r),s=1/(n-i),l=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l,e[11]=0,e[12]=(t+r)*u,e[13]=(i+n)*s,e[14]=a*l,e[15]=1,e}function y5(e,t,r,n){var i,a,o,u,s,l,f,h,d,v,m=t[0],y=t[1],_=t[2],E=n[0],S=n[1],A=n[2],M=r[0],O=r[1],j=r[2];return Math.abs(m-M)<bn&&Math.abs(y-O)<bn&&Math.abs(_-j)<bn?h5(e):(f=m-M,h=y-O,d=_-j,v=1/Math.hypot(f,h,d),f*=v,h*=v,d*=v,i=S*d-A*h,a=A*f-E*d,o=E*h-S*f,v=Math.hypot(i,a,o),v?(v=1/v,i*=v,a*=v,o*=v):(i=0,a=0,o=0),u=h*o-d*a,s=d*i-f*o,l=f*a-h*i,v=Math.hypot(u,s,l),v?(v=1/v,u*=v,s*=v,l*=v):(u=0,s=0,l=0),e[0]=i,e[1]=u,e[2]=f,e[3]=0,e[4]=a,e[5]=s,e[6]=h,e[7]=0,e[8]=o,e[9]=l,e[10]=d,e[11]=0,e[12]=-(i*m+a*y+o*_),e[13]=-(u*m+s*y+l*_),e[14]=-(f*m+h*y+d*_),e[15]=1,e)}function nD(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=n[0],s=n[1],l=n[2],f=i-r[0],h=a-r[1],d=o-r[2],v=f*f+h*h+d*d;v>0&&(v=1/Math.sqrt(v),f*=v,h*=v,d*=v);var m=s*d-l*h,y=l*f-u*d,_=u*h-s*f;return v=m*m+y*y+_*_,v>0&&(v=1/Math.sqrt(v),m*=v,y*=v,_*=v),e[0]=m,e[1]=y,e[2]=_,e[3]=0,e[4]=h*_-d*y,e[5]=d*m-f*_,e[6]=f*y-h*m,e[7]=0,e[8]=f,e[9]=h,e[10]=d,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function iD(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function aD(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function oD(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function _5(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function uD(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function sD(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function lD(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function b1(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],f=e[8],h=e[9],d=e[10],v=e[11],m=e[12],y=e[13],_=e[14],E=e[15],S=t[0],A=t[1],M=t[2],O=t[3],j=t[4],q=t[5],Y=t[6],ne=t[7],X=t[8],$=t[9],K=t[10],ue=t[11],de=t[12],pe=t[13],le=t[14],ve=t[15];return Math.abs(r-S)<=bn*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(n-A)<=bn*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(i-M)<=bn*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-O)<=bn*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(o-j)<=bn*Math.max(1,Math.abs(o),Math.abs(j))&&Math.abs(u-q)<=bn*Math.max(1,Math.abs(u),Math.abs(q))&&Math.abs(s-Y)<=bn*Math.max(1,Math.abs(s),Math.abs(Y))&&Math.abs(l-ne)<=bn*Math.max(1,Math.abs(l),Math.abs(ne))&&Math.abs(f-X)<=bn*Math.max(1,Math.abs(f),Math.abs(X))&&Math.abs(h-$)<=bn*Math.max(1,Math.abs(h),Math.abs($))&&Math.abs(d-K)<=bn*Math.max(1,Math.abs(d),Math.abs(K))&&Math.abs(v-ue)<=bn*Math.max(1,Math.abs(v),Math.abs(ue))&&Math.abs(m-de)<=bn*Math.max(1,Math.abs(m),Math.abs(de))&&Math.abs(y-pe)<=bn*Math.max(1,Math.abs(y),Math.abs(pe))&&Math.abs(_-le)<=bn*Math.max(1,Math.abs(_),Math.abs(le))&&Math.abs(E-ve)<=bn*Math.max(1,Math.abs(E),Math.abs(ve))}var cD=uo,fD=_5;const hD=Object.freeze(Object.defineProperty({__proto__:null,create:Oa,clone:c5,copy:PP,fromValues:f5,set:DP,identity:h5,transpose:BP,invert:eE,adjoint:NP,determinant:UP,multiply:uo,translate:Gc,scale:wh,rotate:zP,rotateX:d0,rotateY:gm,rotateZ:mm,fromTranslation:p5,fromScaling:$P,fromRotation:GP,fromXRotation:HP,fromYRotation:VP,fromZRotation:jP,fromRotationTranslation:d5,fromQuat2:WP,getTranslation:XP,getScaling:v5,getRotation:YP,fromRotationTranslationScale:ZP,fromRotationTranslationScaleOrigin:qP,fromQuat:KP,frustum:QP,perspectiveNO:g5,perspective:tE,perspectiveZO:JP,perspectiveFromFieldOfView:eD,orthoNO:m5,ortho:tD,orthoZO:rD,lookAt:y5,targetTo:nD,str:iD,frob:aD,add:oD,subtract:_5,multiplyScalar:uD,multiplyScalarAndAdd:sD,exactEquals:lD,equals:b1,mul:cD,sub:fD},Symbol.toStringTag,{value:"Module"}));function hh(){var e=new Ii(3);return Ii!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function pD(e){var t=new Ii(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function x5(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function fi(e,t,r){var n=new Ii(3);return n[0]=e,n[1]=t,n[2]=r,n}function dD(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function vD(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function gD(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function E5(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function b5(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function C5(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function mD(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function yD(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function _D(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function xD(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function ED(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function bD(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function CD(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function A5(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function S5(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function T5(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function w5(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function AD(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function ph(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function M5(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function R5(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2];return e[0]=i*s-a*u,e[1]=a*o-n*s,e[2]=n*u-i*o,e}function SD(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e}function TD(e,t,r,n,i,a){var o=a*a,u=o*(2*a-3)+1,s=o*(a-2)+a,l=o*(a-1),f=o*(3-2*a);return e[0]=t[0]*u+r[0]*s+n[0]*l+i[0]*f,e[1]=t[1]*u+r[1]*s+n[1]*l+i[1]*f,e[2]=t[2]*u+r[2]*s+n[2]*l+i[2]*f,e}function wD(e,t,r,n,i,a){var o=1-a,u=o*o,s=a*a,l=u*o,f=3*a*u,h=3*s*o,d=s*a;return e[0]=t[0]*l+r[0]*f+n[0]*h+i[0]*d,e[1]=t[1]*l+r[1]*f+n[1]*h+i[1]*d,e[2]=t[2]*l+r[2]*f+n[2]*h+i[2]*d,e}function MD(e,t){t=t||1;var r=Ob()*2*Math.PI,n=Ob()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function _d(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e}function RD(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function OD(e,t,r){var n=r[0],i=r[1],a=r[2],o=r[3],u=t[0],s=t[1],l=t[2],f=i*l-a*s,h=a*u-n*l,d=n*s-i*u,v=i*d-a*h,m=a*f-n*d,y=n*h-i*f,_=o*2;return f*=_,h*=_,d*=_,v*=2,m*=2,y*=2,e[0]=u+f+v,e[1]=s+h+m,e[2]=l+d+y,e}function LD(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function FD(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function ID(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function C1(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],u=t[2],s=Math.sqrt(r*r+n*n+i*i),l=Math.sqrt(a*a+o*o+u*u),f=s*l,h=f&&M5(e,t)/f;return Math.acos(Math.min(Math.max(h,-1),1))}function kD(e){return e[0]=0,e[1]=0,e[2]=0,e}function PD(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function DD(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function BD(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],u=t[2];return Math.abs(r-a)<=bn*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=bn*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-u)<=bn*Math.max(1,Math.abs(i),Math.abs(u))}var A1=E5,ND=b5,UD=C5,zD=A5,$D=S5,GD=x5,HD=T5,VD=function(){var e=hh();return function(t,r,n,i,a,o){var u,s;for(r||(r=3),n||(n=0),i?s=Math.min(i*r+n,t.length):s=t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}();const _h=Object.freeze(Object.defineProperty({__proto__:null,create:hh,clone:pD,length:x5,fromValues:fi,copy:dD,set:vD,add:gD,subtract:E5,multiply:b5,divide:C5,ceil:mD,floor:yD,min:_D,max:xD,round:ED,scale:bD,scaleAndAdd:CD,distance:A5,squaredDistance:S5,squaredLength:T5,negate:w5,inverse:AD,normalize:ph,dot:M5,cross:R5,lerp:SD,hermite:TD,bezier:wD,random:MD,transformMat4:_d,transformMat3:RD,transformQuat:OD,rotateX:LD,rotateY:FD,rotateZ:ID,angle:C1,zero:kD,str:PD,exactEquals:DD,equals:BD,sub:A1,mul:ND,div:UD,dist:zD,sqrDist:$D,len:GD,sqrLen:HD,forEach:VD},Symbol.toStringTag,{value:"Module"}));function O5(){var e=new Ii(4);return Ii!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function jD(e,t,r,n){var i=new Ii(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function WD(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function rE(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}(function(){var e=O5();return function(t,r,n,i,a,o){var u,s;for(r||(r=4),n||(n=0),i?s=Math.min(i*r+n,t.length):s=t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}})();function Pr(){var e=new Ii(2);return Ii!=Float32Array&&(e[0]=0,e[1]=0),e}function Mh(e,t){var r=new Ii(2);return r[0]=e,r[1]=t,r}function gu(e,t){return e[0]=t[0],e[1]=t[1],e}function L5(e,t,r){return e[0]=t,e[1]=r,e}function Pn(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Nc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function XD(e,t){return e[0]=-t[0],e[1]=-t[1],e}function xu(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function vl(e,t){return e[0]*t[0]+e[1]*t[1]}function YD(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}var Rh=Nc;(function(){var e=Pr();return function(t,r,n,i,a,o){var u,s;for(r||(r=2),n||(n=0),i?s=Math.min(i*r+n,t.length):s=t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],a(e,e,o),t[u]=e[0],t[u+1]=e[1];return t}})();var Vv=Pr();Pr();var Zn=Pr(),Js=Pr(),Kf=Pr();function s_(e,t,r,n,i){Pn(e,r,n),xu(e,e),t=Mh(-e[1],e[0]);var a=Mh(-r[1],r[0]);return[i/vl(t,a),t]}function el(e,t){return L5(e,-t[1],t[0])}function Qf(e,t,r){return Rh(e,t,r),xu(e,e),e}function l_(e,t){return e[0]===t[0]&&e[1]===t[1]}var ZD=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(this,e),T(this,"lastFlip",-1),T(this,"miter",Mh(0,0)),T(this,"started",!1),T(this,"dash",!1),T(this,"totalDistance",0),T(this,"currentIndex",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return Pe(e,[{key:"extrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,o=i.startIndex,u=1;u<a;u++){var s,l,f,h=r[u-1];h.push((s=n[u-1][2])!==null&&s!==void 0?s:0);var d=n[u-1],v=r[u];v.push((l=n[u][2])!==null&&l!==void 0?l:0);var m=n[u],y=u<r.length-1?[].concat(It(r[u+1]),[(f=n[u+1][2])!==null&&f!==void 0?f:0]):null,_=u<n.length-1?n[u+1]:null,E=this.segment_gaode2(i,o,h,v,y,d,m,_);o+=E}if(this.dash)for(var S=0;S<i.positions.length/6;S++)i.positions[S*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,o=i.startIndex,u=1;u<a;u++){var s,l,f,h=r[u-1];h.push((s=n[u-1][2])!==null&&s!==void 0?s:0);var d=n[u-1],v=r[u];v.push((l=n[u][2])!==null&&l!==void 0?l:0);var m=n[u],y=u<r.length-1?[].concat(It(r[u+1]),[(f=n[u+1][2])!==null&&f!==void 0?f:0]):null,_=u<n.length-1?n[u+1]:null,E=this.simpleSegment(i,o,h,v,y,d,m,_);o+=E}if(this.dash)for(var S=0;S<i.positions.length/6;S++)i.positions[S*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,o=1;o<i;o++){var u=r[o-1],s=r[o],l=o<r.length-1?r[o+1]:null,f=this.segment(n,a,u,s,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,o=1;o<i;o++){var u=r[o-1],s=r[o],l=o<r.length-1?r[o+1]:null,f=this.simpleSegment(n,a,u,s,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(r,n,i,a,o,u,s,l){var f=0,h=r.indices,d=r.positions,v=r.normals,m=this.cap==="square",y=this.join==="bevel",_=ci([s[0],s[1]]),E=ci([u[0],u[1]]);Qf(Zn,a,i);var S=0;if(this.dash&&(S=this.lineSegmentDistance(_,E),this.totalDistance+=S),this.normal||(this.normal=Pr(),el(this.normal,Zn)),!this.started)if(this.started=!0,m){var A=Pr(),M=Pr();Pn(A,this.normal,Zn),Pn(M,this.normal,Zn),v.push(M[0],M[1],0),v.push(A[0],A[1],0),d.push(i[0],i[1],i[2]|0,this.totalDistance-S,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),d.push(i[0],i[1],i[2]|0,this.totalDistance-S,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,v,i,this.normal,this.thickness,this.totalDistance-S);if(h.push(n+0,n+1,n+2),o){l_(a,o)&&Pn(o,a,xu(o,Nc(o,a,i))),Qf(Js,o,a);var q=s_(Kf,Pr(),Zn,Js,this.thickness),Y=ir(q,2),ne=Y[0],X=Y[1],$=vl(Kf,this.normal)<0?-1:1,K=y;if(!K&&this.join==="miter"){var ue=ne;ue>this.miterLimit&&(K=!0)}K?(v.push(this.normal[0],this.normal[1],0),v.push(X[0],X[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*$,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*$,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,h.push.apply(h,It(this.lastFlip!==-$?[n,n+2,n+3]:[n+2,n+1,n+3])),h.push(n+2,n+3,n+4),el(Vv,Js),gu(this.normal,Vv),v.push(this.normal[0],this.normal[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*$,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f+=3):(this.extrusions(d,v,a,X,ne,this.totalDistance),h.push.apply(h,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),$=-1,gu(this.normal,X),f+=2),this.lastFlip=$}else{if(el(this.normal,Zn),m){var O=Pr(),j=Pr();Rh(j,Zn,this.normal),Pn(O,Zn,this.normal),v.push(j[0],j[1],0),v.push(O[0],O[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,v,a,this.normal,this.thickness,this.totalDistance);h.push.apply(h,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),f+=2}return f}},{key:"simpleSegment",value:function(r,n,i,a,o){var u=0,s=r.indices,l=r.positions,f=r.normals,h=ci([a[0],a[1]]),d=ci([i[0],i[1]]);Qf(Zn,h,d);var v=0;if(this.dash&&(v=this.lineSegmentDistance(h,d),this.totalDistance+=v),this.normal||(this.normal=Pr(),el(this.normal,Zn)),this.started||(this.started=!0,this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-v)),s.push(n+0,n+1,n+2),!o)el(this.normal,Zn),this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance),s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),u+=2;else{var m=ci([o[0],o[1]]);l_(h,m)&&Pn(m,h,xu(m,Nc(m,h,d))),Qf(Js,m,h);var y=s_(Kf,Pr(),Zn,Js,this.thickness),_=ir(y,2),E=_[0],S=_[1],A=vl(Kf,this.normal)<0?-1:1;this.extrusions(l,f,a,S,E,this.totalDistance),s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),A=-1,gu(this.normal,S),u+=2,this.lastFlip=A}return u}},{key:"segment",value:function(r,n,i,a,o){var u=0,s=r.indices,l=r.positions,f=r.normals,h=this.cap==="square",d=this.join==="bevel",v=ci([a[0],a[1]]),m=ci([i[0],i[1]]);Qf(Zn,v,m);var y=0;if(this.dash&&(y=this.lineSegmentDistance(v,m),this.totalDistance+=y),this.normal||(this.normal=Pr(),el(this.normal,Zn)),!this.started)if(this.started=!0,h){var _=Pr(),E=Pr();Pn(_,this.normal,Zn),Pn(E,this.normal,Zn),f.push(E[0],E[1],0),f.push(_[0],_[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance-y,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),l.push(i[0],i[1],i[2]|0,this.totalDistance-y,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-y);if(s.push(n+0,n+1,n+2),o){var M=ci([o[0],o[1]]);l_(v,M)&&Pn(M,v,xu(M,Nc(M,v,m))),Qf(Js,M,v);var O=s_(Kf,Pr(),Zn,Js,this.thickness),j=ir(O,2),q=j[0],Y=j[1],ne=vl(Kf,this.normal)<0?-1:1,X=d;if(!X&&this.join==="miter"){var $=q;$>this.miterLimit&&(X=!0)}X?(f.push(this.normal[0],this.normal[1],0),f.push(Y[0],Y[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ne,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ne,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s.push.apply(s,It(this.lastFlip!==-ne?[n,n+2,n+3]:[n+2,n+1,n+3])),s.push(n+2,n+3,n+4),el(Vv,Js),gu(this.normal,Vv),f.push(this.normal[0],this.normal[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ne,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u+=3):(this.extrusions(l,f,a,Y,q,this.totalDistance),s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ne=-1,gu(this.normal,Y),u+=2),this.lastFlip=ne}else{if(el(this.normal,Zn),h){var S=Pr(),A=Pr();Rh(A,Zn,this.normal),Pn(S,Zn,this.normal),f.push(A[0],A[1],0),f.push(S[0],S[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance);s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),u+=2}return u}},{key:"extrusions",value:function(r,n,i,a,o,u){n.push(a[0],a[1],0),n.push(a[0],a[1],0),r.push(i[0],i[1],i[2]|0,u,-o,i[2]|0),this.complex.indexes.push(this.currentIndex),r.push(i[0],i[1],i[2]|0,u,o,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(r,n){var i=n[0]-r[0],a=n[1]-r[1];return Math.sqrt(i*i+a*a)}}]),e}();function S1(e){var t=e.coordinates,r=e.originCoordinates,n=e.version,i=new ZD({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=t;Array.isArray(a[0][0])||(a=[t]);var o=r;Array.isArray(o[0][0])||(o=[r]);for(var u=0;u<a.length;u++){var s=a[u],l=o[u];i.extrude_gaode2(s,l)}}else{var f=t;f[0]&&!Array.isArray(f[0][0])&&(f=[t]),f.forEach(function(d){i.extrude(d)})}var h=i.complex;return{vertices:h.positions,indices:h.indices,normals:h.normals,indexes:h.indexes,size:6}}function vg(e){var t=oo(e.coordinates);return{vertices:[].concat(It(t),It(t),It(t),It(t)),indices:[0,1,2,2,3,0],size:t.length}}function F5(e){var t=e.coordinates,r=Eu.exports.flatten(t),n=r.vertices,i=r.dimensions,a=r.holes;return{indices:Eu.exports(n,a,i),vertices:n,size:i}}var qD=function(){var e=Ie(H.mark(function t(r){var n,i,a,o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return n=r.descriptors,i=r.features,a=r.enablePicking,o=r.iconMap,u={a_Color:qx,a_Position:Kx,filter:Qx,a_vertexId:Jx,a_PickingColor:function(y){var _=y.id;return a?ss(_):[0,0,0]},a_DistanceAndIndex:function(y,_,E,S,A,M){return M===void 0?[E[3],10]:[E[3],M]},a_Total_Distance:function(y,_,E){return[E[5]]},a_Size:function(y){var _=y.size,E=_===void 0?1:_;return Array.isArray(E)?[E[0],E[1]]:[E,0]},a_Normal:function(y,_,E,S,A){return A},a_Miter:function(y,_,E){return[E[4]]},a_iconMapUV:function(y){var _=y.texture,E=o[_]||{x:0,y:0},S=E.x,A=E.y;return[S,A]}},s={sizePerElement:0,elements:[]},l=0,f=[],h=3,i.forEach(function(m,y){var _=S1(m),E=_.indices,S=_.vertices,A=_.normals,M=_.size,O=_.indexes;E.forEach(function(ne){f.push(ne+l)}),h=M;var j=S.length/M;s.sizePerElement=h,s.elements.push({featureIdx:y,vertices:S,normals:A,offset:l}),l+=j;for(var q=function(X){var $=(A==null?void 0:A.slice(X*3,X*3+3))||[],K=S.slice(X*M,X*M+M),ue=0;O&&O[X]!==void 0&&(ue=O[X]),n.forEach(function(de){if(de&&u[de.name]){var pe;(pe=de.buffer.data).push.apply(pe,It(u[de.name](m,y,K,X,$,ue)))}})},Y=0;Y<j;Y++)q(Y)}),v.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return v.stop()}},t)}));return function(r){return e.apply(this,arguments)}}(),KD=function(){var e=Ie(H.mark(function t(r){var n,i,a,o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return n=r.descriptors,i=r.features,a=r.enablePicking,o=r.shape2d,u={a_Color:qx,a_Position:Kx,filter:Qx,a_vertexId:Jx,a_PickingColor:function(y){var _=y.id;return a?ss(_):[0,0,0]},a_Shape:function(y){var _=y.shape,E=_===void 0?2:_,S=o.indexOf(E);return[S]},a_Extrude:function(y,_,E,S){var A=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],M=S%4*3;return[A[M],A[M+1],A[M+2]]},a_Size:function(y){var _=y.size,E=_===void 0?5:_;return Array.isArray(E)?[E[0]]:[E]}},s={sizePerElement:0,elements:[]},l=0,f=[],h=3,i.forEach(function(m,y){var _=vg(m),E=_.indices,S=_.vertices,A=_.normals,M=_.size,O=_.indexes;E.forEach(function(ne){f.push(ne+l)}),h=M;var j=S.length/M;s.sizePerElement=h,s.elements.push({featureIdx:y,vertices:S,normals:A,offset:l}),l+=j;for(var q=function(X){var $=(A==null?void 0:A.slice(X*3,X*3+3))||[],K=S.slice(X*M,X*M+M),ue=0;O&&O[X]!==void 0&&(ue=O[X]),n.forEach(function(de){if(de&&u[de.name]){var pe;(pe=de.buffer.data).push.apply(pe,It(u[de.name](m,y,K,X,$,ue)))}})},Y=0;Y<j;Y++)q(Y)}),v.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return v.stop()}},t)}));return function(r){return e.apply(this,arguments)}}(),QD=function(){var e=Ie(H.mark(function t(r){var n,i,a,o,u,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n=r.descriptors,i=r.features,a=r.enablePicking,o={a_Color:qx,a_Position:Kx,filter:Qx,a_vertexId:Jx,a_PickingColor:function(m){var y=m.id;return a?ss(y):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,l=[],f=3,i.forEach(function(v,m){var y=F5(v),_=y.indices,E=y.vertices,S=y.normals,A=y.size,M=y.indexes;_.forEach(function(Y){l.push(Y+s)}),f=A;var O=E.length/A;u.sizePerElement=f,u.elements.push({featureIdx:m,vertices:E,normals:S,offset:s}),s+=O;for(var j=function(ne){var X=(S==null?void 0:S.slice(ne*3,ne*3+3))||[],$=E.slice(ne*A,ne*A+A),K=0;M&&M[ne]!==void 0&&(K=M[ne]),n.forEach(function(ue){if(ue&&o[ue.name]){var de;(de=ue.buffer.data).push.apply(de,It(o[ue.name](v,m,$,ne,X,K)))}})},q=0;q<O;q++)j(q)}),d.abrupt("return",{descriptors:n,featureLayout:u,indices:l});case 8:case"end":return d.stop()}},t)}));return function(r){return e.apply(this,arguments)}}(),I5={pointFill:KD,line:qD,polygonFill:QD},Lb=be({},I5);function JD(e){return T1.apply(this,arguments)}function T1(){return T1=Ie(H.mark(function e(t){var r,n;return H.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t.workerType,n=t.data,!Lb[r]){a.next=3;break}return a.abrupt("return",Lb[r](n));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(r,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),T1.apply(this,arguments)}yP(JD);var k5=new Map;function eB(e,t){k5.set(e,t)}function tB(e){var t=k5.get(e);return t}var rB=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h={};function p(){}function v(){}function d(){}var y={};c(y,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(k([])));m&&m!==e&&n.call(m,a)&&(y=m);var x=d.prototype=p.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var r;o(this,"_invoke",{value:function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=A(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function A(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,h;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=d,o(x,"constructor",{value:d,configurable:!0}),o(d,"constructor",{value:v,configurable:!0}),v.displayName=c(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.call,L=P&&_.bind.bind(M,M),R=P?L:function(t){return function(){return M.apply(t,arguments)}},C=function(t){return null==t},N=TypeError,D=function(t){if(C(t))throw N("Can't call method on "+t);return t},F=Object,W=function(t){return F(D(t))},z=R({}.hasOwnProperty),B=Object.hasOwn||function(t,e){return z(W(t),e)},U=0,G=Math.random(),H=R(1..toString),V=function(t){return"Symbol("+(void 0===t?"":t)+")_"+H(++U+G,36)},q="object"==typeof document&&document.all,Z={all:q,IS_HTMLDDA:void 0===q&&void 0!==q},Y=Z.all,$=Z.IS_HTMLDDA?function(t){return"function"==typeof t||t===Y}:function(t){return"function"==typeof t},K=function(t){return $(t)?t:void 0},Q=function(t,e){return arguments.length<2?K(O[t]):O[t]&&O[t][e]},X=Q("navigator","userAgent")||"",J=O.process,tt=O.Deno,et=J&&J.versions||tt&&tt.version,rt=et&&et.v8;rt&&(E=(w=rt.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&X&&(!(w=X.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=X.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var nt=E,ot=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),it=ot&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,at=I("wks"),ut=O.Symbol,st=ut&&ut.for,ct=it?ut:ut&&ut.withoutSetter||V,ft=function(t){if(!B(at,t)||!ot&&"string"!=typeof at[t]){var e="Symbol."+t;ot&&B(ut,t)?at[t]=ut[t]:at[t]=it&&st?st(e):ct(e)}return at[t]},lt={};lt[ft("toStringTag")]="z";var ht="[object z]"===String(lt),pt=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),vt=Z.all,dt=Z.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:$(t)||t===vt}:function(t){return"object"==typeof t?null!==t:$(t)},yt=O.document,gt=dt(yt)&&dt(yt.createElement),mt=function(t){return gt?yt.createElement(t):{}},xt=!pt&&!j((function(){return 7!=Object.defineProperty(mt("div"),"a",{get:function(){return 7}}).a})),bt=pt&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),wt=String,Et=TypeError,At=function(t){if(dt(t))return t;throw Et(wt(t)+" is not an object")},Ot=Function.prototype.call,St=P?Ot.bind(Ot):function(){return Ot.apply(Ot,arguments)},Tt=R({}.isPrototypeOf),kt=Object,It=it?function(t){return"symbol"==typeof t}:function(t){var e=Q("Symbol");return $(e)&&Tt(e.prototype,kt(t))},jt=String,Pt=function(t){try{return jt(t)}catch(t){return"Object"}},_t=TypeError,Mt=function(t){if($(t))return t;throw _t(Pt(t)+" is not a function")},Lt=function(t,e){var r=t[e];return C(r)?void 0:Mt(r)},Rt=TypeError,Ct=TypeError,Nt=ft("toPrimitive"),Dt=function(t,e){if(!dt(t)||It(t))return t;var r,n=Lt(t,Nt);if(n){if(void 0===e&&(e="default"),r=St(n,t,e),!dt(r)||It(r))return r;throw Ct("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;if($(r=t.valueOf)&&!dt(n=St(r,t)))return n;if("string"!==e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;throw Rt("Can't convert object to primitive value")}(t,e)},Ft=function(t){var e=Dt(t,"string");return It(e)?e:e+""},Wt=TypeError,zt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,Ut={f:pt?bt?function(t,e,r){if(At(t),e=Ft(e),At(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Bt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return zt(t,e,r)}:zt:function(t,e,r){if(At(t),e=Ft(e),At(r),xt)try{return zt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Wt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Gt=Function.prototype,Ht=pt&&Object.getOwnPropertyDescriptor,Vt=B(Gt,"name"),qt={EXISTS:Vt,PROPER:Vt&&"something"===function(){}.name,CONFIGURABLE:Vt&&(!pt||pt&&Ht(Gt,"name").configurable)},Zt=R(Function.toString);$(k.inspectSource)||(k.inspectSource=function(t){return Zt(t)});var Yt,$t,Kt,Qt=k.inspectSource,Xt=O.WeakMap,Jt=$(Xt)&&/native code/.test(String(Xt)),te=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ee=pt?function(t,e,r){return Ut.f(t,e,te(1,r))}:function(t,e,r){return t[e]=r,t},re=I("keys"),ne=function(t){return re[t]||(re[t]=V(t))},oe={},ie=O.TypeError,ae=O.WeakMap;if(Jt||k.state){var ue=k.state||(k.state=new ae);ue.get=ue.get,ue.has=ue.has,ue.set=ue.set,Yt=function(t,e){if(ue.has(t))throw ie("Object already initialized");return e.facade=t,ue.set(t,e),e},$t=function(t){return ue.get(t)||{}},Kt=function(t){return ue.has(t)}}else{var se=ne("state");oe[se]=!0,Yt=function(t,e){if(B(t,se))throw ie("Object already initialized");return e.facade=t,ee(t,se,e),e},$t=function(t){return B(t,se)?t[se]:{}},Kt=function(t){return B(t,se)}}var ce={set:Yt,get:$t,has:Kt,enforce:function(t){return Kt(t)?$t(t):Yt(t,{})},getterFor:function(t){return function(e){var r;if(!dt(e)||(r=$t(e)).type!==t)throw ie("Incompatible receiver, "+t+" required");return r}}},fe=b((function(t){var e=qt.CONFIGURABLE,r=ce.enforce,n=ce.get,o=Object.defineProperty,i=pt&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!B(t,"name")||e&&t.name!==n)&&(pt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&B(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&B(u,"constructor")&&u.constructor?pt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return B(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return $(this)&&n(this).source||Qt(this)}),"toString")})),le=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if($(r)&&fe(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Ut.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},he=R({}.toString),pe=R("".slice),ve=function(t){return pe(he(t),8,-1)},de=ft("toStringTag"),ye=Object,ge="Arguments"==ve(function(){return arguments}()),me=ht?ve:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ye(t),de))?r:ge?ve(e):"Object"==(n=ve(e))&&$(e.callee)?"Arguments":n},xe=ht?{}.toString:function(){return"[object "+me(this)+"]"};ht||le(Object.prototype,"toString",xe,{unsafe:!0});var be={}.propertyIsEnumerable,we=Object.getOwnPropertyDescriptor,Ee={f:we&&!be.call({1:2},1)?function(t){var e=we(this,t);return!!e&&e.enumerable}:be},Ae=Object,Oe=R("".split),Se=j((function(){return!Ae("z").propertyIsEnumerable(0)}))?function(t){return"String"==ve(t)?Oe(t,""):Ae(t)}:Ae,Te=function(t){return Se(D(t))},ke=Object.getOwnPropertyDescriptor,Ie={f:pt?ke:function(t,e){if(t=Te(t),e=Ft(e),xt)try{return ke(t,e)}catch(t){}if(B(t,e))return te(!St(Ee.f,t,e),t[e])}},je=Math.ceil,Pe=Math.floor,_e=Math.trunc||function(t){var e=+t;return(e>0?Pe:je)(e)},Me=function(t){var e=+t;return e!=e||0===e?0:_e(e)},Le=Math.max,Re=Math.min,Ce=function(t,e){var r=Me(t);return r<0?Le(r+e,0):Re(r,e)},Ne=Math.min,De=function(t){return t>0?Ne(Me(t),9007199254740991):0},Fe=function(t){return De(t.length)},We=function(t){return function(e,r,n){var o,i=Te(e),a=Fe(i),u=Ce(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},ze={includes:We(!0),indexOf:We(!1)},Be=ze.indexOf,Ue=R([].push),Ge=function(t,e){var r,n=Te(t),o=0,i=[];for(r in n)!B(oe,r)&&B(n,r)&&Ue(i,r);for(;e.length>o;)B(n,r=e[o++])&&(~Be(i,r)||Ue(i,r));return i},He=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ve=He.concat("length","prototype"),qe={f:Object.getOwnPropertyNames||function(t){return Ge(t,Ve)}},Ze={f:Object.getOwnPropertySymbols},Ye=R([].concat),$e=Q("Reflect","ownKeys")||function(t){var e=qe.f(At(t)),r=Ze.f;return r?Ye(e,r(t)):e},Ke=function(t,e,r){for(var n=$e(e),o=Ut.f,i=Ie.f,a=0;a<n.length;a++){var u=n[a];B(t,u)||r&&B(r,u)||o(t,u,i(e,u))}},Qe=/#|\\.prototype\\./,Xe=function(t,e){var r=tr[Je(t)];return r==rr||r!=er&&($(e)?j(e):!!e)},Je=Xe.normalize=function(t){return String(t).replace(Qe,".").toLowerCase()},tr=Xe.data={},er=Xe.NATIVE="N",rr=Xe.POLYFILL="P",nr=Xe,or=Ie.f,ir=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=or(r,n))&&a.value:r[n],!nr(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ke(i,o)}(t.sham||o&&o.sham)&&ee(i,"sham",!0),le(r,n,i,t)}},ar="process"==ve(O.process),ur=String,sr=TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=R(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return At(r),function(t){if("object"==typeof t||$(t))return t;throw sr("Can't set "+ur(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),fr=Ut.f,lr=ft("toStringTag"),hr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!B(t,lr)&&fr(t,lr,{configurable:!0,value:e})},pr=ft("species"),vr=function(t){var e=Q(t),r=Ut.f;pt&&e&&!e[pr]&&r(e,pr,{configurable:!0,get:function(){return this}})},dr=TypeError,yr=function(t,e){if(Tt(e,t))return t;throw dr("Incorrect invocation")},gr=function(){},mr=[],xr=Q("Reflect","construct"),br=/^\\s*(?:class|function)\\b/,wr=R(br.exec),Er=!br.exec(gr),Ar=function(t){if(!$(t))return!1;try{return xr(gr,mr,t),!0}catch(t){return!1}},Or=function(t){if(!$(t))return!1;switch(me(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Er||!!wr(br,Qt(t))}catch(t){return!0}};Or.sham=!0;var Sr,Tr,kr,Ir,jr=!xr||j((function(){var t;return Ar(Ar.call)||!Ar(Object)||!Ar((function(){t=!0}))||t}))?Or:Ar,Pr=TypeError,_r=function(t){if(jr(t))return t;throw Pr(Pt(t)+" is not a constructor")},Mr=ft("species"),Lr=function(t,e){var r,n=At(t).constructor;return void 0===n||C(r=At(n)[Mr])?e:_r(r)},Rr=Function.prototype,Cr=Rr.apply,Nr=Rr.call,Dr="object"==typeof Reflect&&Reflect.apply||(P?Nr.bind(Cr):function(){return Nr.apply(Cr,arguments)}),Fr=function(t){if("Function"===ve(t))return R(t)},Wr=Fr(Fr.bind),zr=function(t,e){return Mt(t),void 0===e?t:P?Wr(t,e):function(){return t.apply(e,arguments)}},Br=Q("document","documentElement"),Ur=R([].slice),Gr=TypeError,Hr=function(t,e){if(t<e)throw Gr("Not enough arguments");return t},Vr=/(?:ipad|iphone|ipod).*applewebkit/i.test(X),qr=O.setImmediate,Zr=O.clearImmediate,Yr=O.process,$r=O.Dispatch,Kr=O.Function,Qr=O.MessageChannel,Xr=O.String,Jr=0,tn={};try{Sr=O.location}catch(t){}var en=function(t){if(B(tn,t)){var e=tn[t];delete tn[t],e()}},rn=function(t){return function(){en(t)}},nn=function(t){en(t.data)},on=function(t){O.postMessage(Xr(t),Sr.protocol+"//"+Sr.host)};qr&&Zr||(qr=function(t){Hr(arguments.length,1);var e=$(t)?t:Kr(t),r=Ur(arguments,1);return tn[++Jr]=function(){Dr(e,void 0,r)},Tr(Jr),Jr},Zr=function(t){delete tn[t]},ar?Tr=function(t){Yr.nextTick(rn(t))}:$r&&$r.now?Tr=function(t){$r.now(rn(t))}:Qr&&!Vr?(Ir=(kr=new Qr).port2,kr.port1.onmessage=nn,Tr=zr(Ir.postMessage,Ir)):O.addEventListener&&$(O.postMessage)&&!O.importScripts&&Sr&&"file:"!==Sr.protocol&&!j(on)?(Tr=on,O.addEventListener("message",nn,!1)):Tr="onreadystatechange"in mt("script")?function(t){Br.appendChild(mt("script")).onreadystatechange=function(){Br.removeChild(this),en(t)}}:function(t){setTimeout(rn(t),0)});var an,un,sn,cn,fn,ln,hn,pn,vn={set:qr,clear:Zr},dn=/ipad|iphone|ipod/i.test(X)&&void 0!==O.Pebble,yn=/web0s(?!.*chrome)/i.test(X),gn=Ie.f,mn=vn.set,xn=O.MutationObserver||O.WebKitMutationObserver,bn=O.document,wn=O.process,En=O.Promise,An=gn(O,"queueMicrotask"),On=An&&An.value;On||(an=function(){var t,e;for(ar&&(t=wn.domain)&&t.exit();un;){e=un.fn,un=un.next;try{e()}catch(t){throw un?cn():sn=void 0,t}}sn=void 0,t&&t.enter()},Vr||ar||yn||!xn||!bn?!dn&&En&&En.resolve?((hn=En.resolve(void 0)).constructor=En,pn=zr(hn.then,hn),cn=function(){pn(an)}):ar?cn=function(){wn.nextTick(an)}:(mn=zr(mn,O),cn=function(){mn(an)}):(fn=!0,ln=bn.createTextNode(""),new xn(an).observe(ln,{characterData:!0}),cn=function(){ln.data=fn=!fn}));var Sn=On||function(t){var e={fn:t,next:void 0};sn&&(sn.next=e),un||(un=e,cn()),sn=e},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},kn=function(){this.head=null,this.tail=null};kn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var In,jn,Pn,_n=kn,Mn=O.Promise,Ln="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Rn=!Ln&&!ar&&"object"==typeof window&&"object"==typeof document,Cn=(Mn&&Mn.prototype,ft("species")),Nn=!1,Dn=$(O.PromiseRejectionEvent),Fn={CONSTRUCTOR:nr("Promise",(function(){var t=Qt(Mn),e=t!==String(Mn);if(!e&&66===nt)return!0;if(!nt||nt<51||!/native code/.test(t)){var r=new Mn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Cn]=n,!(Nn=r.then((function(){}))instanceof n))return!0}return!e&&(Rn||Ln)&&!Dn})),REJECTION_EVENT:Dn,SUBCLASSING:Nn},Wn=TypeError,zn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw Wn("Bad Promise constructor");e=t,r=n})),this.resolve=Mt(e),this.reject=Mt(r)},Bn={f:function(t){return new zn(t)}},Un=vn.set,Gn=Fn.CONSTRUCTOR,Hn=Fn.REJECTION_EVENT,Vn=Fn.SUBCLASSING,qn=ce.getterFor("Promise"),Zn=ce.set,Yn=Mn&&Mn.prototype,$n=Mn,Kn=Yn,Qn=O.TypeError,Xn=O.document,Jn=O.process,to=Bn.f,eo=to,ro=!!(Xn&&Xn.createEvent&&O.dispatchEvent),no=function(t){var e;return!(!dt(t)||!$(e=t.then))&&e},oo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&co(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Qn("Promise-chain cycle")):(n=no(r))?St(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},io=function(t,e){t.notified||(t.notified=!0,Sn((function(){for(var r,n=t.reactions;r=n.get();)oo(r,t);t.notified=!1,e&&!t.rejection&&uo(t)})))},ao=function(t,e,r){var n,o;ro?((n=Xn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Hn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},uo=function(t){St(Un,O,(function(){var e,r=t.facade,n=t.value;if(so(t)&&(e=Tn((function(){ar?Jn.emit("unhandledRejection",n,r):ao("unhandledrejection",r,n)})),t.rejection=ar||so(t)?2:1,e.error))throw e.value}))},so=function(t){return 1!==t.rejection&&!t.parent},co=function(t){St(Un,O,(function(){var e=t.facade;ar?Jn.emit("rejectionHandled",e):ao("rejectionhandled",e,t.value)}))},fo=function(t,e,r){return function(n){t(e,n,r)}},lo=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,io(t,!0))},ho=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Qn("Promise can't be resolved itself");var n=no(e);n?Sn((function(){var r={done:!1};try{St(n,e,fo(ho,r,t),fo(lo,r,t))}catch(e){lo(r,e,t)}})):(t.value=e,t.state=1,io(t,!1))}catch(e){lo({done:!1},e,t)}}};if(Gn&&(Kn=($n=function(t){yr(this,Kn),Mt(t),St(In,this);var e=qn(this);try{t(fo(ho,e),fo(lo,e))}catch(t){lo(e,t)}}).prototype,(In=function(t){Zn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new _n,rejection:!1,state:0,value:void 0})}).prototype=le(Kn,"then",(function(t,e){var r=qn(this),n=to(Lr(this,$n));return r.parent=!0,n.ok=!$(t)||t,n.fail=$(e)&&e,n.domain=ar?Jn.domain:void 0,0==r.state?r.reactions.add(n):Sn((function(){oo(n,r)})),n.promise})),jn=function(){var t=new In,e=qn(t);this.promise=t,this.resolve=fo(ho,e),this.reject=fo(lo,e)},Bn.f=to=function(t){return t===$n||void 0===t?new jn(t):eo(t)},$(Mn)&&Yn!==Object.prototype)){Pn=Yn.then,Vn||le(Yn,"then",(function(t,e){var r=this;return new $n((function(t,e){St(Pn,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yn.constructor}catch(t){}cr&&cr(Yn,Kn)}ir({global:!0,constructor:!0,wrap:!0,forced:Gn},{Promise:$n}),hr($n,"Promise",!1),vr("Promise");var po={},vo=ft("iterator"),yo=Array.prototype,go=function(t){return void 0!==t&&(po.Array===t||yo[vo]===t)},mo=ft("iterator"),xo=function(t){if(!C(t))return Lt(t,mo)||Lt(t,"@@iterator")||po[me(t)]},bo=TypeError,wo=function(t,e){var r=arguments.length<2?xo(t):e;if(Mt(r))return At(St(r,t));throw bo(Pt(t)+" is not iterable")},Eo=function(t,e,r){var n,o;At(t);try{if(!(n=Lt(t,"return"))){if("throw"===e)throw r;return r}n=St(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return At(n),r},Ao=TypeError,Oo=function(t,e){this.stopped=t,this.result=e},So=Oo.prototype,To=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=zr(e,f),y=function(t){return n&&Eo(n,"normal",t),new Oo(!0,t)},g=function(t){return l?(At(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Ao(Pt(t)+" is not iterable");if(go(o)){for(i=0,a=Fe(t);a>i;i++)if((u=g(t[i]))&&Tt(So,u))return u;return new Oo(!1)}n=wo(t,o)}for(s=h?t.next:n.next;!(c=St(s,n)).done;){try{u=g(c.value)}catch(t){Eo(n,"throw",t)}if("object"==typeof u&&u&&Tt(So,u))return u}return new Oo(!1)},ko=ft("iterator"),Io=!1;try{var jo=0,Po={next:function(){return{done:!!jo++}},return:function(){Io=!0}};Po[ko]=function(){return this},Array.from(Po,(function(){throw 2}))}catch(t){}var _o=function(t,e){if(!e&&!Io)return!1;var r=!1;try{var n={};n[ko]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Mo=Fn.CONSTRUCTOR||!_o((function(t){Mn.all(t).then(void 0,(function(){}))}));ir({target:"Promise",stat:!0,forced:Mo},{all:function(t){var e=this,r=Bn.f(e),n=r.resolve,o=r.reject,i=Tn((function(){var r=Mt(e.resolve),i=[],a=0,u=1;To(t,(function(t){var s=a++,c=!1;u++,St(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Lo=Fn.CONSTRUCTOR,Ro=Mn&&Mn.prototype;if(ir({target:"Promise",proto:!0,forced:Lo,real:!0},{catch:function(t){return this.then(void 0,t)}}),$(Mn)){var Co=Q("Promise").prototype.catch;Ro.catch!==Co&&le(Ro,"catch",Co,{unsafe:!0})}ir({target:"Promise",stat:!0,forced:Mo},{race:function(t){var e=this,r=Bn.f(e),n=r.reject,o=Tn((function(){var o=Mt(e.resolve);To(t,(function(t){St(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ir({target:"Promise",stat:!0,forced:Fn.CONSTRUCTOR},{reject:function(t){var e=Bn.f(this);return St(e.reject,void 0,t),e.promise}});var No=Fn.CONSTRUCTOR;Q("Promise");function Do(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ir({target:"Promise",stat:!0,forced:No},{resolve:function(t){return function(t,e){if(At(t),dt(e)&&e.constructor===t)return e;var r=Bn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Fo="undefined"!=typeof window&&void 0!==window.orientation,Wo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),zo=new Map;function Bo(t){Do(t.source&&!t.url||!t.source&&t.url);var e=zo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Uo((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),zo.set(t.url,e)),t.source&&(e=Uo(t.source),zo.set(t.source,e))),Do(e),e}function Uo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Go(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Ho(t))n.add(t);else if(Ho(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Go(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Ho(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Vo=function(){},qo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Do(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Vo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Vo,this.onError=Vo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Go(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Bo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Zo=self&&self.__assign||function(){return(Zo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},$o=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ko=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Zo(Zo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),Yo(this,void 0,void 0,(function(){var n,o=this;return $o(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return Yo(this,void 0,void 0,(function(){var t,e,r;return $o(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new Wo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Fo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Qo=self&&self.__assign||function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jo={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ti=(function(){function t(t){this.workerPools=new Map,this.props=Qo({},Jo),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return qo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Xo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Qo(Qo({},this.props),t);try{for(var n=Xo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Ko({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ei=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ti.get(t);e||(e=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ti.get(t);ti.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Go(e);self.postMessage(r,n)}},t}();function ri(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ni,oi,ii=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ai=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},ui=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},si=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ci=0;function fi(t,e){var r=this;if("undefined"!=typeof self){var n={process:li};ei.onmessage=function(o,i){return ai(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return ui(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ei.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ni=new ii,oi=i.options||{},a=e(ni,oi,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=si(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ei.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ei.postMessage("done",{}),[3,18];case 16:return ni.push(i.input),[3,18];case 17:return ni.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ei.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function li(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ci++,i=function(t,e){if(e.id===o)switch(t){case"done":ei.removeEventListener(i),r(e.result);break;case"error":ei.removeEventListener(i),n(e.error)}};ei.addEventListener(i);var a={id:o,input:t,options:e};ei.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var hi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pi=mt("span").classList,vi=pi&&pi.constructor&&pi.constructor.prototype,di=vi===Object.prototype?void 0:vi,yi=Array.isArray||function(t){return"Array"==ve(t)},gi=ft("species"),mi=Array,xi=function(t,e){return new(function(t){var e;return yi(t)&&(e=t.constructor,(jr(e)&&(e===mi||yi(e.prototype))||dt(e)&&null===(e=e[gi]))&&(e=void 0)),void 0===e?mi:e}(t))(0===e?0:e)},bi=R([].push),wi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=W(s),d=Se(v),y=zr(c,f),g=Fe(d),m=0,x=l||xi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:bi(b,h)}else switch(t){case 4:return!1;case 7:bi(b,h)}return i?-1:n||o?o:b}},Ei={forEach:wi(0),map:wi(1),filter:wi(2),some:wi(3),every:wi(4),find:wi(5),findIndex:wi(6),filterReject:wi(7)},Ai=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},Oi=Ei.forEach,Si=Ai("forEach")?[].forEach:function(t){return Oi(this,t,arguments.length>1?arguments[1]:void 0)},Ti=function(t){if(t&&t.forEach!==Si)try{ee(t,"forEach",Si)}catch(e){t.forEach=Si}};for(var ki in hi)hi[ki]&&Ti(O[ki]&&O[ki].prototype);Ti(di);var Ii=function(t,e,r){var n=Ft(e);n in t?Ut.f(t,n,te(0,r)):t[n]=r},ji=ft("species"),Pi=function(t){return nt>=51||!j((function(){var e=[];return(e.constructor={})[ji]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},_i=Pi("slice"),Mi=ft("species"),Li=Array,Ri=Math.max;ir({target:"Array",proto:!0,forced:!_i},{slice:function(t,e){var r,n,o,i=Te(this),a=Fe(i),u=Ce(t,a),s=Ce(void 0===e?a:e,a);if(yi(i)&&(r=i.constructor,(jr(r)&&(r===Li||yi(r.prototype))||dt(r)&&null===(r=r[Mi]))&&(r=void 0),r===Li||void 0===r))return Ur(i,u,s);for(n=new(void 0===r?Li:r)(Ri(s-u,0)),o=0;u<s;u++,o++)u in i&&Ii(n,o,i[u]);return n.length=o,n}});var Ci=qt.EXISTS,Ni=Ut.f,Di=Function.prototype,Fi=R(Di.toString),Wi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,zi=R(Wi.exec);pt&&!Ci&&Ni(Di,"name",{configurable:!0,get:function(){try{return zi(Wi,Fi(this))[1]}catch(t){return""}}});var Bi=Ei.map,Ui=Pi("map");ir({target:"Array",proto:!0,forced:!Ui},{map:function(t){return Bi(this,t,arguments.length>1?arguments[1]:void 0)}});var Gi,Hi=Object.keys||function(t){return Ge(t,He)},Vi={f:pt&&!bt?Object.defineProperties:function(t,e){At(t);for(var r,n=Te(e),o=Hi(e),i=o.length,a=0;i>a;)Ut.f(t,r=o[a++],n[r]);return t}},qi=ne("IE_PROTO"),Zi=function(){},Yi=function(t){return"<script>"+t+"<\\/script>"},$i=function(t){t.write(Yi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ki=function(){try{Gi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ki="undefined"!=typeof document?document.domain&&Gi?$i(Gi):((e=mt("iframe")).style.display="none",Br.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Yi("document.F=Object")),t.close(),t.F):$i(Gi);for(var r=He.length;r--;)delete Ki.prototype[He[r]];return Ki()};oe[qi]=!0;var Qi=Object.create||function(t,e){var r;return null!==t?(Zi.prototype=At(t),r=new Zi,Zi.prototype=null,r[qi]=t):r=Ki(),void 0===e?r:Vi.f(r,e)},Xi=Ut.f,Ji=ft("unscopables"),ta=Array.prototype;null==ta[Ji]&&Xi(ta,Ji,{configurable:!0,value:Qi(null)});var ea,ra,na,oa=function(t){ta[Ji][t]=!0},ia=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=ne("IE_PROTO"),ua=Object,sa=ua.prototype,ca=ia?ua.getPrototypeOf:function(t){var e=W(t);if(B(e,aa))return e[aa];var r=e.constructor;return $(r)&&e instanceof r?r.prototype:e instanceof ua?sa:null},fa=ft("iterator"),la=!1;[].keys&&("next"in(na=[].keys())?(ra=ca(ca(na)))!==Object.prototype&&(ea=ra):la=!0),(!dt(ea)||j((function(){var t={};return ea[fa].call(t)!==t})))&&(ea={}),$(ea[fa])||le(ea,fa,(function(){return this}));var ha={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:la},pa=ha.IteratorPrototype,va=function(){return this},da=qt.PROPER,ya=qt.CONFIGURABLE,ga=ha.IteratorPrototype,ma=ha.BUGGY_SAFARI_ITERATORS,xa=ft("iterator"),ba=function(){return this},wa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Qi(pa,{next:te(+!n,r)}),hr(t,o,!1),po[o]=va}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ma&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[xa]||p["@@iterator"]||o&&p[o],d=!ma&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=ca(y.call(new t)))!==Object.prototype&&u.next&&(ca(u)!==ga&&(cr?cr(u,ga):$(u[xa])||le(u,xa,ba)),hr(u,l,!0)),da&&"values"==o&&v&&"values"!==v.name&&(ya?ee(p,"name","values"):(h=!0,d=function(){return St(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ma||h||!(c in p))&&le(p,c,s[c]);else ir({target:e,proto:!0,forced:ma||h},s);return p[xa]!==d&&le(p,xa,d,{name:o}),po[e]=d,s},Ea=function(t,e){return{value:t,done:e}},Aa=Ut.f,Oa=ce.set,Sa=ce.getterFor("Array Iterator"),Ta=wa(Array,"Array",(function(t,e){Oa(this,{type:"Array Iterator",target:Te(t),index:0,kind:e})}),(function(){var t=Sa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Ea(void 0,!0)):Ea("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),ka=po.Arguments=po.Array;if(oa("keys"),oa("values"),oa("entries"),pt&&"values"!==ka.name)try{Aa(ka,"name",{value:"values"})}catch(t){}var Ia,ja,Pa,_a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ma=Ut.f,La=ce.enforce,Ra=ce.get,Ca=O.Int8Array,Na=Ca&&Ca.prototype,Da=O.Uint8ClampedArray,Fa=Da&&Da.prototype,Wa=Ca&&ca(Ca),za=Na&&ca(Na),Ba=Object.prototype,Ua=O.TypeError,Ga=ft("toStringTag"),Ha=V("TYPED_ARRAY_TAG"),Va=_a&&!!cr&&"Opera"!==me(O.opera),qa=!1,Za={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ya={BigInt64Array:8,BigUint64Array:8},$a=function(t){var e=ca(t);if(dt(e)){var r=Ra(e);return r&&B(r,"TypedArrayConstructor")?r.TypedArrayConstructor:$a(e)}},Ka=function(t){if(!dt(t))return!1;var e=me(t);return B(Za,e)||B(Ya,e)};for(Ia in Za)(Pa=(ja=O[Ia])&&ja.prototype)?La(Pa).TypedArrayConstructor=ja:Va=!1;for(Ia in Ya)(Pa=(ja=O[Ia])&&ja.prototype)&&(La(Pa).TypedArrayConstructor=ja);if((!Va||!$(Wa)||Wa===Function.prototype)&&(Wa=function(){throw Ua("Incorrect invocation")},Va))for(Ia in Za)O[Ia]&&cr(O[Ia],Wa);if((!Va||!za||za===Ba)&&(za=Wa.prototype,Va))for(Ia in Za)O[Ia]&&cr(O[Ia].prototype,za);if(Va&&ca(Fa)!==za&&cr(Fa,za),pt&&!B(za,Ga))for(Ia in qa=!0,Ma(za,Ga,{get:function(){return dt(this)?this[Ha]:void 0}}),Za)O[Ia]&&ee(O[Ia],Ha,Ia);var Qa={NATIVE_ARRAY_BUFFER_VIEWS:Va,TYPED_ARRAY_TAG:qa&&Ha,aTypedArray:function(t){if(Ka(t))return t;throw Ua("Target is not a typed array")},aTypedArrayConstructor:function(t){if($(t)&&(!cr||Tt(Wa,t)))return t;throw Ua(Pt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(pt){if(r)for(var o in Za){var i=O[o];if(i&&B(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}za[t]&&!r||le(za,t,r?e:Va&&Na[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(pt){if(cr){if(r)for(n in Za)if((o=O[n])&&B(o,t))try{delete o[t]}catch(t){}if(Wa[t]&&!r)return;try{return le(Wa,t,r?e:Va&&Wa[t]||e)}catch(t){}}for(n in Za)!(o=O[n])||o[t]&&!r||le(o,t,e)}},getTypedArrayConstructor:$a,isView:function(t){if(!dt(t))return!1;var e=me(t);return"DataView"===e||B(Za,e)||B(Ya,e)},isTypedArray:Ka,TypedArray:Wa,TypedArrayPrototype:za},Xa=Qa.NATIVE_ARRAY_BUFFER_VIEWS,Ja=O.ArrayBuffer,tu=O.Int8Array,eu=!Xa||!j((function(){tu(1)}))||!j((function(){new tu(-1)}))||!_o((function(t){new tu,new tu(null),new tu(1.5),new tu(t)}),!0)||j((function(){return 1!==new tu(new Ja(2),1,void 0).length})),ru=function(t,e,r){for(var n in e)le(t,n,e[n],r);return t},nu=RangeError,ou=function(t){if(void 0===t)return 0;var e=Me(t),r=De(e);if(e!==r)throw nu("Wrong length or index");return r},iu=Array,au=Math.abs,uu=Math.pow,su=Math.floor,cu=Math.log,fu=Math.LN2,lu=function(t,e,r){var n,o,i,a=iu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?uu(2,-24)-uu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=au(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=su(cu(t)/fu),t*(i=uu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*uu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*uu(2,e),n+=c):(o=t*uu(2,c-1)*uu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},hu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=uu(2,e),f-=a}return(c?-1:1)*r*uu(2,f-e)},pu=function(t){for(var e=W(this),r=Fe(e),n=arguments.length,o=Ce(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ce(i,r);a>o;)e[o++]=t;return e},vu=Array,du=Math.max,yu=function(t,e,r){for(var n=Fe(t),o=Ce(e,n),i=Ce(void 0===r?n:r,n),a=vu(du(i-o,0)),u=0;o<i;o++,u++)Ii(a,u,t[o]);return a.length=u,a},gu=qe.f,mu=Ut.f,xu=qt.PROPER,bu=qt.CONFIGURABLE,wu=ce.get,Eu=ce.set,Au=O.ArrayBuffer,Ou=Au,Su=Ou&&Ou.prototype,Tu=O.DataView,ku=Tu&&Tu.prototype,Iu=Object.prototype,ju=O.Array,Pu=O.RangeError,_u=R(pu),Mu=R([].reverse),Lu=lu,Ru=hu,Cu=function(t){return[255&t]},Nu=function(t){return[255&t,t>>8&255]},Du=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Fu=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Wu=function(t){return Lu(t,23,4)},zu=function(t){return Lu(t,52,8)},Bu=function(t,e){mu(t.prototype,e,{get:function(){return wu(this)[e]}})},Uu=function(t,e,r,n){var o=ou(r),i=wu(t);if(o+e>i.byteLength)throw Pu("Wrong index");var a=wu(i.buffer).bytes,u=o+i.byteOffset,s=yu(a,u,u+e);return n?s:Mu(s)},Gu=function(t,e,r,n,o,i){var a=ou(r),u=wu(t);if(a+e>u.byteLength)throw Pu("Wrong index");for(var s=wu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(_a){var Hu=xu&&"ArrayBuffer"!==Au.name;if(j((function(){Au(1)}))&&j((function(){new Au(-1)}))&&!j((function(){return new Au,new Au(1.5),new Au(NaN),1!=Au.length||Hu&&!bu})))Hu&&bu&&ee(Au,"name","ArrayBuffer");else{(Ou=function(t){return yr(this,Su),new Au(ou(t))}).prototype=Su;for(var Vu,qu=gu(Au),Zu=0;qu.length>Zu;)(Vu=qu[Zu++])in Ou||ee(Ou,Vu,Au[Vu]);Su.constructor=Ou}cr&&ca(ku)!==Iu&&cr(ku,Iu);var Yu=new Tu(new Ou(2)),$u=R(ku.setInt8);Yu.setInt8(0,2147483648),Yu.setInt8(1,2147483649),!Yu.getInt8(0)&&Yu.getInt8(1)||ru(ku,{setInt8:function(t,e){$u(this,t,e<<24>>24)},setUint8:function(t,e){$u(this,t,e<<24>>24)}},{unsafe:!0})}else Su=(Ou=function(t){yr(this,Su);var e=ou(t);Eu(this,{bytes:_u(ju(e),0),byteLength:e}),pt||(this.byteLength=e)}).prototype,ku=(Tu=function(t,e,r){yr(this,ku),yr(t,Su);var n=wu(t).byteLength,o=Me(e);if(o<0||o>n)throw Pu("Wrong offset");if(o+(r=void 0===r?n-o:De(r))>n)throw Pu("Wrong length");Eu(this,{buffer:t,byteLength:r,byteOffset:o}),pt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,pt&&(Bu(Ou,"byteLength"),Bu(Tu,"buffer"),Bu(Tu,"byteLength"),Bu(Tu,"byteOffset")),ru(ku,{getInt8:function(t){return Uu(this,1,t)[0]<<24>>24},getUint8:function(t){return Uu(this,1,t)[0]},getInt16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Ru(Uu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Ru(Uu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Gu(this,1,t,Cu,e)},setUint8:function(t,e){Gu(this,1,t,Cu,e)},setInt16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Gu(this,4,t,Wu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Gu(this,8,t,zu,e,arguments.length>2?arguments[2]:void 0)}});hr(Ou,"ArrayBuffer"),hr(Tu,"DataView");var Ku={ArrayBuffer:Ou,DataView:Tu},Qu=Math.floor,Xu=Number.isInteger||function(t){return!dt(t)&&isFinite(t)&&Qu(t)===t},Ju=RangeError,ts=RangeError,es=function(t,e){var r=function(t){var e=Me(t);if(e<0)throw Ju("The argument can't be less than 0");return e}(t);if(r%e)throw ts("Wrong offset");return r},rs=R("".slice),ns=function(t){return"Big"===rs(me(t),0,3)},os=TypeError,is=function(t){var e=Dt(t,"number");if("number"==typeof e)throw os("Can't convert number to bigint");return BigInt(e)},as=Qa.aTypedArrayConstructor,us=function(t){var e,r,n,o,i,a,u,s,c=_r(this),f=W(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!go(v))for(s=(u=wo(f,v)).next,f=[];!(a=St(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=zr(h,arguments[2])),r=Fe(f),n=new(as(c))(r),o=ns(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?is(i):+i;return n},ss=function(t,e,r){var n,o;return cr&&$(n=e.constructor)&&n!==r&&dt(o=n.prototype)&&o!==r.prototype&&cr(t,o),t},cs=b((function(t){var e=qe.f,r=Ei.forEach,n=ce.get,o=ce.set,i=ce.enforce,a=Ut.f,u=Ie.f,s=Math.round,c=O.RangeError,f=Ku.ArrayBuffer,l=f.prototype,h=Ku.DataView,p=Qa.NATIVE_ARRAY_BUFFER_VIEWS,v=Qa.TYPED_ARRAY_TAG,d=Qa.TypedArray,y=Qa.TypedArrayPrototype,g=Qa.aTypedArrayConstructor,m=Qa.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Tt(l,t)||"ArrayBuffer"==(e=me(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!It(e)&&e in t&&Xu(+e)&&e>=0},A=function(t,e){return e=Ft(e),E(t,e)?te(2,t[e]):u(t,e)},S=function(t,e,r){return e=Ft(e),!(E(t,e)&&dt(r)&&B(r,"value"))||B(r,"get")||B(r,"set")||r.configurable||B(r,"writable")&&!r.writable||B(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};pt?(p||(Ie.f=A,Ut.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),ir({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?eu&&(T=u((function(t,e,r,n){return yr(t,k),ss(dt(e)?w(e)?void 0!==n?new S(e,es(r,g),n):void 0!==r?new S(e,es(r,g)):new S(e):m(e)?x(T,e):St(us,T,e):new S(ou(e)),t,T)})),cr&&cr(T,d),r(e(S),(function(t){t in T||ee(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){yr(t,k);var i,a,u,s=0,l=0;if(dt(e)){if(!w(e))return m(e)?x(T,e):St(us,T,e);i=e,l=es(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=De(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=ou(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),cr&&cr(T,d),k=T.prototype=Qi(y)),k.constructor!==T&&ee(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&ee(k,v,b);var P=T!=S;I[b]=T,ir({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||ee(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||ee(k,"BYTES_PER_ELEMENT",g),vr(b)}):t.exports=function(){}}));cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var fs=TypeError,ls=function(t,e){if(!delete t[e])throw fs("Cannot delete property "+Pt(e)+" of "+Pt(t))},hs=Math.min,ps=R([].copyWithin||function(t,e){var r=W(this),n=Fe(r),o=Ce(t,n),i=Ce(e,n),a=arguments.length>2?arguments[2]:void 0,u=hs((void 0===a?n:Ce(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ls(r,o),o+=s,i+=s;return r}),vs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("copyWithin",(function(t,e){return ps(vs(this),t,e,arguments.length>2?arguments[2]:void 0)}));var ds=Ei.every,ys=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("every",(function(t){return ds(ys(this),t,arguments.length>1?arguments[1]:void 0)}));var gs=Qa.aTypedArray,ms=Qa.exportTypedArrayMethod,xs=R("".slice);ms("fill",(function(t){var e=arguments.length;gs(this);var r="Big"===xs(me(this),0,3)?is(t):+t;return St(pu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Qa.aTypedArrayConstructor,ws=Qa.getTypedArrayConstructor,Es=function(t){return bs(Lr(t,ws(t)))},As=function(t,e){return function(t,e){for(var r=0,n=Fe(e),o=new t(n);n>r;)o[r]=e[r++];return o}(Es(t),e)},Os=Ei.filter,Ss=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("filter",(function(t){var e=Os(Ss(this),t,arguments.length>1?arguments[1]:void 0);return As(this,e)}));var Ts=Ei.find,ks=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("find",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=Ei.findIndex,js=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("findIndex",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=Ei.forEach,_s=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("forEach",(function(t){Ps(_s(this),t,arguments.length>1?arguments[1]:void 0)}));var Ms=ze.includes,Ls=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("includes",(function(t){return Ms(Ls(this),t,arguments.length>1?arguments[1]:void 0)}));var Rs=ze.indexOf,Cs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("indexOf",(function(t){return Rs(Cs(this),t,arguments.length>1?arguments[1]:void 0)}));var Ns=ft("iterator"),Ds=O.Uint8Array,Fs=R(Ta.values),Ws=R(Ta.keys),zs=R(Ta.entries),Bs=Qa.aTypedArray,Us=Qa.exportTypedArrayMethod,Gs=Ds&&Ds.prototype,Hs=!j((function(){Gs[Ns].call([1])})),Vs=!!Gs&&Gs.values&&Gs[Ns]===Gs.values&&"values"===Gs.values.name,qs=function(){return Fs(Bs(this))};Us("entries",(function(){return zs(Bs(this))}),Hs),Us("keys",(function(){return Ws(Bs(this))}),Hs),Us("values",qs,Hs||!Vs,{name:"values"}),Us(Ns,qs,Hs||!Vs,{name:"values"});var Zs=Qa.aTypedArray,Ys=Qa.exportTypedArrayMethod,$s=R([].join);Ys("join",(function(t){return $s(Zs(this),t)}));var Ks=Math.min,Qs=[].lastIndexOf,Xs=!!Qs&&1/[1].lastIndexOf(1,-0)<0,Js=Ai("lastIndexOf"),tc=Xs||!Js?function(t){if(Xs)return Dr(Qs,this,arguments)||0;var e=Te(this),r=Fe(e),n=r-1;for(arguments.length>1&&(n=Ks(n,Me(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Qs,ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Dr(tc,ec(this),e>1?[t,arguments[1]]:[t])}));var rc=Ei.map,nc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("map",(function(t){return rc(nc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(Es(t))(e)}))}));var oc=TypeError,ic=function(t){return function(e,r,n,o){Mt(r);var i=W(e),a=Se(i),u=Fe(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw oc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ac={left:ic(!1),right:ic(!0)},uc=ac.left,sc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return uc(sc(this),t,e,e>1?arguments[1]:void 0)}));var cc=ac.right,fc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return cc(fc(this),t,e,e>1?arguments[1]:void 0)}));var lc=Qa.aTypedArray,hc=Qa.exportTypedArrayMethod,pc=Math.floor;hc("reverse",(function(){for(var t,e=lc(this).length,r=pc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var vc=O.RangeError,dc=O.Int8Array,yc=dc&&dc.prototype,gc=yc&&yc.set,mc=Qa.aTypedArray,xc=Qa.exportTypedArrayMethod,bc=!j((function(){var t=new Uint8ClampedArray(2);return St(gc,t,{length:1,0:3},1),3!==t[1]})),wc=bc&&Qa.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new dc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));xc("set",(function(t){mc(this);var e=es(arguments.length>1?arguments[1]:void 0,1),r=W(t);if(bc)return St(gc,this,r,e);var n=this.length,o=Fe(r),i=0;if(o+e>n)throw vc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||wc);var Ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Ur(Ec(this),t,e),n=Es(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var Ac=Ei.some,Oc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("some",(function(t){return Ac(Oc(this),t,arguments.length>1?arguments[1]:void 0)}));var Sc=Math.floor,Tc=function(t,e){var r=t.length,n=Sc(r/2);return r<8?kc(t,e):Ic(t,Tc(yu(t,0,n),e),Tc(yu(t,n),e),e)},kc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ic=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},jc=Tc,Pc=X.match(/firefox\\/(\\d+)/i),_c=!!Pc&&+Pc[1],Mc=/MSIE|Trident/.test(X),Lc=X.match(/AppleWebKit\\/(\\d+)\\./),Rc=!!Lc&&+Lc[1],Cc=Qa.aTypedArray,Nc=Qa.exportTypedArrayMethod,Dc=O.Uint16Array,Fc=Dc&&Fr(Dc.prototype.sort),Wc=!(!Fc||j((function(){Fc(new Dc(2),null)}))&&j((function(){Fc(new Dc(2),{})}))),zc=!!Fc&&!j((function(){if(nt)return nt<74;if(_c)return _c<67;if(Mc)return!0;if(Rc)return Rc<602;var t,e,r=new Dc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Fc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Nc("sort",(function(t){return void 0!==t&&Mt(t),zc?Fc(this,t):jc(Cc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!zc||Wc);var Bc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("subarray",(function(t,e){var r=Bc(this),n=r.length,o=Ce(t,n);return new(Es(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,De((void 0===e?n:Ce(e,n))-o))}));var Uc=O.Int8Array,Gc=Qa.aTypedArray,Hc=Qa.exportTypedArrayMethod,Vc=[].toLocaleString,qc=!!Uc&&j((function(){Vc.call(new Uc(1))}));Hc("toLocaleString",(function(){return Dr(Vc,qc?Ur(Gc(this)):Gc(this),Ur(arguments))}),j((function(){return[1,2].toLocaleString()!=new Uc([1,2]).toLocaleString()}))||!j((function(){Uc.prototype.toLocaleString.call([1,2])})));var Zc=Qa.exportTypedArrayMethod,Yc=O.Uint8Array,$c=Yc&&Yc.prototype||{},Kc=[].toString,Qc=R([].join);j((function(){Kc.call({})}))&&(Kc=function(){return Qc(this)});var Xc=$c.toString!=Kc;Zc("toString",Kc,Xc);var Jc,tf,ef=String,rf=function(t){if("Symbol"===me(t))throw TypeError("Cannot convert a Symbol value to a string");return ef(t)},nf=function(){var t=At(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},of=O.RegExp,af=j((function(){var t=of("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),uf=af||j((function(){return!of("a","y").sticky})),sf={BROKEN_CARET:af||j((function(){var t=of("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:uf,UNSUPPORTED_Y:af},cf=O.RegExp,ff=j((function(){var t=cf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),lf=O.RegExp,hf=j((function(){var t=lf("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),pf=ce.get,vf=I("native-string-replace",String.prototype.replace),df=RegExp.prototype.exec,yf=df,gf=R("".charAt),mf=R("".indexOf),xf=R("".replace),bf=R("".slice),wf=(tf=/b*/g,St(df,Jc=/a/,"a"),St(df,tf,"a"),0!==Jc.lastIndex||0!==tf.lastIndex),Ef=sf.BROKEN_CARET,Af=void 0!==/()??/.exec("")[1];(wf||Af||Ef||ff||hf)&&(yf=function(t){var e,r,n,o,i,a,u,s=this,c=pf(s),f=rf(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=St(yf,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=Ef&&s.sticky,v=St(nf,s),d=s.source,y=0,g=f;if(p&&(v=xf(v,"y",""),-1===mf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==gf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Af&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),wf&&(n=s.lastIndex),o=St(df,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:wf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Af&&o&&o.length>1&&St(vf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Qi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Of=yf;ir({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Sf,Tf=ft("species"),kf=RegExp.prototype,If=function(t,e,r,n){var o=ft(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Tf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=Fr(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=Fr(t),s=e.exec;return s===Of||s===kf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));le(String.prototype,t,s[0]),le(kf,o,s[1])}n&&ee(kf[o],"sham",!0)},jf=R("".charAt),Pf=R("".charCodeAt),_f=R("".slice),Mf=function(t){return function(e,r){var n,o,i=rf(D(e)),a=Me(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Pf(i,a))<55296||n>56319||a+1===u||(o=Pf(i,a+1))<56320||o>57343?t?jf(i,a):n:t?_f(i,a,a+2):o-56320+(n-55296<<10)+65536}},Lf={codeAt:Mf(!1),charAt:Mf(!0)},Rf=Lf.charAt,Cf=function(t,e,r){return e+(r?Rf(t,e).length:1)},Nf=Math.floor,Df=R("".charAt),Ff=R("".replace),Wf=R("".slice),zf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,Bf=/\\$([$&'\`]|\\d{1,2})/g,Uf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Bf;return void 0!==o&&(o=W(o),s=zf),Ff(i,s,(function(i,s){var c;switch(Df(s,0)){case"$":return"$";case"&":return t;case"\`":return Wf(e,0,r);case"'":return Wf(e,a);case"<":c=o[Wf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Nf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Df(s,1):n[l-1]+Df(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Gf=TypeError,Hf=function(t,e){var r=t.exec;if($(r)){var n=St(r,t,e);return null!==n&&At(n),n}if("RegExp"===ve(t))return St(Of,t,e);throw Gf("RegExp#exec called on incompatible receiver")},Vf=ft("replace"),qf=Math.max,Zf=Math.min,Yf=R([].concat),$f=R([].push),Kf=R("".indexOf),Qf=R("".slice),Xf="$0"==="a".replace(/./,"$0"),Jf=!!/./[Vf]&&""===/./[Vf]("a","$0");function tl(t){this.message=t}If("replace",(function(t,e,r){var n=Jf?"$":"$0";return[function(t,r){var n=D(this),o=C(t)?void 0:Lt(t,Vf);return o?St(o,t,n,r):St(e,rf(n),t,r)},function(t,o){var i=At(this),a=rf(t);if("string"==typeof o&&-1===Kf(o,n)&&-1===Kf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=$(o);s||(o=rf(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Hf(i,a);if(null===h)break;if($f(l,h),!c)break;""===rf(h[0])&&(i.lastIndex=Cf(a,De(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=rf((h=l[y])[0]),m=qf(Zf(Me(h.index),a.length),0),x=[],b=1;b<h.length;b++)$f(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Yf([g],x,m,a);void 0!==w&&$f(E,w);var A=rf(Dr(o,void 0,E))}else A=Uf(g,a,m,x,w,o);m>=d&&(v+=Qf(a,d,m)+A,d=m+g.length)}return v+Qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Xf||Jf),tl.prototype=new Error,tl.prototype.name="InvalidCharacterError",ir({global:!0,forced:O.globalThis!==O},{globalThis:O}),Sf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Sf.devicePixelRatio;var el=TypeError,rl=Object.getOwnPropertyDescriptor,nl=pt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(yi(t)&&!rl(t,"length").writable)throw el("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ol=TypeError,il=function(t){if(t>9007199254740991)throw ol("Maximum allowed index exceeded");return t},al=Pi("splice"),ul=Math.max,sl=Math.min;ir({target:"Array",proto:!0,forced:!al},{splice:function(t,e){var r,n,o,i,a,u,s=W(this),c=Fe(s),f=Ce(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=sl(ul(Me(e),0),c-f)),il(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&Ii(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ls(s,u);for(i=c;i>c-n+r;i--)ls(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ls(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return nl(s,c-n+r),o}});var cl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),fl=Object.assign,ll=Object.defineProperty,hl=R([].concat),pl=!fl||j((function(){if(pt&&1!==fl({b:1},fl(ll({},"a",{enumerable:!0,get:function(){ll(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=fl({},t)[r]||"abcdefghijklmnopqrst"!=Hi(fl({},e)).join("")}))?function(t,e){for(var r=W(t),n=arguments.length,o=1,i=Ze.f,a=Ee.f;n>o;)for(var u,s=Se(arguments[o++]),c=i?hl(Hi(s),i(s)):Hi(s),f=c.length,l=0;f>l;)u=c[l++],pt&&!St(a,s,u)||(r[u]=s[u]);return r}:fl;ir({target:"Object",stat:!0,arity:2,forced:Object.assign!==pl},{assign:pl});var vl=Ei.findIndex,dl=!0;"findIndex"in[]&&Array(1).findIndex((function(){dl=!1})),ir({target:"Array",proto:!0,forced:dl},{findIndex:function(t){return vl(this,t,arguments.length>1?arguments[1]:void 0)}}),oa("findIndex");var yl=Lf.charAt,gl=ce.set,ml=ce.getterFor("String Iterator");wa(String,"String",(function(t){gl(this,{type:"String Iterator",string:rf(t),index:0})}),(function(){var t,e=ml(this),r=e.string,n=e.index;return n>=r.length?Ea(void 0,!0):(t=yl(r,n),e.index+=t.length,Ea(t,!1))}));var xl=qe.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],wl={f:function(t){return bl&&"Window"==ve(t)?function(t){try{return xl(t)}catch(t){return yu(bl)}}(t):xl(Te(t))}},El=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Al=Object.isExtensible,Ol=j((function(){Al(1)}))||El?function(t){return!!dt(t)&&((!El||"ArrayBuffer"!=ve(t))&&(!Al||Al(t)))}:Al,Sl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),Tl=b((function(t){var e=Ut.f,r=!1,n=V("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=qe.f,e=R([].splice),o={};o[n]=1,t(o).length&&(qe.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ir({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wl.f}))},fastKey:function(t,e){if(!dt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!B(t,n)){if(!Ol(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!B(t,n)){if(!Ol(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Sl&&r&&Ol(t)&&!B(t,n)&&i(t),t}};oe[n]=!0})),kl=(Tl.enable,Tl.fastKey,Tl.getWeakData,Tl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=R(u[t]);le(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!dt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(nr(t,!$(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Tl.enable();else if(nr(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=_o((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){yr(t,u);var r=ss(new a,t,s);return C(e)||To(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ir({global:!0,constructor:!0,forced:s!=a},c),hr(s,t),o||r.setStrong(s,t,n),s}),Il=Tl.getWeakData,jl=ce.set,Pl=ce.getterFor,_l=Ei.find,Ml=Ei.findIndex,Ll=R([].splice),Rl=0,Cl=function(t){return t.frozen||(t.frozen=new Nl)},Nl=function(){this.entries=[]},Dl=function(t,e){return _l(t.entries,(function(t){return t[0]===e}))};Nl.prototype={get:function(t){var e=Dl(this,t);if(e)return e[1]},has:function(t){return!!Dl(this,t)},set:function(t,e){var r=Dl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ml(this.entries,(function(e){return e[0]===t}));return~e&&Ll(this.entries,e,1),!!~e}};var Fl,Wl={getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),jl(t,{type:e,id:Rl++,frozen:void 0}),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Pl(e),u=function(t,e,r){var n=a(t),o=Il(At(e),!0);return!0===o?Cl(n).set(e,r):o[n.id]=r,t};return ru(i,{delete:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).delete(t):r&&B(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).has(t):r&&B(r,e.id)}}),ru(i,r?{get:function(t){var e=a(this);if(dt(t)){var r=Il(t);return!0===r?Cl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},zl=ce.enforce,Bl=!O.ActiveXObject&&"ActiveXObject"in O,Ul=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gl=kl("WeakMap",Ul,Wl);if(Jt&&Bl){Fl=Wl.getConstructor(Ul,"WeakMap",!0),Tl.enable();var Hl=Gl.prototype,Vl=R(Hl.delete),ql=R(Hl.has),Zl=R(Hl.get),Yl=R(Hl.set);ru(Hl,{delete:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),Vl(this,t)||e.frozen.delete(t)}return Vl(this,t)},has:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)||e.frozen.has(t)}return ql(this,t)},get:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)?Zl(this,t):e.frozen.get(t)}return Zl(this,t)},set:function(t,e){if(dt(t)&&!Ol(t)){var r=zl(this);r.frozen||(r.frozen=new Fl),ql(this,t)?Yl(this,t,e):r.frozen.set(t,e)}else Yl(this,t,e);return this}})}var $l=ft("iterator"),Kl=ft("toStringTag"),Ql=Ta.values,Xl=function(t,e){if(t){if(t[$l]!==Ql)try{ee(t,$l,Ql)}catch(e){t[$l]=Ql}if(t[Kl]||ee(t,Kl,e),hi[e])for(var r in Ta)if(t[r]!==Ta[r])try{ee(t,r,Ta[r])}catch(e){t[r]=Ta[r]}}};for(var Jl in hi)Xl(O[Jl]&&O[Jl].prototype,Jl);Xl(di,"DOMTokenList");var th,eh,rh,nh,oh=new WeakMap,ih=function(){function t(){i(this,t),oh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=oh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),oh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=oh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=oh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ah=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(ih));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var uh=my.getSystemInfoSync();th=uh.screenWidth,eh=uh.screenHeight,rh=uh.windowWidth,nh=uh.windowHeight}else{var sh=Sf.innerWidth,ch=Sf.innerHeight;th=sh,eh=ch,rh=sh,nh=ch}var fh={width:th,height:eh,availWidth:rh,availHeight:nh,availLeft:0,availTop:0},lh=fh.availWidth,hh=fh.availHeight,ph={style:[]};function vh(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function dh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:lh+"px",height:hh+"px",margin:"0px",padding:"0px"})}function yh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=lh,t.clientHeight=hh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function gh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=lh,t.offsetHeight=hh)}function mh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=lh,t.scrollHeight=hh)}function xh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var wh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),vh(h(t),o),dh(h(t)),xh(h(t)),yh(h(t)),gh(h(t)),mh(h(t)),t}return u(r)}(ah),Eh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(wh)),Ah={};function Oh(){return Ah}var Sh=u((function t(){i(this,t);var e=Oh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),vh(r),xh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Th={href:"",protocol:"",host:""},kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),Ih=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),jh={},Ph={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Th,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Sh:"video"===t?new Eh:new wh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){jh[t]||(jh[t]=[]),jh[t].push(e)},removeEventListener:function(t,e){var r=jh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=jh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new cl(t)}};Ph.documentElement=new Ih,Ph.head=new wh("head"),Ph.body=new kh,If("match",(function(t,e,r){return[function(e){var r=D(this),n=C(e)?void 0:Lt(e,t);return n?St(n,e,r):new RegExp(e)[t](rf(r))},function(t){var n=At(this),o=rf(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Hf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Hf(n,o));){var f=rf(u[0]);s[c]=f,""===f&&(n.lastIndex=Cf(o,De(n.lastIndex),a)),c++}return 0===c?null:s}]}));var _h,Mh,Lh=ft("isConcatSpreadable"),Rh=nt>=51||!j((function(){var t=[];return t[Lh]=!1,t.concat()[0]!==t})),Ch=Pi("concat"),Nh=function(t){if(!dt(t))return!1;var e=t[Lh];return void 0!==e?!!e:yi(t)};if(ir({target:"Array",proto:!0,arity:1,forced:!Rh||!Ch},{concat:function(t){var e,r,n,o,i,a=W(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Nh(i=-1===e?a:arguments[e]))for(o=Fe(i),il(s+o),r=0;r<o;r++,s++)r in i&&Ii(u,s,i[r]);else il(s+1),Ii(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Dh=my.getSystemInfoSync();_h=Dh.system,Dh.platform,Dh.language}else{var Fh={versions:(Mh=Sf.navigator.userAgent,{trident:Mh.indexOf("Trident")>-1,presto:Mh.indexOf("Presto")>-1,webKit:Mh.indexOf("AppleWebKit")>-1,gecko:Mh.indexOf("Gecko")>-1&&-1===Mh.indexOf("KHTML"),mobile:!!Mh.match(/AppleWebKit.*Mobile.*/),ios:!!Mh.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Mh.indexOf("Android")>-1||Mh.indexOf("Linux")>-1,iPhone:Mh.indexOf("iPhone")>-1,iPad:Mh.indexOf("iPad")>-1,webApp:-1===Mh.indexOf("Safari"),weixin:Mh.indexOf("MicroMessenger")>-1,qq:" qq"===Mh.match(/\\sQQ/i)}),language:(Sf.navigator.browserLanguage||Sf.navigator.language).toLowerCase()};Fh.versions.android?"android":Fh.versions.trident?"IE":Fh.versions.presto?"Opera":Fh.versions.webKit?"webKit":Fh.versions.gecko?"Firefox":Fh.versions.mobile?"mobile":Fh.versions.ios?"ios":Fh.versions.iPhone?"iPhone":Fh.versions.iPad?"ipad":Fh.versions.webApp?"webApp":Fh.versions.weixin?"weixin":Fh.versions.qq&&"qq",_h=Sf.navigator.userAgent,Fh.language}_h.toLowerCase().indexOf("android");cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Wh=Ut.f,zh=Tl.fastKey,Bh=ce.set,Uh=ce.getterFor;kl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),Bh(t,{type:e,index:Qi(null),first:void 0,last:void 0,size:0}),pt||(t.size=0),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Uh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=zh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),pt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=zh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return ru(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,pt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),pt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=zr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),ru(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),pt&&Wh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Uh(e),i=Uh(n);wa(t,e,(function(t,e){Bh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?Ea("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,Ea(void 0,!0))}),r?"entries":"values",!r,!0),vr(e)}});var Gh=R([].join),Hh=Se!=Object,Vh=Ai("join",",");ir({target:"Array",proto:!0,forced:Hh||!Vh},{join:function(t){return Gh(Te(this),void 0===t?",":t)}});var qh=j((function(){Hi(1)}));ir({target:"Object",stat:!0,forced:qh},{keys:function(t){return Hi(W(t))}});var Zh=new Map,Yh=new Map,$h=new Map,Kh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Zh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=$h.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Yh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Yh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Zh.get("requestHeader");r[t]=e,Zh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(ih);s(Kh,"UNSEND",void 0),s(Kh,"OPENED",void 0),s(Kh,"HEADERS_RECEIVED",void 0),s(Kh,"LOADING",void 0),s(Kh,"DONE",void 0),Kh.UNSEND=0,Kh.OPENED=1,Kh.HEADERS_RECEIVED=2,Kh.LOADING=3,Kh.DONE=4;var Qh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Xh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Jh=Qh||Xh;Jh||Sf.XMLHttpRequest,Jh||Sf.location;function tp(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var ep=Ei.filter,rp=Pi("filter");function np(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function op(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ip(t){return t.filter?[1]:[0]}function ap(t,e){return[e]}ir({target:"Array",proto:!0,forced:!rp},{filter:function(t){return ep(this,t,arguments.length>1?arguments[1]:void 0)}});var up=cp,sp=cp;function cp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=fp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=fp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(wp(s));for(c.sort(gp),o=0;o<c.length;o++)r=mp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return hp(h,p,r,n,o,c,0),p}function fp(t,e,r,n,o){var i,a;if(o===Rp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=_p(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=_p(i,t[i],t[i+1],a);return a&&Sp(a,a.next)&&(Mp(a),a=a.next),a}function lp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Sp(n,n.next)&&0!==Op(n.prev,n,n.next))n=n.next;else{if(Mp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function hp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=bp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?vp(t,n,o,i):pp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Mp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?hp(t=dp(lp(t),e,r),e,r,n,o,i,2):2===a&&yp(t,e,r,n,o,i):hp(lp(t),e,r,n,o,i,1);break}}}function pp(t){var e=t.prev,r=t,n=t.next;if(Op(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ep(o,u,i,s,a,c,v.x,v.y)&&Op(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Op(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=bp(p,v,e,r,n),m=bp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Sp(o,i)&&Tp(o,n,n.next,i)&&jp(o,i)&&jp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Mp(n),Mp(n.next),n=t=i),n=n.next}while(n!==t);return lp(n)}function yp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Ap(a,u)){var s=Pp(a,u);return a=lp(a,a.next),s=lp(s,s.next),hp(a,e,r,n,o,i,0),void hp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function gp(t,e){return t.x-e.x}function mp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ep(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),jp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=Pp(r,t);return lp(n,n.next),lp(r,r.next)}function xp(t,e){return Op(t.prev,t,e.prev)<0&&Op(e.next,t,t.next)<0}function bp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ep(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Ap(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Tp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Op(t.prev,t,e.prev)||Op(t,e.prev,e))||Sp(t,e)&&Op(t.prev,t,t.next)>0&&Op(e.prev,e,e.next)>0)}function Op(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Sp(t,e){return t.x===e.x&&t.y===e.y}function Tp(t,e,r,n){var o=Ip(Op(t,e,r)),i=Ip(Op(t,e,n)),a=Ip(Op(r,n,t)),u=Ip(Op(r,n,e));return o!==i&&a!==u||(!(0!==o||!kp(t,r,e))||(!(0!==i||!kp(t,n,e))||(!(0!==a||!kp(r,t,n))||!(0!==u||!kp(r,e,n)))))}function kp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ip(t){return t>0?1:t<0?-1:0}function jp(t,e){return Op(t.prev,t,t.next)<0?Op(t,e,t.next)>=0&&Op(t,t.prev,e)>=0:Op(t,e,t.prev)<0||Op(t,t.next,e)<0}function Pp(t,e){var r=new Lp(t.i,t.x,t.y),n=new Lp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function _p(t,e,r,n){var o=new Lp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Mp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}cp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Rp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Rp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},cp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},up.default=sp;var Cp=R(1..valueOf),Np=R("".replace),Dp="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",Fp=RegExp("^"+Dp+Dp+"*"),Wp=RegExp(Dp+Dp+"*$"),zp=function(t){return function(e){var r=rf(D(e));return 1&t&&(r=Np(r,Fp,"")),2&t&&(r=Np(r,Wp,"")),r}},Bp={start:zp(1),end:zp(2),trim:zp(3)},Up=qe.f,Gp=Ie.f,Hp=Ut.f,Vp=Bp.trim,qp=O.Number,Zp=qp.prototype,Yp=O.TypeError,$p=R("".slice),Kp=R("".charCodeAt),Qp=function(t){var e=Dt(t,"number");return"bigint"==typeof e?e:Xp(e)},Xp=function(t){var e,r,n,o,i,a,u,s,c=Dt(t,"number");if(It(c))throw Yp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Vp(c),43===(e=Kp(c,0))||45===e){if(88===(r=Kp(c,2))||120===r)return NaN}else if(48===e){switch(Kp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=$p(c,2)).length,u=0;u<a;u++)if((s=Kp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(nr("Number",!qp(" 0o1")||!qp("0b1")||qp("+0x1"))){for(var Jp,tv=function(t){var e=arguments.length<1?0:qp(Qp(t)),r=this;return Tt(Zp,r)&&j((function(){Cp(r)}))?ss(Object(e),r,tv):e},ev=pt?Up(qp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),rv=0;ev.length>rv;rv++)B(qp,Jp=ev[rv])&&!B(tv,Jp)&&Hp(tv,Jp,Gp(qp,Jp));tv.prototype=Zp,Zp.constructor=tv,le(O,"Number",tv,{constructor:!0})}var nv=RangeError,ov=RangeError,iv=String,av=Math.floor,uv=R((function(t){var e=rf(D(this)),r="",n=Me(t);if(n<0||n==1/0)throw nv("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),sv=R("".slice),cv=R(1..toFixed),fv=function(t,e,r){return 0===e?r:e%2==1?fv(t,e-1,r*t):fv(t*t,e/2,r)},lv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=av(o/1e7)},hv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=av(n/e),n=n%e*1e7},pv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=iv(t[e]);r=""===r?n:r+uv("0",7-n.length)+n}return r},vv=j((function(){return"0.000"!==cv(8e-5,3)||"1"!==cv(.9,0)||"1.25"!==cv(1.255,2)||"1000000000000000128"!==cv(0xde0b6b3a7640080,0)}))||!j((function(){cv({})}));function dv(t){return"number"==typeof t}function yv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ir({target:"Number",proto:!0,forced:vv},{toFixed:function(t){var e,r,n,o,i=Cp(this),a=Me(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw ov("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return iv(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*fv(2,69,1))-69)<0?i*fv(2,-e,1):i/fv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(lv(u,0,r),n=a;n>=7;)lv(u,1e7,0),n-=7;for(lv(u,fv(10,n,1),0),n=e-1;n>=23;)hv(u,1<<23),n-=23;hv(u,1<<n),lv(u,1,1),hv(u,2),c=pv(u)}else lv(u,0,r),lv(u,1<<-e,0),c=pv(u)+uv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+uv("0",a-o)+c:sv(c,0,o-a)+"."+sv(c,o-a)):s+c}});var gv,mv=/"/g,xv=R("".replace);ir({target:"String",proto:!0,forced:(gv="sub",j((function(){var t=""[gv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=rf(D(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+xv(rf(r),mv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var bv=RegExp.prototype,wv=qt.PROPER,Ev=RegExp.prototype.toString,Av=j((function(){return"/a/b"!=Ev.call({source:"a",flags:"b"})})),Ov=wv&&"toString"!=Ev.name;(Av||Ov)&&le(RegExp.prototype,"toString",(function(){var t=At(this);return"/"+rf(t.source)+"/"+rf(function(t){var e=t.flags;return void 0!==e||"flags"in bv||B(t,"flags")||!Tt(bv,t)?e:St(nf,t)}(t))}),{unsafe:!0});var Sv="undefined"!=typeof Float32Array?Float32Array:Array;function Tv(){var t=new Sv(2);return Sv!=Float32Array&&(t[0]=0,t[1]=0),t}function kv(t,e){var r=new Sv(2);return r[0]=t,r[1]=e,r}function Iv(t,e){return t[0]=e[0],t[1]=e[1],t}function jv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Pv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function _v(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Mv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Lv,Rv=Pv,Cv=(Lv=Tv(),Tv()),Nv=(Tv(),Tv()),Dv=Tv(),Fv=Tv();function Wv(t,e,r,n,o){return jv(t,r,n),_v(t,t),[o/Mv(e=kv(-t[1],t[0]),kv(-r[1],r[0])),e]}function zv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Bv(t,e,r){return Rv(t,e,r),_v(t,t),t}function Uv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Gv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",kv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=yv([a[0],a[1]]),g=yv([i[0],i[1]]);Bv(Nv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,h){var x=Tv(),b=Tv();jv(x,this.normal,Nv),jv(b,this.normal,Nv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Uv(n,o)&&jv(o,n,_v(o,Pv(o,n,r))),Bv(Dv,o,n);var w=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),E=w[0],A=w[1],O=Mv(Fv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,Iv(this.normal,A),s+=2),this.lastFlip=O}else{if(zv(this.normal,Nv),h){var T=Tv(),k=Tv();Rv(k,Nv,this.normal),jv(T,Nv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=yv([n[0],n[1]]),f=yv([r[0],r[1]]);Bv(Nv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=yv([o[0],o[1]]);Uv(c,h)&&jv(h,c,_v(h,Pv(h,c,f))),Bv(Dv,h,c);var p=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),v=p[0],g=p[1];Mv(Fv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,Iv(this.normal,g),i+=2,this.lastFlip=-1}else zv(this.normal,Nv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=yv([n[0],n[1]]),h=yv([r[0],r[1]]);Bv(Nv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,c){var v=Tv(),g=Tv();jv(v,this.normal,Nv),jv(g,this.normal,Nv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=yv([o[0],o[1]]);Uv(l,m)&&jv(m,l,_v(m,Pv(m,l,h))),Bv(Dv,m,l);var x=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),b=x[0],w=x[1],E=Mv(Fv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,Iv(this.normal,w),i+=2),this.lastFlip=E}else{if(zv(this.normal,Nv),c){var O=Tv(),S=Tv();Rv(S,Nv,this.normal),jv(O,Nv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Hv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Gv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Vv(t){var e=function(t){if(dv(t[0]))return t;if(dv(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(dv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function qv(t){var e=t.coordinates,r=up.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:up(n,i,o),vertices:n,size:o}}var Zv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Hv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Zv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},$v=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Yv);function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!$v[n]){t.next=3;break}return t.abrupt("return",$v[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return fi(Kv),t.WorkerSourceMap=Yv,t.createWorker=fi,t.worker=Kv,t}({});
`,Zd="l7-worker",nB=3,iB=!0;function aB(e){eB(Zd,e)}function oB(){var e=tB(Zd);if(!e)throw new Error("get worker failed by workerName: ".concat(Zd,"."));return e}function uB(e,t){return w1.apply(this,arguments)}function w1(){return w1=Ie(H.mark(function e(t,r){var n,i,a,o,u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=oB(),i=hP.getWorkerFarm({maxConcurrency:nB,reuseWorkers:iB}),a=i.getWorkerPool({name:Zd,source:n}),l.next=5,a.startJob(Zd,function(f,h,d){return f.done(d)});case 5:return o=l.sent,o.postMessage("process",{input:{workerType:t,data:r}}),l.next=9,o.result;case 9:return u=l.sent,l.abrupt("return",u.result);case 11:case"end":return l.stop()}},e)})),w1.apply(this,arguments)}aB(rB);var mc={BACK:1029,FRONT:1028};function ym(e){switch(e){case"GAODE1.x":return mc.BACK;case"GAODE2.x":return mc.BACK;case"MAPBOX":return mc.FRONT;case"SIMPLE":return mc.FRONT;case"GLOBEL":return mc.BACK;case"DEBAULT":return mc.FRONT;default:return mc.FRONT}}function sB(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}var xh;(function(e){e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace"})(xh||(xh={}));var Ra;(function(e){e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled"})(Ra||(Ra={}));var P5=0,Fb=1,_m=2;function lB(e){e.forEach(function(t){t.isCurrent&&(t.isVisible=t.isLoaded)})}function cB(e){e.forEach(function(t){t.properties.state=P5}),e.forEach(function(t){t.isCurrent&&!D5(t)&&nE(t)}),e.forEach(function(t){t.isVisible=Boolean(t.properties.state&_m)})}function fB(e){e.forEach(function(r){r.properties.state=P5}),e.forEach(function(r){r.isCurrent&&D5(r)});var t=e.slice().sort(function(r,n){return r.z-n.z});t.forEach(function(r){r.isVisible=Boolean(r.properties.state&_m),r.children.length&&(r.isVisible||r.properties.state&Fb)?r.children.forEach(function(n){n.properties.state=Fb}):r.isCurrent&&nE(r)})}function D5(e){for(;e;){if(e.isLoaded)return e.properties.state|=_m,!0;e=e.parent}return!1}function nE(e){e.children.forEach(function(t){t.isLoaded?t.properties.state|=_m:nE(t)})}var td,B5=[-1/0,-1/0,1/0,1/0],hB=.2,pB=5,dB=(td={},T(td,xh.Realtime,lB),T(td,xh.Overlap,cB),T(td,xh.Replace,fB),td),vB=function(){};function M1(e,t,r){var n=Math.floor((e+180)/360*Math.pow(2,r)),i=Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,r));return[n,i]}function Ib(e,t,r){var n=e/Math.pow(2,r)*360-180,i=Math.PI-2*Math.PI*t/Math.pow(2,r),a=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[n,a]}var N5=function(t,r,n){var i=Ib(t,r,n),a=ir(i,2),o=a[0],u=a[1],s=Ib(t+1,r+1,n),l=ir(s,2),f=l[0],h=l[1];return[o,h,f,u]};function gB(e){var t=e.zoom,r=e.latLonBounds,n=e.maxZoom,i=n===void 0?1/0:n,a=e.minZoom,o=a===void 0?0:a,u=e.zoomOffset,s=u===void 0?0:u,l=e.extent,f=l===void 0?B5:l,h=Math.ceil(t)+s;if(Number.isFinite(o)&&h<o)return[];Number.isFinite(i)&&h>i&&(h=i);for(var d=ir(r,4),v=d[0],m=d[1],y=d[2],_=d[3],E=[Math.max(v,f[0]),Math.max(m,f[1]),Math.min(y,f[2]),Math.min(_,f[3])],S=[],A=M1(E[0],E[1],h),M=ir(A,2),O=M[0],j=M[1],q=M1(E[2],E[3],h),Y=ir(q,2),ne=Y[0],X=Y[1],$=O;$<=ne;$++)for(var K=X;K<=j;K++)S.push({x:$,y:K,z:h});var ue=(ne+O)/2,de=(j+X)/2,pe=function(ve,Me){return Math.abs(ve-ue)+Math.abs(Me-de)};return S.sort(function(le,ve){return pe(le.x,le.y)-pe(ve.x,ve.y)}),S}var mB=function(t,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Math.pow(2,n),o=a-1,u=a,s=t,l=r;return i&&(s<0?s=s+u:s>o&&(s=s%u)),{warpX:s,warpY:l}};function yB(e){var t=[],r=/\{([a-z])-([a-z])\}/.exec(e);if(r){var n=r[1].charCodeAt(0),i=r[2].charCodeAt(0),a;for(a=n;a<=i;++a)t.push(e.replace(r[0],String.fromCharCode(a)));return t}if(r=/\{(\d+)-(\d+)\}/.exec(e),r){for(var o=parseInt(r[2],10),u=parseInt(r[1],10);u<=o;u++)t.push(e.replace(r[0],u.toString()));return t}return t.push(e),t}function Ld(e,t){if(!e||!e.length)throw new Error("url is not allowed to be empty");var r=t.x,n=t.y,i=t.z,a=yB(e),o=Math.abs(r+n)%a.length,u=a[o];return u.replace(/\{x\}/g,r.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,i.toString()).replace(/\{bbox\}/g,N5(r,n,i).join(",")).replace(/\{-y\}/g,(Math.pow(2,i)-n-1).toString())}function _B(e,t){var r=t.x,n=t.y,i=t.z,a=t.layer,o=t.version,u=o===void 0?"1.0.0":o,s=t.style,l=s===void 0?"default":s,f=t.format,h=t.service,d=h===void 0?"WMTS":h,v=t.tileMatrixset,m="".concat(e,"&SERVICE=").concat(d,"&REQUEST=GetTile&VERSION=").concat(u,"&LAYER=").concat(a,"&STYLE=").concat(l,"&TILEMATRIXSET=").concat(v,"&FORMAT=").concat(f,"&TILECOL=").concat(r,"&TILEROW=").concat(n,"&TILEMATRIX=").concat(i);return m}function xB(e,t){t===void 0&&(t={});var r=Number(e[0]),n=Number(e[1]),i=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[r,n],u=[r,a],s=[i,a],l=[i,n];return cm([[o,l,s,u,o]],t.properties,{bbox:e,id:t.id})}var Pa={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(s,l,f){this.fn=s,this.context=l,this.once=f||!1}function a(s,l,f,h,d){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new i(f,h||s,d),m=r?r+l:l;return s._events[m]?s._events[m].fn?s._events[m]=[s._events[m],v]:s._events[m].push(v):(s._events[m]=v,s._eventsCount++),s}function o(s,l){--s._eventsCount===0?s._events=new n:delete s._events[l]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var l=[],f,h;if(this._eventsCount===0)return l;for(h in f=this._events)t.call(f,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},u.prototype.listeners=function(l){var f=r?r+l:l,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,v=h.length,m=new Array(v);d<v;d++)m[d]=h[d].fn;return m},u.prototype.listenerCount=function(l){var f=r?r+l:l,h=this._events[f];return h?h.fn?1:h.length:0},u.prototype.emit=function(l,f,h,d,v,m){var y=r?r+l:l;if(!this._events[y])return!1;var _=this._events[y],E=arguments.length,S,A;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),E){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,f),!0;case 3:return _.fn.call(_.context,f,h),!0;case 4:return _.fn.call(_.context,f,h,d),!0;case 5:return _.fn.call(_.context,f,h,d,v),!0;case 6:return _.fn.call(_.context,f,h,d,v,m),!0}for(A=1,S=new Array(E-1);A<E;A++)S[A-1]=arguments[A];_.fn.apply(_.context,S)}else{var M=_.length,O;for(A=0;A<M;A++)switch(_[A].once&&this.removeListener(l,_[A].fn,void 0,!0),E){case 1:_[A].fn.call(_[A].context);break;case 2:_[A].fn.call(_[A].context,f);break;case 3:_[A].fn.call(_[A].context,f,h);break;case 4:_[A].fn.call(_[A].context,f,h,d);break;default:if(!S)for(O=1,S=new Array(E-1);O<E;O++)S[O-1]=arguments[O];_[A].fn.apply(_[A].context,S)}}return!0},u.prototype.on=function(l,f,h){return a(this,l,f,h,!1)},u.prototype.once=function(l,f,h){return a(this,l,f,h,!0)},u.prototype.removeListener=function(l,f,h,d){var v=r?r+l:l;if(!this._events[v])return this;if(!f)return o(this,v),this;var m=this._events[v];if(m.fn)m.fn===f&&(!d||m.once)&&(!h||m.context===h)&&o(this,v);else{for(var y=0,_=[],E=m.length;y<E;y++)(m[y].fn!==f||d&&!m[y].once||h&&m[y].context!==h)&&_.push(m[y]);_.length?this._events[v]=_.length===1?_[0]:_:o(this,v)}return this},u.prototype.removeAllListeners=function(l){var f;return l?(f=r?r+l:l,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u})(Pa);const iE=Pa.exports;function EB(e){var t=bB();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function bB(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var CB=function(e){Ut(r,e);var t=EB(r);function r(n){var i;ke(this,r),i=t.call(this),T(re(i),"tileSize",256),T(re(i),"isVisible",!1),T(re(i),"isCurrent",!1),T(re(i),"isVisibleChange",!1),T(re(i),"loadedLayers",0),T(re(i),"isLayerLoaded",!1),T(re(i),"isLoad",!1),T(re(i),"isChildLoad",!1),T(re(i),"parent",null),T(re(i),"children",[]),T(re(i),"data",null),T(re(i),"properties",{}),T(re(i),"loadDataId",0);var a=n.x,o=n.y,u=n.z,s=n.tileSize,l=n.warp,f=l===void 0?!0:l;return i.x=a,i.y=o,i.z=u,i.warp=f||!0,i.tileSize=s,i}return Pe(r,[{key:"isLoading",get:function(){return this.loadStatus===Ra.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===Ra.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===Ra.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===Ra.Cancelled}},{key:"isDone",get:function(){return[Ra.Loaded,Ra.Cancelled,Ra.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return N5(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var i=ir(this.bounds,4),a=i[0],o=i[1],u=i[2],s=i[3],l=[(u-a)/2,(s-o)/2],f=xB(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:l,meta:`
      `.concat(this.key,`
      `)}});return f}},{key:"key",get:function(){var i="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return i}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var n=Ie(H.mark(function a(o){var u,s,l,f,h,d,v,m,y,_,E,S,A,M,O,j,q;return H.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return u=o.getData,s=o.onLoad,l=o.onError,this.loadDataId++,f=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Ra.Loading,h=null,ne.prev=7,v=this.x,m=this.y,y=this.z,_=this.bounds,E=this.tileSize,S=this.warp,A=mB(v,m,y,S),M=A.warpX,O=A.warpY,j=this.abortController.signal,q={x:M,y:O,z:y,bounds:_,tileSize:E,signal:j,warp:S},ne.next=14,u(q,this);case 14:h=ne.sent,ne.next=20;break;case 17:ne.prev=17,ne.t0=ne.catch(7),d=ne.t0;case 20:if(f===this.loadDataId){ne.next=22;break}return ne.abrupt("return");case 22:if(!(this.isCancelled&&!h)){ne.next=24;break}return ne.abrupt("return");case 24:if(!(d||!h)){ne.next=28;break}return this.loadStatus=Ra.Failure,l(d,this),ne.abrupt("return");case 28:this.loadStatus=Ra.Loaded,this.data=h,s(this);case 31:case"end":return ne.stop()}},a,this,[[7,17]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"reloadData",value:function(i){this.isLoading&&this.abortLoad(),this.loadData(i)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=Ra.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),r}(Pa.exports.EventEmitter),AB=function(t,r){var n=Mg(t),i=pm(n,r),a=360*3-180,o=85.0511287798065,u=[Math.max(i[0][0],-a),Math.max(i[0][1],-o),Math.min(i[1][0],a),Math.min(i[1][1],o)];return u},SB=function(t,r){var n=Mg(t),i=Mg(r),a=J4(n,i);return a};function tl(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=TB(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function TB(e,t){if(!!e){if(typeof e=="string")return kb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kb(e,t)}}function kb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wB(e){var t=MB();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function MB(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var RB=function(e){Ut(r,e);var t=wB(r);function r(n){var i;return ke(this,r),i=t.call(this),T(re(i),"currentTiles",[]),T(re(i),"cacheTiles",new Map),T(re(i),"throttleUpdate",tt.exports.throttle(function(a,o){i.update(a,o)},16)),T(re(i),"onTileLoad",function(a){i.emit("tile-loaded",a),i.updateTileVisible()}),T(re(i),"onTileError",function(a,o){i.emit("tile-error",{error:a,tile:o}),i.updateTileVisible()}),T(re(i),"onTileUnload",function(a){i.emit("tile-unload",a)}),i.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:B5,getTileData:vB,warp:!0,updateStrategy:xh.Overlap},i.updateOptions(n),i}return Pe(r,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(i){return i.isDone})}},{key:"tiles",get:function(){var i=Array.from(this.cacheTiles.values()).sort(function(a,o){return a.z-o.z});return i}},{key:"updateOptions",value:function(i){var a=i.minZoom===void 0?this.options.minZoom:Math.ceil(i.minZoom),o=i.maxZoom===void 0?this.options.maxZoom:Math.floor(i.maxZoom);this.options=be(be(be({},this.options),i),{},{minZoom:a,maxZoom:o})}},{key:"update",value:function(i,a){var o=this,u=Math.max(0,Math.ceil(i));if(!(this.lastViewStates&&this.lastViewStates.zoom===u&&SB(this.lastViewStates.latLonBoundsBuffer,a))){var s=AB(a,hB);this.lastViewStates={zoom:u,latLonBounds:a,latLonBoundsBuffer:s};var l=!1,f=this.getTileIndices(u,s).filter(function(h){return o.options.warp||h.x>=0&&h.x<Math.pow(2,u)});this.currentTiles=f.map(function(h){var d=h.x,v=h.y,m=h.z,y=o.getTile(d,v,m);if(y){var _,E,S=((_=y)===null||_===void 0?void 0:_.isFailure)||((E=y)===null||E===void 0?void 0:E.isCancelled);return S&&y.loadData({getData:o.options.getTileData,onLoad:o.onTileLoad,onError:o.onTileError}),y}return y=o.createTile(d,v,m),l=!0,y}),l&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var i=tl(this.cacheTiles),a;try{for(i.s();!(a=i.n()).done;){var o=ir(a.value,2),u=o[0],s=o[1];this.currentTiles.includes(s)||(this.cacheTiles.delete(u),this.onTileUnload(s)),this.onTileUnload(s),s.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(l){i.e(l)}finally{i.f()}}},{key:"pruneRequests",value:function(){var i=[],a=tl(this.cacheTiles.values()),o;try{for(a.s();!(o=a.n()).done;){var u=o.value;u.isLoading&&!u.isCurrent&&!u.isVisible&&i.push(u)}}catch(l){a.e(l)}finally{a.f()}for(;i.length>0;){var s=i.shift();s.abortLoad()}}},{key:"getTileByLngLat",value:function(i,a,o){var u=this.options.zoomOffset,s=Math.ceil(o)+u,l=M1(i,a,s),f=this.tiles.filter(function(h){return h.key==="".concat(l[0],"_").concat(l[1],"_").concat(s)});return f[0]}},{key:"destroy",value:function(){var i=tl(this.cacheTiles.values()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o.isLoading&&o.abortLoad()}}catch(u){i.e(u)}finally{i.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var i=this.options.updateStrategy,a=new Map,o=tl(this.cacheTiles.values()),u;try{for(o.s();!(u=o.n()).done;){var s=u.value;a.set(s.key,s.isVisible),s.isCurrent=!1,s.isVisible=!1}}catch(m){o.e(m)}finally{o.f()}var l=tl(this.currentTiles),f;try{for(l.s();!(f=l.n()).done;){var h=f.value;h.isCurrent=!0,h.isVisible=!0}}catch(m){l.e(m)}finally{l.f()}var d=Array.from(this.cacheTiles.values());typeof i=="function"?i(d):dB[i](d);var v=!1;Array.from(this.cacheTiles.values()).forEach(function(m){m.isVisible!==a.get(m.key)?(m.isVisibleChange=!0,v=!0):m.isVisibleChange=!1}),v&&this.emit("tile-update")}},{key:"getTileIndices",value:function(i,a){var o=this.options,u=o.tileSize,s=o.extent,l=o.zoomOffset,f=Math.floor(this.options.maxZoom),h=Math.ceil(this.options.minZoom),d=gB({maxZoom:f,minZoom:h,zoomOffset:l,tileSize:u,zoom:i,latLonBounds:a,extent:s});return d}},{key:"getTileId",value:function(i,a,o){var u="".concat(i,",").concat(a,",").concat(o);return u}},{key:"getTile",value:function(i,a,o){var u=this.getTileId(i,a,o),s=this.cacheTiles.get(u);return s}},{key:"createTile",value:function(i,a,o){var u=this.getTileId(i,a,o),s=new CB({x:i,y:a,z:o,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(u,s),s.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),s}},{key:"resizeCacheTiles",value:function(){var i=pB*this.currentTiles.length,a=this.cacheTiles.size>i;if(a){var o=tl(this.cacheTiles),u;try{for(o.s();!(u=o.n()).done;){var s=ir(u.value,2),l=s[0],f=s[1];if(!f.isVisible&&!this.currentTiles.includes(f)&&(this.cacheTiles.delete(l),this.onTileUnload(f)),this.cacheTiles.size<=i)break}}catch(h){o.e(h)}finally{o.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var i=tl(this.cacheTiles.values()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o.parent=null,o.children.length=0}}catch(h){i.e(h)}finally{i.f()}var u=tl(this.cacheTiles.values()),s;try{for(u.s();!(s=u.n()).done;){var l=s.value,f=this.getNearestAncestor(l.x,l.y,l.z);l.parent=f,f!=null&&f.children&&f.children.push(l)}}catch(h){u.e(h)}finally{u.f()}}},{key:"getNearestAncestor",value:function(i,a,o){for(;o>this.options.minZoom;){i=Math.floor(i/2),a=Math.floor(a/2),o=o-1;var u=this.getTile(i,a,o);if(u)return u}return null}}]),r}(iE),Pb;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(Pb||(Pb={}));function U5(e,t){var r=t.extent,n=r===void 0?[121.168,30.2828,121.384,30.4219]:r,i=new Promise(function(o){e instanceof HTMLImageElement||sB(e)?o([e]):OB(e,function(u){o(u)})}),a={originData:e,images:i,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return a}function OB(e,t){var r=e,n=[];if(typeof r=="string")m1({url:r},function(o,u){u&&(n.push(u),t(n))});else{var i=r.length,a=0;r.forEach(function(o){m1({url:o},function(u,s){a++,s&&n.push(s),a===i&&t(n)})})}return U5}var LB=Eh;function Eh(e,t){this.x=e,this.y=t}Eh.prototype={clone:function(){return new Eh(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),a=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};Eh.convert=function(e){return e instanceof Eh?e:Array.isArray(e)?new Eh(e[0],e[1]):e};var FB=LB,IB=Oh;function Oh(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(kB,this,t)}function kB(e,t,r){e==1?t.id=r.readVarint():e==2?PB(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function PB(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}Oh.types=["Unknown","Point","LineString","Polygon"];Oh.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=[],u;e.pos<t;){if(n<=0){var s=e.readVarint();r=s&7,n=s>>3}if(n--,r===1||r===2)i+=e.readSVarint(),a+=e.readSVarint(),r===1&&(u&&o.push(u),u=[]),u.push(new FB(i,a));else if(r===7)u&&u.push(u[0].clone());else throw new Error("unknown command "+r)}return u&&o.push(u),o};Oh.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=1/0,u=-1/0,s=1/0,l=-1/0;e.pos<t;){if(n<=0){var f=e.readVarint();r=f&7,n=f>>3}if(n--,r===1||r===2)i+=e.readSVarint(),a+=e.readSVarint(),i<o&&(o=i),i>u&&(u=i),a<s&&(s=a),a>l&&(l=a);else if(r!==7)throw new Error("unknown command "+r)}return[o,s,u,l]};Oh.prototype.toGeoJSON=function(e,t,r){var n=this.extent*Math.pow(2,r),i=this.extent*e,a=this.extent*t,o=this.loadGeometry(),u=Oh.types[this.type],s,l;function f(v){for(var m=0;m<v.length;m++){var y=v[m],_=180-(y.y+a)*360/n;v[m]=[(y.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(_*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(s=0;s<o.length;s++)h[s]=o[s][0];o=h,f(o);break;case 2:for(s=0;s<o.length;s++)f(o[s]);break;case 3:for(o=DB(o),s=0;s<o.length;s++)for(l=0;l<o[s].length;l++)f(o[s][l]);break}o.length===1?o=o[0]:u="Multi"+u;var d={type:"Feature",geometry:{type:u,coordinates:o},properties:this.properties};return"id"in this&&(d.id=this.id),d};function DB(e){var t=e.length;if(t<=1)return[e];for(var r=[],n,i,a=0;a<t;a++){var o=BB(e[a]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}function BB(e){for(var t=0,r=0,n=e.length,i=n-1,a,o;r<n;i=r++)a=e[r],o=e[i],t+=(o.x-a.x)*(a.y+o.y);return t}var NB=IB,UB=z5;function z5(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(zB,this,t),this.length=this._features.length}function zB(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push($B(r))}function $B(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}z5.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new NB(this._pbf,t,this.extent,this._keys,this._values)};var GB=UB,HB=VB;function VB(e,t){this.layers=e.readFields(jB,{},t)}function jB(e,t,r){if(e===3){var n=new GB(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}var WB=HB,aE={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */aE.read=function(e,t,r,n,i){var a,o,u=i*8-n-1,s=(1<<u)-1,l=s>>1,f=-7,h=r?i-1:0,d=r?-1:1,v=e[t+h];for(h+=d,a=v&(1<<-f)-1,v>>=-f,f+=u;f>0;a=a*256+e[t+h],h+=d,f-=8);for(o=a&(1<<-f)-1,a>>=-f,f+=n;f>0;o=o*256+e[t+h],h+=d,f-=8);if(a===0)a=1-l;else{if(a===s)return o?NaN:(v?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-l}return(v?-1:1)*o*Math.pow(2,a-n)};aE.write=function(e,t,r,n,i,a){var o,u,s,l=a*8-i-1,f=(1<<l)-1,h=f>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:a-1,m=n?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,o=f):(o=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-o))<1&&(o--,s*=2),o+h>=1?t+=d/s:t+=d*Math.pow(2,1-h),t*s>=2&&(o++,s/=2),o+h>=f?(u=0,o=f):o+h>=1?(u=(t*s-1)*Math.pow(2,i),o=o+h):(u=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+v]=u&255,v+=m,u/=256,i-=8);for(o=o<<i|u,l+=i;l>0;e[r+v]=o&255,v+=m,o/=256,l-=8);e[r+v-m]|=y*128};var XB=sn,jv=aE;function sn(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}sn.Varint=0;sn.Fixed64=1;sn.Bytes=2;sn.Fixed32=5;var R1=(1<<16)*(1<<16),Db=1/R1,YB=12,$5=typeof TextDecoder>"u"?null:new TextDecoder("utf8");sn.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,a=this.pos;this.type=n&7,e(i,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Wv(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Nb(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Wv(this.buf,this.pos)+Wv(this.buf,this.pos+4)*R1;return this.pos+=8,e},readSFixed64:function(){var e=Wv(this.buf,this.pos)+Nb(this.buf,this.pos+4)*R1;return this.pos+=8,e},readFloat:function(){var e=jv.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=jv.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,r,n;return n=t[this.pos++],r=n&127,n<128||(n=t[this.pos++],r|=(n&127)<<7,n<128)||(n=t[this.pos++],r|=(n&127)<<14,n<128)||(n=t[this.pos++],r|=(n&127)<<21,n<128)?r:(n=t[this.pos],r|=(n&15)<<28,ZB(r,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=YB&&$5?lN(this.buf,t,e):sN(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==sn.Bytes)return e.push(this.readVarint(t));var r=Yu(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==sn.Bytes)return e.push(this.readSVarint());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==sn.Bytes)return e.push(this.readBoolean());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==sn.Bytes)return e.push(this.readFloat());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==sn.Bytes)return e.push(this.readDouble());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==sn.Bytes)return e.push(this.readFixed32());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==sn.Bytes)return e.push(this.readSFixed32());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==sn.Bytes)return e.push(this.readFixed64());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==sn.Bytes)return e.push(this.readSFixed64());var t=Yu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===sn.Varint)for(;this.buf[this.pos++]>127;);else if(t===sn.Bytes)this.pos=this.readVarint()+this.pos;else if(t===sn.Fixed32)this.pos+=4;else if(t===sn.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),eh(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),eh(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),eh(this.buf,e&-1,this.pos),eh(this.buf,Math.floor(e*Db),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),eh(this.buf,e&-1,this.pos),eh(this.buf,Math.floor(e*Db),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){qB(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=cN(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Bb(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),jv.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),jv.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&Bb(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,sn.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,JB,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,eN,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,nN,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,tN,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,rN,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,iN,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,aN,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,oN,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,uN,t)},writeBytesField:function(e,t){this.writeTag(e,sn.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,sn.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,sn.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,sn.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,sn.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,sn.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,sn.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,sn.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,sn.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,sn.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function ZB(e,t,r){var n=r.buf,i,a;if(a=n[r.pos++],i=(a&112)>>4,a<128||(a=n[r.pos++],i|=(a&127)<<3,a<128)||(a=n[r.pos++],i|=(a&127)<<10,a<128)||(a=n[r.pos++],i|=(a&127)<<17,a<128)||(a=n[r.pos++],i|=(a&127)<<24,a<128)||(a=n[r.pos++],i|=(a&1)<<31,a<128))return Jf(e,i,t);throw new Error("Expected varint not more than 10 bytes")}function Yu(e){return e.type===sn.Bytes?e.readVarint()+e.pos:e.pos+1}function Jf(e,t,r){return r?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function qB(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),KB(r,n,t),QB(n,t)}function KB(e,t,r){r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos]=e&127}function QB(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function Bb(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function JB(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function eN(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function tN(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function rN(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function nN(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function iN(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function aN(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function oN(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function uN(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Wv(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function eh(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Nb(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function sN(e,t,r){for(var n="",i=t;i<r;){var a=e[i],o=null,u=a>239?4:a>223?3:a>191?2:1;if(i+u>r)break;var s,l,f;u===1?a<128&&(o=a):u===2?(s=e[i+1],(s&192)===128&&(o=(a&31)<<6|s&63,o<=127&&(o=null))):u===3?(s=e[i+1],l=e[i+2],(s&192)===128&&(l&192)===128&&(o=(a&15)<<12|(s&63)<<6|l&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):u===4&&(s=e[i+1],l=e[i+2],f=e[i+3],(s&192)===128&&(l&192)===128&&(f&192)===128&&(o=(a&15)<<18|(s&63)<<12|(l&63)<<6|f&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,u=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),i+=u}return n}function lN(e,t,r){return $5.decode(e.subarray(t,r))}function cN(e,t,r){for(var n=0,i,a;n<t.length;n++){if(i=t.charCodeAt(n),i>55295&&i<57344)if(a)if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,a=i;continue}else i=a-55296<<10|i-56320|65536,a=null;else{i>56319||n+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):a=i;continue}else a&&(e[r++]=239,e[r++]=191,e[r++]=189,a=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=i&63|128)}return r}var fN=function(){function e(t,r,n,i){ke(this,e),T(this,"vectorLayerCache",{}),this.x=r,this.y=n,this.z=i,this.vectorTile=new WB(new XB(t))}return Pe(e,[{key:"getTileData",value:function(r){if(!r||!this.vectorTile.layers[r])return[];if(this.vectorLayerCache[r])return this.vectorLayerCache[r];var n=this.vectorTile.layers[r];if(Array.isArray(n.features))return this.vectorLayerCache[r]=n.features,n.features;for(var i=[],a=0;a<n.length;a++){var o=n.feature(a),u=o.toGeoJSON(this.x,this.y,this.z);i.push(be(be({},u),{},{properties:be({id:u.id},u.properties)}))}return this.vectorLayerCache[r]=i,i}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),hN={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},pN=function(){var e=Ie(H.mark(function t(r,n,i,a){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=Ld(r,n),s.abrupt("return",new Promise(function(l){var f=Wx(be(be({},a),{},{url:o}),function(h,d){if(h||!d)l(void 0);else{var v=new fN(d,i.x,i.y,i.z);l(v)}});i.xhrCancel=function(){return f.abort()}}));case 2:case"end":return s.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}();function dN(e,t){var r=Array.isArray(e)?e[0]:e,n=function(o,u){return pN(r,o,u,t==null?void 0:t.requestParameters)},i=be(be(be({},hN),t),{},{getTileData:n});return{data:r,dataArray:[],tilesetOptions:i,isTile:!0}}function O1(e,t,r,n){for(var i=n,a=r-t>>1,o=r-t,u,s=e[t],l=e[t+1],f=e[r],h=e[r+1],d=t+3;d<r;d+=3){var v=vN(e[d],e[d+1],s,l,f,h);if(v>i)u=d,i=v;else if(v===i){var m=Math.abs(d-a);m<o&&(u=d,o=m)}}i>n&&(u-t>3&&O1(e,t,u,n),e[u+2]=i,r-u>3&&O1(e,u,r,n))}function vN(e,t,r,n,i,a){var o=i-r,u=a-n;if(o!==0||u!==0){var s=((e-r)*o+(t-n)*u)/(o*o+u*u);s>1?(r=i,n=a):s>0&&(r+=o*s,n+=u*s)}return o=e-r,u=t-n,o*o+u*u}function qd(e,t,r,n){var i={id:typeof e>"u"?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return gN(i),i}function gN(e){var t=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")c_(e,t);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<t.length;n++)c_(e,t[n]);else if(r==="MultiPolygon")for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)c_(e,t[n][i])}function c_(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function mN(e,t){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)gg(r,e.features[n],t,n);else e.type==="Feature"?gg(r,e,t):gg(r,{geometry:e},t);return r}function gg(e,t,r,n){if(!!t.geometry){var i=t.geometry.coordinates,a=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),u=[],s=t.id;if(r.promoteId?s=t.properties[r.promoteId]:r.generateId&&(s=n||0),a==="Point")Ub(i,u);else if(a==="MultiPoint")for(var l=0;l<i.length;l++)Ub(i[l],u);else if(a==="LineString")L1(i,u,o,!1);else if(a==="MultiLineString")if(r.lineMetrics){for(l=0;l<i.length;l++)u=[],L1(i[l],u,o,!1),e.push(qd(s,"LineString",u,t.properties));return}else f_(i,u,o,!1);else if(a==="Polygon")f_(i,u,o,!0);else if(a==="MultiPolygon")for(l=0;l<i.length;l++){var f=[];f_(i[l],f,o,!0),u.push(f)}else if(a==="GeometryCollection"){for(l=0;l<t.geometry.geometries.length;l++)gg(e,{id:s,geometry:t.geometry.geometries[l],properties:t.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(qd(s,a,u,t.properties))}}function Ub(e,t){t.push(G5(e[0])),t.push(H5(e[1])),t.push(0)}function L1(e,t,r,n){for(var i,a,o=0,u=0;u<e.length;u++){var s=G5(e[u][0]),l=H5(e[u][1]);t.push(s),t.push(l),t.push(0),u>0&&(n?o+=(i*l-s*a)/2:o+=Math.sqrt(Math.pow(s-i,2)+Math.pow(l-a,2))),i=s,a=l}var f=t.length-3;t[2]=1,O1(t,0,f,r),t[f+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function f_(e,t,r,n){for(var i=0;i<e.length;i++){var a=[];L1(e[i],a,r,n),t.push(a)}}function G5(e){return e/360+.5}function H5(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function es(e,t,r,n,i,a,o,u){if(r/=t,n/=t,a>=r&&o<n)return e;if(o<r||a>=n)return null;for(var s=[],l=0;l<e.length;l++){var f=e[l],h=f.geometry,d=f.type,v=i===0?f.minX:f.minY,m=i===0?f.maxX:f.maxY;if(v>=r&&m<n){s.push(f);continue}else if(m<r||v>=n)continue;var y=[];if(d==="Point"||d==="MultiPoint")yN(h,y,r,n,i);else if(d==="LineString")V5(h,y,r,n,i,!1,u.lineMetrics);else if(d==="MultiLineString")h_(h,y,r,n,i,!1);else if(d==="Polygon")h_(h,y,r,n,i,!0);else if(d==="MultiPolygon")for(var _=0;_<h.length;_++){var E=[];h_(h[_],E,r,n,i,!0),E.length&&y.push(E)}if(y.length){if(u.lineMetrics&&d==="LineString"){for(_=0;_<y.length;_++)s.push(qd(f.id,d,y[_],f.tags));continue}(d==="LineString"||d==="MultiLineString")&&(y.length===1?(d="LineString",y=y[0]):d="MultiLineString"),(d==="Point"||d==="MultiPoint")&&(d=y.length===3?"Point":"MultiPoint"),s.push(qd(f.id,d,y,f.tags))}}return s.length?s:null}function yN(e,t,r,n,i){for(var a=0;a<e.length;a+=3){var o=e[a+i];o>=r&&o<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function V5(e,t,r,n,i,a,o){for(var u=zb(e),s=i===0?_N:xN,l=e.start,f,h,d=0;d<e.length-3;d+=3){var v=e[d],m=e[d+1],y=e[d+2],_=e[d+3],E=e[d+4],S=i===0?v:m,A=i===0?_:E,M=!1;o&&(f=Math.sqrt(Math.pow(v-_,2)+Math.pow(m-E,2))),S<r?A>r&&(h=s(u,v,m,_,E,r),o&&(u.start=l+f*h)):S>n?A<n&&(h=s(u,v,m,_,E,n),o&&(u.start=l+f*h)):p_(u,v,m,y),A<r&&S>=r&&(h=s(u,v,m,_,E,r),M=!0),A>n&&S<=n&&(h=s(u,v,m,_,E,n),M=!0),!a&&M&&(o&&(u.end=l+f*h),t.push(u),u=zb(e)),o&&(l+=f)}var O=e.length-3;v=e[O],m=e[O+1],y=e[O+2],S=i===0?v:m,S>=r&&S<=n&&p_(u,v,m,y),O=u.length-3,a&&O>=3&&(u[O]!==u[0]||u[O+1]!==u[1])&&p_(u,u[0],u[1],u[2]),u.length&&t.push(u)}function zb(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function h_(e,t,r,n,i,a){for(var o=0;o<e.length;o++)V5(e[o],t,r,n,i,a,!1)}function p_(e,t,r,n){e.push(t),e.push(r),e.push(n)}function _N(e,t,r,n,i,a){var o=(a-t)/(n-t);return e.push(a),e.push(r+(i-r)*o),e.push(1),o}function xN(e,t,r,n,i,a){var o=(a-r)/(i-r);return e.push(t+(n-t)*o),e.push(a),e.push(1),o}function EN(e,t){var r=t.buffer/t.extent,n=e,i=es(e,1,-1-r,r,0,-1,2,t),a=es(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=es(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=$b(i,1).concat(n)),a&&(n=n.concat($b(a,-1)))),n}function $b(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],a=i.type,o;if(a==="Point"||a==="MultiPoint"||a==="LineString")o=d_(i.geometry,t);else if(a==="MultiLineString"||a==="Polygon"){o=[];for(var u=0;u<i.geometry.length;u++)o.push(d_(i.geometry[u],t))}else if(a==="MultiPolygon")for(o=[],u=0;u<i.geometry.length;u++){for(var s=[],l=0;l<i.geometry[u].length;l++)s.push(d_(i.geometry[u][l],t));o.push(s)}r.push(qd(i.id,a,o,i.tags))}return r}function d_(e,t){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function Gb(e,t){if(e.transformed)return e;var r=1<<e.z,n=e.x,i=e.y,a,o,u;for(a=0;a<e.features.length;a++){var s=e.features[a],l=s.geometry,f=s.type;if(s.geometry=[],f===1)for(o=0;o<l.length;o+=2)s.geometry.push(Hb(l[o],l[o+1],t,r,n,i));else for(o=0;o<l.length;o++){var h=[];for(u=0;u<l[o].length;u+=2)h.push(Hb(l[o][u],l[o][u+1],t,r,n,i));s.geometry.push(h)}}return e.transformed=!0,e}function Hb(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function bN(e,t,r,n,i){for(var a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},u=0;u<e.length;u++){o.numFeatures++,CN(o,e[u],a,i);var s=e[u].minX,l=e[u].minY,f=e[u].maxX,h=e[u].maxY;s<o.minX&&(o.minX=s),l<o.minY&&(o.minY=l),f>o.maxX&&(o.maxX=f),h>o.maxY&&(o.maxY=h)}return o}function CN(e,t,r,n){var i=t.geometry,a=t.type,o=[];if(a==="Point"||a==="MultiPoint")for(var u=0;u<i.length;u+=3)o.push(i[u]),o.push(i[u+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")v_(o,i,e,r,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(u=0;u<i.length;u++)v_(o,i[u],e,r,a==="Polygon",u===0);else if(a==="MultiPolygon")for(var s=0;s<i.length;s++){var l=i[s];for(u=0;u<l.length;u++)v_(o,l[u],e,r,!0,u===0)}if(o.length){var f=t.tags||null;if(a==="LineString"&&n.lineMetrics){f={};for(var h in t.tags)f[h]=t.tags[h];f.mapbox_clip_start=i.start/i.size,f.mapbox_clip_end=i.end/i.size}var d={geometry:o,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:f};t.id!==null&&(d.id=t.id),e.features.push(d)}}function v_(e,t,r,n,i,a){var o=n*n;if(n>0&&t.size<(i?o:n)){r.numPoints+=t.length/3;return}for(var u=[],s=0;s<t.length;s+=3)(n===0||t[s+2]>o)&&(r.numSimplified++,u.push(t[s]),u.push(t[s+1])),r.numPoints++;i&&AN(u,a),e.push(u)}function AN(e,t){for(var r=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var o=e[n],u=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=o,e[i-1-n]=u}}function SN(e,t){return new xm(e,t)}function xm(e,t){t=this.options=TN(Object.create(this.options),t);var r=t.debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=mN(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=EN(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}xm.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};xm.prototype.splitTile=function(e,t,r,n,i,a,o){for(var u=[e,t,r,n],s=this.options,l=s.debug;u.length;){n=u.pop(),r=u.pop(),t=u.pop(),e=u.pop();var f=1<<t,h=F1(t,r,n),d=this.tiles[h];if(!d&&(l>1&&console.time("creation"),d=this.tiles[h]=bN(e,t,r,n,s),this.tileCoords.push({z:t,x:r,y:n}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var v="z"+t;this.stats[v]=(this.stats[v]||0)+1,this.total++}if(d.source=e,i){if(t===s.maxZoom||t===i)continue;var m=1<<i-t;if(r!==Math.floor(a/m)||n!==Math.floor(o/m))continue}else if(t===s.indexMaxZoom||d.numPoints<=s.indexMaxPoints)continue;if(d.source=null,e.length!==0){l>1&&console.time("clipping");var y=.5*s.buffer/s.extent,_=.5-y,E=.5+y,S=1+y,A,M,O,j,q,Y;A=M=O=j=null,q=es(e,f,r-y,r+E,0,d.minX,d.maxX,s),Y=es(e,f,r+_,r+S,0,d.minX,d.maxX,s),e=null,q&&(A=es(q,f,n-y,n+E,1,d.minY,d.maxY,s),M=es(q,f,n+_,n+S,1,d.minY,d.maxY,s),q=null),Y&&(O=es(Y,f,n-y,n+E,1,d.minY,d.maxY,s),j=es(Y,f,n+_,n+S,1,d.minY,d.maxY,s),Y=null),l>1&&console.timeEnd("clipping"),u.push(A||[],t+1,r*2,n*2),u.push(M||[],t+1,r*2,n*2+1),u.push(O||[],t+1,r*2+1,n*2),u.push(j||[],t+1,r*2+1,n*2+1)}}};xm.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var o=1<<e;t=(t%o+o)%o;var u=F1(e,t,r);if(this.tiles[u])return Gb(this.tiles[u],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var s=e,l=t,f=r,h;!h&&s>0;)s--,l=Math.floor(l/2),f=Math.floor(f/2),h=this.tiles[F1(s,l,f)];return!h||!h.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",s,l,f),a>1&&console.time("drilling down"),this.splitTile(h.source,s,l,f,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[u]?Gb(this.tiles[u],i):null)};function F1(e,t,r){return((1<<e)*r+t)*32+e}function TN(e,t){for(var r in t)e[r]=t[r];return e}var wN=function(){function e(t,r,n,i){ke(this,e),T(this,"vectorLayerCache",{}),this.x=r,this.y=n,this.z=i,this.vectorTile=t}return Pe(e,[{key:"getTileData",value:function(r){if(!r||!this.vectorTile.layers[r])return[];if(this.vectorLayerCache[r])return this.vectorLayerCache[r];var n=this.vectorTile.layers[r];return n.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),MN={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function RN(e){for(var t=0,r=0,n=e.length,i=n-1,a,o;r<n;i=r++)a=e[r],o=e[i],t+=(o.x-a.x)*(a.y+o.y);return t}function ON(e){var t=e.length;if(t<=1)return[e];for(var r=[],n,i,a=0;a<t;a++){var o=RN(e[a]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}var LN=["Unknown","Point","LineString","Polygon"];function FN(e,t,r,n,i){var a=i.geometry,o=i.type,u=i.tags,s=i.id,l=e*Math.pow(2,n),f=e*t,h=e*r,d=LN[o],v,m;function y(S){for(var A=0;A<S.length;A++){var M=S[A];if(M[3])break;var O=180-(M[1]+h)*360/l,j=(M[0]+f)*360/l-180,q=360/Math.PI*Math.atan(Math.exp(O*Math.PI/180))-90;S[A]=[j,q,0,1]}}switch(o){case 1:var _=[];for(v=0;v<a.length;v++)_[v]=a[v][0];a=_,y(a);break;case 2:for(v=0;v<a.length;v++)y(a[v]);break;case 3:for(a=ON(a),v=0;v<a.length;v++)for(m=0;m<a[v].length;m++)y(a[v][m]);break}a.length===1?a=a[0]:d="Multi"+d;var E={type:"Feature",geometry:{type:d,coordinates:a},properties:u,id:s,tileOrigin:[0,0],coord:""};return E}var IN=function(){var e=Ie(H.mark(function t(r,n,i,a){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",new Promise(function(s){var l=n.getTile(r.z,r.x,r.y),f=l?l.features.map(function(v){return FN(a,i.x,i.y,i.z,v)}):[],h={layers:{defaultLayer:{features:f}}},d=new wN(h,r.x,r.y,r.z);s(d)}));case 1:case"end":return u.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}();function kN(e){var t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions>"u"?t:be(be({},t),e.geojsonvtOptions)}function PN(e,t){var r=kN(t),n=r.extent||4096,i=SN(e,r),a=function(s,l){return IN(l,i,s,n)},o=be(be(be({},MN),t),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:o,isTile:!0}}function DN(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;case"^":return Math.pow(t,r);case"abs":return Math.abs(t);case"floor":return Math.floor(t);case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"sin":return Math.sin(t);case"cos":return Math.cos(t);case"atan":return r===-1?Math.atan(t):Math.atan2(t,r);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Fd(e,t){for(var r=t[0],n=r.width,i=r.height,a=t.map(function(v){return v.rasterData}),o=n*i,u=[],s=JSON.stringify(e),l=0;l<o;l++){var f=JSON.parse(s),h=j5(f,a,l);if(typeof h=="number")u.push(h);else{var d=I1(f);u.push(d)}}return u}function j5(e,t,r){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return t[e[1]][r]}catch{return console.warn("Raster Data err!"),0}e.map(function(n,i){if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[i]=t[n[1]][r]}catch{console.warn("Raster Data err!"),e[i]=0}break;default:j5(n,t,r)}})}function BN(e){var t=ir(e,3),r=t[0],n=t[1],i=n===void 0?-1:n,a=t[2],o=a===void 0?-1:a;if(r===void 0)return console.warn("Express err!"),["+",0,0];var u=r.replace(/\s+/g,"");return[u,i,o]}function I1(e){var t=BN(e),r=t[0],n=t[1],i=t[2];return Array.isArray(n)&&(n=I1(e[1])),Array.isArray(i)&&(i=I1(e[2])),DN(r,n,i)}var NN={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:UN}};function UN(e,t){for(var r=e[0].rasterData,n=e[1].rasterData,i=e[2].rasterData,a=[],o=(t==null?void 0:t.countCut)||[2,98],u=ir(o,2),s=u[0],l=u[1],f=(t==null?void 0:t.RMinMax)||g_(r,s,l),h=(t==null?void 0:t.GMinMax)||g_(n,s,l),d=(t==null?void 0:t.BMinMax)||g_(i,s,l),v=0;v<r.length;v++)a.push(Math.max(0,r[v]-f[0])),a.push(Math.max(0,n[v]-h[0])),a.push(Math.max(0,i[v]-d[0]));return{rasterData:a,rMinMax:f,gMinMax:h,bMinMax:d}}function g_(e,t,r){var n=e.slice().sort(function(u,s){return u-s}),i=n.length,a=n[Math.ceil(i*t/100)],o=n[Math.ceil(i*r/100)];return[a,o]}function oE(e,t,r){return k1.apply(this,arguments)}function k1(){return k1=Ie(H.mark(function e(t,r,n){var i,a,o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(t.length!==0){h.next=2;break}return h.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return h.next=4,Promise.all(t.map(function(d){var v=d.data,m=d.bands,y=m===void 0?[0]:m;return r(v,y)}));case 4:i=h.sent,a=[],i.forEach(function(d){Array.isArray(d)?a.push.apply(a,It(d)):a.push(d)}),o=a[0],u=o.width,s=o.height,h.t0=Th(n),h.next=h.t0==="function"?11:h.t0==="object"?13:15;break;case 11:return l=n(a),h.abrupt("break",16);case 13:return Array.isArray(n)?l={rasterData:Fd(n,a)}:l=zN(n,a),h.abrupt("break",16);case 15:l={rasterData:a[0].rasterData};case 16:return h.abrupt("return",be(be({},l),{},{width:u,height:s}));case 17:case"end":return h.stop()}},e)})),k1.apply(this,arguments)}function zN(e,t){var r=NN[e.type];if(r.type==="function")return r.method(t,e==null?void 0:e.options);if(r.type==="operation")return e.type==="rgb"?$N(r.expression,t):{rasterData:Fd(r.expression,t)}}function $N(e,t){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var r=Fd(e.r||["band",0],t),n=Fd(e.g||["band",0],t),i=Fd(e.b||["band",0],t);return[r,n,i]}function Vb(e,t,r,n){return P1.apply(this,arguments)}function P1(){return P1=Ie(H.mark(function e(t,r,n,i){var a;return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,oE(t,r,n);case 2:a=u.sent,i(null,{data:a});case 4:case"end":return u.stop()}},e)})),P1.apply(this,arguments)}function GN(e,t){return e.map(function(r){return r[t]*1})}function W5(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function HN(e,t){var r=t.extent,n=t.width,i=t.height,a=t.min,o=t.max,u=t.format,s=t.operation,l,f,h;if(u===void 0||W5(e))l=Array.from(e),f=n,h=i;else{var d=Array.isArray(e)?e:[e];l=oE(d,u,s)}var v={_id:1,dataArray:[{_id:1,data:l,width:f,height:h,min:a,max:o,coordinates:[[r[0],r[1]],[r[2],r[3]]]}]};return v}function VN(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function la(e,t){if(e==null)return{};var r=VN(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}var jN=["extent","min","max","width","height","format","operation"];function WN(e,t){var r=t.extent,n=t.min,i=t.max,a=t.width,o=t.height,u=t.format,s=t.operation,l=la(t,jN),f;if(u===void 0||W5(e))f=Array.from(e);else{var h=Array.isArray(e)?e:[e];f=oE(h,u,s)}var d={_id:1,dataArray:[be(be({_id:1,data:f,width:a,height:o},l),{},{min:n,max:i,coordinates:[[r[0],r[1]],[r[2],r[3]]]})]};return d}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var jb;(function(e){(function(t){var r=typeof du=="object"?du:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(e);typeof r.Reflect>"u"?r.Reflect=e:n=i(r.Reflect,n),t(n);function i(a,o){return function(u,s){typeof a[u]!="function"&&Object.defineProperty(a,u,{configurable:!0,writable:!0,value:s}),o&&o(u,s)}}})(function(t){var r=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",u={__proto__:[]}instanceof Array,s=!o&&!u,l={create:o?function(){return Gt(Object.create(null))}:u?function(){return Gt({__proto__:null})}:function(){return Gt({})},has:s?function(C,Se){return r.call(C,Se)}:function(C,Se){return Se in C},get:s?function(C,Se){return r.call(C,Se)?C[Se]:void 0}:function(C,Se){return C[Se]}},f=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",d=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:yt(),v=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:et(),m=!h&&typeof WeakMap=="function"?WeakMap:Wt(),y=new m;function _(C,Se,$e,ft){if(ct($e)){if(!qt(C))throw new TypeError;if(!k(Se))throw new TypeError;return X(C,Se)}else{if(!qt(C))throw new TypeError;if(!Zt(Se))throw new TypeError;if(!Zt(ft)&&!ct(ft)&&!$t(ft))throw new TypeError;return $t(ft)&&(ft=void 0),$e=Mt($e),$(C,Se,$e,ft)}}t("decorate",_);function E(C,Se){function $e(ft,St){if(!Zt(ft))throw new TypeError;if(!ct(St)&&!ae(St))throw new TypeError;ve(C,Se,ft,St)}return $e}t("metadata",E);function S(C,Se,$e,ft){if(!Zt($e))throw new TypeError;return ct(ft)||(ft=Mt(ft)),ve(C,Se,$e,ft)}t("defineMetadata",S);function A(C,Se,$e){if(!Zt(Se))throw new TypeError;return ct($e)||($e=Mt($e)),ue(C,Se,$e)}t("hasMetadata",A);function M(C,Se,$e){if(!Zt(Se))throw new TypeError;return ct($e)||($e=Mt($e)),de(C,Se,$e)}t("hasOwnMetadata",M);function O(C,Se,$e){if(!Zt(Se))throw new TypeError;return ct($e)||($e=Mt($e)),pe(C,Se,$e)}t("getMetadata",O);function j(C,Se,$e){if(!Zt(Se))throw new TypeError;return ct($e)||($e=Mt($e)),le(C,Se,$e)}t("getOwnMetadata",j);function q(C,Se){if(!Zt(C))throw new TypeError;return ct(Se)||(Se=Mt(Se)),Me(C,Se)}t("getMetadataKeys",q);function Y(C,Se){if(!Zt(C))throw new TypeError;return ct(Se)||(Se=Mt(Se)),Ne(C,Se)}t("getOwnMetadataKeys",Y);function ne(C,Se,$e){if(!Zt(Se))throw new TypeError;ct($e)||($e=Mt($e));var ft=K(Se,$e,!1);if(ct(ft)||!ft.delete(C))return!1;if(ft.size>0)return!0;var St=y.get(Se);return St.delete($e),St.size>0||y.delete(Se),!0}t("deleteMetadata",ne);function X(C,Se){for(var $e=C.length-1;$e>=0;--$e){var ft=C[$e],St=ft(Se);if(!ct(St)&&!$t(St)){if(!k(St))throw new TypeError;Se=St}}return Se}function $(C,Se,$e,ft){for(var St=C.length-1;St>=0;--St){var pr=C[St],rr=pr(Se,$e,ft);if(!ct(rr)&&!$t(rr)){if(!Zt(rr))throw new TypeError;ft=rr}}return ft}function K(C,Se,$e){var ft=y.get(C);if(ct(ft)){if(!$e)return;ft=new d,y.set(C,ft)}var St=ft.get(Se);if(ct(St)){if(!$e)return;St=new d,ft.set(Se,St)}return St}function ue(C,Se,$e){var ft=de(C,Se,$e);if(ft)return!0;var St=Je(Se);return $t(St)?!1:ue(C,St,$e)}function de(C,Se,$e){var ft=K(Se,$e,!1);return ct(ft)?!1:gn(ft.has(C))}function pe(C,Se,$e){var ft=de(C,Se,$e);if(ft)return le(C,Se,$e);var St=Je(Se);if(!$t(St))return pe(C,St,$e)}function le(C,Se,$e){var ft=K(Se,$e,!1);if(!ct(ft))return ft.get(C)}function ve(C,Se,$e,ft){var St=K($e,ft,!0);St.set(C,Se)}function Me(C,Se){var $e=Ne(C,Se),ft=Je(C);if(ft===null)return $e;var St=Me(ft,Se);if(St.length<=0)return $e;if($e.length<=0)return St;for(var pr=new v,rr=[],sr=0,Jt=$e;sr<Jt.length;sr++){var Er=Jt[sr],Ar=pr.has(Er);Ar||(pr.add(Er),rr.push(Er))}for(var Yr=0,Zr=St;Yr<Zr.length;Yr++){var Er=Zr[Yr],Ar=pr.has(Er);Ar||(pr.add(Er),rr.push(Er))}return rr}function Ne(C,Se){var $e=[],ft=K(C,Se,!1);if(ct(ft))return $e;for(var St=ft.keys(),pr=Ge(St),rr=0;;){var sr=Qe(pr);if(!sr)return $e.length=rr,$e;var Jt=je(sr);try{$e[rr]=Jt}catch(Er){try{Ot(pr)}finally{throw Er}}rr++}}function Xe(C){if(C===null)return 1;switch(typeof C){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return C===null?1:6;default:return 6}}function ct(C){return C===void 0}function $t(C){return C===null}function Qt(C){return typeof C=="symbol"}function Zt(C){return typeof C=="object"?C!==null:typeof C=="function"}function jt(C,Se){switch(Xe(C)){case 0:return C;case 1:return C;case 2:return C;case 3:return C;case 4:return C;case 5:return C}var $e=Se===3?"string":Se===5?"number":"default",ft=_e(C,i);if(ft!==void 0){var St=ft.call(C,$e);if(Zt(St))throw new TypeError;return St}return Cr(C,$e==="default"?"number":$e)}function Cr(C,Se){if(Se==="string"){var $e=C.toString;if(ar($e)){var ft=$e.call(C);if(!Zt(ft))return ft}var St=C.valueOf;if(ar(St)){var ft=St.call(C);if(!Zt(ft))return ft}}else{var St=C.valueOf;if(ar(St)){var ft=St.call(C);if(!Zt(ft))return ft}var pr=C.toString;if(ar(pr)){var ft=pr.call(C);if(!Zt(ft))return ft}}throw new TypeError}function gn(C){return!!C}function ii(C){return""+C}function Mt(C){var Se=jt(C,3);return Qt(Se)?Se:ii(Se)}function qt(C){return Array.isArray?Array.isArray(C):C instanceof Object?C instanceof Array:Object.prototype.toString.call(C)==="[object Array]"}function ar(C){return typeof C=="function"}function k(C){return typeof C=="function"}function ae(C){switch(Xe(C)){case 3:return!0;case 4:return!0;default:return!1}}function _e(C,Se){var $e=C[Se];if($e!=null){if(!ar($e))throw new TypeError;return $e}}function Ge(C){var Se=_e(C,a);if(!ar(Se))throw new TypeError;var $e=Se.call(C);if(!Zt($e))throw new TypeError;return $e}function je(C){return C.value}function Qe(C){var Se=C.next();return Se.done?!1:Se}function Ot(C){var Se=C.return;Se&&Se.call(C)}function Je(C){var Se=Object.getPrototypeOf(C);if(typeof C!="function"||C===f||Se!==f)return Se;var $e=C.prototype,ft=$e&&Object.getPrototypeOf($e);if(ft==null||ft===Object.prototype)return Se;var St=ft.constructor;return typeof St!="function"||St===C?Se:St}function yt(){var C={},Se=[],$e=function(){function rr(sr,Jt,Er){this._index=0,this._keys=sr,this._values=Jt,this._selector=Er}return rr.prototype["@@iterator"]=function(){return this},rr.prototype[a]=function(){return this},rr.prototype.next=function(){var sr=this._index;if(sr>=0&&sr<this._keys.length){var Jt=this._selector(this._keys[sr],this._values[sr]);return sr+1>=this._keys.length?(this._index=-1,this._keys=Se,this._values=Se):this._index++,{value:Jt,done:!1}}return{value:void 0,done:!0}},rr.prototype.throw=function(sr){throw this._index>=0&&(this._index=-1,this._keys=Se,this._values=Se),sr},rr.prototype.return=function(sr){return this._index>=0&&(this._index=-1,this._keys=Se,this._values=Se),{value:sr,done:!0}},rr}();return function(){function rr(){this._keys=[],this._values=[],this._cacheKey=C,this._cacheIndex=-2}return Object.defineProperty(rr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),rr.prototype.has=function(sr){return this._find(sr,!1)>=0},rr.prototype.get=function(sr){var Jt=this._find(sr,!1);return Jt>=0?this._values[Jt]:void 0},rr.prototype.set=function(sr,Jt){var Er=this._find(sr,!0);return this._values[Er]=Jt,this},rr.prototype.delete=function(sr){var Jt=this._find(sr,!1);if(Jt>=0){for(var Er=this._keys.length,Ar=Jt+1;Ar<Er;Ar++)this._keys[Ar-1]=this._keys[Ar],this._values[Ar-1]=this._values[Ar];return this._keys.length--,this._values.length--,sr===this._cacheKey&&(this._cacheKey=C,this._cacheIndex=-2),!0}return!1},rr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=C,this._cacheIndex=-2},rr.prototype.keys=function(){return new $e(this._keys,this._values,ft)},rr.prototype.values=function(){return new $e(this._keys,this._values,St)},rr.prototype.entries=function(){return new $e(this._keys,this._values,pr)},rr.prototype["@@iterator"]=function(){return this.entries()},rr.prototype[a]=function(){return this.entries()},rr.prototype._find=function(sr,Jt){return this._cacheKey!==sr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=sr)),this._cacheIndex<0&&Jt&&(this._cacheIndex=this._keys.length,this._keys.push(sr),this._values.push(void 0)),this._cacheIndex},rr}();function ft(rr,sr){return rr}function St(rr,sr){return sr}function pr(rr,sr){return[rr,sr]}}function et(){return function(){function C(){this._map=new d}return Object.defineProperty(C.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),C.prototype.has=function(Se){return this._map.has(Se)},C.prototype.add=function(Se){return this._map.set(Se,Se),this},C.prototype.delete=function(Se){return this._map.delete(Se)},C.prototype.clear=function(){this._map.clear()},C.prototype.keys=function(){return this._map.keys()},C.prototype.values=function(){return this._map.values()},C.prototype.entries=function(){return this._map.entries()},C.prototype["@@iterator"]=function(){return this.keys()},C.prototype[a]=function(){return this.keys()},C}()}function Wt(){var C=16,Se=l.create(),$e=ft();return function(){function Jt(){this._key=ft()}return Jt.prototype.has=function(Er){var Ar=St(Er,!1);return Ar!==void 0?l.has(Ar,this._key):!1},Jt.prototype.get=function(Er){var Ar=St(Er,!1);return Ar!==void 0?l.get(Ar,this._key):void 0},Jt.prototype.set=function(Er,Ar){var Yr=St(Er,!0);return Yr[this._key]=Ar,this},Jt.prototype.delete=function(Er){var Ar=St(Er,!1);return Ar!==void 0?delete Ar[this._key]:!1},Jt.prototype.clear=function(){this._key=ft()},Jt}();function ft(){var Jt;do Jt="@@WeakMap@@"+sr();while(l.has(Se,Jt));return Se[Jt]=!0,Jt}function St(Jt,Er){if(!r.call(Jt,$e)){if(!Er)return;Object.defineProperty(Jt,$e,{value:l.create()})}return Jt[$e]}function pr(Jt,Er){for(var Ar=0;Ar<Er;++Ar)Jt[Ar]=Math.random()*255|0;return Jt}function rr(Jt){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(Jt)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(Jt)):pr(new Uint8Array(Jt),Jt):pr(new Array(Jt),Jt)}function sr(){var Jt=rr(C);Jt[6]=Jt[6]&79|64,Jt[8]=Jt[8]&191|128;for(var Er="",Ar=0;Ar<C;++Ar){var Yr=Jt[Ar];(Ar===4||Ar===6||Ar===8)&&(Er+="-"),Yr<16&&(Er+="0"),Er+=Yr.toString(16).toLowerCase()}return Er}}function Gt(C){return C.__=void 0,delete C.__,C}})})(jb||(jb={}));var mu="named",X5="name",uE="unmanaged",Y5="optional",Em="inject",Kd="multi_inject",Z5="inversify:tagged",q5="inversify:tagged_props",D1="inversify:paramtypes",XN="design:paramtypes",Id="post_construct";function YN(){return[Em,Kd,X5,uE,mu,Y5]}var Wb=YN(),Ai={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Ci={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},ns={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},ZN=0;function v0(){return ZN++}var qN=function(){function e(t,r){this.id=v0(),this.activated=!1,this.serviceIdentifier=t,this.scope=r,this.type=Ci.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===Ai.Singleton?this.activated:!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}(),KN="Cannot apply @injectable decorator multiple times.",QN="Metadata key was used more than once in a parameter:",rd="NULL argument",Xb="Key Not Found",JN="Ambiguous match found for serviceIdentifier:",e9="Could not unbind serviceIdentifier:",t9="No matching bindings found for serviceIdentifier:",r9="Missing required @injectable annotation in:",n9="Missing required @inject or @multiInject annotation in:",i9=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},a9="Circular dependency found:",o9="Invalid binding type:",u9="No snapshot available to restore.",s9="Invalid return type in middleware. Middleware must return!",l9="Value provided to function binding must be a function!",c9="The toSelf function can only be applied when a constructor is used as service identifier",f9="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",h9=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+(e[0]+" must be >= than the number of constructor arguments of its base class.")},p9="Invalid Container constructor argument. Container options must be an object.",d9="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",v9="Invalid Container option. Auto bind injectable must be a boolean",g9="Invalid Container option. Skip base check must be a boolean",m9="Cannot apply @postConstruct decorator multiple times in the same class",y9=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},_9=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency "+("in one of the '"+e[0]+"' bindings. Please investigate bindings with")+("service identifier '"+e[1]+"'.")},x9="Maximum call stack size exceeded",E9=function(){function e(){}return e.prototype.getConstructorMetadata=function(t){var r=Reflect.getMetadata(D1,t),n=Reflect.getMetadata(Z5,t);return{compilerGeneratedMetadata:r,userGeneratedMetadata:n||{}}},e.prototype.getPropertiesMetadata=function(t){var r=Reflect.getMetadata(q5,t)||[];return r},e}(),mg={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function K5(e){return e instanceof RangeError||e.message===x9}function Qd(e){if(typeof e=="function"){var t=e;return t.name}else{if(typeof e=="symbol")return e.toString();var t=e;return t}}function Yb(e,t,r){var n="",i=r(e,t);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(a){var o="Object";a.implementationType!==null&&(o=bm(a.implementationType)),n=n+`
 `+o,a.constraint.metaData&&(n=n+" - "+a.constraint.metaData)})),n}function Q5(e,t){return e.parentRequest===null?!1:e.parentRequest.serviceIdentifier===t?!0:Q5(e.parentRequest,t)}function b9(e){function t(n,i){i===void 0&&(i=[]);var a=Qd(n.serviceIdentifier);return i.push(a),n.parentRequest!==null?t(n.parentRequest,i):i}var r=t(e);return r.reverse().join(" --> ")}function J5(e){e.childRequests.forEach(function(t){if(Q5(t,t.serviceIdentifier)){var r=b9(t);throw new Error(a9+" "+r)}else J5(t)})}function C9(e,t){if(t.isTagged()||t.isNamed()){var r="",n=t.getNamedTag(),i=t.getCustomTags();return n!==null&&(r+=n.toString()+`
`),i!==null&&i.forEach(function(a){r+=a.toString()+`
`})," "+e+`
 `+e+" - "+r}else return" "+e}function bm(e){if(e.name)return e.name;var t=e.toString(),r=t.match(/^function\s*([^\s(]+)/);return r?r[1]:"Anonymous function: "+t}var eM=function(){function e(t){this.id=v0(),this.container=t}return e.prototype.addPlan=function(t){this.plan=t},e.prototype.setCurrentRequest=function(t){this.currentRequest=t},e}(),xl=function(){function e(t,r){this.key=t,this.value=r}return e.prototype.toString=function(){return this.key===mu?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}(),A9=function(){function e(t,r){this.parentContext=t,this.rootRequest=r}return e}();function S9(e,t,r,n){var i=Z5;tM(i,e,t,n,r)}function T9(e,t,r){var n=q5;tM(n,e.constructor,t,r)}function tM(e,t,r,n,i){var a={},o=typeof i=="number",u=i!==void 0&&o?i.toString():r;if(o&&r!==void 0)throw new Error(f9);Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var s=a[u];if(!Array.isArray(s))s=[];else for(var l=0,f=s;l<f.length;l++){var h=f[l];if(h.key===n.key)throw new Error(QN+" "+h.key.toString())}s.push(n),a[u]=s,Reflect.defineMetadata(e,a,t)}function Zb(e,t){Reflect.decorate(e,t)}function w9(e,t){return function(r,n){t(r,n,e)}}function M9(e,t,r){typeof r=="number"?Zb([w9(r,e)],t):typeof r=="string"?Reflect.decorate([e],t,r):Zb([e],t)}var R9=function(){function e(t){this._cb=t}return e.prototype.unwrap=function(){return this._cb()},e}();function kr(e){return function(t,r,n){if(e===void 0)throw new Error(i9(t.name));var i=new xl(Em,e);typeof n=="number"?S9(t,r,n,i):T9(t,r,i)}}var O9=function(){function e(t){this.str=t}return e.prototype.startsWith=function(t){return this.str.indexOf(t)===0},e.prototype.endsWith=function(t){var r="",n=t.split("").reverse().join("");return r=this.str.split("").reverse().join(""),this.startsWith.call({str:r},n)},e.prototype.contains=function(t){return this.str.indexOf(t)!==-1},e.prototype.equals=function(t){return this.str===t},e.prototype.value=function(){return this.str},e}(),Cm=function(){function e(t,r,n,i){this.id=v0(),this.type=t,this.serviceIdentifier=n,this.name=new O9(r||""),this.metadata=new Array;var a=null;typeof i=="string"?a=new xl(mu,i):i instanceof xl&&(a=i),a!==null&&this.metadata.push(a)}return e.prototype.hasTag=function(t){for(var r=0,n=this.metadata;r<n.length;r++){var i=n[r];if(i.key===t)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(Kd)},e.prototype.matchesArray=function(t){return this.matchesTag(Kd)(t)},e.prototype.isNamed=function(){return this.hasTag(mu)},e.prototype.isTagged=function(){return this.metadata.some(function(t){return Wb.every(function(r){return t.key!==r})})},e.prototype.isOptional=function(){return this.matchesTag(Y5)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===mu})[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(t){return Wb.every(function(r){return t.key!==r})}):null},e.prototype.matchesNamedTag=function(t){return this.matchesTag(mu)(t)},e.prototype.matchesTag=function(t){var r=this;return function(n){for(var i=0,a=r.metadata;i<a.length;i++){var o=a[i];if(o.key===t&&o.value===n)return!0}return!1}},e}(),Fg=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};function L9(e,t){var r=bm(t),n=rM(e,r,t,!1);return n}function rM(e,t,r,n){var i=e.getConstructorMetadata(r),a=i.compilerGeneratedMetadata;if(a===void 0){var o=r9+" "+t+".";throw new Error(o)}var u=i.userGeneratedMetadata,s=Object.keys(u),l=r.length===0&&s.length>0,f=s.length>r.length,h=l||f?s.length:r.length,d=I9(n,t,a,u,h),v=nM(e,r),m=Fg(Fg([],d),v);return m}function F9(e,t,r,n,i){var a=i[e.toString()]||[],o=aM(a),u=o.unmanaged!==!0,s=n[e],l=o.inject||o.multiInject;if(s=l||s,s instanceof R9&&(s=s.unwrap()),u){var f=s===Object,h=s===Function,d=s===void 0,v=f||h||d;if(!t&&v){var m=n9+" argument "+e+" in class "+r+".";throw new Error(m)}var y=new Cm(ns.ConstructorArgument,o.targetName,s);return y.metadata=a,y}return null}function I9(e,t,r,n,i){for(var a=[],o=0;o<i;o++){var u=o,s=F9(u,e,t,r,n);s!==null&&a.push(s)}return a}function nM(e,t){for(var r=e.getPropertiesMetadata(t),n=[],i=Object.keys(r),a=0,o=i;a<o.length;a++){var u=o[a],s=r[u],l=aM(r[u]),f=l.targetName||u,h=l.inject||l.multiInject,d=new Cm(ns.ClassProperty,f,h);d.metadata=s,n.push(d)}var v=Object.getPrototypeOf(t.prototype).constructor;if(v!==Object){var m=nM(e,v);n=Fg(Fg([],n),m)}return n}function iM(e,t){var r=Object.getPrototypeOf(t.prototype).constructor;if(r!==Object){var n=bm(r),i=rM(e,n,r,!0),a=i.map(function(s){return s.metadata.filter(function(l){return l.key===uE})}),o=[].concat.apply([],a).length,u=i.length-o;return u>0?u:iM(e,r)}else return 0}function aM(e){var t={};return e.forEach(function(r){t[r.key.toString()]=r.value}),{inject:t[Em],multiInject:t[Kd],targetName:t[X5],unmanaged:t[uE]}}var sE=function(){function e(t,r,n,i,a){this.id=v0(),this.serviceIdentifier=t,this.parentContext=r,this.parentRequest=n,this.target=a,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return e.prototype.addChildRequest=function(t,r,n){var i=new e(t,this.parentContext,this,r,n);return this.childRequests.push(i),i},e}();function B1(e){return e._bindingDictionary}function k9(e,t,r,n,i,a){var o=e?Kd:Em,u=new xl(o,r),s=new Cm(t,n,r,u);if(i!==void 0){var l=new xl(i,a);s.metadata.push(l)}return s}function qb(e,t,r,n,i){var a=Jd(r.container,i.serviceIdentifier),o=[];return a.length===mg.NoBindingsAvailable&&r.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(i.serviceIdentifier).toSelf(),a=Jd(r.container,i.serviceIdentifier)),t?o=a:o=a.filter(function(u){var s=new sE(u.serviceIdentifier,r,n,u,i);return u.constraint(s)}),P9(i.serviceIdentifier,o,i,r.container),o}function P9(e,t,r,n){switch(t.length){case mg.NoBindingsAvailable:if(r.isOptional())return t;var i=Qd(e),a=t9;throw a+=C9(i,r),a+=Yb(n,i,Jd),new Error(a);case mg.OnlyOneBindingAvailable:if(!r.isArray())return t;case mg.MultipleBindingsAvailable:default:if(r.isArray())return t;var i=Qd(e),a=JN+" "+i;throw a+=Yb(n,i,Jd),new Error(a)}}function oM(e,t,r,n,i,a){var o,u;if(i===null){o=qb(e,t,n,null,a),u=new sE(r,n,null,o,a);var s=new A9(n,u);n.addPlan(s)}else o=qb(e,t,n,i,a),u=i.addChildRequest(a.serviceIdentifier,o,a);o.forEach(function(l){var f=null;if(a.isArray())f=u.addChildRequest(l.serviceIdentifier,l,a);else{if(l.cache)return;f=u}if(l.type===Ci.Instance&&l.implementationType!==null){var h=L9(e,l.implementationType);if(!n.container.options.skipBaseClassChecks){var d=iM(e,l.implementationType);if(h.length<d){var v=h9(bm(l.implementationType));throw new Error(v)}}h.forEach(function(m){oM(e,!1,m.serviceIdentifier,n,f,m)})}})}function Jd(e,t){var r=[],n=B1(e);return n.hasKey(t)?r=n.get(t):e.parent!==null&&(r=Jd(e.parent,t)),r}function D9(e,t,r,n,i,a,o,u){u===void 0&&(u=!1);var s=new eM(t),l=k9(r,n,i,"",a,o);try{return oM(e,u,i,s,null,l),s}catch(f){throw K5(f)&&s.plan&&J5(s.plan.rootRequest),f}}function B9(e,t,r,n){var i=new Cm(ns.Variable,"",t,new xl(r,n)),a=new eM(e),o=new sE(t,a,null,[],i);return o}var N9=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};function U9(e,t,r){var n=t.filter(function(a){return a.target!==null&&a.target.type===ns.ClassProperty}),i=n.map(r);return n.forEach(function(a,o){var u="";u=a.target.name.value();var s=i[o];e[u]=s}),e}function z9(e,t){return new(e.bind.apply(e,N9([void 0],t)))}function $9(e,t){if(Reflect.hasMetadata(Id,e)){var r=Reflect.getMetadata(Id,e);try{t[r.value]()}catch(n){throw new Error(y9(e.name,n.message))}}}function G9(e,t,r){var n=null;if(t.length>0){var i=t.filter(function(o){return o.target!==null&&o.target.type===ns.ConstructorArgument}),a=i.map(r);n=z9(e,a),n=U9(n,t,r)}else n=new e;return $9(e,n),n}var m_=function(e,t,r){try{return r()}catch(n){throw K5(n)?new Error(_9(e,t.toString())):n}},N1=function(e){return function(t){t.parentContext.setCurrentRequest(t);var r=t.bindings,n=t.childRequests,i=t.target&&t.target.isArray(),a=!t.parentRequest||!t.parentRequest.target||!t.target||!t.parentRequest.target.matchesArray(t.target.serviceIdentifier);if(i&&a)return n.map(function(h){var d=N1(e);return d(h)});var o=null;if(t.target.isOptional()&&r.length===0)return;var u=r[0],s=u.scope===Ai.Singleton,l=u.scope===Ai.Request;if(s&&u.activated)return u.cache;if(l&&e!==null&&e.has(u.id))return e.get(u.id);if(u.type===Ci.ConstantValue)o=u.cache,u.activated=!0;else if(u.type===Ci.Function)o=u.cache,u.activated=!0;else if(u.type===Ci.Constructor)o=u.implementationType;else if(u.type===Ci.DynamicValue&&u.dynamicValue!==null)o=m_("toDynamicValue",u.serviceIdentifier,function(){return u.dynamicValue(t.parentContext)});else if(u.type===Ci.Factory&&u.factory!==null)o=m_("toFactory",u.serviceIdentifier,function(){return u.factory(t.parentContext)});else if(u.type===Ci.Provider&&u.provider!==null)o=m_("toProvider",u.serviceIdentifier,function(){return u.provider(t.parentContext)});else if(u.type===Ci.Instance&&u.implementationType!==null)o=G9(u.implementationType,n,N1(e));else{var f=Qd(t.serviceIdentifier);throw new Error(o9+" "+f)}return typeof u.onActivation=="function"&&(o=u.onActivation(t.parentContext,o)),s&&(u.cache=o,u.activated=!0),l&&e!==null&&!e.has(u.id)&&e.set(u.id,o),o}};function H9(e){var t=N1(e.plan.rootRequest.requestScope);return t(e.plan.rootRequest)}var Ku=function(e,t){var r=e.parentRequest;return r!==null?t(r)?!0:Ku(r,t):!1},xd=function(e){return function(t){var r=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(e)(t)};return r.metaData=new xl(e,t),r}},Xv=xd(mu),y_=function(e){return function(t){var r=null;if(t!==null)if(r=t.bindings[0],typeof e=="string"){var n=r.serviceIdentifier;return n===e}else{var i=t.bindings[0].implementationType;return e===i}return!1}},lE=function(){function e(t){this._binding=t}return e.prototype.when=function(t){return this._binding.constraint=t,new Ei(this._binding)},e.prototype.whenTargetNamed=function(t){return this._binding.constraint=Xv(t),new Ei(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){var r=t.target!==null&&!t.target.isNamed()&&!t.target.isTagged();return r},new Ei(this._binding)},e.prototype.whenTargetTagged=function(t,r){return this._binding.constraint=xd(t)(r),new Ei(this._binding)},e.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(r){return y_(t)(r.parentRequest)},new Ei(this._binding)},e.prototype.whenParentNamed=function(t){return this._binding.constraint=function(r){return Xv(t)(r.parentRequest)},new Ei(this._binding)},e.prototype.whenParentTagged=function(t,r){return this._binding.constraint=function(n){return xd(t)(r)(n.parentRequest)},new Ei(this._binding)},e.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(r){return Ku(r,y_(t))},new Ei(this._binding)},e.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(r){return!Ku(r,y_(t))},new Ei(this._binding)},e.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(r){return Ku(r,Xv(t))},new Ei(this._binding)},e.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(r){return!Ku(r,Xv(t))},new Ei(this._binding)},e.prototype.whenAnyAncestorTagged=function(t,r){return this._binding.constraint=function(n){return Ku(n,xd(t)(r))},new Ei(this._binding)},e.prototype.whenNoAncestorTagged=function(t,r){return this._binding.constraint=function(n){return!Ku(n,xd(t)(r))},new Ei(this._binding)},e.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(r){return Ku(r,t)},new Ei(this._binding)},e.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(r){return!Ku(r,t)},new Ei(this._binding)},e}(),Ei=function(){function e(t){this._binding=t}return e.prototype.onActivation=function(t){return this._binding.onActivation=t,new lE(this._binding)},e}(),cl=function(){function e(t){this._binding=t,this._bindingWhenSyntax=new lE(this._binding),this._bindingOnSyntax=new Ei(this._binding)}return e.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},e.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(t,r){return this._bindingWhenSyntax.whenTargetTagged(t,r)},e.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},e.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},e.prototype.whenParentTagged=function(t,r){return this._bindingWhenSyntax.whenParentTagged(t,r)},e.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},e.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},e.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},e.prototype.whenAnyAncestorTagged=function(t,r){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,r)},e.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},e.prototype.whenNoAncestorTagged=function(t,r){return this._bindingWhenSyntax.whenNoAncestorTagged(t,r)},e.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},e.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},e.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},e}(),V9=function(){function e(t){this._binding=t}return e.prototype.inRequestScope=function(){return this._binding.scope=Ai.Request,new cl(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=Ai.Singleton,new cl(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=Ai.Transient,new cl(this._binding)},e}(),Kb=function(){function e(t){this._binding=t,this._bindingWhenSyntax=new lE(this._binding),this._bindingOnSyntax=new Ei(this._binding),this._bindingInSyntax=new V9(t)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},e.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(t,r){return this._bindingWhenSyntax.whenTargetTagged(t,r)},e.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},e.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},e.prototype.whenParentTagged=function(t,r){return this._bindingWhenSyntax.whenParentTagged(t,r)},e.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},e.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},e.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},e.prototype.whenAnyAncestorTagged=function(t,r){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,r)},e.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},e.prototype.whenNoAncestorTagged=function(t,r){return this._bindingWhenSyntax.whenNoAncestorTagged(t,r)},e.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},e.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},e.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},e}(),j9=function(){function e(t){this._binding=t}return e.prototype.to=function(t){return this._binding.type=Ci.Instance,this._binding.implementationType=t,new Kb(this._binding)},e.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+c9);var t=this._binding.serviceIdentifier;return this.to(t)},e.prototype.toConstantValue=function(t){return this._binding.type=Ci.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Ai.Singleton,new cl(this._binding)},e.prototype.toDynamicValue=function(t){return this._binding.type=Ci.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Kb(this._binding)},e.prototype.toConstructor=function(t){return this._binding.type=Ci.Constructor,this._binding.implementationType=t,this._binding.scope=Ai.Singleton,new cl(this._binding)},e.prototype.toFactory=function(t){return this._binding.type=Ci.Factory,this._binding.factory=t,this._binding.scope=Ai.Singleton,new cl(this._binding)},e.prototype.toFunction=function(t){if(typeof t!="function")throw new Error(l9);var r=this.toConstantValue(t);return this._binding.type=Ci.Function,this._binding.scope=Ai.Singleton,r},e.prototype.toAutoFactory=function(t){return this._binding.type=Ci.Factory,this._binding.factory=function(r){var n=function(){return r.container.get(t)};return n},this._binding.scope=Ai.Singleton,new cl(this._binding)},e.prototype.toProvider=function(t){return this._binding.type=Ci.Provider,this._binding.provider=t,this._binding.scope=Ai.Singleton,new cl(this._binding)},e.prototype.toService=function(t){this.toDynamicValue(function(r){return r.container.get(t)})},e}(),W9=function(){function e(){}return e.of=function(t,r){var n=new e;return n.bindings=t,n.middleware=r,n},e}(),Qb=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(t,r){if(t==null)throw new Error(rd);if(r==null)throw new Error(rd);var n=this._map.get(t);n!==void 0?(n.push(r),this._map.set(t,n)):this._map.set(t,[r])},e.prototype.get=function(t){if(t==null)throw new Error(rd);var r=this._map.get(t);if(r!==void 0)return r;throw new Error(Xb)},e.prototype.remove=function(t){if(t==null)throw new Error(rd);if(!this._map.delete(t))throw new Error(Xb)},e.prototype.removeByCondition=function(t){var r=this;this._map.forEach(function(n,i){var a=n.filter(function(o){return!t(o)});a.length>0?r._map.set(i,a):r._map.delete(i)})},e.prototype.hasKey=function(t){if(t==null)throw new Error(rd);return this._map.has(t)},e.prototype.clone=function(){var t=new e;return this._map.forEach(function(r,n){r.forEach(function(i){return t.add(n,i.clone())})}),t},e.prototype.traverse=function(t){this._map.forEach(function(r,n){t(n,r)})},e}(),X9=globalThis&&globalThis.__awaiter||function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(f){try{l(n.next(f))}catch(h){o(h)}}function s(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(u,s)}l((n=n.apply(e,t||[])).next())})},Y9=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(f){return s([l,f])}}function s(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Z9=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},cE=function(){function e(t){this._appliedMiddleware=[];var r=t||{};if(typeof r!="object")throw new Error(""+p9);if(r.defaultScope===void 0)r.defaultScope=Ai.Transient;else if(r.defaultScope!==Ai.Singleton&&r.defaultScope!==Ai.Transient&&r.defaultScope!==Ai.Request)throw new Error(""+d9);if(r.autoBindInjectable===void 0)r.autoBindInjectable=!1;else if(typeof r.autoBindInjectable!="boolean")throw new Error(""+v9);if(r.skipBaseClassChecks===void 0)r.skipBaseClassChecks=!1;else if(typeof r.skipBaseClassChecks!="boolean")throw new Error(""+g9);this.options={autoBindInjectable:r.autoBindInjectable,defaultScope:r.defaultScope,skipBaseClassChecks:r.skipBaseClassChecks},this.id=v0(),this._bindingDictionary=new Qb,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new E9}return e.merge=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=new e,o=Z9([t,r],n).map(function(l){return B1(l)}),u=B1(a);function s(l,f){l.traverse(function(h,d){d.forEach(function(v){f.add(v.serviceIdentifier,v.clone())})})}return o.forEach(function(l){s(l,u)}),a},e.prototype.load=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=this._getContainerModuleHelpersFactory(),i=0,a=t;i<a.length;i++){var o=a[i],u=n(o.id);o.registry(u.bindFunction,u.unbindFunction,u.isboundFunction,u.rebindFunction)}},e.prototype.loadAsync=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return X9(this,void 0,void 0,function(){var n,i,a,o,u;return Y9(this,function(s){switch(s.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,a=t,s.label=1;case 1:return i<a.length?(o=a[i],u=n(o.id),[4,o.registry(u.bindFunction,u.unbindFunction,u.isboundFunction,u.rebindFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},e.prototype.unload=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=function(a){return function(o){return o.moduleId===a}};r.forEach(function(a){var o=i(a.id);t._bindingDictionary.removeByCondition(o)})},e.prototype.bind=function(t){var r=this.options.defaultScope||Ai.Transient,n=new qN(t,r);return this._bindingDictionary.add(t,n),new j9(n)},e.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},e.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch{throw new Error(e9+" "+Qd(t))}},e.prototype.unbindAll=function(){this._bindingDictionary=new Qb},e.prototype.isBound=function(t){var r=this._bindingDictionary.hasKey(t);return!r&&this.parent&&(r=this.parent.isBound(t)),r},e.prototype.isBoundNamed=function(t,r){return this.isBoundTagged(t,mu,r)},e.prototype.isBoundTagged=function(t,r,n){var i=!1;if(this._bindingDictionary.hasKey(t)){var a=this._bindingDictionary.get(t),o=B9(this,t,r,n);i=a.some(function(u){return u.constraint(o)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(t,r,n)),i},e.prototype.snapshot=function(){this._snapshots.push(W9.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var t=this._snapshots.pop();if(t===void 0)throw new Error(u9);this._bindingDictionary=t.bindings,this._middleware=t.middleware},e.prototype.createChild=function(t){var r=new e(t||this.options);return r.parent=this,r},e.prototype.applyMiddleware=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._appliedMiddleware=this._appliedMiddleware.concat(t);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce(function(i,a){return a(i)},n)},e.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},e.prototype.get=function(t){return this._get(!1,!1,ns.Variable,t)},e.prototype.getTagged=function(t,r,n){return this._get(!1,!1,ns.Variable,t,r,n)},e.prototype.getNamed=function(t,r){return this.getTagged(t,mu,r)},e.prototype.getAll=function(t){return this._get(!0,!0,ns.Variable,t)},e.prototype.getAllTagged=function(t,r,n){return this._get(!1,!0,ns.Variable,t,r,n)},e.prototype.getAllNamed=function(t,r){return this.getAllTagged(t,mu,r)},e.prototype.resolve=function(t){var r=this.createChild();return r.bind(t).toSelf(),this._appliedMiddleware.forEach(function(n){r.applyMiddleware(n)}),r.get(t)},e.prototype._getContainerModuleHelpersFactory=function(){var t=this,r=function(u,s){u._binding.moduleId=s},n=function(u){return function(s){var l=t.bind.bind(t),f=l(s);return r(f,u),f}},i=function(u){return function(s){var l=t.unbind.bind(t);l(s)}},a=function(u){return function(s){var l=t.isBound.bind(t);return l(s)}},o=function(u){return function(s){var l=t.rebind.bind(t),f=l(s);return r(f,u),f}};return function(u){return{bindFunction:n(u),isboundFunction:a(),rebindFunction:o(u),unbindFunction:i()}}},e.prototype._get=function(t,r,n,i,a,o){var u=null,s={avoidConstraints:t,contextInterceptor:function(l){return l},isMultiInject:r,key:a,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(u=this._middleware(s),u==null)throw new Error(s9)}else u=this._planAndResolve()(s);return u},e.prototype._planAndResolve=function(){var t=this;return function(r){var n=D9(t._metadataReader,t,r.isMultiInject,r.targetType,r.serviceIdentifier,r.key,r.value,r.avoidConstraints);n=r.contextInterceptor(n);var i=H9(n);return i}},e}();function xr(){return function(e){if(Reflect.hasOwnMetadata(D1,e))throw new Error(KN);var t=Reflect.getMetadata(XN,e)||[];return Reflect.defineMetadata(D1,t,e),e}}function q9(){return function(e,t,r){var n=new xl(Id,t);if(Reflect.hasOwnMetadata(Id,e.constructor))throw new Error(m9);Reflect.defineMetadata(Id,n,e.constructor)}}var nd=Symbol.for("INJECTION");function Am(e,t,r,n){function i(){return n&&!Reflect.hasMetadata(nd,this,t)&&Reflect.defineMetadata(nd,r(),this,t),Reflect.hasMetadata(nd,this,t)?Reflect.getMetadata(nd,this,t):r()}function a(o){Reflect.defineMetadata(nd,o,this,t)}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:i,set:a})}function K9(e,t){return function(r){return function(n,i){var a=function(){return e.get(r)};Am(n,i,a,t)}}}function Q9(e,t){return function(r,n){return function(i,a){var o=function(){return e.getNamed(r,n)};Am(i,a,o,t)}}}function J9(e,t){return function(r,n,i){return function(a,o){var u=function(){return e.getTagged(r,n,i)};Am(a,o,u,t)}}}function eU(e,t){return function(r){return function(n,i){var a=function(){return e.getAll(r)};Am(n,i,a,t)}}}function tU(e,t){t===void 0&&(t=!0);var r=K9(e,t),n=Q9(e,t),i=J9(e,t),a=eU(e,t);return{lazyInject:r,lazyInjectNamed:n,lazyInjectTagged:i,lazyMultiInject:a}}var Oe={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},fE={exports:{}};fE.exports=g0;fE.exports.default=g0;var bh=1e20;function g0(e,t,r,n,i,a){this.fontSize=e||24,this.buffer=t===void 0?3:t,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=r||8;var o=this.size=this.fontSize+this.buffer*2,u=o+this.buffer*2,s=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;s?this.canvas=my.createOffscreenCanvas(o,o,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,s?this.middle=Math.round(o/2*1):this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function rU(e,t,r,n,i,a,o){a.fill(bh,0,t*r),o.fill(0,0,t*r);for(var u=(t-n)/2,s=0;s<i;s++)for(var l=0;l<n;l++){var f=(s+u)*t+l+u,h=e.data[4*(s*n+l)+3]/255;if(h===1)a[f]=0,o[f]=bh;else if(h===0)a[f]=bh,o[f]=0;else{var d=Math.max(0,.5-h),v=Math.max(0,h-.5);a[f]=d*d,o[f]=v*v}}}function nU(e,t,r,n,i,a,o){for(var u=0;u<t*r;u++){var s=Math.sqrt(n[u])-Math.sqrt(i[u]);e[u]=Math.round(255-255*(s/a+o))}}g0.prototype._draw=function(e,t){var r=this.ctx.measureText(e),n=r.width,i=2*this.buffer,a,o,u,s,l,f,h,d;t&&this.useMetrics?(l=Math.floor(r.actualBoundingBoxAscent),d=this.buffer+Math.ceil(r.actualBoundingBoxAscent),f=this.buffer,h=this.buffer,o=Math.min(this.size,Math.ceil(r.actualBoundingBoxRight-r.actualBoundingBoxLeft)),s=Math.min(this.size-f,Math.ceil(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)),a=o+i,u=s+i,this.ctx.textBaseline="alphabetic"):(a=o=this.size,u=s=this.size,l=19*this.fontSize/24,f=h=0,d=this.middle,this.ctx.textBaseline="middle");var v;o&&s&&(this.ctx.clearRect(h,f,o,s),this.ctx.fillText(e,this.buffer,d),v=this.ctx.getImageData(h,f,o,s));var m=new Uint8ClampedArray(a*u);return rU(v,a,u,o,s,this.gridOuter,this.gridInner),Jb(this.gridOuter,a,u,this.f,this.v,this.z),Jb(this.gridInner,a,u,this.f,this.v,this.z),nU(m,a,u,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:m,metrics:{width:o,height:s,sdfWidth:a,sdfHeight:u,top:l,left:0,advance:n}}};g0.prototype.draw=function(e){return this._draw(e,!1).data};g0.prototype.drawWithMetrics=function(e){return this._draw(e,!0)};function Jb(e,t,r,n,i,a){for(var o=0;o<t;o++)eC(e,o,t,r,n,i,a);for(var u=0;u<r;u++)eC(e,u*t,1,t,n,i,a)}function eC(e,t,r,n,i,a,o){var u,s,l,f;for(a[0]=0,o[0]=-bh,o[1]=bh,u=0;u<n;u++)i[u]=e[t+u*r];for(u=1,s=0,l=0;u<n;u++){do f=a[s],l=(i[u]-i[f]+u*u-f*f)/(u-f)/2;while(l<=o[s]&&--s>-1);s++,a[s]=u,o[s]=l,o[s+1]=bh}for(u=0,s=0;u<n;u++){for(;o[s+1]<u;)s++;f=a[s],e[t+u*r]=i[f]+(u-f)*(u-f)}}function uM(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=iU(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function iU(e,t){if(!!e){if(typeof e=="string")return tC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tC(e,t)}}function tC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var id=30;function aU(e){var t=e.characterSet,r=e.getFontWidth,n=e.fontHeight,i=e.buffer,a=e.maxCanvasWidth,o=e.mapping,u=o===void 0?{}:o,s=e.xOffset,l=s===void 0?0:s,f=e.yOffset,h=f===void 0?0:f,d=0,v=l;Array.from(t).forEach(function(y,_){if(!u[y]){var E=r(y,_);v+id>a&&(v=0,d++),u[y]={x:v,y:h+d*id,width:id,height:id,advance:E},v+=id}});var m=n+i*2;return{mapping:u,xOffset:v,yOffset:h+d*m,canvasHeight:sM(h+(d+1)*m)}}function oU(e,t,r){var n=0,i=0,a=0,o=[],u={},s=uM(e),l;try{for(s.s();!(l=s.n()).done;){var f=l.value;if(!u[f.id]){var h=f.size;n+h+t>r&&(rC(u,o,i),n=0,i=a+i+t,a=0,o=[]),o.push({icon:f,xOffset:n}),n=n+h+t,a=Math.max(a,h)}}}catch(v){s.e(v)}finally{s.f()}o.length>0&&rC(u,o,i);var d=sM(a+i+t);return{mapping:u,canvasHeight:d}}function rC(e,t,r){var n=uM(t),i;try{for(n.s();!(i=n.n()).done;){var a=i.value,o=a.icon,u=a.xOffset;e[o.id]=be(be({},o),{},{x:u,y:r,image:o.image,width:o.width,height:o.height})}}catch(s){n.e(s)}finally{n.f()}}function sM(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var nC,iC;function aC(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=uU(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function uU(e,t){if(!!e){if(typeof e=="string")return oC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oC(e,t)}}function oC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sU(e){var t=lU();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function lU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cU=_U(),fU="sans-serif",hU="normal",pU=24,dU=3,vU=.25,gU=8,uC=1024,mU=1,sC=1,yU=3;function _U(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}function lC(e,t,r,n){e.font="".concat(n," ").concat(r,"px ").concat(t),e.fillStyle="black",e.textBaseline="middle"}function cC(e,t){for(var r=0;r<e.length;r++)t.data[4*r+3]=e[r]}var xU=(nC=xr(),nC(iC=function(e){Ut(r,e);var t=sU(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"fontAtlas",void 0),T(re(n),"iconFontMap",void 0),T(re(n),"iconFontGlyphs",{}),T(re(n),"fontOptions",void 0),T(re(n),"key",void 0),T(re(n),"cache",new Yk(yU)),n}return Pe(r,[{key:"scale",get:function(){return sC}},{key:"canvas",get:function(){var i=this.cache.get(this.key);return i&&i.data}},{key:"mapping",get:function(){var i=this.cache.get(this.key);return i&&i.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:fU,fontWeight:hU,characterSet:cU,fontSize:pU,buffer:dU,sdf:!0,cutoff:vU,radius:gU,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(i){var a=this;i.forEach(function(o){a.iconFontGlyphs[o.name]=o.unicode})}},{key:"addIconFont",value:function(i,a){this.iconFontMap.set(i,a)}},{key:"getIconFontKey",value:function(i){return this.iconFontMap.get(i)||i}},{key:"getGlyph",value:function(i){return this.iconFontGlyphs[i]?String.fromCharCode(parseInt(this.iconFontGlyphs[i],16)):""}},{key:"setFontOptions",value:function(i){this.fontOptions=be(be({},this.fontOptions),i),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),o=this.cache.get(this.key);if(!(o&&a.length===0)){var u=this.generateFontAtlas(this.key,a,o);this.fontAtlas=u,this.cache.set(this.key,u)}}},{key:"addFontFace",value:function(i,a){var o=this,u=document.createElement("style");u.type="text/css",u.innerText=`
        @font-face{
            font-family: '`.concat(i,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),u.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(i),"L7text"),document.fonts.ready.then(function(){o.emit("fontloaded",{fontFamily:i})})}catch(s){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(s)}},document.getElementsByTagName("head")[0].appendChild(u)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(i,a,o){var u=this.fontOptions,s=u.fontFamily,l=u.fontWeight,f=u.fontSize,h=u.buffer,d=u.sdf,v=u.radius,m=u.cutoff,y=u.iconfont,_=o&&o.data;_||(_=en.document.createElement("canvas"),_.width=uC);var E=_.getContext("2d",{willReadFrequently:!0});lC(E,s,f,l);var S=aU(be({getFontWidth:function(Ne){return E.measureText(Ne).width},fontHeight:f*sC,buffer:h,characterSet:a,maxCanvasWidth:uC},o&&{mapping:o.mapping,xOffset:o.xOffset,yOffset:o.yOffset})),A=S.mapping,M=S.canvasHeight,O=S.xOffset,j=S.yOffset,q=E.getImageData(0,0,_.width,_.height);if(_.height=M,E.putImageData(q,0,0),lC(E,s,f,l),d){var Y=new fE.exports(f,h,v,m,s,l),ne=E.getImageData(0,0,Y.size,Y.size),X=aC(a),$;try{for(X.s();!($=X.n()).done;){var K=$.value;if(y){var ue=String.fromCharCode(parseInt(K.replace("&#x","").replace(";",""),16)),de=Y.draw(ue);cC(de,ne)}else cC(Y.draw(K),ne);E.putImageData(ne,A[K].x,A[K].y)}}catch(Me){X.e(Me)}finally{X.f()}}else{var pe=aC(a),le;try{for(pe.s();!(le=pe.n()).done;){var ve=le.value;E.fillText(ve,A[ve].x,A[ve].y+f*mU)}}catch(Me){pe.e(Me)}finally{pe.f()}}return{xOffset:O,yOffset:j,mapping:A,data:_,width:_.width,height:_.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(i,a){var o=this.cache.get(i);if(!o)return a;var u=[],s=o.mapping,l=new Set(Object.keys(s)),f=new Set(a);return f.forEach(function(h){l.has(h)||u.push(h)}),u}}]),r}(Pa.exports.EventEmitter))||iC),fC,hC;function EU(e){var t=bU();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function bU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var CU=3,pC=1024,ad=64,AU=(fC=xr(),fC(hC=function(e){Ut(r,e);var t=EU(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"canvasHeight",128),T(re(n),"texture",void 0),T(re(n),"canvas",void 0),T(re(n),"iconData",void 0),T(re(n),"iconMap",void 0),T(re(n),"ctx",void 0),T(re(n),"loadingImageCount",0),n}return Pe(r,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=en.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var n=Ie(H.mark(function a(o,u){var s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return s=new Image,this.loadingImageCount++,this.hasImage(o)?console.warn("Image Id already exists"):this.iconData.push({id:o,size:ad}),this.updateIconMap(),h.next=6,this.loadImage(u);case 6:s=h.sent,l=this.iconData.find(function(d){return d.id===o}),l&&(l.image=s,l.width=s.width,l.height=s.height),this.update();case 10:case"end":return h.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"addImageMini",value:function(i,a,o){var u=this,s=o.getSceneConfig().canvas,l=s.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:ad}),this.updateIconMap(),this.loadImageMini(a,s).then(function(f){l=f;var h=u.iconData.find(function(d){return d.id===i});h&&(h.image=l,h.width=l.width,h.height=l.height),u.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(i){return this.iconMap.hasOwnProperty(i)}},{key:"removeImage",value:function(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(function(a){return a.id!==i}),delete this.iconMap[i],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(i){return new Promise(function(a,o){if(i instanceof HTMLImageElement){a(i);return}var u=new Image;u.crossOrigin="anonymous",u.onload=function(){a(u)},u.onerror=function(){o(new Error("Could not load image at "+i))},u.src=i instanceof File?URL.createObjectURL(i):i})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var i=this;this.canvas.width=pC,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var o=i.iconMap[a],u=o.x,s=o.y,l=o.image,f=o.width,h=f===void 0?64:f,d=o.height,v=d===void 0?64:d,m=Math.max(h,v),y=m/ad,_=v/y,E=h/y;l&&i.ctx.drawImage(l,u+(ad-E)/2,s+(ad-_)/2,E,_)})}},{key:"updateIconMap",value:function(){var i=oU(this.iconData,CU,pC),a=i.mapping,o=i.canvasHeight;this.iconMap=a,this.canvasHeight=o}},{key:"loadImageMini",value:function(i,a){return new Promise(function(o,u){var s=a.createImage();s.crossOrigin="anonymous",s.onload=function(){o(s)},s.onerror=function(){u(new Error("Could not load image at "+i))},s.src=i})}}]),r}(Pa.exports.EventEmitter))||hC),dC,vC,SU=(dC=xr(),dC(vC=function(){function e(){ke(this,e),T(this,"viewport",void 0),T(this,"overridedViewProjectionMatrix",void 0),T(this,"jitteredViewProjectionMatrix",void 0),T(this,"jitteredProjectionMatrix",void 0),T(this,"viewMatrixInverse",void 0),T(this,"cameraPosition",void 0)}return Pe(e,[{key:"init",value:function(){}},{key:"update",value:function(r){this.viewport=r,this.viewMatrixInverse=Oa(),eE(this.viewMatrixInverse,r.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var r=this.viewport.getCenter(),n=ir(r,2),i=n[0],a=n[1];return[i,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}},{key:"setViewProjectionMatrix",value:function(r){this.overridedViewProjectionMatrix=r}},{key:"jitterProjectionMatrix",value:function(r,n){var i=p5(Oa(),[r,n,0]);this.jitteredProjectionMatrix=uo(Oa(),i,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=uo(Oa(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||vC),Lh;(function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom"})(Lh||(Lh={}));var gC,mC;function TU(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=wU(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function wU(e,t){if(!!e){if(typeof e=="string")return yC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yC(e,t)}}function yC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var MU={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},RU=(gC=xr(),gC(mC=function(){function e(){ke(this,e),T(this,"container",void 0),T(this,"controlCorners",void 0),T(this,"controlContainer",void 0),T(this,"scene",void 0),T(this,"mapsService",void 0),T(this,"controls",[]),T(this,"unAddControls",[])}return Pe(e,[{key:"init",value:function(r,n){this.container=r.container,this.scene=n,this.mapsService=n.get(Oe.IMapService),this.initControlPos()}},{key:"addControl",value:function(r,n){var i=n.get(Oe.IMapService);i.map?(r.addTo(this.scene),this.controls.push(r)):this.unAddControls.push(r)}},{key:"getControlByName",value:function(r){return this.controls.find(function(n){return n.controlOption.name===r})}},{key:"removeControl",value:function(r){var n=this.controls.indexOf(r);return n>-1&&this.controls.splice(n,1),r.remove(),this}},{key:"addControls",value:function(){var r=this;this.unAddControls.forEach(function(n){n.addTo(r.scene),r.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var r=TU(this.controls),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.remove()}}catch(a){r.e(a)}finally{r.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var r=this.controlCorners={},n="l7-",i=this.controlContainer=ca("div",n+"control-container",this.container);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=u.map(function(l){return n+l}).join(" ");r[u.filter(function(l){return!["row","column"].includes(l)}).join("")]=ca("div",s,i)}function o(u){var s=u.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat(It(s),[MU[u]])}Object.values(Lh).forEach(function(u){a(o(u))})}},{key:"clearControlPos",value:function(){for(var r in this.controlCorners)this.controlCorners[r]&&wg(this.controlCorners[r]);this.controlContainer&&wg(this.controlContainer)}}]),e}())||mC),_C,xC,OU=(_C=xr(),_C(xC=function(){function e(){ke(this,e),T(this,"container",void 0),T(this,"scene",void 0),T(this,"mapsService",void 0),T(this,"markers",[]),T(this,"markerLayers",[]),T(this,"unAddMarkers",[]),T(this,"unAddMarkerLayers",[])}return Pe(e,[{key:"addMarkerLayer",value:function(r){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(r),r.addTo(this.scene)):this.unAddMarkerLayers.push(r)}},{key:"removeMarkerLayer",value:function(r){r.destroy(),this.markerLayers.indexOf(r);var n=this.markerLayers.indexOf(r);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(r){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(r),r.addTo(this.scene)):this.unAddMarkers.push(r)}},{key:"addMarkers",value:function(){var r=this;this.unAddMarkers.forEach(function(n){n.addTo(r.scene),r.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var r=this;this.unAddMarkerLayers.forEach(function(n){r.markerLayers.push(n),n.addTo(r.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(r){r.remove(),this.markers.indexOf(r);var n=this.markers.indexOf(r);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(r){this.scene=r,this.mapsService=r.get(Oe.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(r){r.remove()}),this.markers=[],this.markerLayers.forEach(function(r){r.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(r){r.destroy()}}]),e}())||xC),EC,bC,LU=(EC=xr(),EC(bC=function(){function e(){ke(this,e),T(this,"scene",void 0),T(this,"mapsService",void 0),T(this,"popups",[]),T(this,"unAddPopups",[])}return Pe(e,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(r){r.isOpen()&&r.remove();var n=this.popups.indexOf(r);n>-1&&this.popups.splice(n,1);var i=this.unAddPopups.indexOf(r);i>-1&&this.unAddPopups.splice(i,1)}},{key:"destroy",value:function(){this.popups.forEach(function(r){return r.remove()})}},{key:"addPopup",value:function(r){var n=this;r&&r.getOptions().autoClose&&[].concat(It(this.popups),It(this.unAddPopups)).forEach(function(i){i.getOptions().autoClose&&n.removePopup(i)}),this.isMarkerReady?(r.addTo(this.scene),this.popups.push(r)):this.unAddPopups.push(r),r.on("close",function(){n.removePopup(r)})}},{key:"initPopup",value:function(){var r=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(n){r.addPopup(n),r.unAddPopups=[]})}},{key:"init",value:function(r){this.scene=r,this.mapsService=r.get(Oe.IMapService)}}]),e}())||bC),FU={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},CC,AC,IU={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},kU={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},PU=(CC=xr(),CC(AC=function(){function e(){ke(this,e),T(this,"sceneConfigCache",{}),T(this,"layerConfigCache",{}),T(this,"layerAttributeConfigCache",{})}return Pe(e,[{key:"getSceneConfig",value:function(r){return this.sceneConfigCache[r]}},{key:"getSceneWarninfo",value:function(r){return FU[r]}},{key:"setSceneConfig",value:function(r,n){this.sceneConfigCache[r]=be(be({},IU),n)}},{key:"getLayerConfig",value:function(r){return this.layerConfigCache[r]}},{key:"setLayerConfig",value:function(r,n,i){this.layerConfigCache[n]=be({},tt.exports.merge({},this.sceneConfigCache[r],kU,i))}},{key:"getAttributeConfig",value:function(r){return this.layerAttributeConfigCache[r]}},{key:"setAttributeConfig",value:function(r,n){this.layerAttributeConfigCache[r]=be(be({},this.layerAttributeConfigCache[r]),n)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||AC);function Mr(e,t,r,n){!r||Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function wr(e,t,r,n,i){var a={};return Object.keys(n).forEach(function(o){a[o]=n[o]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce(function(o,u){return u(e,t,o)||o},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,t,a),a=null),a}var __=Math.PI/180,DU=512,SC=4003e4;function TC(e){var t=e.latitude,r=t===void 0?0:t,n=e.zoom,i=n===void 0?0:n,a=e.scale,o=e.highPrecision,u=o===void 0?!1:o,s=e.flipY,l=s===void 0?!1:s;a=a!==void 0?a:Math.pow(2,i);var f={},h=DU*a,d=Math.cos(r*__),v=h/360,m=v/d,y=h/SC/d;if(f.pixelsPerMeter=[y,-y,y],f.metersPerPixel=[1/y,-1/y,1/y],f.pixelsPerDegree=[v,-m,y],f.degreesPerPixel=[1/v,-1/m,1/y],u){var _=__*Math.tan(r*__)/d,E=v*_/2,S=h/SC*_,A=S/m*y;f.pixelsPerDegree2=[0,-E,S],f.pixelsPerMeter2=[A,0,A],l&&(f.pixelsPerDegree2[1]=-f.pixelsPerDegree2[1],f.pixelsPerMeter2[1]=-f.pixelsPerMeter2[1])}return l&&(f.pixelsPerMeter[1]=-f.pixelsPerMeter[1],f.metersPerPixel[1]=-f.metersPerPixel[1],f.pixelsPerDegree[1]=-f.pixelsPerDegree[1],f.degreesPerPixel[1]=-f.degreesPerPixel[1]),f}var yu;(function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2"})(yu||(yu={}));var yc={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},wC,MC,RC,x_,OC,BU=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],NU=(wC=xr(),MC=kr(Oe.ICameraService),wC(RC=(x_=function(){function e(){ke(this,e),T(this,"needRefresh",!0),Mr(this,"cameraService",OC,this),T(this,"coordinateSystem",void 0),T(this,"viewportCenter",void 0),T(this,"viewportCenterProjection",void 0),T(this,"pixelsPerDegree",void 0),T(this,"pixelsPerDegree2",void 0),T(this,"pixelsPerMeter",void 0)}return Pe(e,[{key:"refresh",value:function(r){var n=this.cameraService.getZoom(),i=this.cameraService.getZoomScale(),a=r||this.cameraService.getCenter(),o=TC({latitude:a[1],zoom:n}),u=o.pixelsPerMeter,s=o.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=u,this.pixelsPerDegree=s,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===yu.LNGLAT||this.coordinateSystem===yu.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===yu.LNGLAT_OFFSET?this.calculateLnglatOffset(a,n):this.coordinateSystem===yu.P20_OFFSET&&this.calculateLnglatOffset(a,n,i,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(r){this.coordinateSystem=r}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(r,n,i,a){var o=TC({latitude:r[1],zoom:n,scale:i,flipY:a,highPrecision:!0}),u=o.pixelsPerMeter,s=o.pixelsPerDegree,l=o.pixelsPerDegree2,f=this.cameraService.getViewMatrix(),h=this.cameraService.getProjectionMatrix(),d=uo([],h,f),v=this.cameraService.projectFlat([Math.fround(r[0]),Math.fround(r[1])],Math.pow(2,n));this.viewportCenterProjection=rE([],[v[0],v[1],0,1],d),f=this.cameraService.getViewMatrixUncentered()||f,d=uo([],h,f),d=uo([],d,BU),this.cameraService.setViewProjectionMatrix(d),this.pixelsPerMeter=u,this.pixelsPerDegree=s,this.pixelsPerDegree2=l}}]),e}(),OC=wr(x_.prototype,"cameraService",[MC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x_))||RC),lM={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,r,n,i){var a=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,o=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u"),u=a||o,s=["","webkit","Moz","MS","ms","o"],l=u?"":r.createElement("div"),f="function",h=Math.round,d=Math.abs,v=Date.now;function m(F,B,te){return setTimeout(j(F,te),B)}function y(F,B,te){return Array.isArray(F)?(_(F,te[B],te),!0):!1}function _(F,B,te){var Le;if(!!F)if(F.forEach)F.forEach(B,te);else if(F.length!==i)for(Le=0;Le<F.length;)B.call(te,F[Le],Le,F),Le++;else for(Le in F)F.hasOwnProperty(Le)&&B.call(te,F[Le],Le,F)}function E(F,B,te){var Le="DEPRECATED METHOD: "+B+`
`+te+` AT 
`;return function(){var vt=new Error("get-stack-trace"),Vt=vt&&vt.stack?vt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Sr=t.console&&(t.console.warn||t.console.log);return Sr&&Sr.call(t.console,Le,Vt),F.apply(this,arguments)}}var S;typeof Object.assign!="function"?S=function(B){if(B===i||B===null)throw new TypeError("Cannot convert undefined or null to object");for(var te=Object(B),Le=1;Le<arguments.length;Le++){var vt=arguments[Le];if(vt!==i&&vt!==null)for(var Vt in vt)vt.hasOwnProperty(Vt)&&(te[Vt]=vt[Vt])}return te}:S=Object.assign;var A=E(function(B,te,Le){for(var vt=Object.keys(te),Vt=0;Vt<vt.length;)(!Le||Le&&B[vt[Vt]]===i)&&(B[vt[Vt]]=te[vt[Vt]]),Vt++;return B},"extend","Use `assign`."),M=E(function(B,te){return A(B,te,!0)},"merge","Use `assign`.");function O(F,B,te){var Le=B.prototype,vt;vt=F.prototype=Object.create(Le),vt.constructor=F,vt._super=Le,te&&S(vt,te)}function j(F,B){return function(){return F.apply(B,arguments)}}function q(F,B){return typeof F==f?F.apply(B&&B[0]||i,B):F}function Y(F,B){return F===i?B:F}function ne(F,B,te){_(ue(B),function(Le){F.addEventListener(Le,te,!1)})}function X(F,B,te){_(ue(B),function(Le){F.removeEventListener(Le,te,!1)})}function $(F,B){for(;F;){if(F==B)return!0;F=F.parentNode}return!1}function K(F,B){return F.indexOf(B)>-1}function ue(F){return F.trim().split(/\s+/g)}function de(F,B,te){if(F.indexOf&&!te)return F.indexOf(B);for(var Le=0;Le<F.length;){if(te&&F[Le][te]==B||!te&&F[Le]===B)return Le;Le++}return-1}function pe(F){return Array.prototype.slice.call(F,0)}function le(F,B,te){for(var Le=[],vt=[],Vt=0;Vt<F.length;){var Sr=B?F[Vt][B]:F[Vt];de(vt,Sr)<0&&Le.push(F[Vt]),vt[Vt]=Sr,Vt++}return te&&(B?Le=Le.sort(function(Dn,Jn){return Dn[B]>Jn[B]}):Le=Le.sort()),Le}function ve(F,B){for(var te,Le,vt=B[0].toUpperCase()+B.slice(1),Vt=0;Vt<s.length;){if(te=s[Vt],Le=te?te+vt:B,Le in F)return Le;Vt++}return i}var Me=1;function Ne(){return Me++}function Xe(F){var B=F.ownerDocument||F;return B.defaultView||B.parentWindow||t}var ct=/mobile|tablet|ip(ad|hone|od)|android/i,$t="ontouchstart"in t,Qt=ve(t,"PointerEvent")!==i,Zt=$t&&ct.test(navigator.userAgent),jt="touch",Cr="pen",gn="mouse",ii="kinect",Mt=25,qt=1,ar=2,k=4,ae=8,_e=1,Ge=2,je=4,Qe=8,Ot=16,Je=Ge|je,yt=Qe|Ot,et=Je|yt,Wt=["x","y"],Gt=["clientX","clientY"];function C(F,B){var te=this;this.manager=F,this.callback=B,this.element=F.element,this.target=F.options.inputTarget,this.domHandler=function(Le){q(F.options.enable,[F])&&te.handler(Le)},this.init()}C.prototype={handler:function(){},init:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(Xe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&X(this.element,this.evEl,this.domHandler),this.evTarget&&X(this.target,this.evTarget,this.domHandler),this.evWin&&X(Xe(this.element),this.evWin,this.domHandler)}};function Se(F){var B,te=F.options.inputClass;return te?B=te:Qt?B=ps:Zt?B=ds:$t?B=vs:B=Au,new B(F,$e)}function $e(F,B,te){var Le=te.pointers.length,vt=te.changedPointers.length,Vt=B&qt&&Le-vt===0,Sr=B&(k|ae)&&Le-vt===0;te.isFirst=!!Vt,te.isFinal=!!Sr,Vt&&(F.session={}),te.eventType=B,ft(F,te),F.emit("hammer.input",te),F.recognize(te),F.session.prevInput=te}function ft(F,B){var te=F.session,Le=B.pointers,vt=Le.length;te.firstInput||(te.firstInput=rr(B)),vt>1&&!te.firstMultiple?te.firstMultiple=rr(B):vt===1&&(te.firstMultiple=!1);var Vt=te.firstInput,Sr=te.firstMultiple,An=Sr?Sr.center:Vt.center,Dn=B.center=sr(Le);B.timeStamp=v(),B.deltaTime=B.timeStamp-Vt.timeStamp,B.angle=Yr(An,Dn),B.distance=Ar(An,Dn),St(te,B),B.offsetDirection=Er(B.deltaX,B.deltaY);var Jn=Jt(B.deltaTime,B.deltaX,B.deltaY);B.overallVelocityX=Jn.x,B.overallVelocityY=Jn.y,B.overallVelocity=d(Jn.x)>d(Jn.y)?Jn.x:Jn.y,B.scale=Sr?Da(Sr.pointers,Le):1,B.rotation=Sr?Zr(Sr.pointers,Le):0,B.maxPointers=te.prevInput?B.pointers.length>te.prevInput.maxPointers?B.pointers.length:te.prevInput.maxPointers:B.pointers.length,pr(te,B);var gi=F.element;$(B.srcEvent.target,gi)&&(gi=B.srcEvent.target),B.target=gi}function St(F,B){var te=B.center,Le=F.offsetDelta||{},vt=F.prevDelta||{},Vt=F.prevInput||{};(B.eventType===qt||Vt.eventType===k)&&(vt=F.prevDelta={x:Vt.deltaX||0,y:Vt.deltaY||0},Le=F.offsetDelta={x:te.x,y:te.y}),B.deltaX=vt.x+(te.x-Le.x),B.deltaY=vt.y+(te.y-Le.y)}function pr(F,B){var te=F.lastInterval||B,Le=B.timeStamp-te.timeStamp,vt,Vt,Sr,An;if(B.eventType!=ae&&(Le>Mt||te.velocity===i)){var Dn=B.deltaX-te.deltaX,Jn=B.deltaY-te.deltaY,gi=Jt(Le,Dn,Jn);Vt=gi.x,Sr=gi.y,vt=d(gi.x)>d(gi.y)?gi.x:gi.y,An=Er(Dn,Jn),F.lastInterval=B}else vt=te.velocity,Vt=te.velocityX,Sr=te.velocityY,An=te.direction;B.velocity=vt,B.velocityX=Vt,B.velocityY=Sr,B.direction=An}function rr(F){for(var B=[],te=0;te<F.pointers.length;)B[te]={clientX:h(F.pointers[te].clientX),clientY:h(F.pointers[te].clientY)},te++;return{timeStamp:v(),pointers:B,center:sr(B),deltaX:F.deltaX,deltaY:F.deltaY}}function sr(F){var B=F.length;if(B===1)return{x:h(F[0].clientX),y:h(F[0].clientY)};for(var te=0,Le=0,vt=0;vt<B;)te+=F[vt].clientX,Le+=F[vt].clientY,vt++;return{x:h(te/B),y:h(Le/B)}}function Jt(F,B,te){return{x:B/F||0,y:te/F||0}}function Er(F,B){return F===B?_e:d(F)>=d(B)?F<0?Ge:je:B<0?Qe:Ot}function Ar(F,B,te){te||(te=Wt);var Le=B[te[0]]-F[te[0]],vt=B[te[1]]-F[te[1]];return Math.sqrt(Le*Le+vt*vt)}function Yr(F,B,te){te||(te=Wt);var Le=B[te[0]]-F[te[0]],vt=B[te[1]]-F[te[1]];return Math.atan2(vt,Le)*180/Math.PI}function Zr(F,B){return Yr(B[1],B[0],Gt)+Yr(F[1],F[0],Gt)}function Da(F,B){return Ar(B[0],B[1],Gt)/Ar(F[0],F[1],Gt)}var Wh={mousedown:qt,mousemove:ar,mouseup:k},Jc="mousedown",Xh="mousemove mouseup";function Au(){this.evEl=Jc,this.evWin=Xh,this.pressed=!1,C.apply(this,arguments)}O(Au,C,{handler:function(B){var te=Wh[B.type];te&qt&&B.button===0&&(this.pressed=!0),te&ar&&B.which!==1&&(te=k),this.pressed&&(te&k&&(this.pressed=!1),this.callback(this.manager,te,{pointers:[B],changedPointers:[B],pointerType:gn,srcEvent:B}))}});var ef={pointerdown:qt,pointermove:ar,pointerup:k,pointercancel:ae,pointerout:ae},Yh={2:jt,3:Cr,4:gn,5:ii},tf="pointerdown",wl="pointermove pointerup pointercancel";!u&&t.MSPointerEvent&&!t.PointerEvent&&(tf="MSPointerDown",wl="MSPointerMove MSPointerUp MSPointerCancel");function ps(){this.evEl=tf,this.evWin=wl,C.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}O(ps,C,{handler:function(B){var te=this.store,Le=!1,vt=B.type.toLowerCase().replace("ms",""),Vt=ef[vt],Sr=Yh[B.pointerType]||B.pointerType,An=Sr==jt,Dn=de(te,B.pointerId,"pointerId");Vt&qt&&(B.button===0||An)?Dn<0&&(te.push(B),Dn=te.length-1):Vt&(k|ae)&&(Le=!0),!(Dn<0)&&(te[Dn]=B,this.callback(this.manager,Vt,{pointers:te,changedPointers:[B],pointerType:Sr,srcEvent:B}),Le&&te.splice(Dn,1))}});var rf={touchstart:qt,touchmove:ar,touchend:k,touchcancel:ae},Zh="touchstart",pi="touchstart touchmove touchend touchcancel";function nf(){this.evTarget=Zh,this.evWin=pi,this.started=!1,C.apply(this,arguments)}O(nf,C,{handler:function(B){var te=rf[B.type];if(te===qt&&(this.started=!0),!!this.started){var Le=Ml.call(this,B,te);te&(k|ae)&&Le[0].length-Le[1].length===0&&(this.started=!1),this.callback(this.manager,te,{pointers:Le[0],changedPointers:Le[1],pointerType:jt,srcEvent:B})}}});function Ml(F,B){var te=pe(F.touches),Le=pe(F.changedTouches);return B&(k|ae)&&(te=le(te.concat(Le),"identifier",!0)),[te,Le]}var qh={touchstart:qt,touchmove:ar,touchend:k,touchcancel:ae},Rl="touchstart touchmove touchend touchcancel";function ds(){this.evTarget=Rl,this.targetIds={},C.apply(this,arguments)}O(ds,C,{handler:function(B){var te=qh[B.type],Le=Kh.call(this,B,te);!Le||this.callback(this.manager,te,{pointers:Le[0],changedPointers:Le[1],pointerType:jt,srcEvent:B})}});function Kh(F,B){var te=pe(F.touches),Le=this.targetIds;if(B&(qt|ar)&&te.length===1)return Le[te[0].identifier]=!0,[te,te];var vt,Vt,Sr=pe(F.changedTouches),An=[],Dn=this.target;if(Vt=te.filter(function(Jn){return $(Jn.target,Dn)}),B===qt)for(vt=0;vt<Vt.length;)Le[Vt[vt].identifier]=!0,vt++;for(vt=0;vt<Sr.length;)Le[Sr[vt].identifier]&&An.push(Sr[vt]),B&(k|ae)&&delete Le[Sr[vt].identifier],vt++;if(!!An.length)return[le(Vt.concat(An),"identifier",!0),An]}var Qh=2500,af=25;function vs(){C.apply(this,arguments);var F=j(this.handler,this);this.touch=new ds(this.manager,F),this.mouse=new Au(this.manager,F),this.primaryTouch=null,this.lastTouches=[]}O(vs,C,{handler:function(B,te,Le){var vt=Le.pointerType==jt,Vt=Le.pointerType==gn;if(!(Vt&&Le.sourceCapabilities&&Le.sourceCapabilities.firesTouchEvents)){if(vt)of.call(this,te,Le);else if(Vt&&Jh.call(this,Le))return;this.callback(B,te,Le)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function of(F,B){F&qt?(this.primaryTouch=B.changedPointers[0].identifier,fn.call(this,B)):F&(k|ae)&&fn.call(this,B)}function fn(F){var B=F.changedPointers[0];if(B.identifier===this.primaryTouch){var te={x:B.clientX,y:B.clientY};this.lastTouches.push(te);var Le=this.lastTouches,vt=function(){var Vt=Le.indexOf(te);Vt>-1&&Le.splice(Vt,1)};setTimeout(vt,Qh)}}function Jh(F){for(var B=F.srcEvent.clientX,te=F.srcEvent.clientY,Le=0;Le<this.lastTouches.length;Le++){var vt=this.lastTouches[Le],Vt=Math.abs(B-vt.x),Sr=Math.abs(te-vt.y);if(Vt<=af&&Sr<=af)return!0}return!1}var Ol=u?i:ve(l.style,"touchAction"),uf=Ol!==i,sf="compute",lf="auto",Ll="manipulation",co="none",Su="pan-x",Ba="pan-y",gs=tp();function zo(F,B){this.manager=F,this.set(B)}zo.prototype={set:function(F){F==sf&&(F=this.compute()),uf&&this.manager.element.style&&gs[F]&&(this.manager.element.style[Ol]=F),this.actions=F.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var F=[];return _(this.manager.recognizers,function(B){q(B.options.enable,[B])&&(F=F.concat(B.getTouchAction()))}),ep(F.join(" "))},preventDefaults:function(F){var B=F.srcEvent,te=F.offsetDirection;if(this.manager.session.prevented){B.preventDefault();return}var Le=this.actions,vt=K(Le,co)&&!gs[co],Vt=K(Le,Ba)&&!gs[Ba],Sr=K(Le,Su)&&!gs[Su];if(vt){var An=F.pointers.length===1,Dn=F.distance<2,Jn=F.deltaTime<250;if(An&&Dn&&Jn)return}if(!(Sr&&Vt)&&(vt||Vt&&te&Je||Sr&&te&yt))return this.preventSrc(B)},preventSrc:function(F){this.manager.session.prevented=!0,F.preventDefault()}};function ep(F){if(K(F,co))return co;var B=K(F,Su),te=K(F,Ba);return B&&te?co:B||te?B?Su:Ba:K(F,Ll)?Ll:lf}function tp(){if(!uf)return!1;var F={};if(u)return F;var B=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(te){F[te]=B?t.CSS.supports("touch-action",te):!0}),F}var ms=1,di=2,fo=4,ha=8,pa=ha,Tu=16,Xi=32;function da(F){this.options=S({},this.defaults,F||{}),this.id=Ne(),this.manager=null,this.options.enable=Y(this.options.enable,!0),this.state=ms,this.simultaneous={},this.requireFail=[]}da.prototype={defaults:{},set:function(F){return S(this.options,F),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(F){if(y(F,"recognizeWith",this))return this;var B=this.simultaneous;return F=wu(F,this),B[F.id]||(B[F.id]=F,F.recognizeWith(this)),this},dropRecognizeWith:function(F){return y(F,"dropRecognizeWith",this)?this:(F=wu(F,this),delete this.simultaneous[F.id],this)},requireFailure:function(F){if(y(F,"requireFailure",this))return this;var B=this.requireFail;return F=wu(F,this),de(B,F)===-1&&(B.push(F),F.requireFailure(this)),this},dropRequireFailure:function(F){if(y(F,"dropRequireFailure",this))return this;F=wu(F,this);var B=de(this.requireFail,F);return B>-1&&this.requireFail.splice(B,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(F){return!!this.simultaneous[F.id]},emit:function(F){var B=this,te=this.state;function Le(vt){B.manager.emit(vt,F)}te<ha&&Le(B.options.event+Fl(te)),Le(B.options.event),F.additionalEvent&&Le(F.additionalEvent),te>=ha&&Le(B.options.event+Fl(te))},tryEmit:function(F){if(this.canEmit())return this.emit(F);this.state=Xi},canEmit:function(){for(var F=0;F<this.requireFail.length;){if(!(this.requireFail[F].state&(Xi|ms)))return!1;F++}return!0},recognize:function(F){var B=S({},F);if(!q(this.options.enable,[this,B])){this.reset(),this.state=Xi;return}this.state&(pa|Tu|Xi)&&(this.state=ms),this.state=this.process(B),this.state&(di|fo|ha|Tu)&&this.tryEmit(B)},process:function(F){},getTouchAction:function(){},reset:function(){}};function Fl(F){return F&Tu?"cancel":F&ha?"end":F&fo?"move":F&di?"start":""}function Il(F){return F==Ot?"down":F==Qe?"up":F==Ge?"left":F==je?"right":""}function wu(F,B){var te=B.manager;return te?te.get(F):F}function vi(){da.apply(this,arguments)}O(vi,da,{defaults:{pointers:1},attrTest:function(F){var B=this.options.pointers;return B===0||F.pointers.length===B},process:function(F){var B=this.state,te=F.eventType,Le=B&(di|fo),vt=this.attrTest(F);return Le&&(te&ae||!vt)?B|Tu:Le||vt?te&k?B|ha:B&di?B|fo:di:Xi}});function ys(){vi.apply(this,arguments),this.pX=null,this.pY=null}O(ys,vi,{defaults:{event:"pan",threshold:10,pointers:1,direction:et},getTouchAction:function(){var F=this.options.direction,B=[];return F&Je&&B.push(Ba),F&yt&&B.push(Su),B},directionTest:function(F){var B=this.options,te=!0,Le=F.distance,vt=F.direction,Vt=F.deltaX,Sr=F.deltaY;return vt&B.direction||(B.direction&Je?(vt=Vt===0?_e:Vt<0?Ge:je,te=Vt!=this.pX,Le=Math.abs(F.deltaX)):(vt=Sr===0?_e:Sr<0?Qe:Ot,te=Sr!=this.pY,Le=Math.abs(F.deltaY))),F.direction=vt,te&&Le>B.threshold&&vt&B.direction},attrTest:function(F){return vi.prototype.attrTest.call(this,F)&&(this.state&di||!(this.state&di)&&this.directionTest(F))},emit:function(F){this.pX=F.deltaX,this.pY=F.deltaY;var B=Il(F.direction);B&&(F.additionalEvent=this.options.event+B),this._super.emit.call(this,F)}});function _s(){vi.apply(this,arguments)}O(_s,vi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[co]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.scale-1)>this.options.threshold||this.state&di)},emit:function(F){if(F.scale!==1){var B=F.scale<1?"in":"out";F.additionalEvent=this.options.event+B}this._super.emit.call(this,F)}});function va(){da.apply(this,arguments),this._timer=null,this._input=null}O(va,da,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[lf]},process:function(F){var B=this.options,te=F.pointers.length===B.pointers,Le=F.distance<B.threshold,vt=F.deltaTime>B.time;if(this._input=F,!Le||!te||F.eventType&(k|ae)&&!vt)this.reset();else if(F.eventType&qt)this.reset(),this._timer=m(function(){this.state=pa,this.tryEmit()},B.time,this);else if(F.eventType&k)return pa;return Xi},reset:function(){clearTimeout(this._timer)},emit:function(F){this.state===pa&&(F&&F.eventType&k?this.manager.emit(this.options.event+"up",F):(this._input.timeStamp=v(),this.manager.emit(this.options.event,this._input)))}});function Mu(){vi.apply(this,arguments)}O(Mu,vi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[co]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.rotation)>this.options.threshold||this.state&di)}});function kl(){vi.apply(this,arguments)}O(kl,vi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Je|yt,pointers:1},getTouchAction:function(){return ys.prototype.getTouchAction.call(this)},attrTest:function(F){var B=this.options.direction,te;return B&(Je|yt)?te=F.overallVelocity:B&Je?te=F.overallVelocityX:B&yt&&(te=F.overallVelocityY),this._super.attrTest.call(this,F)&&B&F.offsetDirection&&F.distance>this.options.threshold&&F.maxPointers==this.options.pointers&&d(te)>this.options.velocity&&F.eventType&k},emit:function(F){var B=Il(F.offsetDirection);B&&this.manager.emit(this.options.event+B,F),this.manager.emit(this.options.event,F)}});function Ru(){da.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}O(Ru,da,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ll]},process:function(F){var B=this.options,te=F.pointers.length===B.pointers,Le=F.distance<B.threshold,vt=F.deltaTime<B.time;if(this.reset(),F.eventType&qt&&this.count===0)return this.failTimeout();if(Le&&vt&&te){if(F.eventType!=k)return this.failTimeout();var Vt=this.pTime?F.timeStamp-this.pTime<B.interval:!0,Sr=!this.pCenter||Ar(this.pCenter,F.center)<B.posThreshold;this.pTime=F.timeStamp,this.pCenter=F.center,!Sr||!Vt?this.count=1:this.count+=1,this._input=F;var An=this.count%B.taps;if(An===0)return this.hasRequireFailures()?(this._timer=m(function(){this.state=pa,this.tryEmit()},B.interval,this),di):pa}return Xi},failTimeout:function(){return this._timer=m(function(){this.state=Xi},this.options.interval,this),Xi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==pa&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ai(F,B){return B=B||{},B.recognizers=Y(B.recognizers,ai.defaults.preset),new $o(F,B)}ai.VERSION="2.0.7",ai.defaults={domEvents:!1,touchAction:sf,enable:!0,inputTarget:null,inputClass:null,preset:[[Mu,{enable:!1}],[_s,{enable:!1},["rotate"]],[kl,{direction:Je}],[ys,{direction:Je},["swipe"]],[Ru],[Ru,{event:"doubletap",taps:2},["tap"]],[va]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ou=1,Pl=2;function $o(F,B){this.options=S({},ai.defaults,B||{}),this.options.inputTarget=this.options.inputTarget||F,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=F,this.input=Se(this),this.touchAction=new zo(this,this.options.touchAction),xs(this,!0),_(this.options.recognizers,function(te){var Le=this.add(new te[0](te[1]));te[2]&&Le.recognizeWith(te[2]),te[3]&&Le.requireFailure(te[3])},this)}$o.prototype={set:function(F){return S(this.options,F),F.touchAction&&this.touchAction.update(),F.inputTarget&&(this.input.destroy(),this.input.target=F.inputTarget,this.input.init()),this},stop:function(F){this.session.stopped=F?Pl:Ou},recognize:function(F){var B=this.session;if(!B.stopped){this.touchAction.preventDefaults(F);var te,Le=this.recognizers,vt=B.curRecognizer;(!vt||vt&&vt.state&pa)&&(vt=B.curRecognizer=null);for(var Vt=0;Vt<Le.length;)te=Le[Vt],B.stopped!==Pl&&(!vt||te==vt||te.canRecognizeWith(vt))?te.recognize(F):te.reset(),!vt&&te.state&(di|fo|ha)&&(vt=B.curRecognizer=te),Vt++}},get:function(F){if(F instanceof da)return F;for(var B=this.recognizers,te=0;te<B.length;te++)if(B[te].options.event==F)return B[te];return null},add:function(F){if(y(F,"add",this))return this;var B=this.get(F.options.event);return B&&this.remove(B),this.recognizers.push(F),F.manager=this,this.touchAction.update(),F},remove:function(F){if(y(F,"remove",this))return this;if(F=this.get(F),F){var B=this.recognizers,te=de(B,F);te!==-1&&(B.splice(te,1),this.touchAction.update())}return this},on:function(F,B){if(F!==i&&B!==i){var te=this.handlers;return _(ue(F),function(Le){te[Le]=te[Le]||[],te[Le].push(B)}),this}},off:function(F,B){if(F!==i){var te=this.handlers;return _(ue(F),function(Le){B?te[Le]&&te[Le].splice(de(te[Le],B),1):delete te[Le]}),this}},emit:function(F,B){this.options.domEvents&&Dl(F,B);var te=this.handlers[F]&&this.handlers[F].slice();if(!(!te||!te.length)){B.type=F,B.preventDefault=function(){B.srcEvent.preventDefault()};for(var Le=0;Le<te.length;)te[Le](B),Le++}},destroy:function(){this.element&&xs(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function xs(F,B){var te=F.element;if(!!te.style){var Le;_(F.options.cssProps,function(vt,Vt){Le=ve(te.style,Vt),B?(F.oldCssProps[Le]=te.style[Le],te.style[Le]=vt):te.style[Le]=F.oldCssProps[Le]||""}),B||(F.oldCssProps={})}}function Dl(F,B){if(!u){var te=r.createEvent("Event");te.initEvent(F,!0,!0),te.gesture=B,B.target.dispatchEvent(te)}}if(!u){S(ai,{INPUT_START:qt,INPUT_MOVE:ar,INPUT_END:k,INPUT_CANCEL:ae,STATE_POSSIBLE:ms,STATE_BEGAN:di,STATE_CHANGED:fo,STATE_ENDED:ha,STATE_RECOGNIZED:pa,STATE_CANCELLED:Tu,STATE_FAILED:Xi,DIRECTION_NONE:_e,DIRECTION_LEFT:Ge,DIRECTION_RIGHT:je,DIRECTION_UP:Qe,DIRECTION_DOWN:Ot,DIRECTION_HORIZONTAL:Je,DIRECTION_VERTICAL:yt,DIRECTION_ALL:et,Manager:$o,Input:C,TouchAction:zo,TouchInput:ds,MouseInput:Au,PointerEventInput:ps,TouchMouseInput:vs,SingleTouchInput:nf,Recognizer:da,AttrRecognizer:vi,Tap:Ru,Pan:ys,Swipe:kl,Pinch:_s,Rotate:Mu,Press:va,on:ne,off:X,each:_,merge:M,extend:A,assign:S,inherit:O,bindFn:j,prefixed:ve});var Go=typeof window<"u"?window:typeof self<"u"?self:{};Go.Hammer=ai,typeof i=="function"&&i.amd?i(function(){return ai}):e.exports?e.exports=ai:t[n]=ai}})(typeof window<"u"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")})(lM);const od=lM.exports;var bi;(function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"})(bi||(bi={}));var LC,FC,IC,E_,kC;function UU(e){var t=zU();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function zU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $U={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},GU=(LC=xr(),FC=kr(Oe.IMapService),LC(IC=(E_=function(e){Ut(r,e);var t=UU(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"indragging",!1),Mr(re(n),"mapService",kC,re(n)),T(re(n),"hammertime",void 0),T(re(n),"lastClickTime",0),T(re(n),"lastClickXY",[-1,-1]),T(re(n),"clickTimer",void 0),T(re(n),"$containter",void 0),T(re(n),"onDrag",function(u){var s=n.interactionEvent(u);s.type=$U[s.type],s.type==="dragging"?n.indragging=!0:n.indragging=!1,n.emit(bi.Drag,s)}),T(re(n),"onHammer",function(u){u.srcEvent.stopPropagation();var s=n.interactionEvent(u);n.emit(bi.Hover,s)}),T(re(n),"onTouch",function(u){var s=u.touches[0];n.onHover({x:s.pageX,y:s.pageY,type:"touch"})}),T(re(n),"onHover",function(u){var s=u.clientX,l=u.clientY,f=s,h=l,d=u.type,v=n.mapService.getMapContainer();if(v)if(Fa)f=f-v.left-0,h=h-v.top-0;else{var m=v.getBoundingClientRect(),y=m.top,_=m.left;f=f-_-v.clientLeft,h=h-y-v.clientTop}var E=n.mapService.containerToLngLat([f,h]);if(d==="click"){if(!Fa&&"ontouchstart"in document.documentElement)return;n.isDoubleTap(f,h,E);return}if(d==="touch"){n.isDoubleTap(f,h,E);return}d!=="click"&&d!=="dblclick"&&n.emit(bi.Hover,{x:f,y:h,lngLat:E,type:d,target:u})}),n}return Pe(r,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(bi.Hover)}},{key:"triggerHover",value:function(i){var a=i.x,o=i.y;this.emit(bi.Hover,{x:a,y:o})}},{key:"triggerSelect",value:function(i){this.emit(bi.Select,{featureId:i})}},{key:"triggerActive",value:function(i){this.emit(bi.Active,{featureId:i})}},{key:"handleMiniEvent",value:function(i){this.onHover({clientX:i.touches[0].pageX,clientY:i.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var i=this.mapService.getMapContainer();if(i)if(Fa)en.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var a=new od.Manager(i);a.add(new od.Tap({event:"dblclick",taps:2})),a.add(new od.Tap({event:"click"})),a.add(new od.Pan({threshold:0,pointers:0})),a.add(new od.Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("mousemove",this.onHover),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){if(Fa)en.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(i){var a=i.type,o=i.pointerType,u,s;o==="touch"?(s=Math.floor(i.pointers[0].clientY),u=Math.floor(i.pointers[0].clientX)):(s=Math.floor(i.srcEvent.y),u=Math.floor(i.srcEvent.x));var l=this.mapService.getMapContainer();if(l){var f=l.getBoundingClientRect(),h=f.top,d=f.left;u-=d,s-=h}var v=this.mapService.containerToLngLat([u,s]);return{x:u,y:s,lngLat:v,type:a,target:i.srcEvent}}},{key:"isDoubleTap",value:function(i,a,o){var u=this,s=new Date().getTime(),l="click";s-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),l="dblclick",this.emit(bi.Hover,{x:i,y:a,lngLat:o,type:l})):(this.lastClickTime=s,this.lastClickXY=[i,a],this.clickTimer=setTimeout(function(){l="click",u.emit(bi.Hover,{x:i,y:a,lngLat:o,type:l})},400))}}]),r}(iE),kC=wr(E_.prototype,"mapService",[FC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E_))||IC),HU=0;function VU(e){if(Fa)return null;var t=e;if(typeof e=="string"&&(t=document.getElementById(e)),t){var r=document.createElement("div");return r.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,r.id="l7-scene-".concat(HU++),r.classList.add("l7-scene"),t.appendChild(r),r}return null}function jU(e){var t,r,n=!0;return e==null||(t=e.target)===null||t===void 0||(r=t.path)===null||r===void 0||r.map(function(i){if(i!=null&&i.classList){var a;i==null||(a=i.classList)===null||a===void 0||a.forEach(function(o){(o==="l7-marker"||o==="l7-popup")&&(n=!1)})}}),n}var w;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(w||(w={}));var PC,DC,BC,NC,UC,zC,$C,_c,GC,HC,VC,jC,WC,WU=(PC=xr(),DC=kr(Oe.IMapService),BC=kr(Oe.IRendererService),NC=kr(Oe.IGlobalConfigService),UC=kr(Oe.IInteractionService),zC=kr(Oe.ILayerService),PC($C=(_c=function(){function e(){var t=this;ke(this,e),T(this,"pickedColors",void 0),T(this,"pickedTileLayers",[]),Mr(this,"mapService",GC,this),Mr(this,"rendererService",HC,this),Mr(this,"configService",VC,this),Mr(this,"interactionService",jC,this),Mr(this,"layerService",WC,this),T(this,"pickingFBO",void 0),T(this,"width",0),T(this,"height",0),T(this,"alreadyInPicking",!1),T(this,"pickBufferScale",1),T(this,"pickFromPickingFBO",function(r,n){var i=n.x,a=n.y,o=n.lngLat,u=n.type,s=n.target,l=!1,f=t.rendererService,h=f.readPixels,d=f.getContainer,v=t.getContainerSize(d()),m=v.width,y=v.height;m*=Rn,y*=Rn;var _=r.getLayerConfig(),E=_.enableHighlight,S=_.enableSelect,A=i*Rn,M=a*Rn;if(A>m-1*Rn||A<0||M>y-1*Rn||M<0)return!1;var O=h({x:Math.floor(A/t.pickBufferScale),y:Math.floor((y-(a+1)*Rn)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:t.pickingFBO});if(t.pickedColors=O,O[0]!==0||O[1]!==0||O[2]!==0){var j=Bc(O),q=r.layerPickService.getFeatureById(j);j!==r.getCurrentPickId()&&u==="mousemove"&&(u="mouseenter");var Y={x:i,y:a,type:u,lngLat:o,featureId:j,feature:q,target:s};q&&(l=!0,r.setCurrentPickId(j),t.triggerHoverOnLayer(r,Y))}else{var ne={x:i,y:a,lngLat:o,type:r.getCurrentPickId()!==null&&u==="mousemove"?"mouseout":"un"+u,featureId:null,target:s,feature:null};t.triggerHoverOnLayer(r,be(be({},ne),{},{type:"unpick"})),t.triggerHoverOnLayer(r,ne),r.setCurrentPickId(null)}if(E&&r.layerPickService.highlightPickedFeature(O),S&&u==="click"&&(O==null?void 0:O.toString())!==[0,0,0,0].toString()){var X=Bc(O);r.getCurrentSelectedId()===null||X!==r.getCurrentSelectedId()?(r.layerPickService.selectFeature(O),r.setCurrentSelectedId(X)):(r.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),r.setCurrentSelectedId(null))}return l})}return Pe(e,[{key:"init",value:function(r){var n=this.rendererService,i=n.createTexture2D,a=n.createFramebuffer,o=n.getContainer,u=this.getContainerSize(o()),s=u.width,l=u.height;s*=Rn,l*=Rn,this.pickBufferScale=this.configService.getSceneConfig(r).pickBufferScale||1,this.pickingFBO=a({color:i({width:Math.round(s/this.pickBufferScale),height:Math.round(l/this.pickBufferScale),wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})}),this.interactionService.on(bi.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var t=Ie(H.mark(function n(i,a,o){var u=this,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:s=this.rendererService,l=s.useFramebuffer,f=s.clear,this.resizePickingFBO(),l(this.pickingFBO,function(){f({framebuffer:u.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.hooks.beforePickingEncode.call(),i.renderModels(),i.hooks.afterPickingEncode.call();var v=u.pickBox(i,a);o(v)});case 3:case"end":return d.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"pickBox",value:function(r,n){var i=this,a=n.map(function(X){var $=X<0?0:X;return Math.floor($*Rn/i.pickBufferScale)}),o=ir(a,4),u=o[0],s=o[1],l=o[2],f=o[3],h=this.rendererService,d=h.readPixels,v=h.getContainer,m=this.getContainerSize(v()),y=m.width,_=m.height;if(y*=Rn,_*=Rn,u>(y-1)*Rn/this.pickBufferScale||l<0||s>(_-1)*Rn/this.pickBufferScale||f<0)return[];for(var E=Math.min(y/this.pickBufferScale,l)-u,S=Math.min(_/this.pickBufferScale,f)-s,A=d({x:u,y:Math.floor(_/this.pickBufferScale-(f+1)),width:E,height:S,data:new Uint8Array(E*S*4),framebuffer:this.pickingFBO}),M=[],O={},j=0;j<A.length/4;j=j+1){var q=A.slice(j*4,j*4+4),Y=Bc(q);if(Y!==-1&&!O[Y]){var ne=r.layerPickService.getFeatureById(Y);M.push(be(be({},ne),{},{pickedFeatureIdx:Y})),O[Y]=!0}}return M}},{key:"handleCursor",value:function(r,n){var i=r.getLayerConfig(),a=i.cursor,o=a===void 0?"":a,u=i.cursorEnabled;if(u){var s=this.mapService.version,l=s==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),f=l==null?void 0:l.style.getPropertyValue("cursor");n==="unmousemove"&&f!==""?l==null||l.style.setProperty("cursor",""):n==="mousemove"&&(l==null||l.style.setProperty("cursor",o))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(r){return r.getContext?{width:r.width/Rn,height:r.height/Rn}:r.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var t=Ie(H.mark(function n(i){return H.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(!this.layerService.needPick(i.type)||!this.isPickingAllLayer())){o.next=2;break}return o.abrupt("return");case 2:return this.alreadyInPicking=!0,o.next=5,this.pickingLayers(i);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return o.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var r=this.rendererService.getContainer,n=this.getContainerSize(r()),i=n.width,a=n.height;i*=Rn,a*=Rn,(this.width!==i||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(i/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=i,this.height=a)}},{key:"pickingLayers",value:function(){var t=Ie(H.mark(function n(i){var a=this,o,u,s;return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o=this.rendererService,u=o.useFramebuffer,s=o.clear,this.resizePickingFBO(),u(this.pickingFBO,function(){var h=a.layerService.getRenderList();h.filter(function(d){return d.needPick(i.type)}).reverse().some(function(d){s({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),d.layerPickService.pickRender(i);var v=a.pickFromPickingFBO(d,i);return a.layerService.pickedLayerId=v?+d.id:-1,v&&!d.getLayerConfig().enablePropagation})});case 3:case"end":return f.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"triggerHoverOnLayer",value:function(r,n){jU(n)&&(this.handleCursor(r,n.type),r.emit(n.type,n))}}]),e}(),GC=wr(_c.prototype,"mapService",[DC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HC=wr(_c.prototype,"rendererService",[BC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VC=wr(_c.prototype,"configService",[NC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jC=wr(_c.prototype,"interactionService",[UC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WC=wr(_c.prototype,"layerService",[zC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c))||$C),XU=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;ke(this,e),T(this,"autoStart",void 0),T(this,"startTime",0),T(this,"oldTime",0),T(this,"running",!1),T(this,"elapsedTime",0),this.autoStart=t}return Pe(e,[{key:"start",value:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance>"u"?Date:performance).now();r=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=r}return r}}]),e}(),XC,YC,ZC,qC,Yv,KC,QC;function YU(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ZU(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function ZU(e,t){if(!!e){if(typeof e=="string")return JC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JC(e,t)}}function JC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qU(e){var t=KU();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function KU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var QU=(XC=xr(),YC=kr(Oe.IRendererService),ZC=kr(Oe.IMapService),XC(qC=(Yv=function(e){Ut(r,e);var t=qU(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"pickedLayerId",-1),T(re(n),"clock",new XU),T(re(n),"alreadyInRendering",!1),T(re(n),"layers",[]),T(re(n),"layerList",[]),T(re(n),"layerRenderID",void 0),T(re(n),"sceneInited",!1),T(re(n),"animateInstanceCount",0),T(re(n),"shaderPicking",!0),T(re(n),"enableRender",!0),Mr(re(n),"renderService",KC,re(n)),Mr(re(n),"mapService",QC,re(n)),T(re(n),"reRender",tt.exports.throttle(function(){n.updateLayerRenderList(),n.renderLayers()},32)),T(re(n),"throttleRenderLayers",tt.exports.throttle(function(){n.renderLayers()},16)),n}return Pe(r,[{key:"needPick",value:function(i){return this.layerList.some(function(a){return a.needPick(i)})}},{key:"add",value:function(i){var a=this;this.layers.push(i),this.sceneInited&&i.init().then(function(){a.updateLayerRenderList(),a.renderLayers()})}},{key:"addMask",value:function(i){var a=this;this.sceneInited&&i.init().then(function(){a.renderLayers()})}},{key:"initLayers",value:function(){var n=Ie(H.mark(function a(){var o=this;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var l=Ie(H.mark(function f(h){return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(h.startInit){v.next=4;break}return v.next=3,h.init();case 3:o.updateLayerRenderList();case 4:case"end":return v.stop()}},f)}));return function(f){return l.apply(this,arguments)}}());case 2:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(i){return this.layers.find(function(a){return a.id===i})}},{key:"getLayerByName",value:function(i){return this.layers.find(function(a){return a.name===i})}},{key:"remove",value:function(i,a){if(a){var o=a.layerChildren.indexOf(i);o>-1&&a.layerChildren.splice(o,1)}else{var u=this.layers.indexOf(i);u>-1&&this.layers.splice(u,1)}this.updateLayerRenderList(),i.destroy(),this.renderLayers(),this.emit("layerChange",this.layers)}},{key:"removeAllLayers",value:function(){this.destroy(),this.renderLayers()}},{key:"setEnableRender",value:function(i){this.enableRender=i}},{key:"renderLayers",value:function(){var n=Ie(H.mark(function a(){var o,u,s;return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){f.next=2;break}return f.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),o=YU(this.layerList),f.prev=5,o.s();case 7:if((u=o.n()).done){f.next=19;break}if(s=u.value,s.masks.filter(function(h){return h.inited}).length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),s.masks.map(function(){var h=Ie(H.mark(function d(v){return H.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:v.render();case 1:case"end":return y.stop()}},d)}));return function(d){return h.apply(this,arguments)}}())),!s.getLayerConfig().enableMultiPassRenderer){f.next=15;break}return f.next=13,s.renderMultiPass();case 13:f.next=17;break;case 15:return f.next=17,s.render();case 17:f.next=7;break;case 19:f.next=24;break;case 21:f.prev=21,f.t0=f.catch(5),o.e(f.t0);case 24:return f.prev=24,o.f(),f.finish(24);case 27:this.alreadyInRendering=!1;case 28:case"end":return f.stop()}},a,this,[[5,21,24,27]])}));function i(){return n.apply(this,arguments)}return i}()},{key:"renderMask",value:function(i){i.filter(function(a){return a.inited}).map(function(a){a.render()})}},{key:"beforeRenderData",value:function(){var n=Ie(H.mark(function a(o){var u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,o.hooks.beforeRenderData.promise();case 2:u=l.sent,u&&this.renderLayers();case 4:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"renderLayer",value:function(){var n=Ie(H.mark(function a(o){var u=this;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(o.masks.filter(function(f){return f.inited}).length>0&&o.masks.map(function(f){u.renderService.clear({stencil:0,depth:1,framebuffer:null}),f.render()}),!o.getLayerConfig().enableMultiPassRenderer){l.next=6;break}return l.next=4,o.renderMultiPass();case 4:l.next=8;break;case 6:return l.next=8,o.render();case 8:case"end":return l.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"updateLayerRenderList",value:function(){var i=this;this.layerList=[],this.layers.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).sort(function(a,o){return a.zIndex-o.zIndex}).forEach(function(a){i.layerList.push(a)})}},{key:"destroy",value:function(){this.layers.forEach(function(i){i.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var i=$r(this.mapService.bgColor);this.renderService.clear({color:i,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=en.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){en.cancelAnimationFrame(this.layerRenderID)}}]),r}(Pa.exports.EventEmitter),KC=wr(Yv.prototype,"renderService",[YC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QC=wr(Yv.prototype,"mapService",[ZC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yv))||qC),JU=function(){function e(t){var r=this;ke(this,e),T(this,"name",void 0),T(this,"type",void 0),T(this,"scale",void 0),T(this,"descriptor",void 0),T(this,"featureBufferLayout",[]),T(this,"needRescale",!1),T(this,"needRemapping",!1),T(this,"needRegenerateVertices",!1),T(this,"featureRange",{startIndex:0,endIndex:1/0}),T(this,"vertexAttribute",void 0),T(this,"defaultCallback",function(n){if(n.length===0){var i;return((i=r.scale)===null||i===void 0?void 0:i.defaultValues)||[]}return n.map(function(a,o){var u,s=(u=r.scale)===null||u===void 0?void 0:u.scalers[o].func,l=s(a);return l})}),this.setProps(t)}return Pe(e,[{key:"setProps",value:function(r){Object.assign(this,r)}},{key:"mapping",value:function(r){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var i,a=(i=this.scale)===null||i===void 0?void 0:i.callback.apply(i,It(r));if(!tt.exports.isNil(a))return[a]}return this.defaultCallback(r)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),ez=["modelType"],tz=["buffer","update","name"],rz=["buffer","update","name"],nz=["buffer","update","name"],ud,eA,tA,rA,b_,nA,iz=(ud={},T(ud,w.FLOAT,4),T(ud,w.UNSIGNED_BYTE,1),T(ud,w.UNSIGNED_SHORT,2),ud),az=(eA=xr(),tA=kr(Oe.IRendererService),eA(rA=(b_=function(){function e(){ke(this,e),T(this,"attributesAndIndices",void 0),Mr(this,"rendererService",nA,this),T(this,"attributes",[]),T(this,"triangulation",void 0),T(this,"featureLayout",{sizePerElement:0,elements:[]})}return Pe(e,[{key:"registerStyleAttribute",value:function(r){var n=this.getLayerStyleAttribute(r.name||"");return n?n.setProps(r):(n=new JU(r),this.attributes.push(n)),n}},{key:"updateStyleAttribute",value:function(r,n,i){var a=this.getLayerStyleAttribute(r);a||(a=this.registerStyleAttribute(be(be({},n),{},{name:r})));var o=n.scale;o&&a&&(a.scale=o,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,i&&i.featureRange&&(a.featureRange=i.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(r){return this.attributes.find(function(n){return n.name===r})}},{key:"getLayerAttributeScale",value:function(r){var n,i=this.getLayerStyleAttribute(r),a=i==null||(n=i.scale)===null||n===void 0?void 0:n.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,u=this.attributes.find(function(O){return O.name===r});if(u&&u.descriptor){var s=u.descriptor,l=s.update,f=s.buffer,h=s.size,d=h===void 0?0:h,v=iz[f.type||w.FLOAT];if(l){var m=this.featureLayout,y=m.elements,_=m.sizePerElement,E=y.slice(i,a);if(!E.length)return;var S=E[0].offset,A=S*d*v,M=E.map(function(O,j){for(var q=O.featureIdx,Y=O.vertices,ne=O.normals,X=Y.length/_,$=[],K=0;K<X;K++){var ue=ne?ne.slice(K*3,K*3+3):[];$.push.apply($,It(l(n[q],q,Y.slice(K*_,K*_+_),j,ue)))}return $}).reduce(function(O,j){return O.push.apply(O,It(j)),O},[]);u.vertexAttribute.updateBuffer({data:M,offset:A}),o==null||o.emit("legend:".concat(r),{type:r,attr:u})}}}},{key:"createAttributesAndIndicesAscy",value:function(r,n,i){var a=this;this.featureLayout={sizePerElement:0,elements:[]};var o=this.attributes.map(function(m){return m.resetDescriptor(),m.descriptor}).filter(function(m){return m}),u=i.modelType,s=la(i,ez),l=this.rendererService,f=l.createAttribute,h=l.createBuffer,d=l.createElements,v={};return new Promise(function(m,y){uB(u,be({descriptors:a.getDescriptorsWithOutFunc(o),features:r,segmentNumber:n},s)).then(function(_){_.descriptors.forEach(function(S,A){if(S){var M=S.buffer;S.update,S.name;var O=la(S,tz),j=f(be({buffer:h(M)},O));v[S.name||""]=j,a.attributes[A].vertexAttribute=j}}),a.featureLayout=_.featureLayout;var E=d({data:_.indices,type:w.UNSIGNED_INT,count:_.indices.length});a.attributesAndIndices={attributes:v,elements:E,count:null},m(a.attributesAndIndices)}).catch(function(_){console.warn(_),y(_)})})}},{key:"createAttributesAndIndices",value:function(r,n,i){var a=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var o=this.attributes.map(function(E){return E.resetDescriptor(),E.descriptor}),u=0,s=0,l=[],f=3;r.forEach(function(E,S){var A=a.triangulation(E,i),M=A.indices,O=A.vertices,j=A.normals,q=A.size,Y=A.indexes,ne=A.count;typeof ne=="number"&&(s+=ne),M.forEach(function(ue){l.push(ue+u)}),f=q;var X=O.length/q;a.featureLayout.sizePerElement=f,a.featureLayout.elements.push({featureIdx:S,vertices:O,normals:j,offset:u}),u+=X;for(var $=function(de){var pe=(j==null?void 0:j.slice(de*3,de*3+3))||[],le=O.slice(de*q,de*q+q),ve=0;Y&&Y[de]!==void 0&&(ve=Y[de]),o.forEach(function(Me,Ne){if(Me&&Me.update){var Xe;(Xe=Me.buffer.data).push.apply(Xe,It(Me.update(E,S,le,de,pe,ve)))}})},K=0;K<X;K++)$(K)});var h=this.rendererService,d=h.createAttribute,v=h.createBuffer,m=h.createElements,y={};o.forEach(function(E,S){if(E){var A=E.buffer;E.update,E.name;var M=la(E,rz),O=d(be({buffer:v(A)},M));y[E.name||""]=O,a.attributes[S].vertexAttribute=O}});var _=m({data:l,type:w.UNSIGNED_INT,count:l.length});return this.attributesAndIndices={attributes:y,elements:_,count:s},this.attributesAndIndices}},{key:"createAttributes",value:function(r,n){var i=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var a=this.attributes.map(function(d){return d.resetDescriptor(),d.descriptor}),o=0,u=3;r.forEach(function(d,v){var m=i.triangulation(d),y=m.indices,_=m.vertices,E=m.normals,S=m.size,A=m.indexes;y.forEach(function(q){}),u=S;var M=_.length/S;i.featureLayout.sizePerElement=u,i.featureLayout.elements.push({featureIdx:v,vertices:_,normals:E,offset:o}),o+=M;for(var O=function(Y){var ne=(E==null?void 0:E.slice(Y*3,Y*3+3))||[],X=_.slice(Y*S,Y*S+S),$=0;A&&A[Y]!==void 0&&($=A[Y]),a.forEach(function(K,ue){if(K&&K.update){var de;(de=K.buffer.data).push.apply(de,It(K.update(d,v,X,Y,ne,$)))}})},j=0;j<M;j++)O(j)});var s=this.rendererService,l=s.createAttribute,f=s.createBuffer,h={};return a.forEach(function(d,v){if(d){var m=d.buffer;d.update,d.name;var y=la(d,nz),_=l(be({buffer:f(m)},y));h[d.name||""]=_,i.attributes[v].vertexAttribute=_}}),{attributes:h}}},{key:"clearAllAttributes",value:function(){var r;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(r=this.attributesAndIndices)===null||r===void 0||r.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(r){return r.map(function(n){return{buffer:n.buffer,name:n.name,size:n.size}})}}]),e}(),nA=wr(b_.prototype,"rendererService",[tA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b_))||rA);function cM(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(f){try{l(n.next(f))}catch(h){o(h)}}function s(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(u,s)}l((n=n.apply(e,t||[])).next())})}function fM(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(f){return s([l,f])}}function s(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function hE(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function pE(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function dE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var U1={exports:{}},Ig={exports:{}},e0={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=t.default})(e0,e0.exports);var fa={},z1={exports:{}},$1={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];var a=n.pop();return r.call(this,n,a)}},e.exports=t.default})($1,$1.exports);var Al={};Object.defineProperty(Al,"__esModule",{value:!0});Al.fallback=hM;Al.wrap=pM;var oz=Al.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,uz=Al.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,sz=Al.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function hM(e){setTimeout(e,0)}function pM(e){return function(t){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e(function(){return t.apply(void 0,r)})}}var Ed;oz?Ed=queueMicrotask:uz?Ed=setImmediate:sz?Ed=process.nextTick:Ed=hM;Al.default=pM(Ed);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=$1.exports,n=u(r),i=Al,a=u(i),o=fa;function u(h){return h&&h.__esModule?h:{default:h}}function s(h){return(0,o.isAsync)(h)?function(){for(var d=[],v=arguments.length;v--;)d[v]=arguments[v];var m=d.pop(),y=h.apply(this,d);return l(y,m)}:(0,n.default)(function(d,v){var m;try{m=h.apply(this,d)}catch(y){return v(y)}if(m&&typeof m.then=="function")return l(m,v);v(null,m)})}function l(h,d){return h.then(function(v){f(d,null,v)},function(v){f(d,v&&v.message?v:new Error(v))})}function f(h,d,v){try{h(d,v)}catch(m){(0,a.default)(function(y){throw y},m)}}e.exports=t.default})(z1,z1.exports);Object.defineProperty(fa,"__esModule",{value:!0});fa.isAsyncIterable=fa.isAsyncGenerator=fa.isAsync=void 0;var lz=z1.exports,cz=fz(lz);function fz(e){return e&&e.__esModule?e:{default:e}}function dM(e){return e[Symbol.toStringTag]==="AsyncFunction"}function hz(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function pz(e){return typeof e[Symbol.asyncIterator]=="function"}function dz(e){if(typeof e!="function")throw new Error("expected a function");return dM(e)?(0,cz.default)(e):e}fa.default=dz;fa.isAsync=dM;fa.isAsyncGenerator=hz;fa.isAsyncIterable=pz;var Hc={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n,i){if(i===void 0&&(i=n.length),!i)throw new Error("arity is undefined");function a(){for(var o=this,u=[],s=arguments.length;s--;)u[s]=arguments[s];return typeof u[i-1]=="function"?n.apply(this,u):new Promise(function(l,f){u[i-1]=function(h){for(var d=[],v=arguments.length-1;v-- >0;)d[v]=arguments[v+1];if(h)return f(h);l(d.length>1?d:d[0])},n.apply(o,u)})}return a}e.exports=t.default})(Hc,Hc.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=e0.exports,n=s(r),i=fa,a=s(i),o=Hc.exports,u=s(o);function s(l){return l&&l.__esModule?l:{default:l}}t.default=(0,u.default)(function(l,f,h){var d=(0,n.default)(f)?[]:{};l(f,function(v,m,y){(0,a.default)(v)(function(_){for(var E,S=[],A=arguments.length-1;A-- >0;)S[A]=arguments[A+1];S.length<2&&(E=S,S=E[0]),d[m]=S,y(_)})},function(v){return h(v,d)})},3),e.exports=t.default})(Ig,Ig.exports);var G1={exports:{}},kg={exports:{}},H1={exports:{}},t0={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){function i(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];if(n!==null){var u=n;n=null,u.apply(this,a)}}return Object.assign(i,n),i}e.exports=t.default})(t0,t0.exports);var V1={exports:{}},j1={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return r[Symbol.iterator]&&r[Symbol.iterator]()},e.exports=t.default})(j1,j1.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var r=e0.exports,n=o(r),i=j1.exports,a=o(i);function o(h){return h&&h.__esModule?h:{default:h}}function u(h){var d=-1,v=h.length;return function(){return++d<v?{value:h[d],key:d}:null}}function s(h){var d=-1;return function(){var m=h.next();return m.done?null:(d++,{value:m.value,key:d})}}function l(h){var d=h?Object.keys(h):[],v=-1,m=d.length;return function y(){var _=d[++v];return _==="__proto__"?y():v<m?{value:h[_],key:_}:null}}function f(h){if((0,n.default)(h))return u(h);var d=(0,a.default)(h);return d?s(d):l(h)}e.exports=t.default})(V1,V1.exports);var r0={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var o=n;n=null,o.apply(this,i)}}e.exports=t.default})(r0,r0.exports);var W1={exports:{}},n0={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={};t.default=r,e.exports=t.default})(n0,n0.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n0.exports,n=i(r);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,u,s,l){var f=!1,h=!1,d=!1,v=0,m=0;function y(){v>=u||d||f||(d=!0,o.next().then(function(S){var A=S.value,M=S.done;if(!(h||f)){if(d=!1,M){f=!0,v<=0&&l(null);return}v++,s(A,m,_),m++,y()}}).catch(E))}function _(S,A){if(v-=1,!h){if(S)return E(S);if(S===!1){f=!0,h=!0;return}if(A===n.default||f&&v<=0)return f=!0,l(null);y()}}function E(S){h||(d=!1,f=!0,l(S))}y()}e.exports=t.default})(W1,W1.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=t0.exports,n=v(r),i=V1.exports,a=v(i),o=r0.exports,u=v(o),s=fa,l=W1.exports,f=v(l),h=n0.exports,d=v(h);function v(m){return m&&m.__esModule?m:{default:m}}t.default=function(m){return function(y,_,E){if(E=(0,n.default)(E),m<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!y)return E(null);if((0,s.isAsyncGenerator)(y))return(0,f.default)(y,m,_,E);if((0,s.isAsyncIterable)(y))return(0,f.default)(y[Symbol.asyncIterator](),m,_,E);var S=(0,a.default)(y),A=!1,M=!1,O=0,j=!1;function q(ne,X){if(!M)if(O-=1,ne)A=!0,E(ne);else if(ne===!1)A=!0,M=!0;else{if(X===d.default||A&&O<=0)return A=!0,E(null);j||Y()}}function Y(){for(j=!0;O<m&&!A;){var ne=S();if(ne===null){A=!0,O<=0&&E(null);return}O+=1,_(ne.value,ne.key,(0,u.default)(q))}j=!1}Y()}},e.exports=t.default})(H1,H1.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=H1.exports,n=s(r),i=fa,a=s(i),o=Hc.exports,u=s(o);function s(f){return f&&f.__esModule?f:{default:f}}function l(f,h,d,v){return(0,n.default)(h)(f,(0,a.default)(d),v)}t.default=(0,u.default)(l,4),e.exports=t.default})(kg,kg.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=kg.exports,n=o(r),i=Hc.exports,a=o(i);function o(s){return s&&s.__esModule?s:{default:s}}function u(s,l,f){return(0,n.default)(s,1,l,f)}t.default=(0,a.default)(u,3),e.exports=t.default})(G1,G1.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=Ig.exports,n=o(r),i=G1.exports,a=o(i);function o(s){return s&&s.__esModule?s:{default:s}}function u(s,l){return(0,n.default)(a.default,s,l)}e.exports=t.default})(U1,U1.exports);var Sm=dE(U1.exports),lu=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,Sm(this.tasks)},e.prototype.tap=function(t,r){var n=this;this.tasks.push(function(i){r.apply(void 0,pE([],hE(n.args),!1)),i(null,t)})},e}(),X1={exports:{}},Y1={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=e0.exports,n=_(r),i=n0.exports,a=_(i),o=kg.exports,u=_(o),s=t0.exports,l=_(s),f=r0.exports,h=_(f),d=fa,v=_(d),m=Hc.exports,y=_(m);function _(M){return M&&M.__esModule?M:{default:M}}function E(M,O,j){j=(0,l.default)(j);var q=0,Y=0,ne=M.length,X=!1;ne===0&&j(null);function $(K,ue){K===!1&&(X=!0),X!==!0&&(K?j(K):(++Y===ne||ue===a.default)&&j(null))}for(;q<ne;q++)O(M[q],q,(0,h.default)($))}function S(M,O,j){return(0,u.default)(M,1/0,O,j)}function A(M,O,j){var q=(0,n.default)(M)?E:S;return q(M,(0,v.default)(O),j)}t.default=(0,y.default)(A,3),e.exports=t.default})(Y1,Y1.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=Y1.exports,n=o(r),i=Ig.exports,a=o(i);function o(s){return s&&s.__esModule?s:{default:s}}function u(s,l){return(0,a.default)(n.default,s,l)}e.exports=t.default})(X1,X1.exports);X1.exports;var Z1={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=t0.exports,n=f(r),i=r0.exports,a=f(i),o=fa,u=f(o),s=Hc.exports,l=f(s);function f(d){return d&&d.__esModule?d:{default:d}}function h(d,v){if(v=(0,n.default)(v),!Array.isArray(d))return v(new Error("First argument to waterfall must be an array of functions"));if(!d.length)return v();var m=0;function y(E){var S=(0,u.default)(d[m++]);S.apply(void 0,E.concat([(0,a.default)(_)]))}function _(E){for(var S=[],A=arguments.length-1;A-- >0;)S[A]=arguments[A+1];if(E!==!1){if(E||m===d.length)return v.apply(void 0,[E].concat(S));y(S)}}y([])}t.default=(0,l.default)(h),e.exports=t.default})(Z1,Z1.exports);var vz=dE(Z1.exports),iA=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return Sm(this.tasks)},e.prototype.tap=function(t,r){this.tasks.push(function(n){var i=r();n(i,t)})},e}(),gz=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,Sm(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return cM(n,void 0,void 0,function(){return fM(this,function(a){switch(a.label){case 0:return[4,r.apply(void 0,pE([],hE(this.args),!1))];case 1:return a.sent(),i(null,t),[2]}})})})},e}(),mz=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,Sm(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return cM(n,void 0,void 0,function(){var a;return fM(this,function(o){switch(o.label){case 0:return[4,r.apply(void 0,pE([],hE(this.args),!1))];case 1:return a=o.sent(),i(a,t),[2]}})})})},e}(),yz=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return vz(this.tasks)},e.prototype.tapPromise=function(t,r){this.tasks.length===0?this.tasks.push(function(n){r().then(function(i){n(null,i)})}):this.tasks.push(function(n,i){r(n).then(function(a){i(null,a)})})},e}(),vE={exports:{}};function Pg(e){var t=e.target||e.srcElement;t.__resizeRAF__&&cancelAnimationFrame(t.__resizeRAF__),t.__resizeRAF__=requestAnimationFrame(function(){var r=t.__resizeTrigger__,n=r&&r.__resizeListeners__;n&&n.forEach(function(i){i.call(r,e)})})}var aA=function(t,r){var n=this,i=n.document,a,o=i.attachEvent;typeof navigator<"u"&&(a=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function u(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",Pg)}if(!t.__resizeListeners__)if(t.__resizeListeners__=[],o)t.__resizeTrigger__=t,t.attachEvent("onresize",Pg);else{getComputedStyle(t).position==="static"&&(t.style.position="relative");var s=t.__resizeTrigger__=i.createElement("object");s.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),s.setAttribute("class","resize-sensor"),s.setAttribute("tabindex","-1"),s.setAttribute("title",""),s.__resizeElement__=t,s.onload=u,s.type="text/html",a&&t.appendChild(s),s.data="about:blank",a||t.appendChild(s)}t.__resizeListeners__.push(r)};vE.exports=typeof window>"u"?aA:aA.bind(window);var _z=vE.exports.unbind=function(e,t){var r=document.attachEvent,n=e.__resizeListeners__||[];if(t){var i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n=e.__resizeListeners__=[];if(!n.length){if(r)e.detachEvent("onresize",Pg);else if(e.__resizeTrigger__){var a=e.__resizeTrigger__.contentDocument,o=a&&a.defaultView;o&&(o.removeEventListener("resize",Pg),delete o.__resizeTrigger__),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)}delete e.__resizeListeners__}},oA,uA,sA,lA,cA,fA,hA,pA,dA,vA,gA,mA,yA,_A,xA,EA,bA,_i,CA,AA,SA,TA,wA,MA,RA,OA,LA,FA,IA,kA,PA,DA,BA;function xz(e){var t=Ez();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Ez(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bz=(oA=xr(),uA=kr(Oe.SceneID),sA=kr(Oe.IIconService),lA=kr(Oe.IFontService),cA=kr(Oe.IControlService),fA=kr(Oe.IGlobalConfigService),hA=kr(Oe.IMapService),pA=kr(Oe.ICoordinateSystemService),dA=kr(Oe.IRendererService),vA=kr(Oe.ILayerService),gA=kr(Oe.ICameraService),mA=kr(Oe.IInteractionService),yA=kr(Oe.IPickingService),_A=kr(Oe.IShaderModuleService),xA=kr(Oe.IMarkerService),EA=kr(Oe.IPopupService),oA(bA=(_i=function(e){Ut(r,e);var t=xz(r);function r(){var n;return ke(this,r),n=t.call(this),T(re(n),"destroyed",!1),T(re(n),"loaded",!1),Mr(re(n),"id",CA,re(n)),Mr(re(n),"iconService",AA,re(n)),Mr(re(n),"fontService",SA,re(n)),Mr(re(n),"controlService",TA,re(n)),Mr(re(n),"configService",wA,re(n)),Mr(re(n),"map",MA,re(n)),Mr(re(n),"coordinateSystemService",RA,re(n)),Mr(re(n),"rendererService",OA,re(n)),Mr(re(n),"layerService",LA,re(n)),Mr(re(n),"cameraService",FA,re(n)),Mr(re(n),"interactionService",IA,re(n)),Mr(re(n),"pickingService",kA,re(n)),Mr(re(n),"shaderModuleService",PA,re(n)),Mr(re(n),"markerService",DA,re(n)),Mr(re(n),"popupService",BA,re(n)),T(re(n),"inited",!1),T(re(n),"initPromise",void 0),T(re(n),"rendering",!1),T(re(n),"$container",void 0),T(re(n),"canvas",void 0),T(re(n),"markerContainer",void 0),T(re(n),"hooks",void 0),T(re(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),Ek(),n.coordinateSystemService.needRefresh=!0,n.render())}),T(re(n),"handleMapCameraChanged",function(i){n.cameraService.update(i),n.render()}),n.hooks={init:new gz},n}return Pe(r,[{key:"init",value:function(i){var a=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ie(H.mark(function o(){return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise(function(l){a.map.onCameraChanged(function(f){a.cameraService.init(),a.cameraService.update(f),l()}),a.map.init()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on(bi.Drag,a.addSceneEvent.bind(a));case 9:case"end":return s.stop()}},o)}))),this.hooks.init.tapPromise("initRenderer",Ie(H.mark(function o(){var u,s;return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(u=a.map.getOverlayContainer(),u?a.$container=u:a.$container=VU(a.configService.getSceneConfig(a.id).id||""),!a.$container){f.next=12;break}return a.canvas=ca("canvas","",a.$container),a.setCanvas(),f.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),i.gl);case 7:a.initContainer(),vE.exports(a.$container,a.handleWindowResized),en.matchMedia&&((s=en.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||s===void 0||s.addListener(a.handleWindowResized)),f.next=13;break;case 12:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 13:a.pickingService.init(a.id);case 14:case"end":return f.stop()}},o)}))),this.render()}},{key:"initMiniScene",value:function(i){var a=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ie(H.mark(function o(){return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise(function(l){a.map.onCameraChanged(function(f){a.cameraService.init(),a.cameraService.update(f),a.map.version!=="GAODE2.x"&&l()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on(bi.Drag,a.addSceneEvent.bind(a));case 5:case"end":return s.stop()}},o)}))),this.hooks.init.tapPromise("initRenderer",Ie(H.mark(function o(){var u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(u=i.canvas,a.$container=u||null,!a.$container){l.next=7;break}return l.next=5,a.rendererService.init(i.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:l.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return l.stop()}},o)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(i){this.layerService.sceneService=this,this.layerService.add(i)}},{key:"addMask",value:function(i){this.layerService.sceneService=this,this.layerService.addMask(i)}},{key:"render",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(this.rendering||this.destroyed)){u.next=2;break}return u.abrupt("return");case 2:if(this.rendering=!0,this.inited){u.next=16;break}return u.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),u.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,u.next=18;break;case 16:this.layerService.initLayers(),this.layerService.renderLayers();case 18:this.rendering=!1;case 19:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addFontFace",value:function(i,a){this.fontService.addFontFace(i,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(i){var a,o=(a=this.$container)===null||a===void 0?void 0:a.getElementsByTagName("canvas")[0];this.render();var u=i==="jpg"?o==null?void 0:o.toDataURL("image/jpeg"):o==null?void 0:o.toDataURL("image/png");return u}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var i=this.$container.parentElement;i!==null&&(this.markerContainer=ca("div","l7-marker-container",i))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var i=this,a,o;if(!this.inited){this.destroyed=!0;return}if(_z(this.$container,this.handleWindowResized),en.matchMedia){var u;(u=en.matchMedia("screen and (min-resolution: 2dppx)"))===null||u===void 0||u.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var s;(s=i.$container)===null||s===void 0||s.removeChild(i.canvas),i.canvas=null,i.rendererService.destroy()}),(a=this.$container)===null||a===void 0||(o=a.parentNode)===null||o===void 0||o.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var i,a,o=Rn,u=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,s=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,l=this.canvas;l&&(l.width=u*o,l.height=s*o),this.rendererService.viewport({x:0,y:0,width:o*u,height:o*s})}},{key:"setCanvas",value:function(){var i,a,o=Rn,u=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,s=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,l=this.canvas;l.width=u*o,l.height=s*o,l.style.width="100%",l.style.height="100%"}},{key:"addSceneEvent",value:function(i){this.emit(i.type,i)}}]),r}(Pa.exports.EventEmitter),CA=wr(_i.prototype,"id",[uA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AA=wr(_i.prototype,"iconService",[sA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SA=wr(_i.prototype,"fontService",[lA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TA=wr(_i.prototype,"controlService",[cA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wA=wr(_i.prototype,"configService",[fA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MA=wr(_i.prototype,"map",[hA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RA=wr(_i.prototype,"coordinateSystemService",[pA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OA=wr(_i.prototype,"rendererService",[dA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LA=wr(_i.prototype,"layerService",[vA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FA=wr(_i.prototype,"cameraService",[gA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IA=wr(_i.prototype,"interactionService",[mA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kA=wr(_i.prototype,"pickingService",[yA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PA=wr(_i.prototype,"shaderModuleService",[_A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DA=wr(_i.prototype,"markerService",[xA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BA=wr(_i.prototype,"popupService",[EA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i))||bA);function Cz(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break}return t}var Az=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function NA(e){var t={};return e=e.replace(Az,function(r,n,i){var a=i.split(":"),o=a[0].trim(),u="";switch(a.length>1&&(u=a[1].trim()),n){case"bool":u=u==="true";break;case"float":case"int":u=Number(u);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":u?u=u.replace("[","").replace("]","").split(",").reduce(function(s,l){return s.push(Number(l.trim())),s},[]):u=new Array(Cz(n)).fill(0);break}return t[o]=u,"uniform ".concat(n," ").concat(o,`;
`)}),{content:e,uniforms:t}}var UA,zA,$A="#define PI 3.14159265359",Sz=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Tz=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,wz=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Mz=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Rz=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Oz=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,Lz=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,Fz=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Iz=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,kz=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,Pz=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,Dz=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,Bz=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,Nz=/precision\s+(high|low|medium)p\s+float/,Uz=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,zz=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,$z=(UA=xr(),UA(zA=function(){function e(){ke(this,e),T(this,"moduleCache",{}),T(this,"rawContentCache",{})}return Pe(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:$A,fs:$A}),this.registerModule("decode",{vs:Sz,fs:""}),this.registerModule("projection",{vs:Lz,fs:""}),this.registerModule("project",{vs:Oz,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Fz}),this.registerModule("lighting",{vs:wz,fs:""}),this.registerModule("light",{vs:Tz,fs:""}),this.registerModule("picking",{vs:Rz,fs:Mz}),this.registerModule("styleMapping",{vs:Iz,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:Bz,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:kz,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:Pz,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:Dz,fs:""})}},{key:"registerModule",value:function(r,n){if(!this.rawContentCache[r]){var i=n.vs,a=n.fs,o=n.uniforms,u=NA(i),s=u.content,l=u.uniforms,f=NA(a),h=f.content,d=f.uniforms;this.rawContentCache[r]={fs:h,uniforms:be(be(be({},l),d),o),vs:s}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(r){var n=this;if(this.moduleCache[r])return this.moduleCache[r];var i=this.rawContentCache[r].vs,a=this.rawContentCache[r].fs,o=this.processModule(i,[],"vs"),u=o.content,s=o.includeList,l=this.processModule(a,[],"fs"),f=l.content,h=l.includeList,d=f,v=tt.exports.uniq(s.concat(h).concat(r)).reduce(function(m,y){return be(be({},m),n.rawContentCache[y].uniforms)},{});return Nz.test(f)||(d=Uz+f),this.moduleCache[r]={fs:d.trim(),uniforms:v,vs:u.trim()},this.moduleCache[r]}},{key:"processModule",value:function(r,n,i){var a=this,o=r.replace(zz,function(u,s){var l=s.split(" "),f=l[0].replace(/"/g,"");if(n.indexOf(f)>-1)return"";var h=a.rawContentCache[f][i];n.push(f);var d=a.processModule(h,n,i),v=d.content;return v});return{content:o,includeList:n}}}]),e}())||zA);function Gz(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ce(e),e!==null););return e}function gl(){return typeof Reflect<"u"&&Reflect.get?gl=Reflect.get.bind():gl=function(t,r,n){var i=Gz(t,r);if(!!i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},gl.apply(this,arguments)}var El;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(El||(El={}));var GA,HA,Tm=(GA=xr(),GA(HA=function(){function e(){ke(this,e),T(this,"shaderModuleService",void 0),T(this,"rendererService",void 0),T(this,"cameraService",void 0),T(this,"mapService",void 0),T(this,"interactionService",void 0),T(this,"layerService",void 0),T(this,"config",void 0)}return Pe(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return El.Normal}},{key:"init",value:function(r,n){this.config=n,this.rendererService=r.getContainer().get(Oe.IRendererService),this.cameraService=r.getContainer().get(Oe.ICameraService),this.mapService=r.getContainer().get(Oe.IMapService),this.interactionService=r.getContainer().get(Oe.IInteractionService),this.layerService=r.getContainer().get(Oe.ILayerService),this.shaderModuleService=r.getContainer().get(Oe.IShaderModuleService)}},{key:"render",value:function(r){}}]),e}())||HA),VA,jA;function Hz(e){var t=Vz();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Vz(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jz=(VA=xr(),VA(jA=function(e){Ut(r,e);var t=Hz(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(i,a){gl(Ce(r.prototype),"init",this).call(this,i,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),r}(Tm))||jA),WA,XA,YA,C_,ZA;function Wz(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Xz(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function Xz(e,t){if(!!e){if(typeof e=="string")return qA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qA(e,t)}}function qA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yz=(WA=xr(),XA=kr(Oe.IPostProcessor),WA(YA=(C_=function(){function e(){ke(this,e),T(this,"passes",[]),Mr(this,"postProcessor",ZA,this),T(this,"layer",void 0),T(this,"renderFlag",void 0),T(this,"width",0),T(this,"height",0)}return Pe(e,[{key:"setLayer",value:function(r){this.layer=r}},{key:"setRenderFlag",value:function(r){this.renderFlag=r}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var t=Ie(H.mark(function n(){var i,a,o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:i=Wz(this.passes),s.prev=1,i.s();case 3:if((a=i.n()).done){s.next=9;break}return o=a.value,s.next=7,o.render(this.layer);case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),i.e(s.t0);case 14:return s.prev=14,i.f(),s.finish(14);case 17:return s.next=19,this.postProcessor.render(this.layer);case 19:case"end":return s.stop()}},n,this,[[1,11,14,17]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"resize",value:function(r,n){(this.width!==r||this.height!==n)&&(this.postProcessor.resize(r,n),this.width=r,this.height=n)}},{key:"add",value:function(r,n){r.getType()===El.PostProcessing?this.postProcessor.add(r,this.layer,n):(r.init(this.layer,n),this.passes.push(r))}},{key:"insert",value:function(r,n,i){r.init(this.layer,n),this.passes.splice(i,0,r)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),ZA=wr(C_.prototype,"postProcessor",[XA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C_))||YA),KA,QA;function Zz(e){var t=qz();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function qz(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Kz=(KA=xr(),KA(QA=function(e){Ut(r,e);var t=Zz(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"pickingFBO",void 0),T(re(n),"layer",void 0),T(re(n),"width",0),T(re(n),"height",0),T(re(n),"alreadyInRendering",!1),T(re(n),"pickFromPickingFBO",function(u){var s=u.x,l=u.y,f=u.lngLat,h=u.type;if(!(!n.layer.isVisible()||!n.layer.needPick(h))){var d=n.rendererService,v=d.getViewportSize,m=d.readPixels,y=d.useFramebuffer,_=v(),E=_.width,S=_.height,A=n.layer.getLayerConfig(),M=A.enableHighlight,O=A.enableSelect,j=s*Rn,q=l*Rn;if(!(j>E||j<0||q>S||q<0)){var Y;y(n.pickingFBO,function(){var ne;if(Y=m({x:Math.round(j),y:Math.round(S-(l+1)*Rn),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),Y[0]!==0||Y[1]!==0||Y[2]!==0){var X=Bc(Y),$=n.layer.getSource().getFeatureById(X),K={x:s,y:l,type:h,lngLat:f,featureId:X,feature:$};$&&(n.layer.setCurrentPickId(X),n.triggerHoverOnLayer(K))}else{var ue={x:s,y:l,lngLat:f,type:n.layer.getCurrentPickId()===null?"un"+h:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer(be(be({},ue),{},{type:"unpick"})),n.triggerHoverOnLayer(ue),n.layer.setCurrentPickId(null)}M&&n.highlightPickedFeature(Y),O&&h==="click"&&((ne=Y)===null||ne===void 0?void 0:ne.toString())!==[0,0,0,0].toString()&&n.selectFeature(Y)})}}}),n}return Pe(r,[{key:"getType",value:function(){return El.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(i,a){gl(Ce(r.prototype),"init",this).call(this,i,a),this.layer=i;var o=this.rendererService,u=o.createTexture2D,s=o.createFramebuffer,l=o.getViewportSize,f=l(),h=f.width,d=f.height;this.pickingFBO=s({color:u({width:h,height:d,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})}),this.interactionService.on(bi.Hover,this.pickFromPickingFBO),this.interactionService.on(bi.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(bi.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(i){var a=this;if(!this.alreadyInRendering){var o=this.rendererService,u=o.getViewportSize,s=o.useFramebuffer,l=o.clear,f=u(),h=f.width,d=f.height;this.alreadyInRendering=!0,(this.width!==h||this.height!==d)&&(this.pickingFBO.resize({width:h,height:d}),this.width=h,this.height=d),s(this.pickingFBO,function(){l({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var v=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(v),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(i){this.layer.emit(i.type,i)}},{key:"highlightPickedFeature",value:function(i){var a=ir(i,3),o=a[0],u=a[1],s=a[2];this.layer.hooks.beforeHighlight.call([o,u,s]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(i){var a=ir(i,3),o=a[0],u=a[1],s=a[2];this.layer.hooks.beforeSelect.call([o,u,s]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(i){var a=i.featureId,o=ss(a);this.selectFeature(new Uint8Array(o))}},{key:"highlightFeatureHandle",value:function(i){var a=i.featureId,o=ss(a);this.highlightPickedFeature(new Uint8Array(o))}}]),r}(Tm))||QA),JA,eS,tS,A_,rS,Qz=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,cs=(JA=xr(),eS=kr(Oe.IShaderModuleService),JA(tS=(A_=function(){function e(){ke(this,e),Mr(this,"shaderModuleService",rS,this),T(this,"rendererService",void 0),T(this,"config",void 0),T(this,"quad",Qz),T(this,"enabled",!0),T(this,"renderToScreen",!1),T(this,"model",void 0),T(this,"name",void 0),T(this,"optionsToUpdate",{})}return Pe(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(r){this.name=r}},{key:"getType",value:function(){return El.PostProcessing}},{key:"init",value:function(r,n){this.config=n,this.rendererService=r.getContainer().get(Oe.IRendererService),this.shaderModuleService=r.getContainer().get(Oe.IShaderModuleService);var i=this.rendererService,a=i.createAttribute,o=i.createBuffer,u=i.createModel,s=this.setupShaders(),l=s.vs,f=s.fs,h=s.uniforms;this.model=u({vs:l,fs:f,attributes:{a_Position:a({buffer:o({data:[-4,-4,4,-4,0,4],type:w.FLOAT}),size:2})},uniforms:be(be({u_Texture:null},h),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(r,n){var i=this,a=r.multiPassRenderer.getPostProcessor(),o=this.rendererService,u=o.useFramebuffer,s=o.getViewportSize,l=o.clear,f=s(),h=f.width,d=f.height;u(this.renderToScreen?null:a.getWriteFBO(),function(){l({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var v=be({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[h,d]},i.convertOptionsToUniforms(i.optionsToUpdate));n&&(v.u_BloomFinal=1,v.u_Texture2=n),i.model.draw({uniforms:v})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(r){this.enabled=r}},{key:"setRenderToScreen",value:function(r){this.renderToScreen=r}},{key:"updateOptions",value:function(r){this.optionsToUpdate=be(be({},this.optionsToUpdate),r)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(r){var n={};return Object.keys(r).forEach(function(i){tt.exports.isNil(r[i])||(n["u_".concat(tt.exports.upperFirst(tt.exports.camelCase(i)))]=r[i])}),n}}]),e}(),rS=wr(A_.prototype,"shaderModuleService",[eS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A_))||tS),nS,iS;function Jz(e){var t=e$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function e$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var t$=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,r$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,n$=(nS=xr(),nS(iS=function(e){Ut(r,e);var t=Jz(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:r$,fs:t$});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,o=i.fs,u=i.uniforms,s=this.rendererService.getViewportSize(),l=s.width,f=s.height;return{vs:a,fs:o,uniforms:be(be({},u),{},{u_ViewportSize:[l,f]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return tt.exports.isNil(i.bloomRadius)||(a.u_radius=i.bloomRadius),tt.exports.isNil(i.bloomIntensity)||(a.u_intensity=i.bloomIntensity),tt.exports.isNil(i.bloomBaseRadio)||(a.u_baseRadio=i.bloomBaseRadio),a}}]),r}(cs))||iS),aS,oS;function i$(e){var t=a$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function a$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var o$=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,u$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,s$=(aS=xr(),aS(oS=function(e){Ut(r,e);var t=i$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:u$,fs:o$});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,o=i.fs,u=i.uniforms,s=this.rendererService.getViewportSize(),l=s.width,f=s.height;return{vs:a,fs:o,uniforms:be(be({},u),{},{u_ViewportSize:[l,f]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return tt.exports.isNil(i.blurRadius)||(a.u_BlurDir=[i.blurRadius,0]),a}}]),r}(cs))||oS),uS,sS;function l$(e){var t=c$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function c$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var f$=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,h$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,p$=(uS=xr(),uS(sS=function(e){Ut(r,e);var t=l$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:h$,fs:f$});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,o=i.fs,u=i.uniforms,s=this.rendererService.getViewportSize(),l=s.width,f=s.height;return{vs:a,fs:o,uniforms:be(be({},u),{},{u_ViewportSize:[l,f]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return tt.exports.isNil(i.blurRadius)||(a.u_BlurDir=[0,i.blurRadius]),a}}]),r}(cs))||sS),lS,cS;function d$(e){var t=v$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function v$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var g$=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,m$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,y$=(lS=xr(),lS(cS=function(e){Ut(r,e);var t=d$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:m$,fs:g$});var i=this.shaderModuleService.getModule("colorhalftone-pass"),a=i.vs,o=i.fs,u=i.uniforms,s=this.rendererService.getViewportSize(),l=s.width,f=s.height;return{vs:a,fs:o,uniforms:be(be({},u),{},{u_ViewportSize:[l,f]})}}}]),r}(cs))||cS),fS,hS;function _$(e){var t=x$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function x$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E$=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,b$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,C$=(fS=xr(),fS(hS=function(e){Ut(r,e);var t=_$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:b$,fs:E$}),this.shaderModuleService.getModule("copy-pass")}}]),r}(cs))||hS),pS,dS;function A$(e){var t=S$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function S$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var T$=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,w$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,M$=(pS=xr(),pS(dS=function(e){Ut(r,e);var t=A$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:w$,fs:T$});var i=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=i.vs,o=i.fs,u=i.uniforms,s=this.rendererService.getViewportSize(),l=s.width,f=s.height;return{vs:a,fs:o,uniforms:be(be({},u),{},{u_ViewportSize:[l,f]})}}}]),r}(cs))||dS),vS,gS;function R$(e){var t=O$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function O$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var L$=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,F$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,I$=(vS=xr(),vS(gS=function(e){Ut(r,e);var t=R$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:F$,fs:L$});var i=this.shaderModuleService.getModule("ink-pass"),a=i.vs,o=i.fs,u=i.uniforms,s=this.rendererService.getViewportSize(),l=s.width,f=s.height;return{vs:a,fs:o,uniforms:be(be({},u),{},{u_ViewportSize:[l,f]})}}}]),r}(cs))||gS),mS,yS;function k$(e){var t=P$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function P$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var D$=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,B$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,N$=(mS=xr(),mS(yS=function(e){Ut(r,e);var t=k$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:B$,fs:D$}),this.shaderModuleService.getModule("noise-pass")}}]),r}(cs))||yS),_S,xS;function U$(e){var t=z$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function z$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,G$=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,H$=(_S=xr(),_S(xS=function(e){Ut(r,e);var t=U$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:$$,fs:G$}),this.shaderModuleService.getModule("sepia-pass")}}]),r}(cs))||xS),ES,bS,CS,AS,th,SS,V$=(ES=xr(),bS=kr(Oe.IRendererService),CS=q9(),ES(AS=(th=function(){function e(){ke(this,e),Mr(this,"rendererService",SS,this),T(this,"passes",[]),T(this,"readFBO",void 0),T(this,"writeFBO",void 0)}return Pe(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var r=this.rendererService,n=r.getViewportSize,i=r.createTexture2D,a=n(),o=a.width,u=a.height;return i({x:0,y:0,width:o,height:u,copy:!0})}},{key:"getReadFBOTex",value:function(){var r=this,n=this.rendererService.useFramebuffer;return new Promise(function(i){n(r.readFBO,Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:i(r.getCurrentFBOTex());case 1:case"end":return u.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var t=Ie(H.mark(function n(i,a){var o,u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.getReadFBOTex();case 2:o=l.sent,u=0;case 4:if(!(u<4)){l.next=11;break}return l.next=7,a.render(i,o);case 7:this.swap(),u++,l.next=4;break;case 11:case"end":return l.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"render",value:function(){var t=Ie(H.mark(function n(i){var a,o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=0;case 1:if(!(a<this.passes.length)){s.next=15;break}if(o=this.passes[a],o.setRenderToScreen(this.isLastEnabledPass(a)),o.getName()!=="bloom"){s.next=9;break}return s.next=7,this.renderBloomPass(i,o);case 7:s.next=12;break;case 9:return s.next=11,o.render(i);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,s.next=1;break;case 15:case"end":return s.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"resize",value:function(r,n){this.readFBO.resize({width:r,height:n}),this.writeFBO.resize({width:r,height:n})}},{key:"add",value:function(r,n,i){r.init(n,i),this.passes.push(r)}},{key:"insert",value:function(r,n,i,a){r.init(i,a),this.passes.splice(n,0,r)}},{key:"getPostProcessingPassByName",value:function(r){return this.passes.find(function(n){return n.getName()===r})}},{key:"init",value:function(){var r=this.rendererService,n=r.createFramebuffer,i=r.createTexture2D;this.readFBO=n({color:i({width:1,height:1,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})}),this.writeFBO=n({color:i({width:1,height:1,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(r){for(var n=r+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var r=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=r}}]),e}(),SS=wr(th.prototype,"rendererService",[bS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wr(th.prototype,"init",[CS],Object.getOwnPropertyDescriptor(th.prototype,"init"),th.prototype),th))||AS),TS,wS;function j$(e){var t=W$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function W$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var X$=(TS=xr(),TS(wS=function(e){Ut(r,e);var t=j$(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getType",value:function(){return El.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(i,a){gl(Ce(r.prototype),"init",this).call(this,i,a)}},{key:"render",value:function(i){var a=this.rendererService,o=a.useFramebuffer,u=a.clear,s=i.multiPassRenderer.getPostProcessor().getReadFBO();o(s,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:s}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(function(l){l.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}]),r}(Tm))||wS),MS,RS,OS,S_,LS;function Y$(e){var t=Z$();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Z$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q$=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,FS=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,K$=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function IS(e,t){for(var r=0,n=1/t,i=e;i>0;)r=r+n*(i%t),i=Math.floor(i/t),n=n/t;return r}var Q$=1,J$=(MS=xr(),RS=kr(Oe.IShaderModuleService),MS(OS=(S_=function(e){Ut(r,e);var t=Y$(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Mr(re(n),"shaderModuleService",LS,re(n)),T(re(n),"haltonSequence",[]),T(re(n),"accumulatingId",0),T(re(n),"frame",0),T(re(n),"timer",void 0),T(re(n),"sampleRenderTarget",void 0),T(re(n),"prevRenderTarget",void 0),T(re(n),"outputRenderTarget",void 0),T(re(n),"copyRenderTarget",void 0),T(re(n),"blendModel",void 0),T(re(n),"outputModel",void 0),T(re(n),"copyModel",void 0),n}return Pe(r,[{key:"getType",value:function(){return El.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(i,a){gl(Ce(r.prototype),"init",this).call(this,i,a);var o=this.rendererService,u=o.createFramebuffer,s=o.createTexture2D;this.sampleRenderTarget=u({color:s({width:1,height:1,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})}),this.prevRenderTarget=u({color:s({width:1,height:1,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})}),this.outputRenderTarget=u({color:s({width:1,height:1,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})}),this.copyRenderTarget=u({color:s({width:1,height:1,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE})});for(var l=0;l<30;l++)this.haltonSequence.push([IS(l,2),IS(l,3)]);this.blendModel=this.createTriangleModel("blend-pass",q$),this.outputModel=this.createTriangleModel("copy-pass",FS,{blend:{enable:!0,func:{srcRGB:w.ONE,dstRGB:w.ONE_MINUS_SRC_ALPHA,srcAlpha:w.ONE,dstAlpha:w.ONE_MINUS_SRC_ALPHA},equation:{rgb:w.FUNC_ADD,alpha:w.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",FS)}},{key:"render",value:function(i){var a=this,o=this.rendererService,u=o.clear,s=o.getViewportSize,l=o.useFramebuffer,f=s(),h=f.width,d=f.height;this.sampleRenderTarget.resize({width:h,height:d}),this.prevRenderTarget.resize({width:h,height:d}),this.outputRenderTarget.resize({width:h,height:d}),this.copyRenderTarget.resize({width:h,height:d}),this.resetFrame(),this.stopAccumulating();var v=i.multiPassRenderer.getPostProcessor().getReadFBO();l(v,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:v}),i.multiPassRenderer.setRenderFlag(!1),i.render(),i.multiPassRenderer.setRenderFlag(!0)});var m=function y(_){!a.accumulatingId||_!==a.accumulatingId||a.isFinished()||(a.doRender(i),en.requestAnimationFrame(function(){y(_)}))};this.accumulatingId=Q$++,this.timer=en.setTimeout(function(){m(a.accumulatingId)},50)}},{key:"doRender",value:function(i){var a=this,o=this.rendererService,u=o.clear,s=o.getViewportSize,l=o.useFramebuffer,f=s(),h=f.width,d=f.height,v=i.getLayerConfig(),m=v.jitterScale,y=m===void 0?1:m,_=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((_[0]*2-1)/h*y,(_[1]*2-1)/d*y),i.multiPassRenderer.setRenderFlag(!1),i.hooks.beforeRender.call(),l(this.sampleRenderTarget,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),i.render()}),i.hooks.afterRender.call(),i.multiPassRenderer.setRenderFlag(!0);var E=i.getLayerConfig();l(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:E.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?i.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(l(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),l(i.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),i.multiPassRenderer.getPostProcessor().render(i));var S=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=S,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,en.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(i,a,o){this.shaderModuleService.registerModule(i,{vs:K$,fs:a});var u=this.shaderModuleService.getModule(i),s=u.vs,l=u.fs,f=u.uniforms,h=this.rendererService,d=h.createAttribute,v=h.createBuffer,m=h.createModel;return m(be({vs:s,fs:l,attributes:{a_Position:d({buffer:v({data:[-4,-4,4,-4,0,4],type:w.FLOAT}),size:2})},uniforms:be({},f),depth:{enable:!1},count:3},o))}}]),r}(Tm),LS=wr(S_.prototype,"shaderModuleService",[RS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S_))||OS),wi=new cE;wi.bind(Oe.IGlobalConfigService).to(PU).inSingletonScope();M9(xr(),Pa.exports.EventEmitter);wi.bind(Oe.IEventEmitter).to(Pa.exports.EventEmitter);var eG=tU(wi,!1),gE=function(t){var r=eG.lazyInject(t);return function(n,i,a){r.call(this,n,i),a&&(a.initializer=function(){return n[i]})}},tG=0;function rG(){var e=new cE;return e.parent=wi,e.bind(Oe.SceneID).toConstantValue("".concat(tG++)),e.bind(Oe.IShaderModuleService).to($z).inSingletonScope(),e.bind(Oe.ILayerService).to(QU).inSingletonScope(),e.bind(Oe.ISceneService).to(bz).inSingletonScope(),e.bind(Oe.ICameraService).to(SU).inSingletonScope(),e.bind(Oe.ICoordinateSystemService).to(NU).inSingletonScope(),e.bind(Oe.IInteractionService).to(GU).inSingletonScope(),e.bind(Oe.IPickingService).to(WU).inSingletonScope(),e.bind(Oe.IControlService).to(RU).inSingletonScope(),e.bind(Oe.IMarkerService).to(OU).inSingletonScope(),e.bind(Oe.IIconService).to(AU).inSingletonScope(),e.bind(Oe.IFontService).to(xU).inSingletonScope(),e.bind(Oe.IPopupService).to(LU).inSingletonScope(),e.bind(Oe.INormalPass).to(jz).whenTargetNamed("clear"),e.bind(Oe.INormalPass).to(Kz).whenTargetNamed("pixelPicking"),e.bind(Oe.INormalPass).to(X$).whenTargetNamed("render"),e.bind(Oe.INormalPass).to(J$).whenTargetNamed("taa"),e.bind(Oe.IFactoryNormalPass).toFactory(function(t){return function(r){return t.container.getNamed(Oe.INormalPass,r)}}),e.bind(Oe.IPostProcessingPass).to(C$).whenTargetNamed("copy"),e.bind(Oe.IPostProcessingPass).to(n$).whenTargetNamed("bloom"),e.bind(Oe.IPostProcessingPass).to(s$).whenTargetNamed("blurH"),e.bind(Oe.IPostProcessingPass).to(p$).whenTargetNamed("blurV"),e.bind(Oe.IPostProcessingPass).to(N$).whenTargetNamed("noise"),e.bind(Oe.IPostProcessingPass).to(H$).whenTargetNamed("sepia"),e.bind(Oe.IPostProcessingPass).to(y$).whenTargetNamed("colorHalftone"),e.bind(Oe.IPostProcessingPass).to(M$).whenTargetNamed("hexagonalPixelate"),e.bind(Oe.IPostProcessingPass).to(I$).whenTargetNamed("ink"),e.bind(Oe.IFactoryPostProcessingPass).toFactory(function(t){return function(r){var n=t.container.getNamed(Oe.IPostProcessingPass,r);return n.setName(r),n}}),e}function Dg(e){var t=new cE;return t.parent=e,t.bind(Oe.IStyleAttributeService).to(az).inSingletonScope(),t.bind(Oe.IMultiPassRenderer).to(Yz).inSingletonScope(),t.bind(Oe.IPostProcessor).to(V$).inSingletonScope(),t}var Fo;(function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"})(Fo||(Fo={}));var Jr;(function(e){e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging"})(Jr||(Jr={}));var sl;(function(e){e.CONSTANT="constant",e.VARIABLE="variable"})(sl||(sl={}));var Ft;(function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"})(Ft||(Ft={}));var rs;(function(e){e.IMAGE="image",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb"})(rs||(rs={}));var kS=["mapload","mapchange","mapAfterFrameChange"],xc={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},Zv=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];function nG(e,t){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(r){return Ld(r,t)}):e.map(function(r){return{url:Ld(r.url,t),bands:r.bands||[0]}}):Ld(e,t)}function iG(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(t){return{url:t,bands:[0]}}):e}function PS(e,t){e.xhrCancel=function(){t.map(function(r){r.abort()})}}var aG=function(){var e=Ie(H.mark(function t(r,n,i,a,o){var u,s,l,f,h,d;return H.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(u=iG(n.url),!(u.length>1)){m.next=15;break}return m.next=4,oG(u,n);case 4:if(s=m.sent,l=s.rasterFiles,f=s.xhrList,h=s.errList,PS(r,f),!(h.length>0)){m.next=12;break}return i(h,null),m.abrupt("return");case 12:Vb(l,a,o,i),m.next=17;break;case 15:d=Wx(n,function(y,_){if(y)i(y);else if(_){var E=[{data:_,bands:u[0].bands}];Vb(E,a,o,i)}}),PS(r,[d]);case 17:case"end":return m.stop()}},t)}));return function(r,n,i,a,o){return e.apply(this,arguments)}}();function oG(e,t){return q1.apply(this,arguments)}function q1(){return q1=Ie(H.mark(function e(t,r){var n,i,a,o,u,s,l,f,h,d,v;return H.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:n=[],i=[],a=[],o=0;case 4:if(!(o<t.length)){y.next=20;break}return u=t[o],s=be(be({},r),{},{url:u.url}),l=u.bands,y.next=10,Dk(be(be({},s),{},{type:"arrayBuffer"}));case 10:f=y.sent,h=f.err,d=f.data,v=f.xhr,h&&a.push(h),i.push(v),n.push({data:d,bands:l});case 17:o++,y.next=4;break;case 20:return y.abrupt("return",{rasterFiles:n,xhrList:i,errList:a});case 21:case"end":return y.stop()}},e)})),q1.apply(this,arguments)}var uG=function(){var e=Ie(H.mark(function t(r,n,i,a,o){var u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u={url:nG(r,n)},l.abrupt("return",new Promise(function(f,h){aG(i,u,function(d,v){d?h(d):v&&f(v)},a,o)}));case 2:case"end":return l.stop()}},t)}));return function(r,n,i,a,o){return e.apply(this,arguments)}}(),DS=function(){var e=Ie(H.mark(function t(r,n,i,a){var o,u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u=Array.isArray(r)?r[0]:r,a.wmtsOptions?o=_B(u,be(be({},n),a.wmtsOptions)):o=Ld(Array.isArray(r)?r[0]:r,n),l.abrupt("return",new Promise(function(f,h){var d=m1({url:o},function(v,m){v?h(v):m&&f(m)});i.xhrCancel=function(){return d.abort()}}));case 3:case"end":return l.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}(),sG=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},lG={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0};rs.ARRAYBUFFER,rs.RGB;function cG(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function fG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(cG(e))throw new Error("tile server url is error");var r=(t==null?void 0:t.dataType)||rs.IMAGE;r===rs.RGB&&(r=rs.ARRAYBUFFER);var n=function(o,u){switch(r){case rs.IMAGE:return DS(e,o,u,t);case rs.ARRAYBUFFER:return uG(e,o,u,(t==null?void 0:t.format)||sG,t==null?void 0:t.operation);default:return DS(e,o,u,t)}},i=be(be(be({},lG),t),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:i,isTile:!0}}var hG={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},pG=function(){var e=Ie(H.mark(function t(r){return H.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(function(a){var o=ir(r.bounds,4),u=o[0],s=o[1],l=o[2],f=o[3],h={layers:{testTile:{features:[{type:"Feature",properties:{key:r.x+"/"+r.y+"/"+r.z,textLng:(u+l)/2,textLat:(s+f)/2},geometry:{type:"LineString",coordinates:[[l,f],[l,s],[u,s],[u,s]]}}]}}};a(h)}));case 1:case"end":return i.stop()}},t)}));return function(r){return e.apply(this,arguments)}}();function dG(e,t){var r=function(a){return pG(a)},n=be(be(be({},hG),t),{},{getTileData:r});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var vM={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(du,function(){function r(X,$,K,ue,de,pe){if(!(de-ue<=K)){var le=ue+de>>1;n(X,$,le,ue,de,pe%2),r(X,$,K,ue,le-1,pe+1),r(X,$,K,le+1,de,pe+1)}}function n(X,$,K,ue,de,pe){for(;de>ue;){if(de-ue>600){var le=de-ue+1,ve=K-ue+1,Me=Math.log(le),Ne=.5*Math.exp(2*Me/3),Xe=.5*Math.sqrt(Me*Ne*(le-Ne)/le)*(ve-le/2<0?-1:1),ct=Math.max(ue,Math.floor(K-ve*Ne/le+Xe)),$t=Math.min(de,Math.floor(K+(le-ve)*Ne/le+Xe));n(X,$,K,ct,$t,pe)}var Qt=$[2*K+pe],Zt=ue,jt=de;for(i(X,$,ue,K),$[2*de+pe]>Qt&&i(X,$,ue,de);Zt<jt;){for(i(X,$,Zt,jt),Zt++,jt--;$[2*Zt+pe]<Qt;)Zt++;for(;$[2*jt+pe]>Qt;)jt--}$[2*ue+pe]===Qt?i(X,$,ue,jt):(jt++,i(X,$,jt,de)),jt<=K&&(ue=jt+1),K<=jt&&(de=jt-1)}}function i(X,$,K,ue){a(X,K,ue),a($,2*K,2*ue),a($,2*K+1,2*ue+1)}function a(X,$,K){var ue=X[$];X[$]=X[K],X[K]=ue}function o(X,$,K,ue,de,pe,le){for(var ve=[0,X.length-1,0],Me=[],Ne,Xe;ve.length;){var ct=ve.pop(),$t=ve.pop(),Qt=ve.pop();if($t-Qt<=le){for(var Zt=Qt;Zt<=$t;Zt++)Ne=$[2*Zt],Xe=$[2*Zt+1],Ne>=K&&Ne<=de&&Xe>=ue&&Xe<=pe&&Me.push(X[Zt]);continue}var jt=Math.floor((Qt+$t)/2);Ne=$[2*jt],Xe=$[2*jt+1],Ne>=K&&Ne<=de&&Xe>=ue&&Xe<=pe&&Me.push(X[jt]);var Cr=(ct+1)%2;(ct===0?K<=Ne:ue<=Xe)&&(ve.push(Qt),ve.push(jt-1),ve.push(Cr)),(ct===0?de>=Ne:pe>=Xe)&&(ve.push(jt+1),ve.push($t),ve.push(Cr))}return Me}function u(X,$,K,ue,de,pe){for(var le=[0,X.length-1,0],ve=[],Me=de*de;le.length;){var Ne=le.pop(),Xe=le.pop(),ct=le.pop();if(Xe-ct<=pe){for(var $t=ct;$t<=Xe;$t++)s($[2*$t],$[2*$t+1],K,ue)<=Me&&ve.push(X[$t]);continue}var Qt=Math.floor((ct+Xe)/2),Zt=$[2*Qt],jt=$[2*Qt+1];s(Zt,jt,K,ue)<=Me&&ve.push(X[Qt]);var Cr=(Ne+1)%2;(Ne===0?K-de<=Zt:ue-de<=jt)&&(le.push(ct),le.push(Qt-1),le.push(Cr)),(Ne===0?K+de>=Zt:ue+de>=jt)&&(le.push(Qt+1),le.push(Xe),le.push(Cr))}return ve}function s(X,$,K,ue){var de=X-K,pe=$-ue;return de*de+pe*pe}var l=function(X){return X[0]},f=function(X){return X[1]},h=function($,K,ue,de,pe){K===void 0&&(K=l),ue===void 0&&(ue=f),de===void 0&&(de=64),pe===void 0&&(pe=Float64Array),this.nodeSize=de,this.points=$;for(var le=$.length<65536?Uint16Array:Uint32Array,ve=this.ids=new le($.length),Me=this.coords=new pe($.length*2),Ne=0;Ne<$.length;Ne++)ve[Ne]=Ne,Me[2*Ne]=K($[Ne]),Me[2*Ne+1]=ue($[Ne]);r(ve,Me,de,0,ve.length-1,0)};h.prototype.range=function($,K,ue,de){return o(this.ids,this.coords,$,K,ue,de,this.nodeSize)},h.prototype.within=function($,K,ue){return u(this.ids,this.coords,$,K,ue,this.nodeSize)};var d={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(X){return X}},v=Math.fround||function(X){return function($){return X[0]=+$,X[0]}}(new Float32Array(1)),m=function($){this.options=q(Object.create(d),$),this.trees=new Array(this.options.maxZoom+1)};m.prototype.load=function($){var K=this.options,ue=K.log,de=K.minZoom,pe=K.maxZoom,le=K.nodeSize;ue&&console.time("total time");var ve="prepare "+$.length+" points";ue&&console.time(ve),this.points=$;for(var Me=[],Ne=0;Ne<$.length;Ne++)!$[Ne].geometry||Me.push(_($[Ne],Ne));this.trees[pe+1]=new h(Me,Y,ne,le,Float32Array),ue&&console.timeEnd(ve);for(var Xe=pe;Xe>=de;Xe--){var ct=+Date.now();Me=this._cluster(Me,Xe),this.trees[Xe]=new h(Me,Y,ne,le,Float32Array),ue&&console.log("z%d: %d clusters in %dms",Xe,Me.length,+Date.now()-ct)}return ue&&console.timeEnd("total time"),this},m.prototype.getClusters=function($,K){var ue=(($[0]+180)%360+360)%360-180,de=Math.max(-90,Math.min(90,$[1])),pe=$[2]===180?180:(($[2]+180)%360+360)%360-180,le=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)ue=-180,pe=180;else if(ue>pe){var ve=this.getClusters([ue,de,180,le],K),Me=this.getClusters([-180,de,pe,le],K);return ve.concat(Me)}for(var Ne=this.trees[this._limitZoom(K)],Xe=Ne.range(A(ue),M(le),A(pe),M(de)),ct=[],$t=0,Qt=Xe;$t<Qt.length;$t+=1){var Zt=Qt[$t],jt=Ne.points[Zt];ct.push(jt.numPoints?E(jt):this.points[jt.index])}return ct},m.prototype.getChildren=function($){var K=this._getOriginId($),ue=this._getOriginZoom($),de="No cluster with the specified id.",pe=this.trees[ue];if(!pe)throw new Error(de);var le=pe.points[K];if(!le)throw new Error(de);for(var ve=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),Me=pe.within(le.x,le.y,ve),Ne=[],Xe=0,ct=Me;Xe<ct.length;Xe+=1){var $t=ct[Xe],Qt=pe.points[$t];Qt.parentId===$&&Ne.push(Qt.numPoints?E(Qt):this.points[Qt.index])}if(Ne.length===0)throw new Error(de);return Ne},m.prototype.getLeaves=function($,K,ue){K=K||10,ue=ue||0;var de=[];return this._appendLeaves(de,$,K,ue,0),de},m.prototype.getTile=function($,K,ue){var de=this.trees[this._limitZoom($)],pe=Math.pow(2,$),le=this.options,ve=le.extent,Me=le.radius,Ne=Me/ve,Xe=(ue-Ne)/pe,ct=(ue+1+Ne)/pe,$t={features:[]};return this._addTileFeatures(de.range((K-Ne)/pe,Xe,(K+1+Ne)/pe,ct),de.points,K,ue,pe,$t),K===0&&this._addTileFeatures(de.range(1-Ne/pe,Xe,1,ct),de.points,pe,ue,pe,$t),K===pe-1&&this._addTileFeatures(de.range(0,Xe,Ne/pe,ct),de.points,-1,ue,pe,$t),$t.features.length?$t:null},m.prototype.getClusterExpansionZoom=function($){for(var K=this._getOriginZoom($)-1;K<=this.options.maxZoom;){var ue=this.getChildren($);if(K++,ue.length!==1)break;$=ue[0].properties.cluster_id}return K},m.prototype._appendLeaves=function($,K,ue,de,pe){for(var le=this.getChildren(K),ve=0,Me=le;ve<Me.length;ve+=1){var Ne=Me[ve],Xe=Ne.properties;if(Xe&&Xe.cluster?pe+Xe.point_count<=de?pe+=Xe.point_count:pe=this._appendLeaves($,Xe.cluster_id,ue,de,pe):pe<de?pe++:$.push(Ne),$.length===ue)break}return pe},m.prototype._addTileFeatures=function($,K,ue,de,pe,le){for(var ve=0,Me=$;ve<Me.length;ve+=1){var Ne=Me[ve],Xe=K[Ne],ct=Xe.numPoints,$t=void 0,Qt=void 0,Zt=void 0;if(ct)$t=S(Xe),Qt=Xe.x,Zt=Xe.y;else{var jt=this.points[Xe.index];$t=jt.properties,Qt=A(jt.geometry.coordinates[0]),Zt=M(jt.geometry.coordinates[1])}var Cr={type:1,geometry:[[Math.round(this.options.extent*(Qt*pe-ue)),Math.round(this.options.extent*(Zt*pe-de))]],tags:$t},gn=void 0;ct?gn=Xe.id:this.options.generateId?gn=Xe.index:this.points[Xe.index].id&&(gn=this.points[Xe.index].id),gn!==void 0&&(Cr.id=gn),le.features.push(Cr)}},m.prototype._limitZoom=function($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))},m.prototype._cluster=function($,K){for(var ue=[],de=this.options,pe=de.radius,le=de.extent,ve=de.reduce,Me=de.minPoints,Ne=pe/(le*Math.pow(2,K)),Xe=0;Xe<$.length;Xe++){var ct=$[Xe];if(!(ct.zoom<=K)){ct.zoom=K;for(var $t=this.trees[K+1],Qt=$t.within(ct.x,ct.y,Ne),Zt=ct.numPoints||1,jt=Zt,Cr=0,gn=Qt;Cr<gn.length;Cr+=1){var ii=gn[Cr],Mt=$t.points[ii];Mt.zoom>K&&(jt+=Mt.numPoints||1)}if(jt>Zt&&jt>=Me){for(var qt=ct.x*Zt,ar=ct.y*Zt,k=ve&&Zt>1?this._map(ct,!0):null,ae=(Xe<<5)+(K+1)+this.points.length,_e=0,Ge=Qt;_e<Ge.length;_e+=1){var je=Ge[_e],Qe=$t.points[je];if(!(Qe.zoom<=K)){Qe.zoom=K;var Ot=Qe.numPoints||1;qt+=Qe.x*Ot,ar+=Qe.y*Ot,Qe.parentId=ae,ve&&(k||(k=this._map(ct,!0)),ve(k,this._map(Qe)))}}ct.parentId=ae,ue.push(y(qt/jt,ar/jt,ae,jt,k))}else if(ue.push(ct),jt>1)for(var Je=0,yt=Qt;Je<yt.length;Je+=1){var et=yt[Je],Wt=$t.points[et];Wt.zoom<=K||(Wt.zoom=K,ue.push(Wt))}}}return ue},m.prototype._getOriginId=function($){return $-this.points.length>>5},m.prototype._getOriginZoom=function($){return($-this.points.length)%32},m.prototype._map=function($,K){if($.numPoints)return K?q({},$.properties):$.properties;var ue=this.points[$.index].properties,de=this.options.map(ue);return K&&de===ue?q({},de):de};function y(X,$,K,ue,de){return{x:v(X),y:v($),zoom:1/0,id:K,parentId:-1,numPoints:ue,properties:de}}function _(X,$){var K=X.geometry.coordinates,ue=K[0],de=K[1];return{x:v(A(ue)),y:v(M(de)),zoom:1/0,index:$,parentId:-1}}function E(X){return{type:"Feature",id:X.id,properties:S(X),geometry:{type:"Point",coordinates:[O(X.x),j(X.y)]}}}function S(X){var $=X.numPoints,K=$>=1e4?Math.round($/1e3)+"k":$>=1e3?Math.round($/100)/10+"k":$;return q(q({},X.properties),{cluster:!0,cluster_id:X.id,point_count:$,point_count_abbreviated:K})}function A(X){return X/360+.5}function M(X){var $=Math.sin(X*Math.PI/180),K=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return K<0?0:K>1?1:K}function O(X){return(X-.5)*360}function j(X){var $=(180-X*360)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function q(X,$){for(var K in $)X[K]=$[K];return X}function Y(X){return X.x}function ne(X){return X.y}return m})})(vM);const vG=vM.exports;function gM(e,t){var r=t.radius,n=r===void 0?40:r,i=t.maxZoom,a=i===void 0?18:i,o=t.minZoom,u=o===void 0?0:o,s=t.zoom,l=s===void 0?2:s;if(e.pointIndex){var f=e.pointIndex.getClusters(e.extent,Math.floor(l));return e.dataArray=gG(f),e}var h=new vG({radius:n,minZoom:u,maxZoom:a}),d={type:"FeatureCollection",features:[]};return d.features=e.dataArray.map(function(v){return{type:"Feature",geometry:{type:"Point",coordinates:v.coordinates},properties:be({},v)}}),h.load(d.features),h}function gG(e){return e.map(function(t,r){return be({coordinates:t.geometry.coordinates,_id:r+1},t.properties)})}function mG(e){if(e.length===0)throw new Error("max requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t}function yG(e){if(e.length===0)throw new Error("min requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t}function mM(e){if(e.length===0)return 0;for(var t=e[0],r=0,n,i=1;i<e.length;i++)n=t+e[i]*1,Math.abs(t)>=Math.abs(e[i])?r+=t-n+e[i]:r+=e[i]-n+t,t=n;return t+r*1}function _G(e){if(e.length===0)throw new Error("mean requires at least one data point");return mM(e)/e.length}var xG={min:yG,max:mG,mean:_G,sum:mM};function EG(e){var t=bG();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function bG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CG(e,t){if(Array.isArray(t))return t}var mE=function(e){Ut(r,e);var t=EG(r);function r(n,i){var a;return ke(this,r),a=t.call(this),T(re(a),"type","source"),T(re(a),"isTile",!1),T(re(a),"inited",!1),T(re(a),"hooks",{init:new lu}),T(re(a),"parser",{type:"geojson"}),T(re(a),"transforms",[]),T(re(a),"cluster",!1),T(re(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),T(re(a),"invalidExtent",!1),T(re(a),"dataArrayChanged",!1),T(re(a),"cfg",{autoRender:!0}),a.originData=n,a.initCfg(i),a.init().then(function(){a.inited=!0,a.emit("update",{type:"inited"})}),a}return Pe(r,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(i){return this.clusterIndex.getClusters(this.caculClusterExtent(2),i)}},{key:"getClustersLeaves",value:function(i){return this.clusterIndex.getLeaves(i,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(i){var a=this,o=this.clusterOptions,u=o.method,s=u===void 0?"sum":u,l=o.field,f=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(i));this.clusterOptions.zoom=i,f.forEach(function(h){h.id||(h.properties.point_count=1)}),(l||tt.exports.isFunction(s))&&(f=f.map(function(h){var d=h.id;if(d){var v=a.clusterIndex.getLeaves(d,1/0),m=v.map(function(E){return E.properties}),y;if(tt.exports.isString(s)&&l){var _=GN(m,l);y=xG[s](_)}tt.exports.isFunction(s)&&(y=s(m)),h.properties.stat=y}else h.properties.point_count=1;return h})),this.data=Z2("geojson")({type:"FeatureCollection",features:f}),this.executeTrans()}},{key:"getFeatureById",value:function(i){var a=this.parser,o=a.type,u=o===void 0?"geojson":o,s=a.geometry;if(u==="geojson"&&!this.cluster){var l=i<this.originData.features.length?this.originData.features[i]:"null",f=tt.exports.cloneDeep(l);if(f!=null&&f.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var h=this.data.dataArray.find(function(d){return d._id===i});f.properties=h}return f}else return u==="json"&&s?this.data.dataArray.find(function(d){return d._id===i}):i<this.data.dataArray.length?this.data.dataArray[i]:"null"}},{key:"updateFeaturePropertiesById",value:function(i,a){this.data.dataArray=this.data.dataArray.map(function(o){return o._id===i?be(be({},o),a):o}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(i,a){var o=this.data.dataArray.find(function(u){return u[i]===a});return o==null?void 0:o._id}},{key:"setData",value:function(i,a){var o=this;this.originData=i,this.dataArrayChanged=!1,this.initCfg(a),this.init().then(function(){o.emit("update",{type:"update"})})}},{key:"destroy",value:function(){var i;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(i=this.tileset)===null||i===void 0||i.destroy()}},{key:"processData",value:function(){var n=Ie(H.mark(function a(){var o=this;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise(function(l,f){try{o.excuteParser(),o.initCluster(),o.executeTrans(),l({})}catch(h){f(h)}});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},a)}));function i(){return n.apply(this,arguments)}return i}()},{key:"initCfg",value:function(i){this.cfg=tt.exports.mergeWith(this.cfg,i,CG);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=be(be({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.inited=!1,u.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"excuteParser",value:function(){var i=this.parser,a=i.type||"geojson",o=Z2(a);this.data=o(this.originData,i),this.tileset=this.initTileset(),!i.cancelExtent&&(this.extent=$k(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(i){this.center=[(i[0]+i[2])/2,(i[1]+i[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var i=this.data.tilesetOptions;if(!!i){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(i),this.tileset;var a=new RB(be({},i));return a}}},{key:"executeTrans",value:function(){var i=this,a=this.transforms;a.forEach(function(o){var u=o.type,s=tI(u)(i.data,o);Object.assign(i.data,s)})}},{key:"initCluster",value:function(){if(!!this.cluster){var i=this.clusterOptions||{};this.clusterIndex=gM(this.data,i)}}},{key:"caculClusterExtent",value:function(i){var a=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(a=pm(Mg(this.extent),i)),a[0].concat(a[1])}}]),r}(Pa.exports.EventEmitter);function AG(e,t){var r=t.callback;return r&&(e.dataArray=e.dataArray.filter(r)),e}function BS(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=SG(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function SG(e,t){if(!!e){if(typeof e=="string")return NS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NS(e,t)}}function NS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yE=6378e3;function TG(e,t){var r=e.dataArray,n=t.size,i=n===void 0?10:n,a=i/(2*Math.PI*yE)*(256<<20)/2,o=wG(r,i),u=o.gridHash,s=o.gridOffset,l=LG(u,s,t);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:l}}function wG(e,t){var r=1/0,n=-1/0,i,a=BS(e),o;try{for(a.s();!(o=a.n()).done;){var u=o.value;i=u.coordinates[1],Number.isFinite(i)&&(r=i<r?i:r,n=i>n?i:n)}}catch(A){a.e(A)}finally{a.f()}var s=(r+n)/2,l=MG(t,s);if(l.xOffset<=0||l.yOffset<=0)return{gridHash:{},gridOffset:l};var f={},h=BS(e),d;try{for(h.s();!(d=h.n()).done;){var v=d.value,m=v.coordinates[1],y=v.coordinates[0];if(Number.isFinite(m)&&Number.isFinite(y)){var _=Math.floor((m+90)/l.yOffset),E=Math.floor((y+180)/l.xOffset),S="".concat(_,"-").concat(E);f[S]=f[S]||{count:0,points:[]},f[S].count+=1,f[S].points.push(v)}}}catch(A){h.e(A)}finally{h.f()}return{gridHash:f,gridOffset:l}}function MG(e,t){var r=RG(e),n=OG(t,e);return{yOffset:r,xOffset:n}}function RG(e){return e/yE*(180/Math.PI)}function OG(e,t){return t/yE*(180/Math.PI)/Math.cos(e*Math.PI/180)}function LG(e,t,r){return Object.keys(e).reduce(function(n,i,a){var o=i.split("-"),u=parseInt(o[0],10),s=parseInt(o[1],10),l={};if(r.field&&r.method){var f=q4(e[i].points,r.field);l[r.method]=Z4[r.method](f)}return Object.assign(l,{_id:a,coordinates:ci([-180+t.xOffset*(s+.5),-90+t.yOffset*(u+.5)]),rawData:e[i].points,count:e[i].count}),n.push(l),n},[])}var sh=Math.PI/3,FG=[0,sh,2*sh,3*sh,4*sh,5*sh];function IG(e){return e[0]}function kG(e){return e[1]}function PG(){var e=0,t=0,r=1,n=1,i=IG,a=kG,o,u,s;function l(h){var d={},v=[],m,y=h.length;for(m=0;m<y;++m)if(!(isNaN(E=+i.call(null,_=h[m],m,h))||isNaN(S=+a.call(null,_,m,h)))){var _,E,S,A=Math.round(S=S/s),M=Math.round(E=E/u-(A&1)/2),O=S-A;if(Math.abs(O)*3>1){var j=E-M,q=M+(E<M?-1:1)/2,Y=A+(S<A?-1:1),ne=E-q,X=S-Y;j*j+O*O>ne*ne+X*X&&(M=q+(A&1?1:-1)/2,A=Y)}var $=M+"-"+A,K=d[$];K?K.push(_):(v.push(K=d[$]=[_]),K.x=(M+(A&1)/2)*u,K.y=A*s)}return v}function f(h){var d=0,v=0;return FG.map(function(m){var y=Math.sin(m)*h,_=-Math.cos(m)*h,E=y-d,S=_-v;return d=y,v=_,[E,S]})}return l.hexagon=function(h){return"m"+f(h==null?o:+h).join("l")+"z"},l.centers=function(){for(var h=[],d=Math.round(t/s),v=Math.round(e/u),m=d*s;m<n+o;m+=s,++d)for(var y=v*u+(d&1)*u/2;y<r+u/2;y+=u)h.push([y,m]);return h},l.mesh=function(){var h=f(o).slice(0,4).join("l");return l.centers().map(function(d){return"M"+d+"m"+h}).join("")},l.x=function(h){return arguments.length?(i=h,l):i},l.y=function(h){return arguments.length?(a=h,l):a},l.radius=function(h){return arguments.length?(o=+h,u=o*2*Math.sin(sh),s=o*1.5,l):o},l.size=function(h){return arguments.length?(e=t=0,r=+h[0],n=+h[1],l):[r-e,n-t]},l.extent=function(h){return arguments.length?(e=+h[0][0],t=+h[0][1],r=+h[1][0],n=+h[1][1],l):[[e,t],[r,n]]},l.radius(1)}var DG=6378e3;function BG(e,t){var r=e.dataArray,n=t.size,i=n===void 0?10:n,a=t.method,o=a===void 0?"sum":a,u=i/(2*Math.PI*DG)*(256<<20)/2,s=r.map(function(d){var v=ci(d.coordinates),m=ir(v,2),y=m[0],_=m[1];return be(be({},d),{},{coordinates:[y,_]})}),l=PG().radius(u).x(function(d){return d.coordinates[0]}).y(function(d){return d.coordinates[1]}),f=l(s),h={dataArray:f.map(function(d,v){var m;if(t.field&&o){var y=q4(d,t.field);d[o]=Z4[o](y)}return m={},T(m,t.method,d[o]),T(m,"count",d.length),T(m,"rawData",d),T(m,"coordinates",[d.x,d.y]),T(m,"_id",v),m}),radius:u,xOffset:u,yOffset:u,type:"hexagon"};return h}function NG(e,t){var r=t.sourceField,n=t.targetField,i=t.data,a={};return i.forEach(function(o){a[o[r]]=o}),e.dataArray=e.dataArray.map(function(o){var u=o[n];return be(be({},o),a[u])}),e}function UG(e,t){var r=t.callback;return r&&(e.dataArray=e.dataArray.map(r)),e}bu("rasterTile",fG);bu("mvt",dN);bu("geojsonvt",PN);bu("testTile",dG);bu("geojson",EI);bu("image",U5);bu("csv",yI);bu("json",F4);bu("raster",HN);bu("rasterRgb",WN);Gh("cluster",gM);Gh("filter",AG);Gh("join",NG);Gh("map",UG);Gh("grid",TG);Gh("hexagon",BG);window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(e){try{let h=function(){u||(u=!0,a())},d=function(){try{o.documentElement.doScroll("left")}catch{return void setTimeout(d,50)}h()};var l=h,f=d,r=(r=document.getElementsByTagName("script"))[r.length-1],t=r.getAttribute("data-injectcss"),r=r.getAttribute("data-disable-injectsvg");if(!r){var n,i,a,o,u,s=function(m,y){y.parentNode.insertBefore(m,y)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(v){console&&console.log(v)}}n=function(){var m,y=document.createElement("div");y.innerHTML=e._iconfont_svg_string_3580659,(y=y.getElementsByTagName("svg")[0])&&(y.setAttribute("aria-hidden","true"),y.style.position="absolute",y.style.width=0,y.style.height=0,y.style.overflow="hidden",y=y,(m=document.body).firstChild?s(y,m.firstChild):m.appendChild(y))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),n()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(a=n,o=e.document,u=!1,d(),o.onreadystatechange=function(){o.readyState=="complete"&&(o.onreadystatechange=null,h())})}}catch{}}(window);function zG(e){var t=$G();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function $G(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var yM=function(e){Ut(r,e);var t=zG(r);function r(n){var i;return ke(this,r),i=t.call(this),r.controlCount++,i.controlOption=be(be({},i.getDefault(n)),n||{}),i}return Pe(r,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(i){var a=this.getDefault(i);Object.entries(i).forEach(function(o){var u=ir(o,2),s=u[0],l=u[1];l===void 0&&(i[s]=a[s])}),"position"in i&&this.setPosition(i.position),"className"in i&&this.setClassName(i.className),"style"in i&&this.setStyle(i.style),this.controlOption=be(be({},this.controlOption),i)}},{key:"addTo",value:function(i){this.mapsService=i.get(Oe.IMapService),this.renderService=i.get(Oe.IRendererService),this.layerService=i.get(Oe.ILayerService),this.controlService=i.get(Oe.IControlService),this.configService=i.get(Oe.IGlobalConfigService),this.scene=i.get(Oe.ISceneService),this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd(),Rd(this.container,"l7-control");var a=this.controlOption,o=a.className,u=a.style;return o&&this.setClassName(o),u&&this.setStyle(u),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;wg(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return ca("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var i=this.container;v1(i,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var i=this.container;Rd(i,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(i){return{position:Lh.TOPRIGHT,name:"".concat(r.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}},{key:"setPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lh.TOPLEFT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=i,a&&a.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(i){var a=this.container,o=this.controlOption.className;o&&v1(a,o),i&&Rd(a,i)}},{key:"setStyle",value:function(i){var a=this.container;i?a.setAttribute("style",i):a.removeAttribute("style")}},{key:"insertContainer",value:function(){var i=this.controlOption.position,a=this.container;if(i instanceof Element)i.appendChild(a);else{var o=this.controlService.controlCorners[i];i.indexOf("bottom")!==-1?o.insertBefore(a,o.firstChild):o.appendChild(a)}}},{key:"checkUpdateOption",value:function(i,a){return a.some(function(o){return o in i})}}]),r}(iE);T(yM,"controlCount",0);function GG(e){var t=HG();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function HG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var VG=function(e){Ut(r,e);var t=GG(r);function r(n,i){var a;return ke(this,r),a=t.call(this),T(re(a),"isShow",!1),T(re(a),"timeout",null),T(re(a),"show",function(){return a.isShow||!a.contentDOM.innerHTML||(a.resetPopperPosition(),v1(a.popperDOM,"l7-popper-hide"),a.isShow=!0,a.option.unique&&r.conflictPopperList.forEach(function(o){o!==re(a)&&o.isShow&&o.hide()}),a.emit("show")),re(a)}),T(re(a),"hide",function(){return a.isShow&&(Rd(a.popperDOM,"l7-popper-hide"),a.isShow=!1,a.emit("hide")),re(a)}),T(re(a),"setHideTimeout",function(){a.timeout||(a.timeout=window.setTimeout(function(){!a.isShow||(a.hide(),a.timeout=null)},300))}),T(re(a),"clearHideTimeout",function(){a.timeout&&(window.clearTimeout(a.timeout),a.timeout=null)}),T(re(a),"onBtnClick",function(){a.isShow?a.hide():a.show()}),T(re(a),"onBtnMouseLeave",function(){a.setHideTimeout()}),T(re(a),"onBtnMouseMove",function(){a.clearHideTimeout(),!a.isShow&&a.show()}),a.button=n,a.option=i,a.init(),i.unique&&r.conflictPopperList.push(re(a)),a}return Pe(r,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(i){typeof i=="string"?this.contentDOM.innerHTML=i:i instanceof HTMLElement&&(X4(this.contentDOM),this.contentDOM.appendChild(i)),this.content=i}},{key:"init",value:function(){var i=this.option.trigger;this.popperDOM=this.createPopper(),i==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),wg(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var i={},a=this.option,o=a.container,u=a.offset,s=u===void 0?[0,0]:u,l=a.placement,f=ir(s,2),h=f[0],d=f[1],v=this.button.getBoundingClientRect(),m=o.getBoundingClientRect(),y=Sk(v,m),_=y.left,E=y.right,S=y.top,A=y.bottom,M=!1,O=!1;/^(left|right)/.test(l)?(l.includes("left")?i.right="".concat(v.width+E,"px"):l.includes("right")&&(i.left="".concat(v.width+_,"px")),l.includes("start")?i.top="".concat(S,"px"):l.includes("end")?i.bottom="".concat(A,"px"):(i.top="".concat(S+v.height/2,"px"),O=!0,i.transform="translate(".concat(h,"px, calc(").concat(d,"px - 50%))"))):/^(top|bottom)/.test(l)&&(l.includes("top")?i.bottom="".concat(v.height+A,"px"):l.includes("bottom")&&(i.top="".concat(v.height+S,"px")),l.includes("start")?i.left="".concat(_,"px"):l.includes("end")?i.right="".concat(E,"px"):(i.left="".concat(_+v.width/2,"px"),M=!0,i.transform="translate(calc(".concat(h,"px - 50%), ").concat(d,"px)"))),i.transform="translate(calc(".concat(h,"px - ").concat(M?"50%":"0%","), calc(").concat(d,"px - ").concat(O?"50%":"0%",")");var j=l.split("-");j.length&&Rd(this.popperDOM,j.map(function(q){return"l7-popper-".concat(q)}).join(" ")),Ck(this.popperDOM,Ak(i))}},{key:"createPopper",value:function(){var i=this.option,a=i.container,o=i.className,u=o===void 0?"":o,s=i.content,l=ca("div","l7-popper l7-popper-hide ".concat(u)),f=ca("div","l7-popper-content"),h=ca("div","l7-popper-arrow");return l.appendChild(f),l.appendChild(h),a.appendChild(l),this.popperDOM=l,this.contentDOM=f,s&&this.setContent(s),l}}]),r}(Pa.exports.EventEmitter);T(VG,"conflictPopperList",[]);var US;(function(e){e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index"})(US||(US={}));function jG(e){var t=WG();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function WG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var XG=function(e){Ut(r,e);var t=jG(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getDefault",value:function(){return{position:Lh.BOTTOMLEFT,name:"logo",href:"https://l7.antv.vision/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var i=ca("div","l7-control-logo");return this.setLogoContent(i),i}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(i){gl(Ce(r.prototype),"setOptions",this).call(this,i),this.checkUpdateOption(i,["img","href"])&&(X4(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(i){var a=this.controlOption,o=a.href,u=a.img,s=ca("img");if(s.setAttribute("src",u),s.setAttribute("aria-label","AntV logo"),Tk(s),o){var l=ca("a","l7-control-logo-link");l.target="_blank",l.href=o,l.rel="noopener nofollow",l.setAttribute("rel","noopener nofollow"),l.appendChild(s),i.appendChild(l)}else i.appendChild(s)}}]),r}(yM);function zS(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=YG(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function YG(e,t){if(!!e){if(typeof e=="string")return $S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $S(e,t)}}function $S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var GS=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],as=function(){if(typeof document>"u")return!1;var e=GS[0],t={},r=zS(GS),n;try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i==null?void 0:i[1];if(a in document){var o=zS(i.entries()),u;try{for(o.s();!(u=o.n()).done;){var s=ir(u.value,2),l=s[0],f=s[1];t[e[l]]=f}}catch(h){o.e(h)}finally{o.f()}return t}}}catch(h){r.e(h)}finally{r.f()}return!1}(),HS={change:as.fullscreenchange,error:as.fullscreenerror},to={request:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,r=arguments.length>1?arguments[1]:void 0;return new Promise(function(n,i){var a=function u(){to.off("change",u),n()};to.on("change",a);var o=t[as.requestFullscreen](r);o instanceof Promise&&o.then(a).catch(i)})},exit:function(){return new Promise(function(t,r){if(!to.isFullscreen){t();return}var n=function a(){to.off("change",a),t()};to.on("change",n);var i=document[as.exitFullscreen]();i instanceof Promise&&i.then(n).catch(r)})},toggle:function(t,r){return to.isFullscreen?to.exit():to.request(t,r)},onchange:function(t){to.on("change",t)},onerror:function(t){to.on("error",t)},on:function(t,r){var n=HS[t];n&&document.addEventListener(n,r,!1)},off:function(t,r){var n=HS[t];n&&document.removeEventListener(n,r,!1)},raw:as};Object.defineProperties(to,{isFullscreen:{get:function(){return Boolean(document[as.fullscreenElement])}},element:{enumerable:!0,get:function(){var t;return(t=document[as.fullscreenElement])!==null&&t!==void 0?t:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[as.fullscreenEnabled])}}});as||(to={isEnabled:!1});function ZG(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}ZG(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 800;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  overflow: hidden;
}
.l7-control-zoom .l7-button-control {
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
  border-radius: 0;
  font-size: 16px;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:first-child {
  border-bottom: 1px solid #f0f0f0;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  pointer-events: none;
  will-change: transform;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  pointer-events: auto;
  font-size: 14px;
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  font-weight: bold;
  margin-bottom: 8px;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  line-height: 18px;
  text-align: center;
  padding: 0;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  font-size: 14px;
}
.l7-popup .l7-popup-tip {
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var rl,K1=(rl={},T(rl,Fo.additive,{enable:!0,func:{srcRGB:w.ONE,dstRGB:w.ONE,srcAlpha:1,dstAlpha:1}}),T(rl,Fo.none,{enable:!1}),T(rl,Fo.normal,{enable:!0,func:{srcRGB:w.SRC_ALPHA,dstRGB:w.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),T(rl,Fo.subtractive,{enable:!0,func:{srcRGB:w.ONE,dstRGB:w.ONE,srcAlpha:w.ZERO,dstAlpha:w.ONE_MINUS_SRC_COLOR},equation:{rgb:w.FUNC_SUBTRACT,alpha:w.FUNC_SUBTRACT}}),T(rl,Fo.max,{enable:!0,func:{srcRGB:w.ONE,dstRGB:w.ONE},equation:{rgb:w.MAX_EXT}}),T(rl,Fo.min,{enable:!0,func:{srcRGB:w.ONE,dstRGB:w.ONE},equation:{rgb:w.MIN_EXT}}),rl);function La(e,t,r,n,i){t.updateStyleAttribute(e,r,n,i)}function qG(e,t){t.tileLayer||t.isTileLayer||(e.opacity&&qv("opacity",t,e.opacity),e.strokeWidth&&qv("strokeWidth",t,e.strokeWidth),e.strokeOpacity&&qv("strokeOpacity",t,e.strokeOpacity),e.stroke&&KG("stroke",t,e.stroke),e.offsets&&VS("offsets",t,e.offsets),e.textOffset&&VS("textOffset",t,e.textOffset),e.thetaOffset&&qv("thetaOffset",t,e.thetaOffset))}function qv(e,t,r){tt.exports.isString(r)?La(e,t,r,function(n){return n}):tt.exports.isNumber(r)||(Array.isArray(r)&&r.length===2?tt.exports.isString(r[0])&&tt.exports.isFunction(r[1])||tt.exports.isString(r[0])&&Array.isArray(r[1])&&tt.exports.isNumber(r[1][0])&&tt.exports.isNumber(r[1][1])?La(e,t,r[0],r[1]):La(e,t,[1],void 0):La(e,t,[1],void 0))}function VS(e,t,r){tt.exports.isString(r)?La(e,t,r,function(n){return n}):Array.isArray(r)&&r.length===2&&tt.exports.isString(r[0])&&tt.exports.isFunction(r[1])?La(e,t,r[0],r[1]):Array.isArray(r)&&r.length===2&&tt.exports.isNumber(r[0])&&tt.exports.isNumber(r[1])?La(e,t,r,void 0):La(e,t,[0,0],void 0)}function KG(e,t,r){tt.exports.isString(r)||(Array.isArray(r)&&r.length===2&&(tt.exports.isString(r[0])&&tt.exports.isFunction(r[1])||tt.exports.isString(r[0])&&Array.isArray(r[1])&&r[1].length>0)?La(e,t,r[0],r[1]):La(e,t,"#fff",void 0))}var jS,T_,WS,QG=(jS=gE(Oe.IGlobalConfigService),T_=function(){function e(t){ke(this,e),Mr(this,"configService",WS,this),this.config=t}return Pe(e,[{key:"setContainer",value:function(r,n,i,a){r.bind(Oe.MapConfig).toConstantValue(be(be({},this.config),{},{id:n,canvas:i,hasBaseMap:a})),r.bind(Oe.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),WS=wr(T_.prototype,"configService",[jS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T_);if(!window)throw Error("AMap JSAPI can only be used in Browser.");var ro;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(ro||(ro={}));var oa={key:"",AMap:{version:"2.0",plugins:[]}},Ju={AMap:ro.notload},JG=function(t){if(typeof t=="function"&&Ju.AMap===ro.loaded){t(window.AMap);return}},eH=function(){var e=Ie(H.mark(function t(r){return H.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(function(a,o){if(Ju.AMap===ro.failed)o("");else if(Ju.AMap===ro.notload){var u=r.key,s=r.version,l=r.plugins;if(!u){o("\u8BF7\u586B\u5199key");return}window.AMap&&location.host!=="lbs.amap.com"&&o("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),oa.key=u,oa.AMap.version=s||oa.AMap.version,oa.AMap.plugins=l||oa.AMap.plugins,Ju.AMap=ro.loading;var f=document.body||document.head;window._onAPILoaded=function(m){m?(Ju.AMap=ro.failed,o(m)):(Ju.AMap=ro.loaded,a(null))};var h=document.createElement("script");h.type="text/javascript",h.async=!1,h.src="https://webapi.amap.com/maps?callback=_onAPILoaded&v="+oa.AMap.version+"&key="+u+"&plugin="+oa.AMap.plugins.join(","),h.onerror=function(m){Ju.AMap=ro.failed,o(m)},f.appendChild(h)}else if(Ju.AMap===ro.loaded){if(r.key&&r.key!==oa.key){o("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return}if(r.version&&r.version!==oa.AMap.version){o("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return}var d=[];r.plugins&&r.plugins.forEach(function(m){oa.AMap.plugins.indexOf(m)===-1&&d.push(m)}),d.length&&window.AMap.plugin(d,function(){a(window.AMap)})}else{if(r.key&&r.key!==oa.key){o("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return}if(r.version&&r.version!==oa.AMap.version){o("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return}var v=[];r.plugins&&r.plugins.forEach(function(m){oa.AMap.plugins.indexOf(m)===-1&&v.push(m)}),JG(function(){v.length&&window.AMap.plugin(v,function(){a(window.AMap)})})}}));case 1:case"end":return i.stop()}},t)}));return function(r){return e.apply(this,arguments)}}();function tH(){delete window.AMap,oa={key:"",AMap:{version:"1.4.15",plugins:[]}},Ju={AMap:ro.notload}}const rH={load:eH,reset:tH};var Ln;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFUALT="DEFUALTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(Ln||(Ln={}));var _M={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(du,function(){function r(h){var d=[];return h.AMapUI&&d.push(n(h.AMapUI)),h.Loca&&d.push(i(h.Loca)),Promise.all(d)}function n(h){return new Promise(function(d,v){var m=[];if(h.plugins)for(var y=0;y<h.plugins.length;y+=1)o.AMapUI.plugins.indexOf(h.plugins[y])==-1&&m.push(h.plugins[y]);if(u.AMapUI===a.failed)v("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(u.AMapUI===a.notload){u.AMapUI=a.loading,o.AMapUI.version=h.version||o.AMapUI.version,y=o.AMapUI.version;var _=document.body||document.head,E=document.createElement("script");E.type="text/javascript",E.src="https://webapi.amap.com/ui/"+y+"/main.js",E.onerror=function(S){u.AMapUI=a.failed,v("\u8BF7\u6C42 AMapUI \u5931\u8D25")},E.onload=function(){if(u.AMapUI=a.loaded,m.length)window.AMapUI.loadUI(m,function(){for(var S=0,A=m.length;S<A;S++){var M=m[S].split("/").slice(-1)[0];window.AMapUI[M]=arguments[S]}for(d();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()});else for(d();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},_.appendChild(E)}else u.AMapUI===a.loaded?h.version&&h.version!==o.AMapUI.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):m.length?window.AMapUI.loadUI(m,function(){for(var S=0,A=m.length;S<A;S++){var M=m[S].split("/").slice(-1)[0];window.AMapUI[M]=arguments[S]}d()}):d():h.version&&h.version!==o.AMapUI.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):s.AMapUI.push(function(S){S?v(S):m.length?window.AMapUI.loadUI(m,function(){for(var A=0,M=m.length;A<M;A++){var O=m[A].split("/").slice(-1)[0];window.AMapUI[O]=arguments[A]}d()}):d()})})}function i(h){return new Promise(function(d,v){if(u.Loca===a.failed)v("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(u.Loca===a.notload){u.Loca=a.loading,o.Loca.version=h.version||o.Loca.version;var m=o.Loca.version,y=o.AMap.version.startsWith("2"),_=m.startsWith("2");if(y&&!_||!y&&_)v("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{y=o.key,_=document.body||document.head;var E=document.createElement("script");E.type="text/javascript",E.src="https://webapi.amap.com/loca?v="+m+"&key="+y,E.onerror=function(S){u.Loca=a.failed,v("\u8BF7\u6C42 AMapUI \u5931\u8D25")},E.onload=function(){for(u.Loca=a.loaded,d();s.Loca.length;)s.Loca.splice(0,1)[0]()},_.appendChild(E)}}else u.Loca===a.loaded?h.version&&h.version!==o.Loca.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):d():h.version&&h.version!==o.Loca.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):s.Loca.push(function(S){S?v(S):v()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var a;(function(h){h.notload="notload",h.loading="loading",h.loaded="loaded",h.failed="failed"})(a||(a={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},u={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},s={AMap:[],AMapUI:[],Loca:[]},l=[],f=function(h){typeof h=="function"&&(u.AMap===a.loaded?h(window.AMap):l.push(h))};return{load:function(h){return new Promise(function(d,v){if(u.AMap==a.failed)v("");else if(u.AMap==a.notload){var m=h.key,y=h.version,_=h.plugins;m?(window.AMap&&location.host!=="lbs.amap.com"&&v("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),o.key=m,o.AMap.version=y||o.AMap.version,o.AMap.plugins=_||o.AMap.plugins,u.AMap=a.loading,y=document.body||document.head,window.___onAPILoaded=function(S){if(delete window.___onAPILoaded,S)u.AMap=a.failed,v(S);else for(u.AMap=a.loaded,r(h).then(function(){d(window.AMap)}).catch(v);l.length;)l.splice(0,1)[0]()},_=document.createElement("script"),_.type="text/javascript",_.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+m+"&plugin="+o.AMap.plugins.join(","),_.onerror=function(S){u.AMap=a.failed,v(S)},y.appendChild(_)):v("\u8BF7\u586B\u5199key")}else if(u.AMap==a.loaded)if(h.key&&h.key!==o.key)v("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(h.version&&h.version!==o.AMap.version)v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(m=[],h.plugins)for(y=0;y<h.plugins.length;y+=1)o.AMap.plugins.indexOf(h.plugins[y])==-1&&m.push(h.plugins[y]);m.length?window.AMap.plugin(m,function(){r(h).then(function(){d(window.AMap)}).catch(v)}):r(h).then(function(){d(window.AMap)}).catch(v)}else if(h.key&&h.key!==o.key)v("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(h.version&&h.version!==o.AMap.version)v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var E=[];if(h.plugins)for(y=0;y<h.plugins.length;y+=1)o.AMap.plugins.indexOf(h.plugins[y])==-1&&E.push(h.plugins[y]);f(function(){E.length?window.AMap.plugin(E,function(){r(h).then(function(){d(window.AMap)}).catch(v)}):r(h).then(function(){d(window.AMap)}).catch(v)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},u={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},s={AMap:[],AMapUI:[],Loca:[]}}}})})(_M);const nH=_M.exports;var iH=function(){function e(t){ke(this,e),T(this,"size",1e4),this.size=t||1e4}return Pe(e,[{key:"setSize",value:function(r){this.size=r}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(r){return(180+r)/360*this.size}},{key:"mercatorYfromLat",value:function(r){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(r){return r/this.size*360-180}},{key:"latFromMercatorY",value:function(r){var n=180-(1-r/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}},{key:"project",value:function(r){var n=this.mercatorXfromLng(r[0]),i=this.mercatorYfromLat(r[1]);return[n,i]}},{key:"unproject",value:function(r){var n=this.lngFromMercatorX(r[0]),i=this.latFromMercatorY(r[1]);return[n,i]}}]),e}();function XS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return be(be({},t),e)}function kd(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yg(e,t){var r=rE([],t,e);return WD(r,r,1/r[3]),r}function Vc(e,t){if(!e)throw new Error(t||"viewport-mercator-project: assertion failed.")}var Do=Math.PI,xM=Do/4,ml=Do/180,YS=180/Do,_E=512,ZS=4003e4,aH=1.5;function EM(e){return Math.pow(2,e)}function w_(e,t){var r=ir(e,2),n=r[0],i=r[1];Vc(Number.isFinite(n)&&Number.isFinite(t)),Vc(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),t*=_E;var a=n*ml,o=i*ml,u=t*(a+Do)/(2*Do),s=t*(Do-Math.log(Math.tan(xM+o*.5)))/(2*Do);return[u,s]}function qS(e,t){var r=ir(e,2),n=r[0],i=r[1];t*=_E;var a=n/t*(2*Do)-Do,o=2*(Math.atan(Math.exp(Do-i/t*(2*Do)))-xM);return[a*YS,o*YS]}function oH(e){var t=e.latitude,r=e.longitude,n=e.zoom,i=e.scale,a=e.highPrecision,o=a===void 0?!1:a;i=i!==void 0?i:EM(n),Vc(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i));var u={},s=_E*i,l=Math.cos(t*ml),f=s/360,h=f/l,d=s/ZS/l;if(u.pixelsPerMeter=[d,-d,d],u.metersPerPixel=[1/d,-1/d,1/d],u.pixelsPerDegree=[f,-h,d],u.degreesPerPixel=[1/f,-1/h,1/d],o){var v=ml*Math.tan(t*ml)/l,m=f*v/2,y=s/ZS*v,_=y/h*d;u.pixelsPerDegree2=[0,-m,y],u.pixelsPerMeter2=[_,0,_]}return u}function uH(e){var t=e.height,r=e.pitch,n=e.bearing,i=e.altitude,a=e.center,o=a===void 0?null:a,u=e.flipY,s=u===void 0?!1:u,l=kd();return Gc(l,l,[0,0,-i]),wh(l,l,[1,1,1/t]),d0(l,l,-r*ml),mm(l,l,n*ml),s&&wh(l,l,[1,-1,1]),o&&Gc(l,l,w5([],o)),l}function sH(e){var t=e.width,r=e.height,n=e.altitude,i=n===void 0?aH:n,a=e.pitch,o=a===void 0?0:a,u=e.nearZMultiplier,s=u===void 0?1:u,l=e.farZMultiplier,f=l===void 0?1:l,h=o*ml,d=Math.atan(.5/i),v=Math.sin(d)*i/Math.sin(Math.PI/2-h-d),m=Math.cos(Math.PI/2-h)*v+i;return{fov:2*Math.atan(r/2/i),aspect:t/r,focalDistance:i,near:s,far:m*f}}function lH(e){var t=e.width,r=e.height,n=e.pitch,i=e.altitude,a=e.nearZMultiplier,o=e.farZMultiplier,u=sH({width:t,height:r,altitude:i,pitch:n,nearZMultiplier:a,farZMultiplier:o}),s=u.fov,l=u.aspect,f=u.near,h=u.far,d=tE([],s,l,f,h);return d}function cH(e,t){var r=ir(e,3),n=r[0],i=r[1],a=r[2],o=a===void 0?0:a;return Vc(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(o)),yg(t,[n,i,o,1])}function bM(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=ir(e,3),i=n[0],a=n[1],o=n[2];if(Vc(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o)){var u=yg(t,[i,a,o,1]);return u}var s=yg(t,[i,a,0,1]),l=yg(t,[i,a,1,1]),f=s[2],h=l[2],d=f===h?0:((r||0)-f)/(h-f);return YD([],s,l,d)}var KS=kd(),fH=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width,n=t.height,i=t.viewMatrix,a=i===void 0?KS:i,o=t.projectionMatrix,u=o===void 0?KS:o;ke(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=u;var s=kd();uo(s,s,this.projectionMatrix),uo(s,s,this.viewMatrix),this.viewProjectionMatrix=s;var l=kd();wh(l,l,[this.width/2,-this.height/2,1]),Gc(l,l,[1,-1,0]),uo(l,l,this.viewProjectionMatrix);var f=eE(kd(),l);if(!f)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=f,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Pe(e,[{key:"equals",value:function(r){return r instanceof e?r.width===this.width&&r.height===this.height&&b1(r.projectionMatrix,this.projectionMatrix)&&b1(r.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,o=this.projectPosition(r),u=cH(o,this.pixelProjectionMatrix),s=ir(u,2),l=s[0],f=s[1],h=a?f:this.height-f;return r.length===2?[l,h]:[l,h,u[2]]}},{key:"unproject",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,o=n.targetZ,u=ir(r,3),s=u[0],l=u[1],f=u[2],h=a?l:this.height-l,d=o&&o*this.pixelsPerMeter,v=bM([s,h,f],this.pixelUnprojectionMatrix,d),m=this.unprojectPosition(v),y=ir(m,3),_=y[0],E=y[1],S=y[2];return Number.isFinite(f)?[_,E,S]:Number.isFinite(o)?[_,E,o]:[_,E]}},{key:"projectPosition",value:function(r){var n=this.projectFlat(r),i=ir(n,2),a=i[0],o=i[1],u=(r[2]||0)*this.pixelsPerMeter;return[a,o,u]}},{key:"unprojectPosition",value:function(r){var n=this.unprojectFlat(r),i=ir(n,2),a=i[0],o=i[1],u=(r[2]||0)/this.pixelsPerMeter;return[a,o,u]}},{key:"projectFlat",value:function(r){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,r}},{key:"unprojectFlat",value:function(r){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,r}}]),e}();function hH(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,a=i===void 0?0:i,o=e.maxZoom,u=o===void 0?24:o,s=e.padding,l=s===void 0?0:s,f=e.offset,h=f===void 0?[0,0]:f,d=ir(n,2),v=ir(d[0],2),m=v[0],y=v[1],_=ir(d[1],2),E=_[0],S=_[1];if(Number.isFinite(l)){var A=l;l={top:A,bottom:A,left:A,right:A}}else Vc(Number.isFinite(l.top)&&Number.isFinite(l.bottom)&&Number.isFinite(l.left)&&Number.isFinite(l.right));var M=new CM({width:t,height:r,longitude:0,latitude:0,zoom:0}),O=M.project([m,S]),j=M.project([E,y]),q=[Math.max(Math.abs(j[0]-O[0]),a),Math.max(Math.abs(j[1]-O[1]),a)],Y=[t-l.left-l.right-Math.abs(h[0])*2,r-l.top-l.bottom-Math.abs(h[1])*2];Vc(Y[0]>0&&Y[1]>0);var ne=Y[0]/q[0],X=Y[1]/q[1],$=(l.right-l.left)/2/ne,K=(l.bottom-l.top)/2/X,ue=[(j[0]+O[0])/2+$,(j[1]+O[1])/2+K],de=M.unproject(ue),pe=M.zoom+Math.log2(Math.abs(Math.min(ne,X)));return{longitude:de[0],latitude:de[1],zoom:Math.min(pe,u)}}var CM=function(e){Ut(t,e);function t(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,a=n.height,o=n.latitude,u=o===void 0?0:o,s=n.longitude,l=s===void 0?0:s,f=n.zoom,h=f===void 0?0:f,d=n.pitch,v=d===void 0?0:d,m=n.bearing,y=m===void 0?0:m,_=n.altitude,E=_===void 0?1.5:_,S=n.nearZMultiplier,A=n.farZMultiplier;ke(this,t),i=i||1,a=a||1;var M=EM(h);E=Math.max(.75,E);var O=w_([l,u],M);O[2]=0;var j=lH({width:i,height:a,pitch:v,bearing:y,altitude:E,nearZMultiplier:S||1/a,farZMultiplier:A||1.01}),q=uH({height:a,center:O,pitch:v,bearing:y,altitude:E,flipY:!0});return r=zt(this,Ce(t).call(this,{width:i,height:a,viewMatrix:q,projectionMatrix:j})),r.latitude=u,r.longitude=l,r.zoom=h,r.pitch=v,r.bearing=y,r.altitude=E,r.scale=M,r.center=O,r.pixelsPerMeter=oH(re(re(r))).pixelsPerMeter[2],Object.freeze(re(re(r))),r}return Pe(t,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return w_(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return qS(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,a=n.pos,o=bM(a,this.pixelUnprojectionMatrix),u=w_(i,this.scale),s=Pn([],u,XD([],o)),l=Pn([],this.center,s);return qS(l,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:a})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,o=this.height,u=hH(Object.assign({width:a,height:o,bounds:n},i)),s=u.longitude,l=u.latitude,f=u.zoom;return new t({width:a,height:o,longitude:s,latitude:l,zoom:f})}}]),t}(fH),pH=function(){function e(){ke(this,e)}return Pe(e,[{key:"syncWithMapCamera",value:function(r){var n=r.center,i=r.zoom,a=r.pitch,o=r.bearing,u=r.viewportHeight,s=r.viewportWidth,l=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new CM(be(be({},l),{},{width:s,height:u,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:a,bearing:o}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}}]),e}(),dH={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},vH=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],QS,JS,eT,tT,rT,nT,rh,iT,aT,oT,uT;function gH(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}gH(`.amap-logo{
 display: none !important;
}
`);var sT={contextmenu:"rightclick"},mH=0;window.forceWebGL=!0;var lT="15cd8a57710d40c9b7c0e3cc120f1200",yH="1.4.15",_H="amap-script",M_=!1,Kv=[],xH=12,EH=(QS=xr(),JS=kr(Oe.IGlobalConfigService),eT=kr(Oe.MapConfig),tT=kr(Oe.ICoordinateSystemService),rT=kr(Oe.IEventEmitter),QS(nT=(rh=function(){function e(){var t=this;ke(this,e),T(this,"version",Ln["GAODE1.x"]),T(this,"simpleMapCoord",new iH),T(this,"bgColor","rgba(0, 0, 0, 0)"),Mr(this,"configService",iT,this),Mr(this,"config",aT,this),Mr(this,"coordinateSystemService",oT,this),Mr(this,"eventEmitter",uT,this),T(this,"handleCameraChanged",function(r){var n=r.camera,i=n.fov,a=n.near,o=n.far,u=n.height,s=n.pitch,l=n.rotation,f=n.aspect,h=n.position,d=t.getCenter(),v=d.lng,m=d.lat;if(t.emit("mapchange"),t.cameraChangedCallback){t.viewport.syncWithMapCamera({aspect:f,bearing:360-l,far:o,fov:i,cameraHeight:u,near:a,pitch:s,zoom:t.map.getZoom()-1,center:[v,m],offsetOrigin:[h.x,h.y]});var y=t.config.offsetZoom,_=y===void 0?xH:y;t.viewport.getZoom()>_?t.coordinateSystemService.setCoordinateSystem(yu.P20_OFFSET):t.coordinateSystemService.setCoordinateSystem(yu.P20),t.cameraChangedCallback(t.viewport)}})}return Pe(e,[{key:"setBgColor",value:function(r){this.bgColor=r}},{key:"addMarkerContainer",value:function(){var r=this.map.getContainer();if(r!==null){var n=r.getElementsByClassName("amap-maps")[0];this.markerContainer=ca("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(r,n){kS.indexOf(r)!==-1?this.eventEmitter.on(r,n):this.map.on(sT[r]||r,n)}},{key:"off",value:function(r,n){kS.indexOf(r)!==-1?this.eventEmitter.off(r,n):this.map.off(sT[r]||r,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var r;return(r=this.map.getContainer())===null||r===void 0?void 0:r.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var r=this.map.getSize();return[r.getWidth(),r.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(r){return this.map.setZoom(r+1)}},{key:"getCenter",value:function(r){if(r!=null&&r.padding){var n=this.getCenter(),i=XS(r.padding),a=this.lngLatToPixel([n.lng,n.lat]),o=[(i.right-i.left)/2,(i.bottom-i.top)/2],u=this.pixelToLngLat([a.x-o[0],a.y-o[1]]);return u}var s=this.map.getCenter();return{lng:s.getLng(),lat:s.getLat()}}},{key:"setCenter",value:function(r,n){if(n!=null&&n.padding){var i=XS(n.padding),a=this.lngLatToPixel(r),o=[(i.right-i.left)/2,(i.bottom-i.top)/2],u=this.pixelToLngLat([a.x+o[0],a.y+o[1]]);this.map.setCenter([u.lng,u.lat])}else this.map.setCenter(r)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var r=this.map.getBounds().toBounds(),n=r.getNorthEast(),i=r.getSouthWest(),a=this.getCenter(),o=a.lng>n.getLng()||a.lng<i.getLng()?180-n.getLng():n.getLng(),u=a.lng<i.getLng()?i.getLng()-180:i.getLng();return[[u,i.getLat()],[o,n.getLat()]]}},{key:"getMinZoom",value:function(){var r=this.map.get("zooms");return r[0]-1}},{key:"getMaxZoom",value:function(){var r=this.map.get("zooms");return r[1]-1}},{key:"setRotation",value:function(r){return this.map.setRotation(r)}},{key:"setPitch",value:function(r){return this.map.setPitch(r)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(r){this.map.panTo(r)}},{key:"panBy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(r,n)}},{key:"fitBounds",value:function(r){this.map.setBounds(new AMap.Bounds([r[0][0],r[0][1],r[1][0],r[1][1]]))}},{key:"setZoomAndCenter",value:function(r,n){this.map.setZoomAndCenter(r+1,n)}},{key:"setMapStyle",value:function(r){this.map.setMapStyle(this.getMapStyleValue(r))}},{key:"setMapStatus",value:function(r){this.map.setStatus(r)}},{key:"getMapStyleConfig",value:function(){return dH}},{key:"getMapStyleValue",value:function(r){return this.getMapStyleConfig()[r]||r}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(r){var n=this.map.pixelToLngLat(new AMap.Pixel(r[0],r[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(r){var n=this.map.lnglatToPixel(new AMap.LngLat(r[0],r[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(r){var n=new AMap.Pixel(r[0],r[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(r){var n=new AMap.LngLat(r[0],r[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToCoord",value:function(r){var n=this.map.lngLatToGeodeticCoord(r),i=n.x,a=n.y;return[i,-a]}},{key:"lngLatToMercator",value:function(r,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(r,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],o=this.viewport.projectFlat(r),u=Oa();return Gc(u,u,fi(o[0],o[1],n)),wh(u,u,fi(a[0],a[1],a[2])),d0(u,u,i[0]),gm(u,u,i[1]),mm(u,u,i[2]),u}},{key:"init",value:function(){var t=Ie(H.mark(function n(){var i=this,a,o,u,s,l,f,h,d,v,m,y,_,E,S;return H.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return a=this.config,o=a.id,u=a.style,s=u===void 0?"light":u,l=a.minZoom,f=l===void 0?0:l,h=a.maxZoom,d=h===void 0?18:h,v=a.token,m=v===void 0?lT:v,y=a.mapInstance,_=a.plugin,E=_===void 0?[]:_,S=la(a,vH),M.next=3,new Promise(function(O){var j=function(){if(y)i.map=y,i.$mapContainer=i.map.getContainer(),setTimeout(function(){i.map.on("camerachange",i.handleCameraChanged),O()},30);else{i.$mapContainer=i.creatMapContainer(o);var Y=be({mapStyle:i.getMapStyleValue(s),zooms:[f,d],viewMode:"3D"},S);Y.zoom&&(Y.zoom+=1);var ne=new AMap.Map(i.$mapContainer,Y);ne.on("camerachange",i.handleCameraChanged),ne.on("camerachange",function(){setTimeout(function(){return i.handleAfterMapChange()})}),i.map=ne,setTimeout(function(){O()},10)}};!M_&&!y?(m===lT&&console.warn(i.configService.getSceneWarninfo("MapToken")),M_=!0,E.push("Map3D"),nH.load({key:m,version:yH,plugins:E}).then(function(){j(),Kv.length&&(Kv.forEach(function(q){return q()}),Kv=[])}).catch(function(q){throw new Error(q)})):M_&&window.AMap||y?j():Kv.push(j)});case 3:this.viewport=new pH;case 4:case"end":return M.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"meterToCoord",value:function(r,n){var i=AMap.GeometryUtil.distance(mh(AMap.LngLat,It(r)),mh(AMap.LngLat,It(n))),a=this.lngLatToCoord(r),o=ir(a,2),u=o[0],s=o[1],l=this.lngLatToCoord(n),f=ir(l,2),h=f[0],d=f[1],v=Math.sqrt(Math.pow(u-h,2)+Math.pow(s-d,2));return v/i}},{key:"updateView",value:function(r){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(r){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],a=r==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return a}},{key:"emit",value:function(r){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];(n=this.eventEmitter).emit.apply(n,[r].concat(a))}},{key:"once",value:function(r){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];(n=this.eventEmitter).once.apply(n,[r].concat(a))}},{key:"destroy",value:function(){var r,n;(r=this.$mapContainer)===null||r===void 0||(n=r.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var i=document.getElementById(_H);i&&document.head.removeChild(i),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(r){this.cameraChangedCallback=r}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(r){var n=r;typeof r=="string"&&(n=document.getElementById(r));var i=document.createElement("div");return i.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,i.id="l7_amap_div"+mH++,n.appendChild(i),i}}]),e}(),iT=wr(rh.prototype,"configService",[JS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aT=wr(rh.prototype,"config",[eT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oT=wr(rh.prototype,"coordinateSystemService",[tT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uT=wr(rh.prototype,"eventEmitter",[rT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rh))||nT),bH=function(){function e(){ke(this,e),T(this,"projectionMatrix",Oa()),T(this,"viewMatrix",Oa()),T(this,"viewProjectionMatrix",Oa()),T(this,"ViewProjectionMatrixUncentered",Oa()),T(this,"viewUncenteredMatrix",Oa())}return Pe(e,[{key:"syncWithMapCamera",value:function(r){var n=r.zoom,i=n===void 0?1:n,a=r.center,o=a===void 0?[0,0]:a,u=r.offsetOrigin,s=u===void 0?[0,0]:u,l=r.cameraPosition,f=l===void 0?[0,0,0]:l,h=r.up,d=h===void 0?[0,1,0]:h,v=r.lookAt,m=v===void 0?[0,0,0]:v,y=r.aspect,_=y===void 0?1:y,E=r.near,S=E===void 0?.1:E,A=r.far,M=A===void 0?1e3:A,O=r.fov,j=O===void 0?45:O;this.zoom=i,this.center=o,tE(this.projectionMatrix,j/180*Math.PI,_,S,M);var q=fi.apply(_h,It(f)),Y=fi.apply(_h,It(m)),ne=fi.apply(_h,It(d));y5(this.viewMatrix,q,Y,ne),this.viewUncenteredMatrix=c5(this.viewMatrix),Gc(this.viewMatrix,this.viewMatrix,fi(-s[0],s[1],0)),uo(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),uo(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var r=ir(this.center,2),n=r[0],i=r[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r){var n=85.0511287798,i=Math.max(Math.min(n,r[1]),-n),a=256<<20,o=Math.PI/180,u=r[0]*o,s=i*o;s=Math.log(Math.tan(Math.PI/4+s/2));var l=.5/Math.PI,f=.5,h=-.5/Math.PI;return o=.5,u=a*(l*u+f)-215440491,s=-(a*(h*s+o)-106744817),[u,s]}}]),e}(),CH=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],cT,fT;function AH(e){var t=SH();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function SH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function TH(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}TH(`.amap-logo{
 display: none !important;
}
`);var hT=[108.92361,34.54083];window.forceWebGL=!0;var wH="ff533602d57df6f8ab3b0fea226ae52f",MH="2.0",RH=(cT=xr(),cT(fT=function(e){Ut(r,e);var t=AH(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"version",Ln["GAODE2.x"]),T(re(n),"handleViewChanged",function(u){var s=n.map.customCoords.getCameraParams(),l=s.fov,f=s.near,h=s.far,d=s.aspect,v=s.position,m=s.lookAt,y=s.up;n.emit("mapchange");var _=n.map.customCoords.getCenter();n.cameraChangedCallback&&(n.viewport.syncWithMapCamera({aspect:d,far:h,fov:l,cameraPosition:v,lookAt:m,up:y,near:f,zoom:n.map.getZoom()-1,center:_,offsetOrigin:[v[0],v[1]]}),n.coordinateSystemService.setCoordinateSystem(yu.P20_2),n.cameraChangedCallback(n.viewport))}),n}return Pe(r,[{key:"setCustomCoordCenter",value:function(i){this.sceneCenter=i,this.sceneCenterMKT=Uv.apply(void 0,It(i))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(i,a){var o=a||this.sceneCenter,u=Uv.apply(void 0,It(o)),s=this._sub(Uv(i[0],i[1]),u);return i[2]&&s.push(i[2]),s}},{key:"lngLatToCoordsByLayer",value:function(i,a){var o=this;return i.map(function(u){return typeof u[0]=="number"?o.lngLatToCoordByLayer(u,a):u.map(function(s){return o.lngLatToCoordByLayer(s,a)})})}},{key:"setCoordCenter",value:function(i){this.map.customCoords.setCenter(i||hT),this.setCustomCoordCenter(i||hT)}},{key:"lngLatToCoord",value:function(i){return this.sceneCenter||(this.map.customCoords.setCenter(i),this.setCustomCoordCenter(i)),this._sub(Uv(i[0],i[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(i){var a=this;return i.map(function(o){return typeof o[0]=="number"?a.lngLatToCoord(o):o.map(function(u){return a.lngLatToCoord(u)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var i=this.map.getContainer();if(i!==null){var a=i.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=ca("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(i){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var i=this.map.getBounds(),a=i.getNorthEast(),o=i.getSouthWest(),u=this.getCenter(),s=u.lng>a.getLng()||u.lng<o.getLng()?180-a.getLng():a.getLng(),l=u.lng<o.getLng()?o.getLng()-180:o.getLng();return[[l,o.getLat()],[s,a.getLat()]]}},{key:"getMinZoom",value:function(){var i=this.map.getZooms();return i[0]-1}},{key:"getMaxZoom",value:function(){var i=this.map.getZooms();return i[1]-1}},{key:"lngLatToContainer",value:function(i){var a=this.map.lngLatToContainer(i);return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(i,a,o){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],s=this.map.customCoords.lngLatToCoord(i),l=Oa();return Gc(l,l,fi(s[0],s[1],a)),wh(l,l,fi(u[0],u[1],u[2])),d0(l,l,o[0]),gm(l,l,o[1]),mm(l,l,o[2]),l}},{key:"init",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E,S,A,M,O,j,q,Y,ne;return H.wrap(function($){for(;;)switch($.prev=$.next){case 0:if(o=this.config,u=o.id,s=o.style,l=s===void 0?"light":s,f=o.minZoom,h=f===void 0?0:f,d=o.maxZoom,v=d===void 0?18:d,m=o.token,y=m===void 0?wH:m,_=o.mapInstance,E=o.plugin,S=E===void 0?[]:E,o.version,A=la(o,CH),this.viewport=new bH,window.AMap||_){$.next=6;break}return S.push("Map3D"),$.next=6,rH.load({key:y,version:MH,plugins:S});case 6:_?(this.map=_,this.$mapContainer=this.map.getContainer(),O=this.map.getCenter(),(M=this.map.customCoords)===null||M===void 0||M.setCenter([O.lng,O.lat]),this.setCustomCoordCenter([O.lng,O.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(u),q=be({mapStyle:this.getMapStyleValue(l),zooms:[h,v],viewMode:"3D"},A),q.zoom&&(q.zoom+=1),Y=new AMap.Map(this.$mapContainer,q),this.map=Y,ne=Y.getCenter(),(j=this.map.customCoords)===null||j===void 0||j.setCenter([ne.lng,ne.lat]),this.setCustomCoordCenter([ne.lng,ne.lat]),Y.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return $.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"initViewPort",value:function(){var i,a=(i=this.map.customCoords)===null||i===void 0?void 0:i.getCameraParams(),o=a.fov,u=a.near,s=a.far,l=a.aspect,f=a.position,h=a.lookAt,d=a.up;this.emit("mapchange");var v=this.map.customCoords.getCenter(),m=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:l,far:s,fov:o,cameraPosition:f,lookAt:h,near:u,up:d,zoom:m-1,center:v,offsetOrigin:[f[0],f[1]]}),this.coordinateSystemService.setCoordinateSystem(yu.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(i,a){var o=[0,0];return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o}}]),r}(EH))||fT);function OH(e){var t=LH();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function LH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var FH=function(e){Ut(r,e);var t=OH(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getServiceConstructor",value:function(){return RH}}]),r}(QG);function IH(e,t){var r=[t[0]-e[0],t[1]-e[1]],n=e5(r),i=[e[0]+n[0]*1e-4,e[1]+n[1]*1e-4];return i}function kH(e,t,r){if(e.length>0&&t.version===Ln["GAODE2.x"]){var n=r.coordCenter;typeof e[0].coordinates[0]=="number"?e.filter(function(i){return!i.originCoordinates}).map(function(i){i.version=Ln["GAODE2.x"],i.originCoordinates=tt.exports.cloneDeep(i.coordinates),i.coordinates=t.lngLatToCoordByLayer(i.coordinates,n)}):e.filter(function(i){return!i.originCoordinates}).map(function(i){i.version=Ln["GAODE2.x"],i.originCoordinates=tt.exports.cloneDeep(i.coordinates),i.coordinates=t.lngLatToCoordsByLayer(i.coordinates,n)})}}function PH(e,t){e.length>0&&t.version===Ln.SIMPLE&&e.map(function(r){r.simpleCoordinate||(r.coordinates=DH(r.coordinates,t),r.simpleCoordinate=!0)})}function DH(e,t){if(typeof e[0]=="number")return t.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){var r=[];return e.map(function(i){var a=[];i.map(function(o){a.push(t.simpleMapCoord.unproject(o))}),r.push(a)}),r}else{var n=[];return e.map(function(i){n.push(t.simpleMapCoord.unproject(i))}),n}}function BH(e,t){var r;if(!e.scale)return[];var n=(e==null||(r=e.scale)===null||r===void 0?void 0:r.scalers)||[],i=[];n.forEach(function(o){var u,s=o.field;(t.hasOwnProperty(s)||((u=e.scale)===null||u===void 0?void 0:u.type)==="variable")&&i.push(t[s])});var a=e.mapping?e.mapping(i):[];return a}function NH(e,t,r,n,i){var a=i==null?void 0:i.getLayerConfig(),o=a.arrow,u=o===void 0?{enable:!1}:o,s=t.map(function(l){var f={id:l._id,coordinates:l.coordinates};if(e.filter(function(v){return v.scale!==void 0}).forEach(function(v){var m=BH(v,l);v.needRemapping=!1,v.name==="color"&&(m=m.map(function(y){return $r(y)})),f[v.name]=Array.isArray(m)&&m.length===1?m[0]:m,v.name==="shape"&&(f.shape=r.getIconFontKey(f[v.name]))}),f.shape==="line"&&u.enable){var h=f.coordinates,d=IH(h[0],h[1]);f.coordinates.splice(1,0,d,d)}return f});return kH(s,n,i),PH(s,n),s}function UH(e,t,r,n,i,a){var o=new mE(i,a),u=n.getLayerStyleAttributes()||[],s=o.data.dataArray,l=s,f=NH(u,l,t,r,e);return o.destroy(),f}function AM(e){return e.map(function(t){return typeof t=="string"&&(t=[t,{}]),t})}function SM(e,t,r,n){var i=e.multiPassRenderer,a=e.getLayerConfig(),o=a.enableTAA;return o?i.add(n("taa")):i.add(n("render")),AM(t).forEach(function(u){var s=ir(u,2),l=s[0],f=s[1];i.add(r(l),f)}),i.add(r("copy")),i}var zH=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function $H(e,t,r){if(typeof t=="string"&&typeof r=="string"&&t!==r){if(e.type==="PointLayer"){e.dataState.dataSourceNeedUpdate=!0;return}zH.map(function(n){if(n.includes(t)&&n.includes(r)){e.dataState.dataSourceNeedUpdate=!0;return}})}}var GH=function(){function e(t){ke(this,e),this.layer=t}return Pe(e,[{key:"pickRender",value:function(r){var n=this.layer;if(n.tileLayer)return n.tileLayer.pickRender(r);n.hooks.beforePickingEncode.call(),n.masks.length>0&&n.masks.filter(function(i){return i.inited}).forEach(function(){var i=Ie(H.mark(function a(o){return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:o.render();case 1:case"end":return s.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),n.renderModels(!0),n.hooks.afterPickingEncode.call()}},{key:"pick",value:function(r,n){var i=this.layer.getContainer(),a=i.get(Oe.IPickingService);return r.type==="RasterLayer"?this.pickRasterLayer(r,n):(this.pickRender(n),a.pickFromPickingFBO(r,n))}},{key:"pickRasterLayer",value:function(r,n,i){var a=this.layer.getContainer(),o=a.get(Oe.IPickingService),u=a.get(Oe.IMapService),s=this.layer.getSource().extent,l=zk(n.lngLat,s),f={x:n.x,y:n.y,type:n.type,lngLat:n.lngLat,target:n,rasterValue:null},h=i||r;if(l){var d=this.readRasterValue(r,s,u,n.x,n.y);return f.rasterValue=d,o.triggerHoverOnLayer(h,f),!0}else return f.type=n.type==="mousemove"?"mouseout":"un"+n.type,o.triggerHoverOnLayer(h,be(be({},f),{},{type:"unpick"})),o.triggerHoverOnLayer(h,f),!1}},{key:"readRasterValue",value:function(r,n,i,a,o){var u=r.getSource().data.dataArray[0],s=ir(n,4),l=s[0],f=l===void 0?0:l,h=s[1],d=h===void 0?0:h,v=s[2],m=v===void 0?10:v,y=s[3],_=y===void 0?-10:y,E=i.lngLatToContainer([f,d]),S=i.lngLatToContainer([m,_]),A=S.x-E.x,M=E.y-S.y,O=[(a-E.x)/A,(o-S.y)/M],j=u.width||1,q=u.height||1,Y=Math.floor(O[0]*j),ne=Math.floor(O[1]*q),X=Math.max(0,ne-1)*j+Y,$=u.data[X];return $}},{key:"selectFeature",value:function(r){var n=this.layer,i=ir(r,3),a=i[0],o=i[1],u=i[2];n.hooks.beforeSelect.call([a,o,u])}},{key:"highlightPickedFeature",value:function(r){var n=ir(r,3),i=n[0],a=n[1],o=n[2];this.layer.hooks.beforeHighlight.call([i,a,o])}},{key:"getFeatureById",value:function(r){return this.layer.getSource().getFeatureById(r)}}]),e}(),HH=function(){function e(t){ke(this,e),this.layer=t;var r=this.layer.getContainer();this.rendererService=r.get(Oe.IRendererService)}return Pe(e,[{key:"getColorTexture",value:function(r){var n=this.getTextureKey(r);return this.key===n?this.colorTexture:(this.createColorTexture(r),this.key=n,this.colorTexture)}},{key:"createColorTexture",value:function(r){var n=this.rendererService.createTexture2D,i=Yx(r),a=n({data:i.data,width:i.width,height:i.height,flipY:!1});return this.colorTexture=a,a}},{key:"setColorTexture",value:function(r,n){this.key=this.getTextureKey(n),this.colorTexture=r}},{key:"destroy",value:function(){var r;(r=this.colorTexture)===null||r===void 0||r.destroy()}},{key:"getTextureKey",value:function(r){return"".concat(r.colors.join("_"),"_").concat(r.positions.join("_"))}}]),e}(),VH=["passes"],jH=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"],pT,R_,dT;function WH(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=XH(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function XH(e,t){if(!!e){if(typeof e=="string")return vT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vT(e,t)}}function vT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YH(e){var t=ZH();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function ZH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gT=0,Vh=(pT=gE(Oe.IGlobalConfigService),R_=function(e){Ut(r,e);var t=YH(r);function r(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ke(this,r),n=t.call(this),T(re(n),"id","".concat(gT++)),T(re(n),"name","".concat(gT)),T(re(n),"visible",!0),T(re(n),"zIndex",0),T(re(n),"inited",!1),T(re(n),"layerModelNeedUpdate",!1),T(re(n),"pickedFeatureID",null),T(re(n),"selectedFeatureID",null),T(re(n),"styleNeedUpdate",!1),T(re(n),"forceRender",!1),T(re(n),"clusterZoom",0),T(re(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),T(re(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),T(re(n),"hooks",{init:new mz,afterInit:new iA,beforeRender:new iA,beforeRenderData:new yz,afterRender:new lu,beforePickingEncode:new lu,afterPickingEncode:new lu,beforeHighlight:new lu(["pickedColor"]),afterHighlight:new lu,beforeSelect:new lu(["pickedColor"]),afterSelect:new lu,beforeDestroy:new lu,afterDestroy:new lu}),T(re(n),"models",[]),T(re(n),"startInit",!1),T(re(n),"layerChildren",[]),T(re(n),"masks",[]),Mr(re(n),"configService",dT,re(n)),T(re(n),"animateOptions",{enable:!1}),T(re(n),"currentPickId",null),T(re(n),"pendingStyleAttributes",[]),T(re(n),"scaleOptions",{}),T(re(n),"animateStatus",!1),T(re(n),"isDestroyed",!1),T(re(n),"encodeDataLength",0),T(re(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var a=n.getLayerConfig();a&&a.autoFit&&n.fitBounds(a.fitBoundsOptions);var o=n.layerSource.getSourceCfg().autoRender;o&&n.reRender()}),n.name=i.name||n.id,n.zIndex=i.zIndex||0,n.rawConfig=i,n}return Pe(r,[{key:"addMaskLayer",value:function(i){this.masks.push(i)}},{key:"removeMaskLayer",value:function(i){var a=this.masks.indexOf(i);a>-1&&this.masks.splice(a,1),i.destroy()}},{key:"getAttribute",value:function(i){return this.styleAttributeService.getLayerStyleAttribute(i)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(i){var a=this;if(Object.keys(i).map(function(u){u in a.rawConfig&&(a.rawConfig[u]=i[u])}),!this.startInit)this.needUpdateConfig=be(be({},this.needUpdateConfig),i);else{var o=this.container.get(Oe.SceneID);qG(i,this),this.configService.setLayerConfig(o,this.id,be(be(be({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(i,a){this.container=i,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(i){return this.plugins.push(i),this}},{key:"init",value:function(){var n=Ie(H.mark(function a(){var o=this,u,s,l,f,h,d,v;return H.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:u=this.container.get(Oe.SceneID),this.startInit=!0,this.configService.setLayerConfig(u,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Oe.IIconService),this.fontService=this.container.get(Oe.IFontService),this.rendererService=this.container.get(Oe.IRendererService),this.layerService=this.container.get(Oe.ILayerService),this.interactionService=this.container.get(Oe.IInteractionService),this.pickingService=this.container.get(Oe.IPickingService),this.mapService=this.container.get(Oe.IMapService),s=this.getLayerConfig(),l=s.enableMultiPassRenderer,f=s.passes,l&&f!==null&&f!==void 0&&f.length&&f.length>0&&this.mapService.on("mapAfterFrameChange",function(){o.renderLayers()}),this.cameraService=this.container.get(Oe.ICameraService),this.coordinateService=this.container.get(Oe.ICoordinateSystemService),this.shaderModuleService=this.container.get(Oe.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Oe.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Oe.IFactoryNormalPass),this.styleAttributeService=this.container.get(Oe.IStyleAttributeService),l&&(this.multiPassRenderer=this.container.get(Oe.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(_){var E=_.attributeName,S=_.attributeField,A=_.attributeValues,M=_.updateOptions;o.styleAttributeService.updateStyleAttribute(E,{scale:be({field:S},o.splitValuesAndCallbackInAttribute(A,o.getLayerConfig()[E]))},M)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Oe.ILayerPlugin),h=WH(this.plugins);try{for(h.s();!(d=h.n()).done;)v=d.value,v.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(_){h.e(_)}finally{h.f()}return this.layerPickService=new GH(this),this.textureService=new HH(this),y.next=29,this.hooks.init.promise();case 29:this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 33:case"end":return y.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"updateModelData",value:function(i){i.attributes&&i.elements?this.models.map(function(a){a.updateAttributesAndElements(i.attributes,i.elements)}):console.warn("data error")}},{key:"createModelData",value:function(i,a){var o;if((o=this.layerModel)!==null&&o!==void 0&&o.createModelData)return this.layerModel.createModelData(a);var u=this.calculateEncodeData(i,a),s=this.triangulation;return u&&s?this.styleAttributeService.createAttributesAndIndices(u,s):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(i){this.layerPickService=i}},{key:"calculateEncodeData",value:function(i,a){return this.inited?UH(this,this.fontService,this.mapService,this.styleAttributeService,i,a):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){this.updateLayerConfig(be(be(be({},this.getDefaultConfig()),this.rawConfig),this.needUpdateConfig));var i=this.getLayerConfig(),a=i.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(i,a,o){return this.updateStyleAttribute("color",i,a,o),this}},{key:"texture",value:function(i,a,o){return this.updateStyleAttribute("texture",i,a,o),this}},{key:"rotate",value:function(i,a,o){return this.updateStyleAttribute("rotate",i,a,o),this}},{key:"size",value:function(i,a,o){return this.updateStyleAttribute("size",i,a,o),this}},{key:"filter",value:function(i,a,o){return this.updateStyleAttribute("filter",i,a,o),this}},{key:"shape",value:function(i,a,o){var u,s,l,f=(u=this.styleAttributeService)===null||u===void 0||(s=u.getLayerStyleAttribute("shape"))===null||s===void 0||(l=s.scale)===null||l===void 0?void 0:l.field,h=i;return this.shapeOption={field:i,values:a},this.updateStyleAttribute("shape",i,a,o),this.tileLayer||$H(this,f,h),this}},{key:"label",value:function(i,a,o){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:a,updateOptions:o}),this}},{key:"animate",value:function(i){var a={};return tt.exports.isObject(i)?(a.enable=!0,a=be(be({},a),i)):a.enable=i,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(i,a){return(i==null?void 0:i.type)==="source"?(this.setSource(i),this):(this.sourceOption={data:i,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(i,a){var o=this;return this.inited?this.layerSource.setData(i,a):this.on("inited",function(){var u=o.getSource();u?o.layerSource.setData(i,a):o.source(new mE(i,a))}),this}},{key:"style",value:function(i){var a=this,o=i.passes,u=la(i,VH);return o&&AM(o).forEach(function(s){var l=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(s[0]);l&&l.updateOptions(s[1])}),this.rawConfig=be(be({},this.rawConfig),u),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(i,a){return tt.exports.isObject(i)?this.scaleOptions=be(be({},this.scaleOptions),i):this.scaleOptions[i]=a,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(),this))}},{key:"renderMultiPass",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){u.next=2;break}return u.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){u.next=7;break}return u.next=5,this.multiPassRenderer.render();case 5:u.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"active",value:function(i){var a={};return a.enableHighlight=tt.exports.isObject(i)?!0:i,tt.exports.isObject(i)?(a.enableHighlight=!0,i.color&&(a.highlightColor=i.color),i.mix&&(a.activeMix=i.mix)):a.enableHighlight=!!i,this.updateLayerConfig(a),this}},{key:"setActive",value:function(i,a){var o=this;if(tt.exports.isObject(i)){var u=i.x,s=u===void 0?0:u,l=i.y,f=l===void 0?0:l;this.updateLayerConfig({highlightColor:tt.exports.isObject(a)?a.color:this.getLayerConfig().highlightColor,activeMix:tt.exports.isObject(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:s,y:f})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:tt.exports.isObject(a)?a.color:this.getLayerConfig().highlightColor,activeMix:tt.exports.isObject(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(ss(i)).then(function(){setTimeout(function(){o.reRender()},1)})}},{key:"select",value:function(i){var a={};return a.enableSelect=tt.exports.isObject(i)?!0:i,tt.exports.isObject(i)?(a.enableSelect=!0,i.color&&(a.selectColor=i.color),i.mix&&(a.selectMix=i.mix)):a.enableSelect=!!i,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(i,a){var o=this;if(tt.exports.isObject(i)){var u=i.x,s=u===void 0?0:u,l=i.y,f=l===void 0?0:l;this.updateLayerConfig({selectColor:tt.exports.isObject(a)?a.color:this.getLayerConfig().selectColor,selectMix:tt.exports.isObject(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:s,y:f})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:tt.exports.isObject(a)?a.color:this.getLayerConfig().selectColor,selectMix:tt.exports.isObject(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(ss(i)).then(function(){setTimeout(function(){o.reRender()},1)})}},{key:"setBlend",value:function(i){return this.updateLayerConfig({blend:i}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(i){this.currentPickId=i}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(i){this.selectedFeatureID=i}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var i=this.mapService.getZoom(),a=this.getLayerConfig(),o=a.visible,u=a.minZoom,s=u===void 0?-1/0:u,l=a.maxZoom,f=l===void 0?1/0:l;return!!o&&i>=s&&i<f}},{key:"setMultiPass",value:function(i,a){if(this.updateLayerConfig({enableMultiPassRenderer:i}),a&&this.updateLayerConfig({passes:a}),i){var o=this.getLayerConfig(),u=o.passes,s=u===void 0?[]:u;this.multiPassRenderer=SM(this,s,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var l=this.rendererService.getViewportSize(),f=l.width,h=l.height;this.multiPassRenderer.resize(f,h)}return this}},{key:"setMinZoom",value:function(i){return this.updateLayerConfig({minZoom:i}),this}},{key:"getMinZoom",value:function(){var i=this.getLayerConfig(),a=i.minZoom;return a}},{key:"getMaxZoom",value:function(){var i=this.getLayerConfig(),a=i.maxZoom;return a}},{key:"get",value:function(i){var a=this.getLayerConfig();return a[i]}},{key:"setMaxZoom",value:function(i){return this.updateLayerConfig({maxZoom:i}),this}},{key:"setAutoFit",value:function(i){return this.updateLayerConfig({autoFit:i}),this}},{key:"fitBounds",value:function(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),o=a.extent,u=o.some(function(s){return Math.abs(s)===1/0});return u?this:(this.mapService.fitBounds([[o[0],o[1]],[o[2],o[3]]],i),this)}},{key:"destroy",value:function(){var i,a,o,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isDestroyed||(this.layerChildren.map(function(s){return s.destroy(!1)}),this.layerChildren=[],this.masks.map(function(s){return s.destroy(!1)}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(i=this.multiPassRenderer)===null||i===void 0||i.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(u),(o=this.tileLayer)===null||o===void 0||o.destroy(),this.models=[],this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var i;this.models.forEach(function(a){return a.destroy()}),(i=this.layerModel)===null||i===void 0||i.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(i){return i.needRescale||i.needRemapping||i.needRegenerateVertices}).length}},{key:"setSource",value:function(i){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var o=this.mapService.getZoom();this.layerSource.updateClusterData(o)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(u){var s=u.type;if(a.coordCenter===void 0){var l,f=a.layerSource.center;a.coordCenter=f,(l=a.mapService)!==null&&l!==void 0&&l.setCoordCenter&&a.mapService.setCoordCenter(f)}s==="update"&&a.sourceEvent()})}},{key:"initSource",value:function(i){this.layerSource=i,this.clusterZoom=0,this.addSourceEvent()}},{key:"getSource",value:function(){return this.layerSource}},{key:"addSourceEvent",value:function(){var i=this;this.layerSource.on("update",function(){if(i.coordCenter===void 0){var a,o=i.layerSource.center;i.coordCenter=o,(a=i.mapService)!==null&&a!==void 0&&a.setCoordCenter&&i.mapService.setCoordCenter(o)}i.sourceEvent()})}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(i){this.encodedData=i,this.encodeDataLength=i.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(i){return this.styleAttributeService.getLayerAttributeScale(i)}},{key:"getLegend",value:function(i){var a,o,u,s=this.styleAttributeService.getLayerStyleAttribute(i),l=(s==null||(a=s.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(o=l[0].option)===null||o===void 0?void 0:o.type,field:s==null||(u=s.scale)===null||u===void 0?void 0:u.field,items:this.getLegendItems(i)}}},{key:"getLegendItems",value:function(i){var a=this.styleAttributeService.getLayerAttributeScale(i);if(!a)return[];if(a.invertExtent){var o=a.range().map(function(l){return T({value:a.invertExtent(l)},i,l)});return o}else if(a.ticks){var u=a.ticks().map(function(l){return T({value:l},i,a(l))});return u}else if(a!=null&&a.domain){var s=a.domain().filter(function(l){return!tt.exports.isUndefined(l)}).map(function(l){return T({value:l},i,a(l))});return s}return[]}},{key:"pick",value:function(i){var a=i.x,o=i.y;this.interactionService.triggerHover({x:a,y:o})}},{key:"boxSelect",value:function(i,a){this.pickingService.boxPickLayer(this,i,a)}},{key:"buildLayerModel",value:function(){var n=Ie(H.mark(function a(o){var u=this,s,l,f,h,d,v,m,y,_,E,S,A,M,O;return H.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return s=o.moduleName,l=o.vertexShader,f=o.fragmentShader,h=o.triangulation,d=o.segmentNumber,v=o.workerEnabled,m=v===void 0?!1:v,y=o.workerOptions,_=la(o,jH),this.shaderModuleService.registerModule(s,{vs:l,fs:f}),E=this.shaderModuleService.getModule(s),S=E.vs,A=E.fs,M=E.uniforms,O=this.rendererService.createModel,q.abrupt("return",new Promise(function(Y,ne){if(y&&y.modelType in I5&&m)u.styleAttributeService.createAttributesAndIndicesAscy(u.encodedData,d,y).then(function(le){var ve=le.attributes,Me=le.elements,Ne=O(be({attributes:ve,uniforms:M,fs:A,vs:S,elements:Me,blend:K1[Fo.normal]},_));Y(Ne)}).catch(function(le){return ne(le)});else{var X=u.styleAttributeService.createAttributesAndIndices(u.encodedData,h,d),$=X.attributes,K=X.elements,ue=X.count,de=be({attributes:$,uniforms:M,fs:A,vs:S,elements:K,blend:K1[Fo.normal]},_);ue&&(de.count=ue);var pe=O(de);Y(pe)}}));case 5:case"end":return q.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"createAttributes",value:function(i){var a=i.triangulation,o=this.styleAttributeService.createAttributes(this.encodedData,a),u=o.attributes;return u}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(i){var a=this.getLayerConfig(),o=a.enableHighlight,u=o===void 0?!0:o,s=a.enableSelect,l=s===void 0?!0:s,f=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&l&&(f=!0),i==="mousemove"&&(u||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(f=!0),this.isVisible()&&f}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return u.stop()}},a)}));function i(){return n.apply(this,arguments)}return i}()},{key:"rebuildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"renderMulPass",value:function(){var n=Ie(H.mark(function a(o){return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.render();case 2:case"end":return s.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"renderModels",value:function(i){var a=this;return this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(o){o.draw({uniforms:a.layerModel.getUninforms()},i)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(i,a,o,u){["color","size","texture","rotate","filter","label","shape"].indexOf(i)!==-1&&this.configService.setAttributeConfig(this.id,T({},i,{field:a,values:o})),this.startInit?this.styleAttributeService.updateStyleAttribute(i,{scale:be({field:a},this.splitValuesAndCallbackInAttribute(o,this.getLayerConfig()[a]))},u):this.pendingStyleAttributes.push({attributeName:i,attributeField:a,attributeValues:o,updateOptions:u})}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(i){console.warn("empty fn")}},{key:"processData",value:function(i){return i}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.models.forEach(function(s){return s.destroy()}),this.models=[],u.next=4,this.layerModel.initModels();case 4:this.models=u.sent;case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(i,a){return{values:tt.exports.isFunction(i)?void 0:i||a,callback:tt.exports.isFunction(i)?i:void 0}}}]),r}(Pa.exports.EventEmitter),dT=wr(R_.prototype,"configService",[pT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_),mT,O_,yT;function qH(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=KH(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function KH(e,t){if(!!e){if(typeof e=="string")return _T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _T(e,t)}}function _T(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rn=(mT=gE(Oe.IGlobalConfigService),O_=function(){function e(t){ke(this,e),Mr(this,"configService",yT,this),this.layer=t,this.rendererService=t.getContainer().get(Oe.IRendererService),this.pickingService=t.getContainer().get(Oe.IPickingService),this.shaderModuleService=t.getContainer().get(Oe.IShaderModuleService),this.styleAttributeService=t.getContainer().get(Oe.IStyleAttributeService),this.mapService=t.getContainer().get(Oe.IMapService),this.iconService=t.getContainer().get(Oe.IIconService),this.fontService=t.getContainer().get(Oe.IFontService),this.cameraService=t.getContainer().get(Oe.ICameraService),this.layerService=t.getContainer().get(Oe.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var r=this.rendererService.createTexture2D;this.createTexture2D=r,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:w.NEAREST,min:w.NEAREST,width:1,height:1}))}return Pe(e,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(r){var n=!1;return tt.exports.isEqual(r.thetaOffset,this.cacheStyleProperties.thetaOffset)||(n=!0,this.cacheStyleProperties.thetaOffset=r.thetaOffset),tt.exports.isEqual(r.opacity,this.cacheStyleProperties.opacity)||(n=!0,this.cacheStyleProperties.opacity=r.opacity),tt.exports.isEqual(r.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(n=!0,this.cacheStyleProperties.strokeOpacity=r.strokeOpacity),tt.exports.isEqual(r.strokeWidth,this.cacheStyleProperties.strokeWidth)||(n=!0,this.cacheStyleProperties.strokeWidth=r.strokeWidth),tt.exports.isEqual(r.stroke,this.cacheStyleProperties.stroke)||(n=!0,this.cacheStyleProperties.stroke=r.stroke),tt.exports.isEqual(r.offsets,this.cacheStyleProperties.offsets)||(n=!0,this.cacheStyleProperties.offsets=r.offsets),this.dataTexture===void 0&&(n=!0),n}},{key:"judgeStyleAttributes",value:function(r){this.clearLastCalRes(),r.opacity!==void 0&&!tt.exports.isNumber(r.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),r.strokeOpacity!==void 0&&!tt.exports.isNumber(r.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),r.strokeWidth!==void 0&&!tt.exports.isNumber(r.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),r.stroke!==void 0&&!this.isStaticColor(r.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),r.offsets!==void 0&&!this.isOffsetStatic(r.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),r.thetaOffset!==void 0&&!tt.exports.isNumber(r.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(r){return tt.exports.isString(r)?!!zc(r):!1}},{key:"getStrokeColor",value:function(r){if(this.isStaticColor(r)){var n=$r(r);return n[0]=n[0]?n[0]:0,n[1]=n[1]?n[1]:0,n[2]=n[2]?n[2]:0,n[3]=n[3]?n[3]:0,n}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(r){return!!(Array.isArray(r)&&r.length===2&&tt.exports.isNumber(r[0])&&tt.exports.isNumber(r[1]))}},{key:"patchMod",value:function(r,n){for(var i=0;i<n;i++)r.push(-1)}},{key:"patchData",value:function(r,n,i){var a=qH(i),o;try{for(a.s();!(o=a.n()).done;){var u=o.value,s=u.attr,l=u.count,f=n[s];f!==void 0?s==="stroke"?r.push.apply(r,It($r(f))):s==="offsets"?this.isOffsetStatic(f)?r.push(-f[0],f[1]):r.push(0,0):r.push(tt.exports.isNumber(f)?f:1):this.patchMod(r,l)}}catch(h){a.e(h)}finally{a.f()}}},{key:"calDataFrame",value:function(r,n,i){for(var a=n.length,o=Math.ceil(a*r/this.DATA_TEXTURE_WIDTH),u=o*this.DATA_TEXTURE_WIDTH,s=[],l=0;l<a;l++){var f=n[l];this.patchData(s,f,i)}for(var h=s.length;h<u;h++)s.push(-1);return{data:s,width:this.DATA_TEXTURE_WIDTH,height:o}}},{key:"getBlend",value:function(){var r=this.layer.getLayerConfig(),n=r.blend,i=n===void 0?"normal":n;return K1[Fo[i]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){var t=Ie(H.mark(function n(){return H.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function r(){return t.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var t=Ie(H.mark(function n(){return H.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function r(){return t.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.duration||4,r.interval||.2,r.trailLength||.1]}},{key:"startModelAnimate",value:function(){var r=this.layer.getLayerConfig(),n=r.animateOption;n.enable&&this.layer.setAnimateStartTime()}}]),e}(),yT=wr(O_.prototype,"configService",[mT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O_),xT;(function(e){e[e.solid=0]="solid",e[e.dash=1]="dash"})(xT||(xT={}));var Fh;(function(e){e.VERTICAL="vertical",e.HORIZONTAL="horizontal"})(Fh||(Fh={}));var Q1;(function(e){e.NORMAL="normal",e.REPLACE="replace"})(Q1||(Q1={}));var ET;(function(e){e.ALWAYS="always",e.DRAGEND="dragend"})(ET||(ET={}));var xE=100;function bT(e){return e/180*Math.acos(-1)}function TM(e){var t=bT(e[0])+Math.PI/2,r=bT(e[1]),n=xE+Math.random()*.4,i=n*Math.cos(r)*Math.cos(t),a=n*Math.cos(r)*Math.sin(t),o=n*Math.sin(r);return[a,o,i]}var Qv=Pr();Pr();var qn=Pr(),nl=Pr(),nh=Pr();function L_(e,t,r,n,i){Pn(e,r,n),xu(e,e),t=Mh(-e[1],e[0]);var a=Mh(-r[1],r[0]);return[i/vl(t,a),t]}function il(e,t){return L5(e,-t[1],t[0])}function ih(e,t,r){return Rh(e,t,r),xu(e,e),e}function F_(e,t){return e[0]===t[0]&&e[1]===t[1]}var QH=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ke(this,e),T(this,"lastFlip",-1),T(this,"miter",Mh(0,0)),T(this,"started",!1),T(this,"dash",!1),T(this,"totalDistance",0),T(this,"currentIndex",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return Pe(e,[{key:"simpleExtrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,o=1;o<i;o++){var u=r[o-1],s=r[o],l=o<r.length-1?r[o+1]:null,f=this.simpleSegment(n,a,u,s,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,o=i.startIndex,u=1;u<a;u++){var s,l,f,h=r[u-1];h.push((s=n[u-1][2])!==null&&s!==void 0?s:0);var d=n[u-1],v=r[u];v.push((l=n[u][2])!==null&&l!==void 0?l:0);var m=n[u],y=u<r.length-1?[].concat(It(r[u+1]),[(f=n[u+1][2])!==null&&f!==void 0?f:0]):null,_=u<n.length-1?n[u+1]:null,E=this.simpleSegment(i,o,h,v,y,d,m,_);o+=E}if(this.dash)for(var S=0;S<i.positions.length/6;S++)i.positions[S*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,o=i.startIndex,u=1;u<a;u++){var s,l,f,h=r[u-1];h.push((s=n[u-1][2])!==null&&s!==void 0?s:0);var d=n[u-1],v=r[u];v.push((l=n[u][2])!==null&&l!==void 0?l:0);var m=n[u],y=u<r.length-1?[].concat(It(r[u+1]),[(f=n[u+1][2])!==null&&f!==void 0?f:0]):null,_=u<n.length-1?n[u+1]:null,E=this.segment_gaode2(i,o,h,v,y,d,m,_);o+=E}if(this.dash)for(var S=0;S<i.positions.length/6;S++)i.positions[S*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,o=1;o<i;o++){var u=r[o-1],s=r[o],l=o<r.length-1?r[o+1]:null,f=this.segment(n,a,u,s,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleSegment",value:function(r,n,i,a,o){var u=0,s=r.indices,l=r.positions,f=r.normals,h=ci([a[0],a[1]]),d=ci([i[0],i[1]]);ih(qn,h,d);var v=0;if(this.dash&&(v=this.lineSegmentDistance(h,d),this.totalDistance+=v),this.normal||(this.normal=Pr(),il(this.normal,qn)),this.started||(this.started=!0,this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-v)),s.push(n+0,n+1,n+2),!o)il(this.normal,qn),this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance),s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),u+=2;else{var m=ci([o[0],o[1]]);F_(h,m)&&Pn(m,h,xu(m,Nc(m,h,d))),ih(nl,m,h);var y=L_(nh,Pr(),qn,nl,this.thickness),_=ir(y,2),E=_[0],S=_[1],A=vl(nh,this.normal)<0?-1:1;this.extrusions(l,f,a,S,E,this.totalDistance),s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),A=-1,gu(this.normal,S),u+=2,this.lastFlip=A}return u}},{key:"segment_gaode2",value:function(r,n,i,a,o,u,s,l){var f=0,h=r.indices,d=r.positions,v=r.normals,m=this.cap==="square",y=this.join==="bevel",_=ci([s[0],s[1]]),E=ci([u[0],u[1]]);ih(qn,a,i);var S=0;if(this.dash&&(S=this.lineSegmentDistance(_,E),this.totalDistance+=S),this.normal||(this.normal=Pr(),il(this.normal,qn)),!this.started)if(this.started=!0,m){var A=Pr(),M=Pr();Pn(A,this.normal,qn),Pn(M,this.normal,qn),v.push(M[0],M[1],0),v.push(A[0],A[1],0),d.push(i[0],i[1],i[2]|0,this.totalDistance-S,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),d.push(i[0],i[1],i[2]|0,this.totalDistance-S,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,v,i,this.normal,this.thickness,this.totalDistance-S);if(h.push(n+0,n+1,n+2),o){F_(a,o)&&Pn(o,a,xu(o,Nc(o,a,i))),ih(nl,o,a);var q=L_(nh,Pr(),qn,nl,this.thickness),Y=ir(q,2),ne=Y[0],X=Y[1],$=vl(nh,this.normal)<0?-1:1,K=y;if(!K&&this.join==="miter"){var ue=ne;ue>this.miterLimit&&(K=!0)}K?(v.push(this.normal[0],this.normal[1],0),v.push(X[0],X[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*$,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*$,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,h.push.apply(h,It(this.lastFlip!==-$?[n,n+2,n+3]:[n+2,n+1,n+3])),h.push(n+2,n+3,n+4),il(Qv,nl),gu(this.normal,Qv),v.push(this.normal[0],this.normal[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*$,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f+=3):(this.extrusions(d,v,a,X,ne,this.totalDistance),h.push.apply(h,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),$=-1,gu(this.normal,X),f+=2),this.lastFlip=$}else{if(il(this.normal,qn),m){var O=Pr(),j=Pr();Rh(j,qn,this.normal),Pn(O,qn,this.normal),v.push(j[0],j[1],0),v.push(O[0],O[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,v,a,this.normal,this.thickness,this.totalDistance);h.push.apply(h,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),f+=2}return f}},{key:"segment",value:function(r,n,i,a,o){var u=0,s=r.indices,l=r.positions,f=r.normals,h=this.cap==="square",d=this.join==="bevel",v=ci([a[0],a[1]]),m=ci([i[0],i[1]]);ih(qn,v,m);var y=0;if(this.dash&&(y=this.lineSegmentDistance(v,m),this.totalDistance+=y),this.normal||(this.normal=Pr(),il(this.normal,qn)),!this.started)if(this.started=!0,h){var _=Pr(),E=Pr();Pn(_,this.normal,qn),Pn(E,this.normal,qn),f.push(E[0],E[1],0),f.push(_[0],_[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance-y,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),l.push(i[0],i[1],i[2]|0,this.totalDistance-y,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-y);if(s.push(n+0,n+1,n+2),o){var M=ci([o[0],o[1]]);F_(v,M)&&Pn(M,v,xu(M,Nc(M,v,m))),ih(nl,M,v);var O=L_(nh,Pr(),qn,nl,this.thickness),j=ir(O,2),q=j[0],Y=j[1],ne=vl(nh,this.normal)<0?-1:1,X=d;if(!X&&this.join==="miter"){var $=q;$>this.miterLimit&&(X=!0)}X?(f.push(this.normal[0],this.normal[1],0),f.push(Y[0],Y[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ne,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ne,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s.push.apply(s,It(this.lastFlip!==-ne?[n,n+2,n+3]:[n+2,n+1,n+3])),s.push(n+2,n+3,n+4),il(Qv,nl),gu(this.normal,Qv),f.push(this.normal[0],this.normal[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ne,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u+=3):(this.extrusions(l,f,a,Y,q,this.totalDistance),s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ne=-1,gu(this.normal,Y),u+=2),this.lastFlip=ne}else{if(il(this.normal,qn),h){var S=Pr(),A=Pr();Rh(A,qn,this.normal),Pn(S,qn,this.normal),f.push(A[0],A[1],0),f.push(S[0],S[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance);s.push.apply(s,It(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),u+=2}return u}},{key:"extrusions",value:function(r,n,i,a,o,u){n.push(a[0],a[1],0),n.push(a[0],a[1],0),r.push(i[0],i[1],i[2]|0,u,-o,i[2]|0),this.complex.indexes.push(this.currentIndex),r.push(i[0],i[1],i[2]|0,u,o,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(r,n){var i=n[0]-r[0],a=n[1]-r[1];return Math.sqrt(i*i+a*a)}}]),e}();function wM(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,a=Eu.exports.flatten(e),o=a.vertices,u=a.dimensions,s=[],l=[],f=[],h=0;h<o.length/u;h++)u===2?s.push(o[h*2],o[h*2+1],1,-1,-1):s.push(o[h*3],o[h*3+1],1,-1,-1),f.push(0,0,1);var d=Eu.exports(a.vertices,a.holes,a.dimensions);l.push.apply(l,It(d));for(var v=function(_){var E=a.vertices.slice(_*u,(_+1)*u),S=a.vertices.slice((_+1)*u,(_+2)*u);S.length===0&&(S=a.vertices.slice(0,u));var A=s.length/5;s.push(E[0],E[1],1,0,0,S[0],S[1],1,.1,0,E[0],E[1],0,0,.8,S[0],S[1],0,.1,.8);var M=JH([S[0],S[1],1],[E[0],E[1],0],[E[0],E[1],1],t);f.push.apply(f,It(M).concat(It(M),It(M),It(M))),l.push.apply(l,It([1,2,0,3,2,1].map(function(O){return O+A})))},m=0;m<i;m++)v(m);return{positions:s,index:l,normals:f}}function JH(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=hh(),a=hh(),o=hh();n&&(e=r_(e),t=r_(t),r=r_(r));var u=fi.apply(_h,It(e)),s=fi.apply(_h,It(t)),l=fi.apply(_h,It(r));A1(i,l,s),A1(a,u,s),R5(o,i,a);var f=hh();return ph(f,o),f}var qa,Oc;(function(e){e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn"})(Oc||(Oc={}));var Lc;(function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon"})(Lc||(Lc={}));function m0(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=Math.PI*2/e,n=[],i=0;i<e;i++)n.push(r*i+t*Math.PI/12);var a=n.map(function(o){var u=Math.sin(o+Math.PI/4),s=Math.cos(o+Math.PI/4);return[u,s,0]});return a}function CT(){return m0(30)}function AT(){return m0(4)}function ST(){return m0(3)}function TT(){return m0(6,1)}function wT(){return m0(5)}var I_=(qa={},T(qa,Lc.CIRCLE,CT),T(qa,Lc.HEXAGON,TT),T(qa,Lc.TRIANGLE,ST),T(qa,Lc.SQUARE,AT),T(qa,Lc.PENTAGON,wT),T(qa,Oc.CYLINDER,CT),T(qa,Oc.HEXAGONCOLUMN,TT),T(qa,Oc.TRIANGLECOLUMN,ST),T(qa,Oc.SQUARECOLUMN,AT),T(qa,Oc.PENTAGONCOLUMN,wT),qa),Jv={};function Uc(e){var t=oo(e.coordinates);return{vertices:[].concat(It(t),It(t),It(t),It(t)),indices:[0,1,2,2,3,0],size:t.length}}function MT(e){var t=oo(e.coordinates),r=TM(t);return{vertices:[].concat(It(r),It(r),It(r),It(r)),indices:[0,1,2,2,3,0],size:r.length}}function MM(e){var t=e.shape,r=oV(t,!1),n=r.positions,i=r.index,a=r.normals;return{vertices:n,indices:i,normals:a,size:5}}function eV(e){var t=oo(e.coordinates);return{vertices:It(t),indices:[0],size:t.length}}function jc(e){var t=e.coordinates,r=e.originCoordinates,n=e.version,i=new QH({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=t;Array.isArray(a[0][0])||(a=[t]);var o=r;Array.isArray(o[0][0])||(o=[r]);for(var u=0;u<a.length;u++){var s=a[u],l=o[u];i.extrude_gaode2(s,l)}}else{var f=t;f[0]&&!Array.isArray(f[0][0])&&(f=[t]),f.forEach(function(d){i.extrude(d)})}var h=i.complex;return{vertices:h.positions,indices:h.indices,normals:h.normals,indexes:h.indexes,size:6}}function tV(e){var t=e.coordinates,r=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var n=rV(t),i=n.results,a=n.totalDistance;return i.map(function(o){r.push(o[0],o[1],o[2],o[3],0,a)}),{vertices:r,indices:[],normals:[],size:6,count:i.length}}function RT(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function k_(e,t){return e.length<3&&e.push(0),t!==void 0&&e.push(t),e}function rV(e){var t=e;Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=e.flat());var r=0;if(t.length<2)return{results:t,totalDistance:0};var n=[],i=k_(t[0],r);n.push(i);for(var a=1;a<t.length-1;a++){var o=RT(t[a-1],t[a]);r+=o;var u=k_(t[a],r);n.push(u),n.push(u)}var s=RT(t[t.length-2],t[t.length-1]);return r+=s,n.push(k_(t[t.length-1],r)),{results:n,totalDistance:r}}function i0(e){var t=e.coordinates,r=Eu.exports.flatten(t),n=r.vertices,i=r.dimensions,a=r.holes;return{indices:Eu.exports(n,a,i),vertices:n,size:i}}function nV(e){var t=e.coordinates,r=Eu.exports.flatten(t),n=r.vertices,i=r.dimensions,a=r.holes;return{indices:Eu.exports(n,a,i),vertices:iV(n),size:i+4}}function iV(e){for(var t=[],r=Wk(e),n=r.center,i=r.radius,a=0;a<e.length;a+=2){var o=e[a],u=e[a+1];t.push.apply(t,[o,u,0].concat(It(n),[i]))}return t}function aV(e){var t=e.coordinates,r=wM(t,!0),n=r.positions,i=r.index,a=r.normals;return{vertices:n,indices:i,normals:a,size:5}}function wm(e){var t=e.coordinates,r=[].concat(It(t[0]),[0,0,1,t[1][0],t[0][1],0,1,1],It(t[1]),[0,1,0],It(t[0]),[0,0,1],It(t[1]),[0,1,0,t[0][0],t[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:r,indices:n,size:5}}function Mm(e,t){for(var r=t||30,n=e.coordinates,i=[],a=[],o=function(l){i.push(l,1,l,n[0][0],n[0][1],n[1][0],n[1][1],l,-1,l,n[0][0],n[0][1],n[1][0],n[1][1]),l!==r-1&&a.push.apply(a,It([0,1,2,1,3,2].map(function(f){return l*2+f})))},u=0;u<r;u++)o(u);return{vertices:i,indices:a,size:7}}function oV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Jv&&Jv[e])return Jv[e];var r=I_[e]?I_[e]():I_.cylinder(),n=wM([r],t);return Jv[e]=n,n}function uV(e){var t=sV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function sV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var lV=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,cV=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,fV=function(e){Ut(r,e);var t=uV(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o=this,u,s,l,f,h,d,v,m,y,_,E;return H.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(u=this.layer.getLayerConfig(),s=u.mask,l=s===void 0?!1:s,f=u.maskInside,h=f===void 0?!0:f,d=this.layer.getSource(),v=this.rendererService.createTexture2D,this.texture=v({height:0,width:0}),!Fa){A.next=12;break}m=this.layerService.sceneService.getSceneConfig().canvas,y=m.createImage(),y.crossOrigin="anonymous",y.src=d.data.originData,y.onload=function(){o.texture=v({data:y,width:y.width,height:y.height}),o.layerService.reRender()},A.next=16;break;case 12:return A.next=14,d.data.images;case 14:_=A.sent,this.texture=v({data:_[0],width:_[0].width,height:_[0].height,mag:w.LINEAR,min:w.LINEAR});case 16:return A.next=18,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:cV,fragmentShader:lV,triangulation:wm,primitive:w.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:vn(l,h)});case 18:return E=A.sent,A.abrupt("return",[E]);case 20:case"end":return A.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_Uv",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),r}(rn),hV={image:fV};const pV=hV;function dV(e){var t=vV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function vV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gV=function(e){Ut(r,e);var t=dV(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"type","ImageLayer"),n}return Pe(r,[{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new pV[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={image:{}};return a[i]}},{key:"getModelType",value:function(){return"image"}}]),r}(Vh);function mV(e){var t=yV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function yV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _V=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,xV=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,EV=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,bV=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  float arcThetaOffset = styleMappingMat[0][1];
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,CV=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,AV=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,SV={solid:0,dash:1},TV=function(e){Ut(r,e);var t=mV(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,d=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,y=i.forward,_=y===void 0?!0:y,E=i.lineTexture,S=E===void 0?!1:E,A=i.iconStep,M=A===void 0?100:A,O=i.segmentNumber,j=O===void 0?30:O,q=i.thetaOffset,Y=q===void 0?.314:q;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,thetaOffset:Y})){this.judgeStyleAttributes({opacity:o,thetaOffset:Y});var ne=this.layer.getEncodedData(),X=this.calDataFrame(this.cellLength,ne,this.cellProperties),$=X.data,K=X.width,ue=X.height;this.rowCount=ue,this.dataTexture=this.cellLength>0&&$.length>0?this.createTexture2D({flipY:!0,data:$,format:w.LUMINANCE,type:w.FLOAT,width:K,height:ue}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}m.length===2&&m.push(0,0);var de=0,pe=[0,0,0,0],le=[0,0,0,0];return u&&s&&(pe=$r(u),le=$r(s),de=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:tt.exports.isNumber(Y)?Y:0,u_opacity:tt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:j,u_line_type:SV[d||"solid"],u_dash_array:m,u_blur:.9,u_lineDir:_?1:-1,u_texture:this.texture,u_line_texture:S?1:0,u_icon_step:M,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:de,u_sourceColor:pe,u_targetColor:le}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.next=4,this.buildModels();case 4:return u.abrupt("return",u.sent);case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor,u=i.lineType;return u==="dash"?{frag:_V,vert:xV,type:"Dash"}:a&&o?{frag:CV,vert:AV,type:"Linear"}:{frag:EV,vert:bV,type:""}}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E;return H.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return o=this.layer.getLayerConfig(),u=o.segmentNumber,s=u===void 0?30:u,l=o.mask,f=l===void 0?!1:l,h=o.maskInside,d=h===void 0?!0:h,v=this.getShaders(),m=v.frag,y=v.vert,_=v.type,A.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+_,vertexShader:y,fragmentShader:m,triangulation:Mm,depth:{enable:!1},blend:this.getBlend(),segmentNumber:s,stencil:vn(f,d)});case 4:return E=A.sent,A.abrupt("return",[E]);case 6:case"end":return A.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ft.Attribute,descriptor:{name:"a_Instance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn);function wV(e){var t=MV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function MV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var RV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,OV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,LV=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,FV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,IV={solid:0,dash:1},kV=function(e){Ut(r,e);var t=wV(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,d=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,y=i.lineTexture,_=y===void 0?!1:y,E=i.iconStep,S=E===void 0?100:E,A=i.segmentNumber,M=A===void 0?30:A,O=i.globalArcHeight,j=O===void 0?10:O;m.length===2&&m.push(0,0);var q=0,Y=[0,0,0,0],ne=[0,0,0,0];if(u&&s&&(Y=$r(u),ne=$r(s),q=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var X=this.layer.getEncodedData(),$=this.calDataFrame(this.cellLength,X,this.cellProperties),K=$.data,ue=$.width,de=$.height;this.rowCount=de,this.dataTexture=this.cellLength>0&&K.length>0?this.createTexture2D({flipY:!0,data:K,format:w.LUMINANCE,type:w.FLOAT,width:ue,height:de}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:xE,u_global_height:j,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:M,u_line_type:IV[d]||0,u_dash_array:m,u_texture:this.texture,u_line_texture:_?1:0,u_icon_step:S,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:q,u_sourceColor:Y,u_targetColor:ne}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.next=4,this.buildModels();case 4:return u.abrupt("return",u.sent);case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor;return a&&o?{frag:LV,vert:FV,type:"Linear"}:{frag:RV,vert:OV,type:""}}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E;return H.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return o=this.layer.getLayerConfig(),u=o.segmentNumber,s=u===void 0?30:u,l=o.mask,f=l===void 0?!1:l,h=o.maskInside,d=h===void 0?!0:h,v=this.getShaders(),m=v.frag,y=v.vert,_=v.type,A.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+_,vertexShader:y,fragmentShader:m,triangulation:Mm,blend:this.getBlend(),segmentNumber:s,stencil:vn(f,d)});case 4:return E=A.sent,A.abrupt("return",[E]);case 6:case"end":return A.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ft.Attribute,descriptor:{name:"a_Instance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn);function PV(e){var t=DV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function DV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var BV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,NV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,UV=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,zV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,$V={solid:0,dash:1},GV=function(e){Ut(r,e);var t=PV(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,d=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,y=i.lineTexture,_=y===void 0?!1:y,E=i.iconStep,S=E===void 0?100:E,A=i.segmentNumber,M=A===void 0?30:A,O=i.globalArcHeight,j=O===void 0?10:O;m.length===2&&m.push(0,0);var q=0,Y=[0,0,0,0],ne=[0,0,0,0];if(u&&s&&(Y=$r(u),ne=$r(s),q=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var X=this.layer.getEncodedData(),$=this.calDataFrame(this.cellLength,X,this.cellProperties),K=$.data,ue=$.width,de=$.height;this.rowCount=de,this.dataTexture=this.cellLength>0&&K.length>0?this.createTexture2D({flipY:!0,data:K,format:w.LUMINANCE,type:w.FLOAT,width:ue,height:de}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:xE,u_global_height:j,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:M,u_line_type:$V[d]||0,u_dash_array:m,u_texture:this.texture,u_line_texture:_?1:0,u_icon_step:S,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:q,u_sourceColor:Y,u_targetColor:ne}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.next=4,this.buildModels();case 4:return u.abrupt("return",u.sent);case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor;return a&&o?{frag:UV,vert:zV,type:"Linear"}:{frag:BV,vert:NV,type:""}}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E;return H.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return o=this.layer.getLayerConfig(),u=o.segmentNumber,s=u===void 0?30:u,l=o.mask,f=l===void 0?!1:l,h=o.maskInside,d=h===void 0?!0:h,v=this.getShaders(),m=v.frag,y=v.vert,_=v.type,A.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+_,vertexShader:y,fragmentShader:m,triangulation:Mm,depth:{enable:!0},blend:this.getBlend(),segmentNumber:s,stencil:vn(f,d)});case 4:return E=A.sent,A.abrupt("return",[E]);case 6:case"end":return A.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ft.Attribute,descriptor:{name:"a_Instance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn);function HV(e){var t=VV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function VV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,WV=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,XV={solid:0,dash:1},YV=function(e){Ut(r,e);var t=HV(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,d=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,y=i.lineTexture,_=y===void 0?!1:y,E=i.iconStep,S=E===void 0?100:E,A=i.segmentNumber,M=A===void 0?30:A;m.length===2&&m.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var O=0,j=[0,0,0,0],q=[0,0,0,0];if(u&&s&&(j=$r(u),q=$r(s),O=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var Y=this.layer.getEncodedData(),ne=this.calDataFrame(this.cellLength,Y,this.cellProperties),X=ne.data,$=ne.width,K=ne.height;this.rowCount=K,this.dataTexture=this.cellLength>0&&X.length>0?this.createTexture2D({flipY:!0,data:X,format:w.LUMINANCE,type:w.FLOAT,width:$,height:K}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:M,u_line_type:XV[d]||0,u_dash_array:m,u_texture:this.texture,u_line_texture:_?1:0,u_icon_step:S,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:O,u_sourceColor:j,u_targetColor:q}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.next=4,this.buildModels();case 4:return u.abrupt("return",u.sent);case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,v.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:WV,fragmentShader:jV,triangulation:Mm,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f)});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ft.Attribute,descriptor:{name:"a_Instance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn);function ZV(e){var t=qV();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function qV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var KV=`#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
uniform float u_CoordinateSystem;
varying vec4 v_color;
uniform float u_arrow: 0.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

varying mat4 styleMappingMat;
void main() {
  float distanceAndIndex = styleMappingMat[0][3];
  float miter = styleMappingMat[0][2];

  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B


  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { 
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap
        discard;
      }
    } else { // amap2 mapbox map
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { 
        discard;
      }
    }
  } else { // line body
    if(miter < 0.0) {
      discard;
    }
  }


  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,QV=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute vec4 a_dirPoints;
attribute vec3 a_DistanceAndIndex;

uniform vec4 u_lineDir;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex
    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );
  styleMappingMat[0][3] = a_DistanceAndIndex.y;
  styleMappingMat[0][2] = a_Miter;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97


  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  // styleMappingMat[1].rg = a_Position.xy + offset;

  vec2 copyOffset = vec2(offset.x, offset.y);

  float lineDistance = a_DistanceAndIndex.x;
  float total_Distance = a_DistanceAndIndex.z;
  float currentLinePointRatio = lineDistance / total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z); // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }
  
  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {
    vec2 startPoint = a_dirPoints.rg;
    vec2 endPoint = a_dirPoints.ba;
    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));
    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));
    // TODO\uFF1A \u540E\u7EED\u4F18\u5316\u53EF\u4EE5\u628A\u4F4D\u7F6E\u8BA1\u7B97\u653E\u5728 cpu \u4E2D\u5B8C\u6210
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    } else {
      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    }
  }

  setPickingColor(a_PickingColor);
}
`,JV=function(e){Ut(r,e);var t=ZV(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.arrow,f=l===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:l,h=0,d=[0,0,0,0],v=[0,0,0,0];if(u&&s&&(d=$r(u),v=$r(s),h=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var m=this.layer.getEncodedData(),y=this.calDataFrame(this.cellLength,m,this.cellProperties),_=y.data,E=y.width,S=y.height;this.rowCount=S,this.dataTexture=this.cellLength>0&&_.length>0?this.createTexture2D({flipY:!0,data:_,format:w.LUMINANCE,type:w.FLOAT,width:E,height:S}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_linearColor:h,u_sourceColor:d,u_targetColor:v,u_arrow:Number(f.enable),u_arrowHeight:f.arrowHeight||3,u_arrowWidth:f.arrowWidth||2,u_tailWidth:f.tailWidth===void 0?1:f.tailWidth}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_;return H.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.depth,d=h===void 0?!1:h,v=this.getShaders(),m=v.frag,y=v.vert,this.layer.triangulation=jc,S.next=5,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:y,fragmentShader:m,triangulation:jc,depth:{enable:d},blend:this.getBlend(),stencil:vn(s,f)});case 5:return _=S.sent,S.abrupt("return",[_]);case 7:case"end":return S.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){return{frag:KV,vert:QV,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ft.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a,o,u,s,l,f){return f===void 0?[u[3],10,u[5]]:[u[3],f,u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:Ft.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:4,update:function(a){var o=a.coordinates[0]||[0,0],u=a.coordinates[3]||[0,0];return[o[0],o[1],u[0],u[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ft.Attribute,descriptor:{name:"a_Miter",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a,o,u){return[u[4]]}}})}}]),r}(rn);function ej(e){var t=tj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function tj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rj=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,nj=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,ij=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = styleMappingMat[3][3];
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,OT=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,aj=`varying vec4 v_color;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3][0]; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,oj={solid:0,dash:1},RM=function(e){Ut(r,e);var t=ej(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"texture",n.createTexture2D({data:[0,0,0,0],mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1,height:1})),T(re(n),"dataTexture",n.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,d=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5,0,0]:v,y=i.lineTexture,_=y===void 0?!1:y,E=i.iconStep,S=E===void 0?100:E,A=i.vertexHeightScale,M=A===void 0?20:A,O=i.borderWidth,j=O===void 0?0:O,q=i.borderColor,Y=q===void 0?"#ccc":q,ne=i.raisingHeight,X=ne===void 0?0:ne,$=i.heightfixed,K=$===void 0?!1:$,ue=i.linearDir,de=ue===void 0?Fh.VERTICAL:ue,pe=i.blur,le=pe===void 0?[1,1,1]:pe,ve=i.arrow,Me=ve===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:ve;m.length===2&&m.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var Ne=0,Xe=[0,0,0,0],ct=[0,0,0,0];if(u&&s&&(Xe=$r(u),ct=$r(s),Ne=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var $t=this.layer.getEncodedData(),Qt=this.calDataFrame(this.cellLength,$t,this.cellProperties),Zt=Qt.data,jt=Qt.width,Cr=Qt.height;this.rowCount=Cr,this.dataTexture=this.cellLength>0&&Zt.length>0?this.createTexture2D({flipY:!0,data:Zt,format:w.LUMINANCE,type:w.FLOAT,width:jt,height:Cr}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_textureBlend:f===Q1.NORMAL?0:1,u_line_type:oj[d],u_dash_array:m,u_blur:le,u_texture:this.texture,u_line_texture:_?1:0,u_icon_step:S,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:j,u_borderColor:$r(Y),u_linearDir:de===Fh.VERTICAL?1:0,u_linearColor:Ne,u_sourceColor:Xe,u_targetColor:ct,u_heightfixed:Number(K),u_vertexScale:M,u_raisingHeight:Number(X),u_arrow:Number(Me.enable),u_arrowHeight:Me.arrowHeight||3,u_arrowWidth:Me.arrowWidth||2,u_tailWidth:Me.tailWidth===void 0?1:Me.tailWidth}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E,S,A,M;return H.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.depth,d=h===void 0?!1:h,v=o.workerEnabled,m=v===void 0?!1:v,y=o.enablePicking,_=this.getShaders(),E=_.frag,S=_.vert,A=_.type,this.layer.triangulation=S1,j.next=5,this.layer.buildLayerModel({moduleName:"line"+A,vertexShader:S,fragmentShader:E,triangulation:S1,depth:{enable:d},blend:this.getBlend(),stencil:vn(s,f),workerEnabled:m,workerOptions:{modelType:"line"+A,enablePicking:y,iconMap:this.iconService.getIconMap()}});case 5:return M=j.sent,j.abrupt("return",[M]);case 7:case"end":return j.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor,u=i.lineType;return u==="dash"?{frag:rj,vert:nj,type:"Dash"}:a&&o?{frag:aj,vert:OT,type:"Linear"}:{frag:ij,vert:OT,type:""}}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ft.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o,u,s,l,f,h){return h===void 0?[s[3],10]:[s[3],h]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ft.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o,u,s){return[s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l,f){return f}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ft.Attribute,descriptor:{name:"a_Miter",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o,u,s){return[s[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn);function uj(e){var t=sj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function sj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var lj=`uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;

#pragma include "picking"

varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,cj=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "picking"

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,fj=function(e){Ut(r,e);var t=uj(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;n.colorTexture&&n.colorTexture.destroy();var s=n.layer.getLayerConfig(),l=s.rampColors,f=Yx(l);n.colorTexture=u({data:new Uint8Array(f.data),width:f.width,height:f.height,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE,min:w.NEAREST,mag:w.NEAREST,flipY:!1})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.vertexHeightScale,s=u===void 0?20:u,l=i.raisingHeight,f=l===void 0?0:l,h=i.heightfixed,d=h===void 0?!1:h,v=i.linearDir,m=v===void 0?Fh.VERTICAL:v;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var y=this.layer.getEncodedData(),_=this.calDataFrame(this.cellLength,y,this.cellProperties),E=_.data,S=_.width,A=_.height;this.rowCount=A,this.dataTexture=this.cellLength>0&&E.length>0?this.createTexture2D({flipY:!0,data:E,format:w.LUMINANCE,type:w.FLOAT,width:S,height:A}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:m===Fh.VERTICAL?1:0,u_opacity:tt.exports.isNumber(o)?o:1,u_texture:this.colorTexture,u_heightfixed:Number(d),u_vertexScale:s,u_raisingHeight:Number(f)}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),u.next=3,this.buildModels();case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.colorTexture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy()}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v;return H.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.depth,d=h===void 0?!1:h,this.layer.triangulation=jc,y.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:cj,fragmentShader:lj,triangulation:jc,depth:{enable:d},blend:this.getBlend(),stencil:vn(s,f)});case 4:return v=y.sent,y.abrupt("return",[v]);case 6:case"end":return y.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ft.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u,s,l,f){return f===void 0?[u[3],10]:[u[3],f]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ft.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a,o,u){return[u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ft.Attribute,descriptor:{name:"a_Miter",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a,o,u){return[u[4]]}}})}}]),r}(rn);function hj(e){var t=pj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function pj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dj=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,vj=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];

  // styleMappingMat[3][0] \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,LT=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  v_color = a_Color; 
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,gj=function(e){Ut(r,e);var t=hj(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.vertexHeightScale,f=l===void 0?20:l,h=0,d=[0,0,0,0],v=[0,0,0,0];if(u&&s&&(d=$r(u),v=$r(s),h=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var m=this.layer.getEncodedData(),y=this.calDataFrame(this.cellLength,m,this.cellProperties),_=y.data,E=y.width,S=y.height;this.rowCount=S,this.dataTexture=this.cellLength>0&&_.length>0?this.createTexture2D({flipY:!0,data:_,format:w.LUMINANCE,type:w.FLOAT,width:E,height:S}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_linearColor:h,u_sourceColor:d,u_targetColor:v,u_vertexScale:f}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor;return a&&o?{frag:vj,vert:LT,type:"lineSimpleLinear"}:{frag:dj,vert:LT,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y;return H.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=this.getShaders(),d=h.frag,v=h.vert,m=h.type,E.next=4,this.layer.buildLayerModel({moduleName:m,vertexShader:v,fragmentShader:d,triangulation:tV,primitive:w.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f),pick:!1});case 4:return y=E.sent,E.abrupt("return",[y]);case 6:case"end":return E.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Ft.Attribute,descriptor:{name:"a_Distance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a,o,u){return[u[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ft.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a,o,u){return[u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}})}}]),r}(rn);function mj(e){var t=yj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function yj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _j=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,xj=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;


#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

void main() {
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // if(u_coord > 0.0) { // \u4F7F\u7528\u7ECF\u7EAC\u5EA6\u5750\u6807
      if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
  // } else { // \u4F7F\u7528\u504F\u79FB\u5750\u6807
  //   vec2 pointPos = a_Position.xy;
  //   vec4 tileWorld = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   tileWorld.xy += pointOffset;

  //   tileWorld.xy += offset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     tileWorld.w *= u_PixelsPerMeter.z;
  //   }
  //   gl_Position = u_ViewProjectionMatrix * tileWorld + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}
`,Ej=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,bj=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_size;

#pragma include "projection"

void main() {

  vec3 size = a_Miter * u_size * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
}
`,Cj=function(e){Ut(r,e);var t=mj(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.usage,s=i.color,l=s===void 0?"#fff":s,f=i.size,h=f===void 0?1:f;return{u_opacity:Number(o),u_color:u==="basemap"?$r(l):[0,0,0,0],u_size:u==="basemap"?h:1}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m;return H.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.depth,d=h===void 0?!1:h,v=o.usage,this.layer.triangulation=jc,_.next=4,this.layer.buildLayerModel({moduleName:"lineTile_"+v,vertexShader:v==="basemap"?bj:xj,fragmentShader:v==="basemap"?Ej:_j,triangulation:jc,blend:this.getBlend(),depth:{enable:d},stencil:vn(s,f),pick:v!=="basemap"});case 4:return m=_.sent,_.abrupt("return",[m]);case 6:case"end":return _.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.usage;a!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(u){var s=u.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(u,s,l,f,h){return h}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ft.Attribute,descriptor:{name:"a_Miter",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(u,s,l){return[l[4]]}}})}}]),r}(rn);function Aj(e){var t=Sj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Sj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Tj=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,wj=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Mj=function(e){Ut(r,e);var t=Aj(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.NEAREST,min:w.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.sourceColor,s=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.heightfixed,d=h===void 0?!1:h,v=i.lineTexture,m=v===void 0?!1:v,y=i.iconStep,_=y===void 0?100:y,E=i.iconStepCount,S=E===void 0?1:E;this.rendererService.getDirty()&&this.texture.bind();var A=0,M=[0,0,0,0],O=[0,0,0,0];return u&&s&&(M=$r(u),O=$r(s),A=1),{u_heightfixed:Number(d),u_opacity:tt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,u_texture:this.texture,u_line_texture:m?1:0,u_iconStepCount:S,u_icon_step:_,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:A,u_sourceColor:M,u_targetColor:O}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.next=4,this.buildModels();case 4:return u.abrupt("return",u.sent);case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:wj,fragmentShader:Tj,triangulation:jc,depth:{enable:!1},blend:this.getBlend()});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Ft.Attribute,descriptor:{name:"a_Distance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o,u,s){return[s[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ft.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o,u,s){return[s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l,f){return f}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ft.Attribute,descriptor:{name:"a_Miter",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o,u,s){return[s[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn),Rj={arc:TV,arc3d:kV,greatcircle:YV,wall:Mj,line:RM,halfLine:JV,simple:gj,linearline:fj,tileLine:Cj,earthArc3d:GV};const Oj=Rj;function Lj(e){var t=Fj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Fj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var EE=function(e){Ut(r,e);var t=Lj(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"type","LineLayer"),T(re(n),"arrowInsertCount",0),T(re(n),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),n}return Pe(r,[{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new Oj[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},halfLine:{},earthArc3d:{}};return a[i]}},{key:"getModelType",value:function(){var i;if(this.layerType)return this.layerType;var a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;return o||"line"}},{key:"processData",value:function(i){if(this.getModelType()!=="simple")return i;var a=[];return i.map(function(o){if(Array.isArray(o.coordinates)&&Array.isArray(o.coordinates[0])&&Array.isArray(o.coordinates[0][0])){var u=be({},o);o.coordinates.map(function(s){a.push(be(be({},u),{},{coordinates:s}))})}else a.push(o)}),a}}]),r}(Vh);function Ij(e){var t=kj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function kj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Pj=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Dj=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,Bj=function(e){Ut(r,e);var t=Ij(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"raiseCount",0),T(re(n),"raiseRepeat",0),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,u=i.opacity,s=u===void 0?1:u,l=i.sourceColor,f=i.targetColor,h=i.pickLight,d=h===void 0?!1:h,v=i.heightfixed,m=v===void 0?!1:v,y=i.opacityLinear,_=y===void 0?{enable:!1,dir:"up"}:y,E=i.lightEnable,S=E===void 0?!0:E;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var A=this.layer.getEncodedData(),M=this.calDataFrame(this.cellLength,A,this.cellProperties),O=M.data,j=M.width,q=M.height;this.rowCount=q,this.dataTexture=this.cellLength>0&&O.length>0?this.createTexture2D({flipY:!0,data:O,format:w.LUMINANCE,type:w.FLOAT,width:j,height:q}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}var Y=0,ne=[0,0,0,0],X=[0,0,0,0];if(l&&f&&(ne=$r(l),X=$r(f),Y=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){var $=o.speed,K=$===void 0?.01:$;this.raiseCount+=K,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(d),u_heightfixed:Number(m),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(s)?s:1,u_linearColor:Y,u_sourceColor:ne,u_targetColor:X,u_opacitylinear:Number(_.enable),u_opacitylinear_dir:_.dir==="up"?1:0,u_lightEnable:Number(S)}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.layer.getLayerConfig(),u=o.animateOption.repeat,s=u===void 0?1:u,this.raiseRepeat=s,h.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:Dj,fragmentShader:Pj,triangulation:MM,depth:{enable:!0},cull:{enable:!0,face:ym(this.mapService.version)},blend:this.getBlend()});case 4:return l=h.sent,h.abrupt("return",[l]);case 6:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a){var o=a.size;if(o){var u=[];return Array.isArray(o)&&(u=o.length===2?[o[0],o[0],o[1]]:o),Array.isArray(o)||(u=[o,o,o]),u}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ft.Attribute,descriptor:{name:"a_Pos",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a){var o=oo(a.coordinates);return TM([o[0],o[1]])}}})}}]),r}(rn);function Nj(e){var t=Uj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Uj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var zj=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,$j=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);

  setPickingColor(a_PickingColor);
}
`,Gj=function(e){Ut(r,e);var t=Nj(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.strokeOpacity,s=u===void 0?1:u,l=i.strokeWidth,f=l===void 0?0:l,h=i.stroke,d=h===void 0?"rgba(0,0,0,0)":h,v=i.offsets,m=v===void 0?[0,0]:v,y=i.blend,_=i.blur,E=_===void 0?0:_;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,strokeOpacity:s,strokeWidth:f,stroke:d,offsets:m})){this.judgeStyleAttributes({opacity:o,strokeOpacity:s,strokeWidth:f,stroke:d,offsets:m});var S=this.layer.getEncodedData(),A=this.calDataFrame(this.cellLength,S,this.cellProperties),M=A.data,O=A.width,j=A.height;this.rowCount=j,this.dataTexture=this.cellLength>0&&M.length>0?this.createTexture2D({flipY:!0,data:M,format:w.LUMINANCE,type:w.FLOAT,width:O,height:j}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_blur:E,u_additive:y==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_stroke_opacity:tt.exports.isNumber(s)?s:1,u_stroke_width:tt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(d),u_offsets:this.isOffsetStatic(m)?m:[0,0]}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.layer.triangulation=MT,s.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:$j,fragmentShader:zj,triangulation:MT,depth:{enable:!0},blend:this.getBlend()});case 3:return o=s.sent,s.abrupt("return",[o]);case 5:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ft.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l){var f=ir(s,3),h=f[0],d=f[1],v=f[2],m=fi(0,0,1),y=fi(h,0,v),_=h>=0?C1(m,y):Math.PI*2-C1(m,y),E=Math.PI*2-Math.asin(d/100),S=Oa();gm(S,S,_),d0(S,S,E);var A=fi(1,1,0);_d(A,A,S),ph(A,A);var M=fi(-1,1,0);_d(M,M,S),ph(M,M);var O=fi(-1,-1,0);_d(O,O,S),ph(O,O);var j=fi(1,-1,0);_d(j,j,S),ph(j,j);var q=[].concat(It(A),It(M),It(O),It(j)),Y=l%4*3;return[q[Y],q[Y+1],q[Y+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ft.Attribute,descriptor:{name:"a_Shape",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.shape,s=u===void 0?2:u,l=i.layer.getLayerConfig().shape2d,f=l.indexOf(s);return[f]}}})}}]),r}(rn);function Hj(e){var t=Vj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Vj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jj=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Wj=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,OM=function(e){Ut(r,e);var t=Hj(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"raiseCount",0),T(re(n),"raiseRepeat",0),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,u=i.opacity,s=u===void 0?1:u,l=i.sourceColor,f=i.targetColor,h=i.pickLight,d=h===void 0?!1:h,v=i.heightfixed,m=v===void 0?!1:v,y=i.opacityLinear,_=y===void 0?{enable:!1,dir:"up"}:y,E=i.lightEnable,S=E===void 0?!0:E;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var A=this.layer.getEncodedData(),M=this.calDataFrame(this.cellLength,A,this.cellProperties),O=M.data,j=M.width,q=M.height;this.rowCount=q,this.dataTexture=this.cellLength>0&&O.length>0?this.createTexture2D({flipY:!0,data:O,format:w.LUMINANCE,type:w.FLOAT,width:j,height:q}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}var Y=0,ne=[0,0,0,0],X=[0,0,0,0];if(l&&f&&(ne=$r(l),X=$r(f),Y=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){var $=o.speed,K=$===void 0?.01:$;this.raiseCount+=K,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(d),u_heightfixed:Number(m),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(s)?s:1,u_linearColor:Y,u_sourceColor:ne,u_targetColor:X,u_opacitylinear:Number(_.enable),u_opacitylinear_dir:_.dir==="up"?1:0,u_lightEnable:Number(S)}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.depth,s=u===void 0?!0:u,l=o.animateOption.repeat,f=l===void 0?1:l,this.raiseRepeat=f,v.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:Wj,fragmentShader:jj,triangulation:MM,blend:this.getBlend(),cull:{enable:!0,face:ym(this.mapService.version)},depth:{enable:s}});case 4:return h=v.sent,v.abrupt("return",[h]);case 6:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a){var o=a.size;if(o){var u=[];return Array.isArray(o)&&(u=o.length===2?[o[0],o[0],o[1]]:o),Array.isArray(o)||(u=[o,o,o]),u}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ft.Attribute,descriptor:{name:"a_Pos",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(a){var o=oo(a.coordinates);return[o[0],o[1],0]}}})}}]),r}(rn);function Xj(e){var t=Yj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Yj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var FT=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Zj=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,P_=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_meter2coord;
uniform float u_meteryScale;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size) * u_meter2coord;
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    if(newSize * pow(2.0, u_Zoom) < 48.0) {
      antialiasblur = max(antialiasblur, -0.05);
    } else if(newSize * pow(2.0, u_Zoom) < 128.0) {
      antialiasblur = max(antialiasblur, -0.6/pow(u_Zoom, 2.0));
    } else {
      antialiasblur = max(antialiasblur, -0.8/pow(u_Zoom, 2.0));
    }
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.x += offset.x / u_meteryScale;
      aPosition.y += offset.y;
      offset = vec2(0.0);
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_raisingHeight;

  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,LM=function(e){Ut(r,e);var t=Xj(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"meter2coord",1),T(re(n),"meterYScale",1),T(re(n),"isMeter",!1),T(re(n),"unit","l7size"),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.strokeOpacity,s=u===void 0?1:u,l=i.strokeWidth,f=l===void 0?0:l,h=i.stroke,d=h===void 0?"rgba(0,0,0,0)":h,v=i.offsets,m=v===void 0?[0,0]:v,y=i.blend,_=i.blur,E=_===void 0?0:_,S=i.raisingHeight,A=S===void 0?0:S,M=i.heightfixed,O=M===void 0?!1:M,j=i.unit,q=j===void 0?"l7size":j;if(this.updateUnit(q),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,strokeOpacity:s,strokeWidth:f,stroke:d,offsets:m})){this.judgeStyleAttributes({opacity:o,strokeOpacity:s,strokeWidth:f,stroke:d,offsets:m});var Y=this.layer.getEncodedData(),ne=this.calDataFrame(this.cellLength,Y,this.cellProperties),X=ne.data,$=ne.width,K=ne.height;this.rowCount=K,this.dataTexture=this.cellLength>0&&X.length>0?this.createTexture2D({flipY:!0,data:X,format:w.LUMINANCE,type:w.FLOAT,width:$,height:K}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(A),u_heightfixed:Number(O),u_meter2coord:this.meter2coord,u_meteryScale:this.meterYScale,u_isMeter:Number(this.isMeter),u_blur:E,u_additive:y==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_stroke_opacity:tt.exports.isNumber(s)?s:1,u_stroke_width:tt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(d),u_offsets:this.isOffsetStatic(m)?m:[0,0]}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),vg)}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateUnit("l7size"),u.next=3,this.buildModels();case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"calMeter2Coord",value:function(){var i=ir(this.layer.getSource().extent,4),a=i[0],o=i[1],u=i[2],s=i[3],l=[(a+u)/2,(o+s)/2],f=this.mapService.version,h=en==null?void 0:en.mapboxgl;if(f===Ln.MAPBOX&&h!==null&&h!==void 0&&h.MercatorCoordinate){var d=h.MercatorCoordinate.fromLngLat({lng:l[0],lat:l[1]},0),v=d.meterInMercatorCoordinateUnits(),m=new h.MercatorCoordinate(d.x-v,d.y,d.z),y=m.toLngLat(),_=new h.MercatorCoordinate(d.x,d.y-v,d.z),E=_.toLngLat();this.meter2coord=l[0]-y.lng,this.meterYScale=(E.lat-l[1])/this.meter2coord;return}var S=this.mapService.meterToCoord(l,[a,o]),A=this.mapService.meterToCoord(l,[u===a?u+.1:u,s===o?o+.1:s]);this.meter2coord=(S+A)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E,S,A,M,O;return H.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.animateOption,d=h===void 0?{enable:!1}:h,v=o.workerEnabled,m=v===void 0?!1:v,y=o.enablePicking,_=o.shape2d,E=this.getShaders(d),S=E.frag,A=E.vert,M=E.type,this.layer.triangulation=vg,q.next=5,this.layer.buildLayerModel({moduleName:M,vertexShader:A,fragmentShader:S,triangulation:vg,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f),workerEnabled:m,workerOptions:{modelType:M,enablePicking:y,shape2d:_}});case 5:return O=q.sent,q.abrupt("return",[O]);case 7:case"end":return q.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(i){if(i.enable)switch(i.type){case"wave":return{frag:FT,vert:P_,type:"pointWave"};default:return{frag:FT,vert:P_,type:"pointWave"}}else return{frag:Zj,vert:P_,type:"pointFill"}}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ft.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ft.Attribute,descriptor:{name:"a_Shape",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.shape,s=u===void 0?2:u,l=i.indexOf(s);return[l]}}})}},{key:"updateUnit",value:function(i){var a=this.mapService.version;this.unit!==i&&(this.unit!=="meter"&&i==="meter"&&a!==Ln.DEFUALT&&a!==Ln.GLOBEL?(this.isMeter=!0,this.calMeter2Coord()):this.unit==="meter"&&i!=="meter"&&(this.isMeter=!1,this.meter2coord=1),this.unit=i)}}]),r}(rn);function qj(e){var t=Kj();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Kj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qj=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Jj=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform float u_isMeter;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,eW=function(e){Ut(r,e);var t=qj(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"meter2coord",1),T(re(n),"isMeter",!1),T(re(n),"radian",0),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layerService.throttleRenderLayers();return}n.texture=u({data:n.iconService.getCanvas(),mag:w.LINEAR,min:w.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.offsets,s=u===void 0?[0,0]:u,l=i.rotation,f=i.raisingHeight,h=f===void 0?0:f,d=i.heightfixed,v=d===void 0?!1:d;this.rendererService.getDirty()&&this.texture.bind();var m=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(m=-1),this.radian=l!==void 0?m*Math.PI*l/180:m*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,offsets:s})){this.judgeStyleAttributes({opacity:o,offsets:s});var y=this.layer.getEncodedData(),_=this.calDataFrame(this.cellLength,y,this.cellProperties),E=_.data,S=_.width,A=_.height;this.rowCount=A,this.dataTexture=this.cellLength>0&&E.length>0?this.createTexture2D({flipY:!0,data:E,format:w.LUMINANCE,type:w.FLOAT,width:S,height:A}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(h),u_heightfixed:Number(v),u_isMeter:Number(this.isMeter),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:tt.exports.isNumber(o)?o:1,u_offsets:this.isOffsetStatic(s)?s:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Uc)}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),o=this.layer.getLayerConfig(),u=o.unit,s=u===void 0?"l7size":u,l=this.mapService.version,s==="meter"&&l!==Ln.DEFUALT&&l!==Ln.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),h.next=7,this.buildModels();case 7:return h.abrupt("return",h.sent);case 8:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"calMeter2Coord",value:function(){var i=ir(this.layer.getSource().extent,4),a=i[0],o=i[1],u=i[2],s=i[3],l=[(a+u)/2,(o+s)/2],f=this.mapService.version;if(f===Ln.MAPBOX&&window.mapboxgl.MercatorCoordinate){var h=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:l[0],lat:l[1]},0),d=1,v=d*h.meterInMercatorCoordinateUnits(),m=new window.mapboxgl.MercatorCoordinate(h.x-v,h.y,h.z),y=m.toLngLat();this.meter2coord=l[0]-y.lng;return}var _=this.mapService.meterToCoord(l,[a,o]),E=this.mapService.meterToCoord(l,[u===a?u+.1:u,s===o?o+.1:s]);this.meter2coord=(_+E)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,v.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:Jj,fragmentShader:Qj,triangulation:Uc,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f),cull:{enable:!0,face:ym(this.mapService.version)}});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;this.iconService.off("imageUpdate",this.updateTexture),(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Ft.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.rotate,s=u===void 0?0:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_Uv",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.shape,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ft.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]*i.meter2coord]:[s*i.meter2coord]}}})}}]),r}(rn);function tW(e){var t=rW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function rW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nW=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,iW=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(textrueOffsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,FM=function(e){Ut(r,e);var t=tW(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"updateTexture",function(){var u=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){n.layerService.throttleRenderLayers()});return}n.texture=u({data:n.iconService.getCanvas(),mag:w.LINEAR,min:w.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.offsets,s=u===void 0?[0,0]:u,l=i.raisingHeight,f=l===void 0?0:l,h=i.heightfixed,d=h===void 0?!1:h;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,offsets:s})){this.judgeStyleAttributes({opacity:o,offsets:s});var v=this.layer.getEncodedData(),m=this.calDataFrame(this.cellLength,v,this.cellProperties),y=m.data,_=m.width,E=m.height;this.rowCount=E,this.dataTexture=this.cellLength>0&&y.length>0?this.createTexture2D({flipY:!0,data:y,format:w.LUMINANCE,type:w.FLOAT,width:_,height:E}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(f),u_heightfixed:Number(d),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:tt.exports.isNumber(o)?o:1,u_offsets:this.isOffsetStatic(s)?s:[0,0]}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.iconService.off("imageUpdate",this.updateTexture),this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),u.next=5,this.buildModels();case 5:return u.abrupt("return",u.sent);case 6:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,v.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:iW,fragmentShader:nW,triangulation:eV,depth:{enable:!1},primitive:w.POINTS,blend:this.getBlend(),stencil:vn(s,f)});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_Uv",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(o){var u=i.iconService.getIconMap(),s=o.shape,l=u[s]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),r}(rn);function aW(e){var t=oW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function oW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var uW=`uniform float u_opacity : 1;
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
}
`,sW=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function IT(e){var t=e.coordinates;return{vertices:It(t),indices:[0],size:t.length}}var IM=function(e){Ut(r,e);var t=aW(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a;return{u_opacity:tt.exports.isNumber(o)?o:1}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,this.layer.triangulation=IT,v.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:sW,fragmentShader:uW,triangulation:IT,depth:{enable:!1},primitive:w.POINTS,blend:this.getBlend(),stencil:vn(s,f),pick:!1});case 4:return h=v.sent,v.abrupt("return",[h]);case 6:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0]]:[u]}}})}}]),r}(rn);function lW(e){var t=cW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function cW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fW=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,hW=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,pW=function(e){Ut(r,e);var t=lW(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"meter2coord",1),T(re(n),"isMeter",!1),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.blend,s=i.speed,l=s===void 0?1:s;return{u_isMeter:Number(this.isMeter),u_speed:l,u_additive:u==="additive"?1:0,u_opacity:tt.exports.isNumber(o)?o:1}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Uc)}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.layer.getLayerConfig(),u=o.unit,s=u===void 0?"l7size":u,l=this.mapService.version,s==="meter"&&l!==Ln.DEFUALT&&l!==Ln.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),h.next=5,this.buildModels();case 5:return h.abrupt("return",h.sent);case 6:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"calMeter2Coord",value:function(){var i=ir(this.layer.getSource().extent,4),a=i[0],o=i[1],u=i[2],s=i[3],l=[(a+u)/2,(o+s)/2],f=this.mapService.version;if(f===Ln.MAPBOX&&window.mapboxgl.MercatorCoordinate){var h=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:l[0],lat:l[1]},0),d=1,v=d*h.meterInMercatorCoordinateUnits(),m=new window.mapboxgl.MercatorCoordinate(h.x-v,h.y,h.z),y=m.toLngLat();this.meter2coord=l[0]-y.lng;return}var _=this.mapService.meterToCoord(l,[a,o]),E=this.mapService.meterToCoord(l,[u===a?u+.1:u,s===o?o+.1:s]);this.meter2coord=(_+E)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,v.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:hW,fragmentShader:fW,triangulation:Uc,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f)});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ft.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]*i.meter2coord]:[s*i.meter2coord]}}})}}]),r}(rn);function dW(e){var t=vW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function vW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gW=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,mW=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  vec2 offset = project_pixel(textrueOffsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function kT(e){var t=e.coordinates;return{vertices:It(t),indices:[0],size:t.length}}var yW=function(e){Ut(r,e);var t=dW(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.offsets,s=u===void 0?[0,0]:u,l=i.blend,f=i.strokeOpacity,h=f===void 0?1:f,d=i.strokeWidth,v=d===void 0?0:d,m=i.stroke,y=m===void 0?"#fff":m;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,offsets:s})){this.judgeStyleAttributes({opacity:o,offsets:s});var _=this.layer.getEncodedData(),E=this.calDataFrame(this.cellLength,_,this.cellProperties),S=E.data,A=E.width,M=E.height;this.rowCount=M,this.dataTexture=this.cellLength>0&&S.length>0?this.createTexture2D({flipY:!0,data:S,format:w.LUMINANCE,type:w.FLOAT,width:A,height:M}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_additive:l==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:tt.exports.isNumber(o)?o:1,u_offsets:this.isOffsetStatic(s)?s:[0,0],u_stroke_opacity:tt.exports.isNumber(h)?h:1,u_stroke_width:tt.exports.isNumber(v)?v:1,u_stroke_color:this.getStrokeColor(y)}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,this.layer.triangulation=kT,v.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:mW,fragmentShader:gW,triangulation:kT,depth:{enable:!1},primitive:w.POINTS,blend:this.getBlend(),stencil:vn(s,f)});case 4:return h=v.sent,v.abrupt("return",[h]);case 6:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0]]:[u]}}})}}]),r}(rn);function _W(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=xW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function xW(e,t){if(!!e){if(typeof e=="string")return PT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PT(e,t)}}function PT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var EW=function(){function e(t,r,n){ke(this,e),T(this,"boxCells",[]);var i=this.boxCells;this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(r/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0}return Pe(e,[{key:"insert",value:function(r,n,i,a,o){this.forEachCell(n,i,a,o,this.insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(o)}},{key:"query",value:function(r,n,i,a,o){return this.queryHitTest(r,n,i,a,!1,o)}},{key:"hitTest",value:function(r,n,i,a,o){return this.queryHitTest(r,n,i,a,!0,o)}},{key:"insertBoxCell",value:function(r,n,i,a,o,u){this.boxCells[o].push(u)}},{key:"queryHitTest",value:function(r,n,i,a,o,u){if(i<0||r>this.width||a<0||n>this.height)return o?!1:[];var s=[];if(r<=0&&n<=0&&this.width<=i&&this.height<=a){if(o)return!0;for(var l=0;l<this.boxKeys.length;l++)s.push({key:this.boxKeys[l],x1:this.bboxes[l*4],y1:this.bboxes[l*4+1],x2:this.bboxes[l*4+2],y2:this.bboxes[l*4+3]});return u?s.filter(u):s}var f={hitTest:o,seenUids:{box:{},circle:{}}};return this.forEachCell(r,n,i,a,this.queryCell,s,f,u),o?s.length>0:s}},{key:"queryCell",value:function(r,n,i,a,o,u,s,l){var f=s.seenUids,h=this.boxCells[o];if(h!==null){var d=this.bboxes,v=_W(h),m;try{for(v.s();!(m=v.n()).done;){var y=m.value;if(!f.box[y]){f.box[y]=!0;var _=y*4;if(r<=d[_+2]&&n<=d[_+3]&&i>=d[_+0]&&a>=d[_+1]&&(!l||l(this.boxKeys[y]))){if(s.hitTest)return u.push(!0),!0;u.push({key:this.boxKeys[y],x1:d[_],y1:d[_+1],x2:d[_+2],y2:d[_+3]})}}}}catch(E){v.e(E)}finally{v.f()}}return!1}},{key:"forEachCell",value:function(r,n,i,a,o,u,s,l){for(var f=this.convertToXCellCoord(r),h=this.convertToYCellCoord(n),d=this.convertToXCellCoord(i),v=this.convertToYCellCoord(a),m=f;m<=d;m++)for(var y=h;y<=v;y++){var _=this.xCellCount*y+m;if(o.call(this,r,n,i,a,_,u,s,l))return}}},{key:"convertToXCellCoord",value:function(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}},{key:"convertToYCellCoord",value:function(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}}]),e}();const bW=EW;var kM=function(){function e(t,r){ke(this,e),T(this,"viewportPadding",100),this.width=t,this.height=r,this.viewportPadding=Math.max(t,r),this.grid=new bW(t+this.viewportPadding,r+this.viewportPadding,25),this.screenRightBoundary=t+this.viewportPadding,this.screenBottomBoundary=r+this.viewportPadding,this.gridRightBoundary=t+2*this.viewportPadding,this.gridBottomBoundary=r+2*this.viewportPadding}return Pe(e,[{key:"placeCollisionBox",value:function(r){var n=r.x1+r.anchorPointX+this.viewportPadding,i=r.y1+r.anchorPointY+this.viewportPadding,a=r.x2+r.anchorPointX+this.viewportPadding,o=r.y2+r.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,i,a,o)||this.grid.hitTest(n,i,a,o)?{box:[]}:{box:[n,i,a,o]}}},{key:"insertCollisionBox",value:function(r,n){var i={featureIndex:n};this.grid.insert(i,r[0],r[1],r[2],r[3])}},{key:"project",value:function(r,n,i){var a=jD(n,i,0,1),o=O5(),u=f5.apply(hD,It(r));return rE(o,a,u),{x:(o[0]/o[3]+1)/2*this.width+this.viewportPadding,y:(-o[1]/o[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(r,n,i,a){return i>=0&&r<this.gridRightBoundary&&a>=0&&n<this.gridBottomBoundary}}]),e}();function PM(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=CW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function CW(e,t){if(!!e){if(typeof e=="string")return DT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DT(e,t)}}function DT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DM(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:t,verticalAlign:r}}function BM(e,t,r,n,i){if(!!i){var a=e[n],o=a.glyph;if(o)for(var u=t[o].advance*a.scale,s=(e[n].x+u)*i,l=r;l<=n;l++)e[l].x-=s}}function NM(e,t,r,n,i,a,o){var u=(t-r)*i,s=(-n*o+.5)*a,l=PM(e),f;try{for(l.s();!(f=l.n()).done;){var h=f.value;h.x+=u,h.y+=s}}catch(d){l.e(d)}finally{l.f()}}function AW(e,t,r,n,i,a,o){var u=-8,s=0,l=u,f=0,h=e.positionedGlyphs,d=a==="right"?1:a==="left"?0:.5,v=h.length;r.forEach(function(S){if(S.split("").forEach(function(M){var O=t[M],j=0;O&&(h.push({glyph:M,x:s,y:l+j,vertical:!1,scale:1,metrics:O}),s+=O.advance+o)}),h.length!==v){var A=s-o;f=Math.max(A,f),BM(h,t,v,h.length-1,d)}s=0,l-=n+5});var m=DM(i),y=m.horizontalAlign,_=m.verticalAlign;NM(h,d,y,_,f,n,r.length);var E=l-u;e.top+=-_*E,e.bottom=e.top-E,e.left+=-y*f,e.right=e.left+f}function SW(e,t,r,n,i,a,o){var u=-8,s=0,l=u,f=0,h=e.positionedGlyphs,d=a==="right"?1:a==="left"?0:.5,v=h.length;r.forEach(function(S){var A=t[S],M=0;if(A&&(h.push({glyph:S,x:A.advance/2,y:l+M,vertical:!1,scale:1,metrics:A}),s+=A.advance+o),h.length!==v){var O=s-o;f=Math.max(O,f),BM(h,t,v,h.length-1,d)}s=0,l-=n+5});var m=DM(i),y=m.horizontalAlign,_=m.verticalAlign;NM(h,d,y,_,f,n,r.length);var E=l-u;e.top+=-_*E,e.bottom=e.top-E,e.left+=-y*f,e.right=e.left+f}function UM(e,t,r,n,i,a){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],u=arguments.length>7?arguments[7]:void 0,s=e.split(`
`),l=[],f={positionedGlyphs:l,top:o[1],bottom:o[1],left:o[0],right:o[0],lineCount:s.length,text:e};return u?SW(f,t,s,r,n,i,a):AW(f,t,s,r,n,i,a),l.length?f:!1}function zM(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,i=n===void 0?[]:n,a=[],o=PM(i),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=s.metrics,f=4,h=l.advance*s.scale/2,d=r?[s.x+h,s.y]:[0,0],v=r?[0,0]:[s.x+h+t[0],s.y+t[1]],m=(0-f)*s.scale-h+v[0],y=(0-f)*s.scale+v[1],_=m+l.width*s.scale,E=y+l.height*s.scale,S={x:m,y},A={x:_,y},M={x:m,y:E},O={x:_,y:E};a.push({tl:S,tr:A,bl:M,br:O,tex:l,glyphOffset:d})}}catch(j){o.e(j)}finally{o.f()}return a}function TW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=wW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function wW(e,t){if(!!e){if(typeof e=="string")return BT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BT(e,t)}}function BT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MW(e){var t=RW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function RW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var NT=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,UT=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function zT(e){var t=this,r=e.id,n=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[r])return{vertices:[],indices:[],size:7};var a=t.glyphInfoMap[r].centroid,o=a.length===2?[a[0],a[1],0]:a;return t.glyphInfoMap[r].glyphQuads.forEach(function(u,s){n.push.apply(n,It(o).concat([u.tex.x,u.tex.y+u.tex.height,u.tl.x,u.tl.y],It(o),[u.tex.x+u.tex.width,u.tex.y+u.tex.height,u.tr.x,u.tr.y],It(o),[u.tex.x+u.tex.width,u.tex.y,u.br.x,u.br.y],It(o),[u.tex.x,u.tex.y,u.bl.x,u.bl.y])),i.push(0+s*4,1+s*4,2+s*4,2+s*4,3+s*4,0+s*4)}),{vertices:n,indices:i,size:7}}var $M=function(e){Ut(r,e);var t=MW(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"glyphInfoMap",{}),T(re(n),"currentZoom",-1),T(re(n),"textureHeight",0),T(re(n),"textCount",0),T(re(n),"preTextStyle",{}),T(re(n),"mapping",Ie(H.mark(function u(){return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n.initGlyph(),n.updateTexture(),l.next=4,n.reBuildModel();case 4:case"end":return l.stop()}},u)}))),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.stroke,s=u===void 0?"#fff":u,l=i.strokeWidth,f=l===void 0?0:l,h=i.textAnchor,d=h===void 0?"center":h,v=i.textAllowOverlap,m=v===void 0?!1:v,y=i.halo,_=y===void 0?.5:y,E=i.gamma,S=E===void 0?2:E,A=i.raisingHeight,M=A===void 0?0:A,O=this.fontService,j=O.canvas,q=O.mapping;if(q&&Object.keys(q).length!==this.textCount&&j&&(this.updateTexture(),this.textCount=Object.keys(q).length),this.preTextStyle={textAnchor:d,textAllowOverlap:m},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,strokeWidth:f,stroke:s})){this.judgeStyleAttributes({opacity:o,strokeWidth:f,stroke:s});var Y=this.layer.getEncodedData(),ne=this.calDataFrame(this.cellLength,Y,this.cellProperties),X=ne.data,$=ne.width,K=ne.height;this.rowCount=K,this.dataTexture=this.cellLength>0&&X.length>0?this.createTexture2D({flipY:!0,data:X,format:w.LUMINANCE,type:w.FLOAT,width:$,height:K}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(M),u_opacity:tt.exports.isNumber(o)?o:1,u_stroke_width:tt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(s),u_sdf_map:this.texture,u_halo_blur:_,u_gamma_scale:S,u_sdf_map_size:[(j==null?void 0:j.width)||1,(j==null?void 0:j.height)||1]}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.layer.inited||this.bindEvent(),this.extent=this.textExtent(),o=this.layer.getLayerConfig(),u=o.textAnchor,s=u===void 0?"center":u,l=o.textAllowOverlap,f=l===void 0?!0:l,this.preTextStyle={textAnchor:s,textAllowOverlap:f},d.next=6,this.buildModels();case 6:return d.abrupt("return",d.sent);case 7:case"end":return d.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v;return H.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.textAllowOverlap,d=h===void 0?!1:h,this.initGlyph(),this.updateTexture(),d||this.filterGlyphs(),y.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:UT,fragmentShader:NT,triangulation:zT.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f)});case 6:return v=y.sent,y.abrupt("return",[v]);case 8:case"end":return y.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"needUpdate",value:function(){var i=this.layer.getLayerConfig(),a=i.textAllowOverlap,o=a===void 0?!1:a,u=this.layer.getEncodedData();if(u.length<5||o)return!1;var s=this.mapService.getZoom(),l=this.mapService.getBounds(),f=J4(this.extent,l);return Math.abs(this.currentZoom-s)>1||!f||o!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Ft.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a){var o=a.rotate,u=o===void 0?0:o;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Ft.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u){return[u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?12:o;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Ft.Attribute,descriptor:{name:"a_tex",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return pm(i,.5)}},{key:"initTextFont",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,o=a===void 0?"400":a,u=i.fontFamily,s=u===void 0?"sans-serif":u,l=this.layer.getEncodedData(),f=[];l.forEach(function(h){var d=h.shape,v=d===void 0?"":d;v=v.toString();var m=TW(v),y;try{for(m.s();!(y=m.n()).done;){var _=y.value;f.indexOf(_)===-1&&f.push(_)}}catch(E){m.e(E)}finally{m.f()}}),this.fontService.setFontOptions({characterSet:f,fontWeight:o,fontFamily:s,iconfont:!1})}},{key:"initIconFontTex",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,o=a===void 0?"400":a,u=i.fontFamily,s=u===void 0?"sans-serif":u,l=this.layer.getEncodedData(),f=[];l.forEach(function(h){var d=h.shape,v=d===void 0?"":d;v="".concat(v),f.indexOf(v)===-1&&f.push(v)}),this.fontService.setFontOptions({characterSet:f,fontWeight:o,fontFamily:s,iconfont:!0})}},{key:"generateGlyphLayout",value:function(i){var a=this,o=this.fontService.mapping,u=this.layer.getLayerConfig(),s=u.spacing,l=s===void 0?2:s,f=u.textAnchor,h=f===void 0?"center":f,d=this.layer.getEncodedData();this.glyphInfo=d.map(function(v){var m=v.shape,y=m===void 0?"":m,_=v.id,E=v.size,S=E===void 0?1:E,A=v.textOffset,M=A===void 0?[0,0]:A,O=UM(y.toString(),o,S,h,"left",l,M,i),j=zM(O,M,!1);return v.shaping=O,v.glyphQuads=j,v.centroid=oo(v.coordinates),v.originCentroid=v.version==="GAODE2.x"?oo(v.originCoordinates):v.originCentroid=v.centroid,a.glyphInfoMap[_]={shaping:O,glyphQuads:j,centroid:oo(v.coordinates)},v})}},{key:"filterGlyphs",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.padding,u=o===void 0?[4,4]:o,s=a.textAllowOverlap,l=s===void 0?!1:s;if(!l){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var f=this.rendererService.getViewportSize(),h=f.width,d=f.height,v=new kM(h,d),m=this.glyphInfo.filter(function(y){var _=y.shaping,E=y.id,S=E===void 0?0:E,A=y.version==="GAODE2.x"?y.originCentroid:y.centroid,M=y.size,O=M/16,j=i.mapService.lngLatToContainer(A),q=v.placeCollisionBox({x1:_.left*O-u[0],x2:_.right*O+u[0],y1:_.top*O-u[1],y2:_.bottom*O+u[1],anchorPointX:j.x,anchorPointY:j.y}),Y=q.box;return Y&&Y.length?(v.insertCollisionBox(Y,S),!0):!1});m.forEach(function(y){i.glyphInfoMap[y.id]=y})}}},{key:"initGlyph",value:function(){var i=this.layer.getLayerConfig(),a=i.iconfont,o=a===void 0?!1:a;o?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(o)}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.fontService.canvas;this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=i({data:a,mag:w.LINEAR,min:w.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,this.filterGlyphs(),v.next=4,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:UT,fragmentShader:NT,triangulation:zT.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f)});case 4:h=v.sent,this.layer.models=[h];case 6:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}]),r}(rn);function OW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=LW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function LW(e,t){if(!!e){if(typeof e=="string")return $T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $T(e,t)}}function $T(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FW(e){var t=IW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function IW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var GT=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,HT=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,VT=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;

uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;
uniform vec4 u_color;

void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(u_color.rgb, u_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
}
`,jT=`#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_size;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "projection"

void main() {
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = u_size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;

}
`;function WT(e){var t=this,r=e.id,n=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[r])return{vertices:[],indices:[],size:7};var a=t.glyphInfoMap[r].centroid,o=a.length===2?[a[0],a[1],0]:a;return t.glyphInfoMap[r].glyphQuads.forEach(function(u,s){n.push.apply(n,It(o).concat([u.tex.x,u.tex.y+u.tex.height,u.tl.x,u.tl.y],It(o),[u.tex.x+u.tex.width,u.tex.y+u.tex.height,u.tr.x,u.tr.y],It(o),[u.tex.x+u.tex.width,u.tex.y,u.br.x,u.br.y],It(o),[u.tex.x,u.tex.y,u.bl.x,u.bl.y])),i.push(0+s*4,1+s*4,2+s*4,2+s*4,3+s*4,0+s*4)}),{vertices:n,indices:i,size:7}}var kW=function(e){Ut(r,e);var t=FW(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"glyphInfoMap",{}),T(re(n),"currentZoom",-1),T(re(n),"textureHeight",0),T(re(n),"textCount",0),T(re(n),"preTextStyle",{}),T(re(n),"mapping",function(){n.initGlyph(),n.updateTexture(),n.filterGlyphs(),n.reBuildModel()}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.stroke,s=u===void 0?"#fff":u,l=i.strokeWidth,f=l===void 0?0:l,h=i.textAnchor,d=h===void 0?"center":h,v=i.textAllowOverlap,m=v===void 0?!1:v,y=i.halo,_=y===void 0?.5:y,E=i.gamma,S=E===void 0?2:E,A=i.usage,M=i.color,O=M===void 0?"#fff":M,j=i.size,q=j===void 0?1:j,Y=this.fontService,ne=Y.canvas,X=Y.mapping;return Object.keys(X).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(X).length),this.preTextStyle={textAnchor:d,textAllowOverlap:m},{u_opacity:tt.exports.isNumber(o)?o:1,u_stroke_width:tt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(s),u_sdf_map:this.texture,u_halo_blur:_,u_gamma_scale:S,u_sdf_map_size:[ne.width,ne.height],u_color:A==="basemap"?$r(O):[0,0,0,0],u_size:A==="basemap"?q:1}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.extent=this.textExtent(),o=this.layer.getLayerConfig(),u=o.textAnchor,s=u===void 0?"center":u,l=o.textAllowOverlap,f=l===void 0?!0:l,this.preTextStyle={textAnchor:s,textAllowOverlap:f},d.next=5,this.buildModels();case 5:return d.abrupt("return",d.sent);case 6:case"end":return d.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s;return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.mapping(),o=this.layer.getLayerConfig(),u=o.usage,f.next=4,this.layer.buildLayerModel({moduleName:"pointTileText_"+u,vertexShader:u==="basemap"?jT:HT,fragmentShader:u==="basemap"?VT:GT,triangulation:WT.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:u!=="basemap"});case 4:return s=f.sent,f.abrupt("return",[s]);case 6:case"end":return f.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.usage;this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Ft.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(u,s,l){return[l[5],l[6]]}}}),a!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(u){var s=u.size,l=s===void 0?12:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Ft.Attribute,descriptor:{name:"a_tex",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(u,s,l){return[l[3],l[4]]}}})}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return pm(i,.5)}},{key:"initTextFont",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,o=a===void 0?"400":a,u=i.fontFamily,s=u===void 0?"sans-serif":u,l=this.layer.getEncodedData(),f=[];l.forEach(function(h){var d=h.shape,v=d===void 0?"":d;v=v.toString();var m=OW(v),y;try{for(m.s();!(y=m.n()).done;){var _=y.value;f.indexOf(_)===-1&&f.push(_)}}catch(E){m.e(E)}finally{m.f()}}),this.fontService.setFontOptions({characterSet:f,fontWeight:o,fontFamily:s,iconfont:!1})}},{key:"generateGlyphLayout",value:function(){var i=this,a=this.fontService.mapping,o=this.layer.getLayerConfig(),u=o.spacing,s=u===void 0?2:u,l=o.textAnchor,f=l===void 0?"center":l,h=this.layer.getEncodedData();this.glyphInfo=h.map(function(d){var v=d.shape,m=v===void 0?"":v,y=d.id,_=d.size,E=_===void 0?1:_,S=d.textOffset,A=S===void 0?[0,0]:S,M=UM(m.toString(),a,E,f,"left",s,A,!1),O=zM(M,A,!1);return d.shaping=M,d.glyphQuads=O,d.centroid=oo(d.coordinates),d.originCentroid=d.version==="GAODE2.x"?oo(d.originCoordinates):d.originCentroid=d.centroid,i.glyphInfoMap[y]={shaping:M,glyphQuads:O,centroid:oo(d.coordinates)},d})}},{key:"filterGlyphs",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.padding,u=o===void 0?[4,4]:o,s=a.textAllowOverlap,l=s===void 0?!1:s;if(!l){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var f=this.rendererService.getViewportSize(),h=f.width,d=f.height,v=new kM(h,d),m=this.glyphInfo.filter(function(y){var _=y.shaping,E=y.id,S=E===void 0?0:E,A=y.version==="GAODE2.x"?y.originCentroid:y.centroid,M=y.size,O=M/24,j=i.mapService.lngLatToContainer(A),q=v.placeCollisionBox({x1:_.left*O-u[0],x2:_.right*O+u[0],y1:_.top*O-u[1],y2:_.bottom*O+u[1],anchorPointX:j.x,anchorPointY:j.y}),Y=q.box;return Y&&Y.length?(v.insertCollisionBox(Y,S),!0):!1});m.forEach(function(y){i.glyphInfoMap[y.id]=y})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.fontService.canvas;this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=i({data:a,mag:w.LINEAR,min:w.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var n=Ie(H.mark(function a(){var o,u,s;return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return o=this.layer.getLayerConfig(),u=o.usage,this.filterGlyphs(),f.next=4,this.layer.buildLayerModel({moduleName:"pointTileText_"+u,vertexShader:u==="basemap"?jT:HT,fragmentShader:u==="basemap"?VT:GT,triangulation:WT.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:u!=="basemap"});case 4:return s=f.sent,f.abrupt("return",[s]);case 6:case"end":return f.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}]),r}(rn);function PW(e){var t=DW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function DW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var BW=`uniform float u_additive;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));


  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,NW=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping

  v_color = a_Color;
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, 0.0);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width));
  offset = project_pixel(offset);

  v_data = vec4(extrude.x, extrude.y, antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
  }

// if(u_coord > 0.0) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
// } else {

  // vec2 pointPos = a_Position.xy;
  // vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  // vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
  
  // world.xy += offset;
  // world.xy += pointOffset;

  // if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //   // Needs to be divided with project_uCommonUnitsPerMeter
  //   world.w *= u_PixelsPerMeter.z;
  // }

  // gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
// }

 
  setPickingColor(a_PickingColor);


}
`,UW=function(e){Ut(r,e);var t=PW(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.strokeOpacity,s=u===void 0?1:u,l=i.strokeWidth,f=l===void 0?0:l,h=i.stroke,d=h===void 0?"rgba(0,0,0,0)":h,v=i.blend;return{u_additive:v==="additive"?1:0,u_opacity:Number(o),u_stroke_opacity:Number(s),u_stroke_width:Number(f),u_stroke_color:this.getStrokeColor(d)}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Uc)}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.layer.getLayerConfig(),u=o.workerEnabled,s=u===void 0?!1:u,l=o.usage,this.layer.triangulation=Uc,d.next=4,this.layer.buildLayerModel({moduleName:"pointTile_"+l,vertexShader:NW,fragmentShader:BW,triangulation:Uc,depth:{enable:!1},cull:{enable:!0,face:ym(this.mapService.version)},blend:this.getBlend(),workerEnabled:s,workerOptions:{modelType:"pointTile"},pick:l!=="basemap"});case 4:return f=d.sent,d.abrupt("return",[f]);case 6:case"end":return d.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ft.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(o,u,s,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ft.Attribute,descriptor:{name:"a_Shape",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(o){var u=o.shape,s=u===void 0?2:u,l=i.layer.getLayerConfig().shape2d,f=l.indexOf(s);return[f]}}})}}]),r}(rn),zW={fillImage:eW,fill:LM,radar:pW,image:FM,normal:IM,simplePoint:yW,extrude:OM,text:$M,tile:UW,tileText:kW,earthFill:Gj,earthExtrude:Bj};const $W=zW;function GW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=HW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw u}}}}function HW(e,t){if(!!e){if(typeof e=="string")return XT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XT(e,t)}}function XT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VW(e){var t=jW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function jW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Bg=function(e){Ut(r,e);var t=VW(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"type","PointLayer"),T(re(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),n}return Pe(r,[{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new $W[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"rebuildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var i=this.shapeOption,a=i.field,o=i.values,u=this.getLayerConfig(),s=u.shape2d,l=this.iconService.getIconMap();if(a&&(s==null?void 0:s.indexOf(a))!==-1)return"fill";if(o==="text")return"text";if(o&&o instanceof Array){var f=GW(o),h;try{for(f.s();!(h=f.n()).done;){var d=h.value;if(typeof d=="string"&&l.hasOwnProperty(d))return"image"}}catch(v){f.e(v)}finally{f.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[i]}},{key:"getModelType",value:function(){var i=this.getEncodedData(),a=this.getLayerConfig(),o=a.shape2d,u=a.shape3d,s=this.iconService.getIconMap(),l=i.find(function(h){return h.hasOwnProperty("shape")});if(l){var f=l.shape;return f==="dot"?"normal":f==="simple"?"simplePoint":f==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(o==null?void 0:o.indexOf(f))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(u==null?void 0:u.indexOf(f))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":s.hasOwnProperty(f)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),r}(Vh);function WW(e){var t=XW();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function XW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var YW=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }

  } else {
     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ZW=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,qW=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,KW=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_Color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,QW=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,JW=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,eX=function(e){Ut(r,e);var t=WW(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.heightfixed,s=u===void 0?!1:u,l=i.raisingHeight,f=l===void 0?0:l,h=i.topsurface,d=h===void 0?!0:h,v=i.sidesurface,m=v===void 0?!0:v,y=i.sourceColor,_=i.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var E=this.layer.getEncodedData(),S=this.calDataFrame(this.cellLength,E,this.cellProperties),A=S.data,M=S.width,O=S.height;this.rowCount=O,this.dataTexture=this.cellLength>0&&A.length>0?this.createTexture2D({flipY:!0,data:A,format:w.LUMINANCE,type:w.FLOAT,width:M,height:O}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}var j=0,q=[1,1,1,1],Y=[1,1,1,1];return y&&_&&(q=$r(y),Y=$r(_),j=1),{u_topsurface:Number(d),u_sidesurface:Number(m),u_heightfixed:Number(s),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(f),u_opacity:tt.exports.isNumber(o)?o:1,u_linearColor:j,u_sourceColor:q,u_targetColor:Y,u_texture:this.texture}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.loadTexture(),u.next=3,this.buildModels();case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y;return H.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=this.getShaders(),d=h.frag,v=h.vert,m=h.type,E.next=4,this.layer.buildLayerModel({moduleName:m,vertexShader:v,fragmentShader:d,triangulation:aV,stencil:vn(s,f)});case 4:return y=E.sent,E.abrupt("return",[y]);case 6:case"end":return E.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.pickLight,o=i.mapTexture;return o?{frag:qW,vert:KW,type:"polygonExtrudeTexture"}:a?{frag:QW,vert:JW,type:"polygonExtrudePickLight"}:{frag:YW,vert:ZW,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var i,a;(i=this.dataTexture)===null||i===void 0||i.destroy(),(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=ir(i,4),o=a[0],u=a[1],s=a[2],l=a[3],f=s-o,h=l-u;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Ft.Attribute,descriptor:{name:"a_uvs",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(v,m,y){var _=y[0],E=y[1];return[(_-o)/f,(E-u)/h,y[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ft.Attribute,descriptor:{name:"a_Normal",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(v,m,y,_,E){return E}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ft.Attribute,descriptor:{name:"a_Size",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(v){var m=v.size,y=m===void 0?10:m;return Array.isArray(y)?[y[0]]:[y]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.mapTexture,u=this.rendererService.createTexture2D;if(this.texture=u({height:0,width:0}),o){var s=new Image;s.crossOrigin="",s.src=o,s.onload=function(){i.texture=u({data:s,width:s.width,height:s.height,wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE,min:w.LINEAR,mag:w.LINEAR}),i.layerService.reRender()}}}}]),r}(rn);function tX(e){var t=rX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function rX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nX=`uniform float u_opacity: 1.0;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,iX=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,aX=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,oX=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,uX=function(e){Ut(r,e);var t=tX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.raisingHeight,o=a===void 0?0:a,u=i.opacity,s=u===void 0?1:u,l=i.opacityLinear,f=l===void 0?{enable:!1,dir:"in"}:l;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var h=this.layer.getEncodedData(),d=this.calDataFrame(this.cellLength,h,this.cellProperties),v=d.data,m=d.width,y=d.height;this.rowCount=y,this.dataTexture=this.cellLength>0&&v.length>0?this.createTexture2D({flipY:!0,data:v,format:w.LUMINANCE,type:w.FLOAT,width:m,height:y}):this.createTexture2D({flipY:!0,data:[1],format:w.LUMINANCE,type:w.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(o),u_opacity:tt.exports.isNumber(s)?s:1,u_opacitylinear:Number(f.enable),u_dir:f.dir==="in"?1:0}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E,S,A;return H.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return o=this.getModelParams(),u=o.frag,s=o.vert,l=o.triangulation,f=o.type,h=this.layer.getLayerConfig(),d=h.mask,v=d===void 0?!1:d,m=h.maskInside,y=m===void 0?!0:m,_=h.workerEnabled,E=_===void 0?!1:_,S=h.enablePicking,this.layer.triangulation=l,O.next=5,this.layer.buildLayerModel({moduleName:f,vertexShader:s,fragmentShader:u,triangulation:l,primitive:w.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:vn(v,y),workerEnabled:E,workerOptions:{modelType:f,enablePicking:S}});case 5:return A=O.sent,O.abrupt("return",[A]);case 7:case"end":return O.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.opacityLinear,o=a===void 0?{enable:!1,dir:"in"}:a;o.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Ft.Attribute,descriptor:{name:"a_linear",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:3,update:function(s,l,f){return[f[3],f[4],f[5]]}}})}},{key:"getModelParams",value:function(){var i=this.layer.getLayerConfig(),a=i.opacityLinear,o=a===void 0?{enable:!1}:a;return o.enable?{frag:iX,vert:aX,type:"polygonLinear",triangulation:nV}:{frag:nX,vert:oX,type:"polygonFill",triangulation:F5}}}]),r}(rn);function sX(e){var t=lX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function lX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cX=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,fX=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,hX=function(e){Ut(r,e);var t=sX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.watercolor,s=u===void 0?"#6D99A8":u,l=i.watercolor2,f=l===void 0?"#0F121C":l;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:$r(s),u_watercolor2:$r(f),u_opacity:tt.exports.isNumber(o)?o:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.loadTexture(),u.next=3,this.buildModels();case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,v.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:fX,fragmentShader:cX,triangulation:i0,primitive:w.TRIANGLES,depth:{enable:!1},stencil:vn(s,f)});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a,o;(i=this.texture1)===null||i===void 0||i.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(o=this.texture3)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=ir(i,4),o=a[0],u=a[1],s=a[2],l=a[3],f=s-o,h=l-u;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Ft.Attribute,descriptor:{name:"a_uv",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(v,m,y,_){var E=v.version===Ln["GAODE2.x"]?v.originCoordinates[0][_]:y,S=ir(E,2),A=S[0],M=S[1];return[(A-o)/f,(M-u)/h]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.rendererService.createTexture2D,o={height:0,width:0};this.texture1=a(o),this.texture2=a(o),this.texture3=a(o),u(function(l){i.texture1=s(l[0]),i.texture2=s(l[1]),i.texture3=s(l[2]),i.layerService.reRender()});function u(l){var f=0,h=[],d=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];d.map(function(v){var m=new Image;m.crossOrigin="",m.src=v,h.push(m),m.onload=function(){f++,f===3&&l(h)}})}function s(l){return a({data:l,width:l.width,height:l.height,wrapS:w.MIRRORED_REPEAT,wrapT:w.MIRRORED_REPEAT,min:w.LINEAR,mag:w.LINEAR})}}}]),r}(rn);function pX(e){var t=dX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function dX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vX=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,gX=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  // if(u_coord > 0.0) {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
    }
  // } else {
  //   vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset = a_Position.xy *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   world.xy += pointOffset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     world.w *= u_PixelsPerMeter.z;
  //   }

  //   gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}

`,mX=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,yX=`attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}`,_X=function(e){Ut(r,e);var t=pX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.usage,s=i.color,l=s===void 0?"#fff":s;return{u_opacity:o,u_color:u==="basemap"?$r(l):[0,0,0,0]}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d;return H.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=o.usage,this.layer.triangulation=i0,m.next=4,this.layer.buildLayerModel({moduleName:"polygonTile_"+h,vertexShader:h==="basemap"?yX:gX,fragmentShader:h==="basemap"?mX:vX,triangulation:i0,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f),pick:h!=="basemap"});case 4:return d=m.sent,m.abrupt("return",[d]);case 6:case"end":return m.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){}}]),r}(rn);function xX(e){var t=EX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function EX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bX=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,CX=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,AX=function(e){Ut(r,e);var t=xX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.speed,s=u===void 0?.5:u;return{u_texture:this.texture,u_speed:s,u_opacity:tt.exports.isNumber(o)?o:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.loadTexture(),u.next=3,this.buildModels();case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,v.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:CX,fragmentShader:bX,triangulation:i0,primitive:w.TRIANGLES,depth:{enable:!1},stencil:vn(s,f)});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=ir(i,4),o=a[0],u=a[1],s=a[2],l=a[3],f=s-o,h=l-u;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Ft.Attribute,descriptor:{name:"a_uv",buffer:{usage:w.STATIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(v,m,y,_){var E=v.version===Ln["GAODE2.x"]?v.originCoordinates[0][_]:y,S=ir(E,2),A=S[0],M=S[1];return[(A-o)/f,(M-u)/h]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.waterTexture,u=this.rendererService.createTexture2D;this.texture=u({height:0,width:0});var s=new Image;s.crossOrigin="",o?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),s.src=o):s.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",s.onload=function(){i.texture=u({data:s,width:s.width,height:s.height,wrapS:w.MIRRORED_REPEAT,wrapT:w.MIRRORED_REPEAT,min:w.LINEAR,mag:w.LINEAR}),i.layerService.reRender()}}}]),r}(rn),SX={fill:uX,line:RM,extrude:eX,text:$M,point_fill:LM,point_image:FM,point_normal:IM,point_extrude:OM,water:AX,ocean:hX,tile:_X};const TX=SX;function wX(e){var t=MX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function MX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var GM=function(e){Ut(r,e);var t=wX(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"type","PolygonLayer"),n}return Pe(r,[{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new TX[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getModelType",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;return o==="fill"?"fill":o==="extrude"?"extrude":o==="water"?"water":o==="ocean"?"ocean":o==="line"?"line":o==="tile"?"tile":this.getPointModelType()}},{key:"getPointModelType",value:function(){var i=this.getEncodedData(),a=this.getLayerConfig(),o=a.shape2d,u=a.shape3d,s=this.iconService.getIconMap(),l=i.find(function(h){return h.hasOwnProperty("shape")});if(l){var f=l.shape;return f==="dot"?"point_normal":(o==null?void 0:o.indexOf(f))!==-1?"point_fill":(u==null?void 0:u.indexOf(f))!==-1?"point_extrude":s.hasOwnProperty(f)?"point_image":"text"}else return"fill"}}]),r}(Vh);function RX(e){var t=OX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function OX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var LX=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,FX=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,YT=function(e){Ut(r,e);var t=RX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.clampLow,s=u===void 0?!0:u,l=i.clampHigh,f=l===void 0?!0:l,h=i.noDataValue,d=h===void 0?-9999999:h,v=i.domain,m=v===void 0?[0,1]:v,y=i.rampColors;return this.colorTexture=this.layer.textureService.getColorTexture(y),{u_opacity:o||1,u_texture:this.texture,u_domain:m,u_clampLow:s,u_clampHigh:typeof f<"u"?f:s,u_noDataValue:d,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var n=Ie(H.mark(function a(o){var u,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!Array.isArray(o.data)){d.next=4;break}return d.abrupt("return",{data:o.data,width:o.width,height:o.height});case 4:return d.next=6,o.data;case 6:return u=d.sent,s=u.rasterData,l=u.width,f=u.height,d.abrupt("return",{data:Array.from(s),width:l,height:f});case 11:case"end":return d.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E,S;return H.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=this.layer.getSource(),d=this.rendererService.createTexture2D,v=h.data.dataArray[0],M.next=6,this.getRasterData(v);case 6:return m=M.sent,y=m.data,_=m.width,E=m.height,this.texture=d({data:y,width:_,height:E,format:w.LUMINANCE,type:w.FLOAT}),M.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:FX,fragmentShader:LX,triangulation:wm,primitive:w.TRIANGLES,depth:{enable:!1},stencil:vn(s,f)});case 13:return S=M.sent,M.abrupt("return",[S]);case 15:case"end":return M.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_Uv",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}},{key:"updateColorTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.layer.getLayerConfig(),o=a.rampColors,u=Yx(o);this.colorTexture=i({data:u.data,width:u.width,height:u.height,flipY:!1})}}]),r}(rn),IX=["data"],kX=["rasterData"];function PX(e){var t=DX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function DX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var BX=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
 
}`,NX=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,UX=function(e){Ut(r,e);var t=PX(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"dataOption",{}),n}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,u=i.noDataValue,s=u===void 0?0:u,l=this.dataOption,f=l.rMinMax,h=l.gMinMax,d=l.bMinMax;return{u_opacity:o||1,u_texture:this.texture,u_noDataValue:s,u_rminmax:f,u_gminmax:h,u_bminmax:d}}},{key:"getRasterData",value:function(){var n=Ie(H.mark(function a(o){var u,s,l,f,h;return H.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!Array.isArray(o.data)){v.next=4;break}return u=o.data,s=la(o,IX),this.dataOption=s,v.abrupt("return",be({data:u},s));case 4:return v.next=6,o.data;case 6:if(l=v.sent,f=l.rasterData,h=la(l,kX),this.dataOption=h,!Array.isArray(f)){v.next=14;break}return v.abrupt("return",be({data:f},h));case 14:return v.abrupt("return",be({data:Array.from(f)},h));case 15:case"end":return v.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m,y,_,E,S;return H.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=this.layer.getSource(),d=this.rendererService.createTexture2D,v=h.data.dataArray[0],M.next=6,this.getRasterData(v);case 6:return m=M.sent,y=m.data,_=m.width,E=m.height,this.texture=d({data:y,width:_,height:E,format:w.RGB,type:w.FLOAT}),M.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:NX,fragmentShader:BX,triangulation:wm,primitive:w.TRIANGLES,depth:{enable:!1},stencil:vn(s,f)});case 13:return S=M.sent,M.abrupt("return",[S]);case 15:case"end":return M.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_Uv",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),r}(rn);function zX(e){var t=$X();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function $X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var GX=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y)) * 256.0;
  float r = baseColor.r * 256.0 * 256.0;
  float g = baseColor.g * 256.0;
  float b = baseColor.b;
  float value =  (r + g + b) * 0.1 - 10000.0;
  
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,HX=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,VX=function(e){Ut(r,e);var t=zX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.clampLow,u=o===void 0?!0:o,s=i.clampHigh,l=s===void 0?!0:s,f=i.noDataValue,h=f===void 0?-9999999:f,d=i.domain,v=d===void 0?[0,1]:d,m=i.rampColors,y=i.colorTexture,_=y;return y?this.layer.textureService.setColorTexture(y,m):_=this.layer.textureService.getColorTexture(m),{u_opacity:a||1,u_texture:this.texture,u_domain:v,u_clampLow:u,u_clampHigh:typeof l<"u"?l:u,u_noDataValue:h,u_colorTexture:_}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f,h,d,v,m;return H.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o=this.layer.getLayerConfig(),u=o.mask,s=u===void 0?!1:u,l=o.maskInside,f=l===void 0?!0:l,h=this.layer.getSource(),d=this.rendererService.createTexture2D,_.next=5,h.data.images;case 5:return v=_.sent,this.texture=d({data:v[0],width:v[0].width,height:v[0].height}),_.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:HX,fragmentShader:GX,triangulation:wm,primitive:w.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:vn(s,f)});case 9:return m=_.sent,_.abrupt("return",[m]);case 11:case"end":return _.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ft.Attribute,descriptor:{name:"a_Uv",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),r}(rn),jX={raster:YT,rasterRgb:UX,raster3d:YT,rasterTerrainRgb:VX};const WX=jX;function XX(e){var t=YX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function YX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bE=function(e){Ut(r,e);var t=XX(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"type","RasterLayer"),n}return Pe(r,[{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new WX[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return a[i]}},{key:"getModelType",value:function(){var i=this.layerSource.getParserType();switch(i){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),r}(Vh);function ZX(e){var t=qX();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function qX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var KX=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,QX=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,JX=function(e){Ut(r,e);var t=ZX(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?0:a,u=i.color,s=u===void 0?"#000":u;return{u_opacity:tt.exports.isNumber(o)?o:0,u_color:$r(s)}}},{key:"initModels",value:function(){var n=Ie(H.mark(function a(){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:QX,fragmentShader:KX,triangulation:i0,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:w.ALWAYS,ref:1,mask:255},opFront:{fail:w.REPLACE,zfail:w.REPLACE,zpass:w.REPLACE}},pick:!1});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),r}(rn),eY={fill:JX};const tY=eY;function rY(e){var t=nY();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function nY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var CE=function(e){Ut(r,e);var t=rY(r);function r(){var n;ke(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),T(re(n),"type","MaskLayer"),n}return Pe(r,[{key:"buildModels",value:function(){var n=Ie(H.mark(function a(){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new tY[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getModelType",value:function(){return"fill"}}]),r}(Vh),ZT,qT,KT,QT,eg,JT,e3,iY=(ZT=xr(),qT=kr(Oe.IMapService),KT=kr(Oe.IFontService),ZT(QT=(eg=function(){function e(){ke(this,e),Mr(this,"mapService",JT,this),Mr(this,"fontService",e3,this)}return Pe(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("DataMappingPlugin",Ie(H.mark(function o(){return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:i.generateMaping(r,{styleAttributeService:a});case 1:case"end":return s.stop()}},o)}))),r.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var o=Ie(H.mark(function u(s){return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(s){f.next=2;break}return f.abrupt("return",s);case 2:return r.dataState.dataMappingNeedUpdate=!1,i.generateMaping(r,{styleAttributeService:a}),f.abrupt("return",!0);case 5:case"end":return f.stop()}},u)}));return function(u){return o.apply(this,arguments)}}()),r.hooks.beforeRender.tap("DataMappingPlugin",function(){var o=r.getSource();if(!(r.layerModelNeedUpdate||!o||!o.inited)){var u=a.getLayerStyleAttributes()||[],s=a.getLayerStyleAttribute("filter"),l=o.data.dataArray;if(!(Array.isArray(l)&&l.length===0)){var f=u.filter(function(m){return m.needRemapping}),h=l;if(s!=null&&s.needRemapping&&s!==null&&s!==void 0&&s.scale&&(h=l.filter(function(m){return i.applyAttributeMapping(s,m)[0]})),f.length)if(s!=null&&s.needRemapping){var d=i.mapping(r,u,h,void 0);r.setEncodedData(d),s.needRemapping=!1}else{var v=i.mapping(r,f,h,r.getEncodedData());r.setEncodedData(v)}}}})}},{key:"generateMaping",value:function(r,n){var i=this,a=n.styleAttributeService,o=a.getLayerStyleAttributes()||[],u=a.getLayerStyleAttribute("filter"),s=r.getSource().data.dataArray,l=s;u!=null&&u.scale&&(l=s.filter(function(h){return i.applyAttributeMapping(u,h)[0]})),l=r.processData(l);var f=this.mapping(r,o,l,void 0);r.setEncodedData(f),r.emit("dataUpdate",null)}},{key:"mapping",value:function(r,n,i,a){var o=this,u=r.getLayerConfig(),s=u.arrow,l=s===void 0?{enable:!1}:s,f=n.filter(function(d){return d.scale!==void 0}),h=i.map(function(d,v){var m=a?a[v]:{},y=be({id:d._id,coordinates:d.coordinates},m);if(f.forEach(function(S){var A=o.applyAttributeMapping(S,d);S.needRemapping=!1,S.name==="color"&&(A=A.map(function(M){return $r(M)})),y[S.name]=Array.isArray(A)&&A.length===1?A[0]:A,S.name==="shape"&&(y.shape=o.fontService.getIconFontKey(y[S.name]))}),l.enable&&(y.shape==="line"||y.shape==="halfLine")){var _=y.coordinates;if(r.arrowInsertCount<r.encodeDataLength){var E=o.getArrowPoints(_[0],_[1]);y.coordinates.splice(1,0,E,E),r.arrowInsertCount++}}return y});return this.adjustData2Amap2Coordinates(h,r),this.adjustData2SimpleCoordinates(h),h}},{key:"adjustData2Amap2Coordinates",value:function(r,n){var i=this;if(r.length>0&&this.mapService.version===Ln["GAODE2.x"]){var a=n.coordCenter||n.getSource().center;typeof r[0].coordinates[0]=="number"?r.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=Ln["GAODE2.x"],o.originCoordinates=tt.exports.cloneDeep(o.coordinates),o.coordinates=i.mapService.lngLatToCoordByLayer(o.coordinates,a)}):r.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=Ln["GAODE2.x"],o.originCoordinates=tt.exports.cloneDeep(o.coordinates),o.coordinates=i.mapService.lngLatToCoordsByLayer(o.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(r){var n=this;r.length>0&&this.mapService.version===Ln.SIMPLE&&r.map(function(i){i.simpleCoordinate||(i.coordinates=n.unProjectCoordinates(i.coordinates),i.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(r){var n=this;if(typeof r[0]=="number")return this.mapService.simpleMapCoord.unproject(r);if(r[0]&&r[0][0]instanceof Array){var i=[];return r.map(function(o){var u=[];o.map(function(s){u.push(n.mapService.simpleMapCoord.unproject(s))}),i.push(u)}),i}else{var a=[];return r.map(function(o){a.push(n.mapService.simpleMapCoord.unproject(o))}),a}}},{key:"applyAttributeMapping",value:function(r,n){var i;if(!r.scale)return[];var a=(r==null||(i=r.scale)===null||i===void 0?void 0:i.scalers)||[],o=[];a.forEach(function(s){var l,f=s.field;(n.hasOwnProperty(f)||((l=r.scale)===null||l===void 0?void 0:l.type)==="variable")&&o.push(n[f])});var u=r.mapping?r.mapping(o):[];return u}},{key:"getArrowPoints",value:function(r,n){var i=[n[0]-r[0],n[1]-r[1]],a=e5(i),o=[r[0]+a[0]*1e-4,r[1]+a[1]*1e-4];return o}}]),e}(),JT=wr(eg.prototype,"mapService",[qT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e3=wr(eg.prototype,"fontService",[KT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eg))||QT),t3,r3,aY=(t3=xr(),t3(r3=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r){var n=this;this.mapService=r.getContainer().get(Oe.IMapService),r.hooks.init.tapPromise("DataSourcePlugin",Ie(H.mark(function i(){var a,o,u,s;return H.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(a=r.getSource(),a||(o=r.sourceOption||r.defaultSourceConfig,u=o.data,s=o.options,a=new mE(u,s),r.setSource(a)),!a.inited){f.next=6;break}n.updateClusterData(r),f.next=8;break;case 6:return f.next=8,new Promise(function(h){a.on("update",function(d){d.type==="inited"&&n.updateClusterData(r),h(null)})});case 8:case"end":return f.stop()}},i)}))),r.hooks.beforeRenderData.tapPromise("DataSourcePlugin",Ie(H.mark(function i(){var a,o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=n.updateClusterData(r),o=r.dataState.dataSourceNeedUpdate,r.dataState.dataSourceNeedUpdate=!1,s.abrupt("return",a||o);case 4:case"end":return s.stop()}},i)})))}},{key:"updateClusterData",value:function(r){if(r.isTileLayer||r.tileLayer||!r.getSource())return!1;var n=r.getSource(),i=n.cluster,a=n.clusterOptions.zoom,o=a===void 0?0:a,u=this.mapService.getZoom()-1,s=r.dataState.dataSourceNeedUpdate;return i&&s&&n.updateClusterData(Math.floor(u)),i&&Math.abs(r.clusterZoom-u)>=1?(o!==Math.floor(u)&&n.updateClusterData(Math.floor(u)),r.clusterZoom=u,!0):!1}}]),e}())||r3);function AE(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function HM(e){return e.length===1&&(e=oY(e)),{left:function(t,r,n,i){for(n==null&&(n=0),i==null&&(i=t.length);n<i;){var a=n+i>>>1;e(t[a],r)<0?n=a+1:i=a}return n},right:function(t,r,n,i){for(n==null&&(n=0),i==null&&(i=t.length);n<i;){var a=n+i>>>1;e(t[a],r)>0?i=a:n=a+1}return n}}}function oY(e){return function(t,r){return AE(e(t),r)}}var uY=HM(AE),Rm=uY.right;function sY(e){return e===null?NaN:+e}function n3(e,t){var r=e.length,n=-1,i,a,o;if(t==null){for(;++n<r;)if((i=e[n])!=null&&i>=i)for(a=o=i;++n<r;)(i=e[n])!=null&&(a>i&&(a=i),o<i&&(o=i))}else for(;++n<r;)if((i=t(e[n],n,e))!=null&&i>=i)for(a=o=i;++n<r;)(i=t(e[n],n,e))!=null&&(a>i&&(a=i),o<i&&(o=i));return[a,o]}var J1=Math.sqrt(50),ex=Math.sqrt(10),tx=Math.sqrt(2);function VM(e,t,r){var n,i=-1,a,o,u;if(t=+t,e=+e,r=+r,e===t&&r>0)return[e];if((n=t<e)&&(a=e,e=t,t=a),(u=_g(e,t,r))===0||!isFinite(u))return[];if(u>0)for(e=Math.ceil(e/u),t=Math.floor(t/u),o=new Array(a=Math.ceil(t-e+1));++i<a;)o[i]=(e+i)*u;else for(e=Math.floor(e*u),t=Math.ceil(t*u),o=new Array(a=Math.ceil(e-t+1));++i<a;)o[i]=(e-i)/u;return n&&o.reverse(),o}function _g(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=J1?10:a>=ex?5:a>=tx?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=J1?10:a>=ex?5:a>=tx?2:1)}function rx(e,t,r){var n=Math.abs(t-e)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),a=n/i;return a>=J1?i*=10:a>=ex?i*=5:a>=tx&&(i*=2),t<e?-i:i}function lY(e,t,r){if(r==null&&(r=sY),!!(n=e.length)){if((t=+t)<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),u=+r(e[a+1],a+1,e);return o+(u-o)*(i-a)}}function cY(e,t,r,n,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*r+(1+3*e+3*a-3*o)*n+o*i)/6}function fY(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],o=n>0?e[n-1]:2*i-a,u=n<t-1?e[n+2]:2*a-i;return cY((r-n/t)*t,o,i,a,u)}}function SE(e){return function(){return e}}function hY(e,t){return function(r){return e+r*t}}function pY(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function dY(e){return(e=+e)==1?jM:function(t,r){return r-t?pY(t,r,e):SE(isNaN(t)?r:t)}}function jM(e,t){var r=t-e;return r?hY(e,r):SE(isNaN(e)?t:e)}const i3=function e(t){var r=dY(t);function n(i,a){var o=r((i=Og(i)).r,(a=Og(a)).r),u=r(i.g,a.g),s=r(i.b,a.b),l=jM(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=u(f),i.b=s(f),i.opacity=l(f),i+""}}return n.gamma=e,n}(1);function vY(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),a=new Array(r),o,u;for(o=0;o<r;++o)u=Og(t[o]),n[o]=u.r||0,i[o]=u.g||0,a[o]=u.b||0;return n=e(n),i=e(i),a=e(a),u.opacity=1,function(s){return u.r=n(s),u.g=i(s),u.b=a(s),u+""}}}var gY=vY(fY);function mY(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function yY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _Y(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=TE(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(u){for(o=0;o<n;++o)a[o]=i[o](u);return a}}function xY(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ng(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function EY(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=TE(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var nx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,D_=new RegExp(nx.source,"g");function bY(e){return function(){return e}}function CY(e){return function(t){return e(t)+""}}function AY(e,t){var r=nx.lastIndex=D_.lastIndex=0,n,i,a,o=-1,u=[],s=[];for(e=e+"",t=t+"";(n=nx.exec(e))&&(i=D_.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,s.push({i:o,x:Ng(n,i)})),r=D_.lastIndex;return r<t.length&&(a=t.slice(r),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?CY(s[0].x):bY(t):(t=s.length,function(l){for(var f=0,h;f<t;++f)u[(h=s[f]).i]=h.x(l);return u.join("")})}function TE(e,t){var r=typeof t,n;return t==null||r==="boolean"?SE(t):(r==="number"?Ng:r==="string"?(n=zc(t))?(t=n,i3):AY:t instanceof zc?i3:t instanceof Date?xY:yY(t)?mY:Array.isArray(t)?_Y:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?EY:Ng)(e,t)}function SY(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Sl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function WM(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e);break}return this}var eo="$";function Ug(){}Ug.prototype=zg.prototype={constructor:Ug,has:function(e){return eo+e in this},get:function(e){return this[eo+e]},set:function(e,t){return this[eo+e]=t,this},remove:function(e){var t=eo+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===eo&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===eo&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===eo&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===eo&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===eo&&++e;return e},empty:function(){for(var e in this)if(e[0]===eo)return!1;return!0},each:function(e){for(var t in this)t[0]===eo&&e(this[t],t.slice(1),this)}};function zg(e,t){var r=new Ug;if(e instanceof Ug)e.each(function(u,s){r.set(s,u)});else if(Array.isArray(e)){var n=-1,i=e.length,a;if(t==null)for(;++n<i;)r.set(n,e[n]);else for(;++n<i;)r.set(t(a=e[n],n,e),a)}else if(e)for(var o in e)r.set(o,e[o]);return r}function a3(){}var Ec=zg.prototype;a3.prototype={constructor:a3,has:Ec.has,add:function(e){return e+="",this[eo+e]=e,this},remove:Ec.remove,clear:Ec.clear,values:Ec.keys,size:Ec.size,empty:Ec.empty,each:Ec.each};var XM=Array.prototype,$g=XM.map,Wc=XM.slice,o3={name:"implicit"};function Gg(){var e=zg(),t=[],r=[],n=o3;function i(a){var o=a+"",u=e.get(o);if(!u){if(n!==o3)return n;e.set(o,u=t.push(a))}return r[(u-1)%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=zg();for(var o=-1,u=a.length,s,l;++o<u;)e.has(l=(s=a[o])+"")||e.set(l,t.push(s));return i},i.range=function(a){return arguments.length?(r=Wc.call(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Gg(t,r).unknown(n)},Sl.apply(i,arguments),i}function TY(e){return function(){return e}}function ix(e){return+e}var u3=[0,1];function Li(e){return e}function ax(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:TY(isNaN(t)?NaN:.5)}function s3(e){var t=e[0],r=e[e.length-1],n;return t>r&&(n=t,t=r,r=n),function(i){return Math.max(t,Math.min(r,i))}}function wY(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=ax(i,n),a=r(o,a)):(n=ax(n,i),a=r(a,o)),function(u){return a(n(u))}}function MY(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=ax(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(u){var s=Rm(e,u,1,n)-1;return a[s](i[s](u))}}function Om(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function wE(){var e=u3,t=u3,r=TE,n,i,a,o=Li,u,s,l;function f(){return u=Math.min(e.length,t.length)>2?MY:wY,s=l=null,h}function h(d){return isNaN(d=+d)?a:(s||(s=u(e.map(n),t,r)))(n(o(d)))}return h.invert=function(d){return o(i((l||(l=u(t,e.map(n),Ng)))(d)))},h.domain=function(d){return arguments.length?(e=$g.call(d,ix),o===Li||(o=s3(e)),f()):e.slice()},h.range=function(d){return arguments.length?(t=Wc.call(d),f()):t.slice()},h.rangeRound=function(d){return t=Wc.call(d),r=SY,f()},h.clamp=function(d){return arguments.length?(o=d?s3(e):Li,h):o!==Li},h.interpolate=function(d){return arguments.length?(r=d,f()):r},h.unknown=function(d){return arguments.length?(a=d,h):a},function(d,v){return n=d,i=v,f()}}function YM(e,t){return wE()(e,t)}function RY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Hg(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ih(e){return e=Hg(Math.abs(e)),e?e[1]:NaN}function OY(e,t){return function(r,n){for(var i=r.length,a=[],o=0,u=e[0],s=0;i>0&&u>0&&(s+u+1>n&&(u=Math.max(1,n-s)),a.push(r.substring(i-=u,i+u)),!((s+=u+1)>n));)u=e[o=(o+1)%e.length];return a.reverse().join(t)}}function LY(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var FY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vg(e){if(!(t=FY.exec(e)))throw new Error("invalid format: "+e);var t;return new ME({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Vg.prototype=ME.prototype;function ME(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ME.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function IY(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var ZM;function kY(e,t){var r=Hg(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(ZM=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Hg(e,Math.max(0,t+a-1))[0]}function l3(e,t){var r=Hg(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const c3={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:RY,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return l3(e*100,t)},r:l3,s:kY,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function f3(e){return e}var h3=Array.prototype.map,p3=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function PY(e){var t=e.grouping===void 0||e.thousands===void 0?f3:OY(h3.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?f3:LY(h3.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"-":e.minus+"",s=e.nan===void 0?"NaN":e.nan+"";function l(h){h=Vg(h);var d=h.fill,v=h.align,m=h.sign,y=h.symbol,_=h.zero,E=h.width,S=h.comma,A=h.precision,M=h.trim,O=h.type;O==="n"?(S=!0,O="g"):c3[O]||(A===void 0&&(A=12),M=!0,O="g"),(_||d==="0"&&v==="=")&&(_=!0,d="0",v="=");var j=y==="$"?r:y==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",q=y==="$"?n:/[%p]/.test(O)?o:"",Y=c3[O],ne=/[defgprs%]/.test(O);A=A===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function X($){var K=j,ue=q,de,pe,le;if(O==="c")ue=Y($)+ue,$="";else{$=+$;var ve=$<0||1/$<0;if($=isNaN($)?s:Y(Math.abs($),A),M&&($=IY($)),ve&&+$==0&&m!=="+"&&(ve=!1),K=(ve?m==="("?m:u:m==="-"||m==="("?"":m)+K,ue=(O==="s"?p3[8+ZM/3]:"")+ue+(ve&&m==="("?")":""),ne){for(de=-1,pe=$.length;++de<pe;)if(le=$.charCodeAt(de),48>le||le>57){ue=(le===46?i+$.slice(de+1):$.slice(de))+ue,$=$.slice(0,de);break}}}S&&!_&&($=t($,1/0));var Me=K.length+$.length+ue.length,Ne=Me<E?new Array(E-Me+1).join(d):"";switch(S&&_&&($=t(Ne+$,Ne.length?E-ue.length:1/0),Ne=""),v){case"<":$=K+$+ue+Ne;break;case"=":$=K+Ne+$+ue;break;case"^":$=Ne.slice(0,Me=Ne.length>>1)+K+$+ue+Ne.slice(Me);break;default:$=Ne+K+$+ue;break}return a($)}return X.toString=function(){return h+""},X}function f(h,d){var v=l((h=Vg(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(Ih(d)/3)))*3,y=Math.pow(10,-m),_=p3[8+m/3];return function(E){return v(y*E)+_}}return{format:l,formatPrefix:f}}var tg,RE,qM;DY({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function DY(e){return tg=PY(e),RE=tg.format,qM=tg.formatPrefix,tg}function BY(e){return Math.max(0,-Ih(Math.abs(e)))}function NY(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ih(t)/3)))*3-Ih(Math.abs(e)))}function UY(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ih(t)-Ih(e))+1}function zY(e,t,r,n){var i=rx(e,t,r),a;switch(n=Vg(n==null?",f":n),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=NY(i,o))&&(n.precision=a),qM(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=UY(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=BY(i))&&(n.precision=a-(n.type==="%")*2);break}}return RE(n)}function jh(e){var t=e.domain;return e.ticks=function(r){var n=t();return VM(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var i=t();return zY(i[0],i[i.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],u=n[a],s;return u<o&&(s=o,o=u,u=s,s=i,i=a,a=s),s=_g(o,u,r),s>0?(o=Math.floor(o/s)*s,u=Math.ceil(u/s)*s,s=_g(o,u,r)):s<0&&(o=Math.ceil(o*s)/s,u=Math.floor(u*s)/s,s=_g(o,u,r)),s>0?(n[i]=Math.floor(o/s)*s,n[a]=Math.ceil(u/s)*s,t(n)):s<0&&(n[i]=Math.ceil(o*s)/s,n[a]=Math.floor(u*s)/s,t(n)),e},e}function KM(){var e=YM(Li,Li);return e.copy=function(){return Om(e,KM())},Sl.apply(e,arguments),jh(e)}function QM(e){var t;function r(n){return isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=$g.call(n,ix),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return QM(e).unknown(t)},e=arguments.length?$g.call(e,ix):[0,1],jh(r)}function JM(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}function d3(e){return Math.log(e)}function v3(e){return Math.exp(e)}function $Y(e){return-Math.log(-e)}function GY(e){return-Math.exp(-e)}function HY(e){return isFinite(e)?+("1e"+e):e<0?0:e}function VY(e){return e===10?HY:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function jY(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function g3(e){return function(t){return-e(-t)}}function WY(e){var t=e(d3,v3),r=t.domain,n=10,i,a;function o(){return i=jY(n),a=VY(n),r()[0]<0?(i=g3(i),a=g3(a),e($Y,GY)):e(d3,v3),t}return t.base=function(u){return arguments.length?(n=+u,o()):n},t.domain=function(u){return arguments.length?(r(u),o()):r()},t.ticks=function(u){var s=r(),l=s[0],f=s[s.length-1],h;(h=f<l)&&(d=l,l=f,f=d);var d=i(l),v=i(f),m,y,_,E=u==null?10:+u,S=[];if(!(n%1)&&v-d<E){if(d=Math.round(d)-1,v=Math.round(v)+1,l>0){for(;d<v;++d)for(y=1,m=a(d);y<n;++y)if(_=m*y,!(_<l)){if(_>f)break;S.push(_)}}else for(;d<v;++d)for(y=n-1,m=a(d);y>=1;--y)if(_=m*y,!(_<l)){if(_>f)break;S.push(_)}}else S=VM(d,v,Math.min(v-d,E)).map(a);return h?S.reverse():S},t.tickFormat=function(u,s){if(s==null&&(s=n===10?".0e":","),typeof s!="function"&&(s=RE(s)),u===1/0)return s;u==null&&(u=10);var l=Math.max(1,n*u/t.ticks().length);return function(f){var h=f/a(Math.round(i(f)));return h*n<n-.5&&(h*=n),h<=l?s(f):""}},t.nice=function(){return r(JM(r(),{floor:function(u){return a(Math.floor(i(u)))},ceil:function(u){return a(Math.ceil(i(u)))}}))},t}function e7(){var e=WY(wE()).domain([1,10]);return e.copy=function(){return Om(e,e7()).base(e.base())},Sl.apply(e,arguments),e}function m3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function XY(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function YY(e){return e<0?-e*e:e*e}function ZY(e){var t=e(Li,Li),r=1;function n(){return r===1?e(Li,Li):r===.5?e(XY,YY):e(m3(r),m3(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},jh(t)}function t7(){var e=ZY(wE());return e.copy=function(){return Om(e,t7()).exponent(e.exponent())},Sl.apply(e,arguments),e}function r7(){var e=[],t=[],r=[],n;function i(){var o=0,u=Math.max(1,t.length);for(r=new Array(u-1);++o<u;)r[o-1]=lY(e,o/u);return a}function a(o){return isNaN(o=+o)?n:t[Rm(r,o)]}return a.invertExtent=function(o){var u=t.indexOf(o);return u<0?[NaN,NaN]:[u>0?r[u-1]:e[0],u<r.length?r[u]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(var u=0,s=o.length,l;u<s;++u)l=o[u],l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(AE),i()},a.range=function(o){return arguments.length?(t=Wc.call(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return r7().domain(e).range(t).unknown(n)},Sl.apply(a,arguments)}function n7(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(s){return s<=s?i[Rm(n,s,0,r)]:a}function u(){var s=-1;for(n=new Array(r);++s<r;)n[s]=((s+1)*t-(s-r)*e)/(r+1);return o}return o.domain=function(s){return arguments.length?(e=+s[0],t=+s[1],u()):[e,t]},o.range=function(s){return arguments.length?(r=(i=Wc.call(s)).length-1,u()):i.slice()},o.invertExtent=function(s){var l=i.indexOf(s);return l<0?[NaN,NaN]:l<1?[e,n[0]]:l>=r?[n[r-1],t]:[n[l-1],n[l]]},o.unknown=function(s){return arguments.length&&(a=s),o},o.thresholds=function(){return n.slice()},o.copy=function(){return n7().domain([e,t]).range(i).unknown(a)},Sl.apply(jh(o),arguments)}function i7(){var e=[.5],t=[0,1],r,n=1;function i(a){return a<=a?t[Rm(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Wc.call(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Wc.call(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return i7().domain(e).range(t).unknown(r)},Sl.apply(i,arguments)}var B_=new Date,N_=new Date;function ji(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),u=i.ceil(a);return a-o<u-a?o:u},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,u){var s=[],l;if(a=i.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),t(a,u),e(a);while(l<a&&a<o);return s},i.filter=function(a){return ji(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;t(o,-1),!a(o););else for(;--u>=0;)for(;t(o,1),!a(o););})},r&&(i.count=function(a,o){return B_.setTime(+a),N_.setTime(+o),e(B_),e(N_),Math.floor(r(B_,N_))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?function(o){return n(o)%a===0}:function(o){return i.count(0,o)%a===0}):i}),i}var jg=ji(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});jg.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ji(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):jg};const qY=jg;jg.range;var Wg=1e3,a0=6e4,y3=36e5,a7=864e5,o7=6048e5,u7=ji(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Wg)},function(e,t){return(t-e)/Wg},function(e){return e.getUTCSeconds()});const KY=u7;u7.range;var s7=ji(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wg)},function(e,t){e.setTime(+e+t*a0)},function(e,t){return(t-e)/a0},function(e){return e.getMinutes()});const QY=s7;s7.range;var l7=ji(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wg-e.getMinutes()*a0)},function(e,t){e.setTime(+e+t*y3)},function(e,t){return(t-e)/y3},function(e){return e.getHours()});const JY=l7;l7.range;var c7=ji(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*a0)/a7},function(e){return e.getDate()-1});const OE=c7;c7.range;function Yc(e){return ji(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,r){t.setDate(t.getDate()+r*7)},function(t,r){return(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*a0)/o7})}var LE=Yc(0),Xg=Yc(1),eZ=Yc(2),tZ=Yc(3),kh=Yc(4),rZ=Yc(5),nZ=Yc(6);LE.range;Xg.range;eZ.range;tZ.range;kh.range;rZ.range;nZ.range;var f7=ji(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});const iZ=f7;f7.range;var FE=ji(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});FE.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ji(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)})};const Ph=FE;FE.range;var h7=ji(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/a7},function(e){return e.getUTCDate()-1});const p7=h7;h7.range;function Zc(e){return ji(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCDate(t.getUTCDate()+r*7)},function(t,r){return(r-t)/o7})}var d7=Zc(0),Yg=Zc(1),aZ=Zc(2),oZ=Zc(3),Dh=Zc(4),uZ=Zc(5),sZ=Zc(6);d7.range;Yg.range;aZ.range;oZ.range;Dh.range;uZ.range;sZ.range;var IE=ji(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});IE.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ji(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)})};const o0=IE;IE.range;function U_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function z_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function sd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function lZ(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,l=ld(i),f=cd(i),h=ld(a),d=cd(a),v=ld(o),m=cd(o),y=ld(u),_=cd(u),E=ld(s),S=cd(s),A={a:ve,A:Me,b:Ne,B:Xe,c:null,d:A3,e:A3,f:FZ,g:GZ,G:VZ,H:RZ,I:OZ,j:LZ,L:v7,m:IZ,M:kZ,p:ct,q:$t,Q:w3,s:M3,S:PZ,u:DZ,U:BZ,V:NZ,w:UZ,W:zZ,x:null,X:null,y:$Z,Y:HZ,Z:jZ,"%":T3},M={a:Qt,A:Zt,b:jt,B:Cr,c:null,d:S3,e:S3,f:ZZ,g:aq,G:uq,H:WZ,I:XZ,j:YZ,L:m7,m:qZ,M:KZ,p:gn,q:ii,Q:w3,s:M3,S:QZ,u:JZ,U:eq,V:tq,w:rq,W:nq,x:null,X:null,y:iq,Y:oq,Z:sq,"%":T3},O={a:X,A:$,b:K,B:ue,c:de,d:b3,e:b3,f:SZ,g:E3,G:x3,H:C3,I:C3,j:EZ,L:AZ,m:xZ,M:bZ,p:ne,q:_Z,Q:wZ,s:MZ,S:CZ,u:dZ,U:vZ,V:gZ,w:pZ,W:mZ,x:pe,X:le,y:E3,Y:x3,Z:yZ,"%":TZ};A.x=j(r,A),A.X=j(n,A),A.c=j(t,A),M.x=j(r,M),M.X=j(n,M),M.c=j(t,M);function j(Mt,qt){return function(ar){var k=[],ae=-1,_e=0,Ge=Mt.length,je,Qe,Ot;for(ar instanceof Date||(ar=new Date(+ar));++ae<Ge;)Mt.charCodeAt(ae)===37&&(k.push(Mt.slice(_e,ae)),(Qe=_3[je=Mt.charAt(++ae)])!=null?je=Mt.charAt(++ae):Qe=je==="e"?" ":"0",(Ot=qt[je])&&(je=Ot(ar,Qe)),k.push(je),_e=ae+1);return k.push(Mt.slice(_e,ae)),k.join("")}}function q(Mt,qt){return function(ar){var k=sd(1900,void 0,1),ae=Y(k,Mt,ar+="",0),_e,Ge;if(ae!=ar.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(qt&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(_e=z_(sd(k.y,0,1)),Ge=_e.getUTCDay(),_e=Ge>4||Ge===0?Yg.ceil(_e):Yg(_e),_e=p7.offset(_e,(k.V-1)*7),k.y=_e.getUTCFullYear(),k.m=_e.getUTCMonth(),k.d=_e.getUTCDate()+(k.w+6)%7):(_e=U_(sd(k.y,0,1)),Ge=_e.getDay(),_e=Ge>4||Ge===0?Xg.ceil(_e):Xg(_e),_e=OE.offset(_e,(k.V-1)*7),k.y=_e.getFullYear(),k.m=_e.getMonth(),k.d=_e.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),Ge="Z"in k?z_(sd(k.y,0,1)).getUTCDay():U_(sd(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(Ge+5)%7:k.w+k.U*7-(Ge+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,z_(k)):U_(k)}}function Y(Mt,qt,ar,k){for(var ae=0,_e=qt.length,Ge=ar.length,je,Qe;ae<_e;){if(k>=Ge)return-1;if(je=qt.charCodeAt(ae++),je===37){if(je=qt.charAt(ae++),Qe=O[je in _3?qt.charAt(ae++):je],!Qe||(k=Qe(Mt,ar,k))<0)return-1}else if(je!=ar.charCodeAt(k++))return-1}return k}function ne(Mt,qt,ar){var k=l.exec(qt.slice(ar));return k?(Mt.p=f[k[0].toLowerCase()],ar+k[0].length):-1}function X(Mt,qt,ar){var k=v.exec(qt.slice(ar));return k?(Mt.w=m[k[0].toLowerCase()],ar+k[0].length):-1}function $(Mt,qt,ar){var k=h.exec(qt.slice(ar));return k?(Mt.w=d[k[0].toLowerCase()],ar+k[0].length):-1}function K(Mt,qt,ar){var k=E.exec(qt.slice(ar));return k?(Mt.m=S[k[0].toLowerCase()],ar+k[0].length):-1}function ue(Mt,qt,ar){var k=y.exec(qt.slice(ar));return k?(Mt.m=_[k[0].toLowerCase()],ar+k[0].length):-1}function de(Mt,qt,ar){return Y(Mt,t,qt,ar)}function pe(Mt,qt,ar){return Y(Mt,r,qt,ar)}function le(Mt,qt,ar){return Y(Mt,n,qt,ar)}function ve(Mt){return o[Mt.getDay()]}function Me(Mt){return a[Mt.getDay()]}function Ne(Mt){return s[Mt.getMonth()]}function Xe(Mt){return u[Mt.getMonth()]}function ct(Mt){return i[+(Mt.getHours()>=12)]}function $t(Mt){return 1+~~(Mt.getMonth()/3)}function Qt(Mt){return o[Mt.getUTCDay()]}function Zt(Mt){return a[Mt.getUTCDay()]}function jt(Mt){return s[Mt.getUTCMonth()]}function Cr(Mt){return u[Mt.getUTCMonth()]}function gn(Mt){return i[+(Mt.getUTCHours()>=12)]}function ii(Mt){return 1+~~(Mt.getUTCMonth()/3)}return{format:function(Mt){var qt=j(Mt+="",A);return qt.toString=function(){return Mt},qt},parse:function(Mt){var qt=q(Mt+="",!1);return qt.toString=function(){return Mt},qt},utcFormat:function(Mt){var qt=j(Mt+="",M);return qt.toString=function(){return Mt},qt},utcParse:function(Mt){var qt=q(Mt+="",!0);return qt.toString=function(){return Mt},qt}}}var _3={"-":"",_:" ",0:"0"},hi=/^\s*\d+/,cZ=/^%/,fZ=/[\\^$*+?|[\]().{}]/g;function tn(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function hZ(e){return e.replace(fZ,"\\$&")}function ld(e){return new RegExp("^(?:"+e.map(hZ).join("|")+")","i")}function cd(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function pZ(e,t,r){var n=hi.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function dZ(e,t,r){var n=hi.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function vZ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function gZ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function mZ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function x3(e,t,r){var n=hi.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function E3(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function yZ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function _Z(e,t,r){var n=hi.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function xZ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function b3(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function EZ(e,t,r){var n=hi.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function C3(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function bZ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function CZ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function AZ(e,t,r){var n=hi.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function SZ(e,t,r){var n=hi.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function TZ(e,t,r){var n=cZ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function wZ(e,t,r){var n=hi.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function MZ(e,t,r){var n=hi.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function A3(e,t){return tn(e.getDate(),t,2)}function RZ(e,t){return tn(e.getHours(),t,2)}function OZ(e,t){return tn(e.getHours()%12||12,t,2)}function LZ(e,t){return tn(1+OE.count(Ph(e),e),t,3)}function v7(e,t){return tn(e.getMilliseconds(),t,3)}function FZ(e,t){return v7(e,t)+"000"}function IZ(e,t){return tn(e.getMonth()+1,t,2)}function kZ(e,t){return tn(e.getMinutes(),t,2)}function PZ(e,t){return tn(e.getSeconds(),t,2)}function DZ(e){var t=e.getDay();return t===0?7:t}function BZ(e,t){return tn(LE.count(Ph(e)-1,e),t,2)}function g7(e){var t=e.getDay();return t>=4||t===0?kh(e):kh.ceil(e)}function NZ(e,t){return e=g7(e),tn(kh.count(Ph(e),e)+(Ph(e).getDay()===4),t,2)}function UZ(e){return e.getDay()}function zZ(e,t){return tn(Xg.count(Ph(e)-1,e),t,2)}function $Z(e,t){return tn(e.getFullYear()%100,t,2)}function GZ(e,t){return e=g7(e),tn(e.getFullYear()%100,t,2)}function HZ(e,t){return tn(e.getFullYear()%1e4,t,4)}function VZ(e,t){var r=e.getDay();return e=r>=4||r===0?kh(e):kh.ceil(e),tn(e.getFullYear()%1e4,t,4)}function jZ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+tn(t/60|0,"0",2)+tn(t%60,"0",2)}function S3(e,t){return tn(e.getUTCDate(),t,2)}function WZ(e,t){return tn(e.getUTCHours(),t,2)}function XZ(e,t){return tn(e.getUTCHours()%12||12,t,2)}function YZ(e,t){return tn(1+p7.count(o0(e),e),t,3)}function m7(e,t){return tn(e.getUTCMilliseconds(),t,3)}function ZZ(e,t){return m7(e,t)+"000"}function qZ(e,t){return tn(e.getUTCMonth()+1,t,2)}function KZ(e,t){return tn(e.getUTCMinutes(),t,2)}function QZ(e,t){return tn(e.getUTCSeconds(),t,2)}function JZ(e){var t=e.getUTCDay();return t===0?7:t}function eq(e,t){return tn(d7.count(o0(e)-1,e),t,2)}function y7(e){var t=e.getUTCDay();return t>=4||t===0?Dh(e):Dh.ceil(e)}function tq(e,t){return e=y7(e),tn(Dh.count(o0(e),e)+(o0(e).getUTCDay()===4),t,2)}function rq(e){return e.getUTCDay()}function nq(e,t){return tn(Yg.count(o0(e)-1,e),t,2)}function iq(e,t){return tn(e.getUTCFullYear()%100,t,2)}function aq(e,t){return e=y7(e),tn(e.getUTCFullYear()%100,t,2)}function oq(e,t){return tn(e.getUTCFullYear()%1e4,t,4)}function uq(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Dh(e):Dh.ceil(e),tn(e.getUTCFullYear()%1e4,t,4)}function sq(){return"+0000"}function T3(){return"%"}function w3(e){return+e}function M3(e){return Math.floor(+e/1e3)}var ah,_7;lq({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function lq(e){return ah=lZ(e),_7=ah.format,ah.parse,ah.utcFormat,ah.utcParse,ah}var bd=1e3,Cd=bd*60,Ad=Cd*60,u0=Ad*24,cq=u0*7,R3=u0*30,$_=u0*365;function fq(e){return new Date(e)}function hq(e){return e instanceof Date?+e:+new Date(+e)}function x7(e,t,r,n,i,a,o,u,s){var l=YM(Li,Li),f=l.invert,h=l.domain,d=s(".%L"),v=s(":%S"),m=s("%I:%M"),y=s("%I %p"),_=s("%a %d"),E=s("%b %d"),S=s("%B"),A=s("%Y"),M=[[o,1,bd],[o,5,5*bd],[o,15,15*bd],[o,30,30*bd],[a,1,Cd],[a,5,5*Cd],[a,15,15*Cd],[a,30,30*Cd],[i,1,Ad],[i,3,3*Ad],[i,6,6*Ad],[i,12,12*Ad],[n,1,u0],[n,2,2*u0],[r,1,cq],[t,1,R3],[t,3,3*R3],[e,1,$_]];function O(q){return(o(q)<q?d:a(q)<q?v:i(q)<q?m:n(q)<q?y:t(q)<q?r(q)<q?_:E:e(q)<q?S:A)(q)}function j(q,Y,ne,X){if(q==null&&(q=10),typeof q=="number"){var $=Math.abs(ne-Y)/q,K=HM(function(ue){return ue[2]}).right(M,$);K===M.length?(X=rx(Y/$_,ne/$_,q),q=e):K?(K=M[$/M[K-1][2]<M[K][2]/$?K-1:K],X=K[1],q=K[0]):(X=Math.max(rx(Y,ne,q),1),q=u)}return X==null?q:q.every(X)}return l.invert=function(q){return new Date(f(q))},l.domain=function(q){return arguments.length?h($g.call(q,hq)):h().map(fq)},l.ticks=function(q,Y){var ne=h(),X=ne[0],$=ne[ne.length-1],K=$<X,ue;return K&&(ue=X,X=$,$=ue),ue=j(q,X,$,Y),ue=ue?ue.range(X,$+1):[],K?ue.reverse():ue},l.tickFormat=function(q,Y){return Y==null?O:s(Y)},l.nice=function(q,Y){var ne=h();return(q=j(q,ne[0],ne[ne.length-1],Y))?h(JM(ne,q)):l},l.copy=function(){return Om(l,x7(e,t,r,n,i,a,o,u,s))},l}function pq(){return Sl.apply(x7(Ph,iZ,LE,OE,JY,QY,KY,qY,_7).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function dq(){var e=0,t=1,r,n,i,a,o=Li,u=!1,s;function l(f){return isNaN(f=+f)?s:o(i===0?.5:(f=(a(f)-r)*i,u?Math.max(0,Math.min(1,f)):f))}return l.domain=function(f){return arguments.length?(r=a(e=+f[0]),n=a(t=+f[1]),i=r===n?0:1/(n-r),l):[e,t]},l.clamp=function(f){return arguments.length?(u=!!f,l):u},l.interpolator=function(f){return arguments.length?(o=f,l):o},l.unknown=function(f){return arguments.length?(s=f,l):s},function(f){return a=f,r=f(e),n=f(t),i=r===n?0:1/(n-r),l}}function E7(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function b7(){var e=jh(dq()(Li));return e.copy=function(){return E7(e,b7())},WM.apply(e,arguments)}function vq(){var e=0,t=.5,r=1,n,i,a,o,u,s=Li,l,f=!1,h;function d(v){return isNaN(v=+v)?h:(v=.5+((v=+l(v))-i)*(v<i?o:u),s(f?Math.max(0,Math.min(1,v)):v))}return d.domain=function(v){return arguments.length?(n=l(e=+v[0]),i=l(t=+v[1]),a=l(r=+v[2]),o=n===i?0:.5/(i-n),u=i===a?0:.5/(a-i),d):[e,t,r]},d.clamp=function(v){return arguments.length?(f=!!v,d):f},d.interpolator=function(v){return arguments.length?(s=v,d):s},d.unknown=function(v){return arguments.length?(h=v,d):h},function(v){return l=v,n=v(e),i=v(t),a=v(r),o=n===i?0:.5/(i-n),u=i===a?0:.5/(a-i),d}}function C7(){var e=jh(vq()(Li));return e.copy=function(){return E7(e,C7())},WM.apply(e,arguments)}var wa,O3,L3,gq=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,mq=(wa={},T(wa,Jr.LINEAR,KM),T(wa,Jr.POWER,t7),T(wa,Jr.LOG,e7),T(wa,Jr.IDENTITY,QM),T(wa,Jr.SEQUENTIAL,b7),T(wa,Jr.TIME,pq),T(wa,Jr.QUANTILE,r7),T(wa,Jr.QUANTIZE,n7),T(wa,Jr.THRESHOLD,i7),T(wa,Jr.CAT,Gg),T(wa,Jr.DIVERGING,C7),wa),yq=(O3=xr(),O3(L3=function(){function e(){ke(this,e),T(this,"scaleOptions",{})}return Pe(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("FeatureScalePlugin",Ie(H.mark(function o(){var u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(i.scaleOptions=r.getScaleOptions(),s=a.getLayerStyleAttributes(),l=(u=r.getSource())===null||u===void 0?void 0:u.data.dataArray,!(Array.isArray(l)&&l.length===0)){h.next=7;break}return h.abrupt("return");case 7:i.caculateScalesForAttributes(s||[],l);case 8:case"end":return h.stop()}},o)}))),r.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var o=Ie(H.mark(function u(s){var l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(s){d.next=2;break}return d.abrupt("return",s);case 2:if(i.scaleOptions=r.getScaleOptions(),l=a.getLayerStyleAttributes(),f=r.getSource().data.dataArray,!(Array.isArray(f)&&f.length===0)){d.next=7;break}return d.abrupt("return",!0);case 7:return i.caculateScalesForAttributes(l||[],f),r.layerModelNeedUpdate=!0,d.abrupt("return",!0);case 10:case"end":return d.stop()}},u)}));return function(u){return o.apply(this,arguments)}}()),r.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!r.layerModelNeedUpdate){i.scaleOptions=r.getScaleOptions();var o=a.getLayerStyleAttributes(),u=r.getSource().data.dataArray;if(!(Array.isArray(u)&&u.length===0)&&o){var s=o.filter(function(l){return l.needRescale});s.length&&i.caculateScalesForAttributes(s,u)}}})}},{key:"isNumber",value:function(r){return!isNaN(parseFloat(r))&&isFinite(r)}},{key:"caculateScalesForAttributes",value:function(r,n){var i=this;r.forEach(function(a){if(a.scale){var o=a.scale;o.names=i.parseFields(a.scale.field||[]);var u=[];o.names.forEach(function(s){var l;u.push(i.createScale(s,a.name,(l=a.scale)===null||l===void 0?void 0:l.values,n))}),u.some(function(s){return s.type===sl.VARIABLE})?(o.type=sl.VARIABLE,u.forEach(function(s){var l;if(!o.callback&&o.values!=="text")switch((l=s.option)===null||l===void 0?void 0:l.type){case Jr.LOG:case Jr.LINEAR:case Jr.POWER:if(o.values&&o.values.length>2){var f=s.scale.ticks(o.values.length);s.scale.domain(f)}o.values?s.scale.range(o.values):s.scale.range(s.option.domain);break;case Jr.QUANTILE:case Jr.QUANTIZE:case Jr.THRESHOLD:s.scale.range(o.values);break;case Jr.CAT:o.values?s.scale.range(o.values):s.scale.range(s.option.domain);break;case Jr.DIVERGING:case Jr.SEQUENTIAL:s.scale.interpolator(gY(o.values));break}if(o.values==="text"){var h;s.scale.range((h=s.option)===null||h===void 0?void 0:h.domain)}})):(o.type=sl.CONSTANT,o.defaultValues=u.map(function(s,l){return s.scale(o.names[l])})),o.scalers=u.map(function(s){return{field:s.field,func:s.scale,option:s.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(r){return Array.isArray(r)?r:tt.exports.isString(r)?r.split("*"):[r]}},{key:"createScale",value:function(r,n,i,a){var o,u,s=this.scaleOptions[n]&&((o=this.scaleOptions[n])===null||o===void 0?void 0:o.field)===r?this.scaleOptions[n]:this.scaleOptions[r],l={field:r,scale:void 0,type:sl.VARIABLE,option:s};if(!a||!a.length)return s&&s.type?l.scale=this.createDefaultScale(s):(l.scale=Gg([r]),l.type=sl.CONSTANT),l;var f=(u=a.find(function(v){return!tt.exports.isNil(v[r])}))===null||u===void 0?void 0:u[r];if(this.isNumber(r)||tt.exports.isNil(f)&&!s)l.scale=Gg([r]),l.type=sl.CONSTANT;else{var h=s&&s.type||this.getDefaultType(f);i==="text"&&(h=Jr.CAT);var d=this.createScaleConfig(h,r,s,a);l.scale=this.createDefaultScale(d),l.option=d}return l}},{key:"getDefaultType",value:function(r){var n=Jr.LINEAR;return typeof r=="string"&&(n=gq.test(r)?Jr.TIME:Jr.CAT),n}},{key:"createScaleConfig",value:function(r,n,i,a){var o={type:r},u=(a==null?void 0:a.map(function(f){return f[n]}))||[];if(i!=null&&i.domain)o.domain=i==null?void 0:i.domain;else if(r!==Jr.CAT&&r!==Jr.QUANTILE&&r!==Jr.DIVERGING)o.domain=n3(u);else if(r===Jr.CAT)o.domain=tt.exports.uniq(u);else if(r===Jr.QUANTILE)o.domain=u;else if(r===Jr.DIVERGING){var s=n3(u),l=(i==null?void 0:i.neutral)!==void 0?i==null?void 0:i.neutral:(s[0]+s[1])/2;o.domain=[s[0],l,s[1]]}return be(be({},o),i)}},{key:"createDefaultScale",value:function(r){var n=r.type,i=r.domain,a=r.unknown,o=r.clamp,u=r.nice,s=mq[n]();return i&&s.domain&&s.domain(i),a&&s.unknown(a),o!==void 0&&s.clamp&&s.clamp(o),u!==void 0&&s.nice&&s.nice(u),s}}]),e}())||L3),F3,I3,_q=(F3=xr(),F3(I3=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var n=r.animateStatus;n&&r.models.forEach(function(i){i.addUniforms(be({},r.layerModel.getAnimateUniforms()))})})}}]),e}())||I3),xq=function(){function e(t){var r=t.rendererService,n=t.layerService,i=t.parent;ke(this,e),T(this,"tileResource",new Map),T(this,"_tiles",[]),this.rendererService=r,this.layerService=n,this.parent=i}return Pe(e,[{key:"tiles",get:function(){return this._tiles}},{key:"hasTile",value:function(r){return this._tiles.some(function(n){return n.key===r})}},{key:"addTile",value:function(r){this._tiles.push(r)}},{key:"getTile",value:function(r){return this._tiles.find(function(n){return n.key===r})}},{key:"getVisibleTileBylngLat",value:function(r){return this._tiles.find(function(n){return n.isLoaded&&n.visible&&n.lnglatInBounds(r)})}},{key:"removeTile",value:function(r){var n=this._tiles.findIndex(function(a){return a.key===r}),i=this._tiles.splice(n,1);i[0]&&i[0].destroy()}},{key:"updateTileVisible",value:function(r){var n=this.getTile(r.key);n==null||n.updateVisible(r.isVisible)}},{key:"isParentLoaded",value:function(r){var n=r.parent;if(!n)return!0;var i=this.getTile(n==null?void 0:n.key);return!!(i!=null&&i.isLoaded)}},{key:"isChildrenLoaded",value:function(r){var n=this,i=r==null?void 0:r.children;return i.length===0?!0:i.some(function(a){var o=n.getTile(a==null?void 0:a.key);return(o==null?void 0:o.isLoaded)===!1})}},{key:"render",value:function(){var t=Ie(H.mark(function n(){var i=this,a;return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:a=this.getRenderLayers(),a.map(function(){var s=Ie(H.mark(function l(f){return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,i.layerService.renderLayer(f);case 2:case"end":return d.stop()}},l)}));return function(l){return s.apply(this,arguments)}}());case 2:case"end":return u.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"getRenderLayers",value:function(){var r=this._tiles.filter(function(i){return i.visible&&i.isLoaded}),n=[];return r.map(function(i){return n.push.apply(n,It(i.getLayers()))}),n}},{key:"getLayers",value:function(){var r=this._tiles.filter(function(i){return i.isLoaded}),n=[];return r.map(function(i){return n.push.apply(n,It(i.getLayers()))}),n}},{key:"getTiles",value:function(){return this._tiles}},{key:"destroy",value:function(){this._tiles.forEach(function(r){return r.destroy()}),this.tileResource.clear()}}]),e}();/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Eq(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(f){return s([l,f])}}function s(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}var bl=function(){function e(t,r){this.next=null,this.key=t,this.data=r,this.left=null,this.right=null}return e}();function bq(e,t){return e>t?1:e<t?-1:0}function fl(e,t,r){for(var n=new bl(null,null),i=n,a=n;;){var o=r(e,t.key);if(o<0){if(t.left===null)break;if(r(e,t.left.key)<0){var u=t.left;if(t.left=u.right,u.right=t,t=u,t.left===null)break}a.left=t,a=t,t=t.left}else if(o>0){if(t.right===null)break;if(r(e,t.right.key)>0){var u=t.right;if(t.right=u.left,u.left=t,t=u,t.right===null)break}i.right=t,i=t,t=t.right}else break}return i.right=t.left,a.left=t.right,t.left=n.right,t.right=n.left,t}function G_(e,t,r,n){var i=new bl(e,t);if(r===null)return i.left=i.right=null,i;r=fl(e,r,n);var a=n(e,r.key);return a<0?(i.left=r.left,i.right=r,r.left=null):a>=0&&(i.right=r.right,i.left=r,r.right=null),i}function k3(e,t,r){var n=null,i=null;if(t){t=fl(e,t,r);var a=r(t.key,e);a===0?(n=t.left,i=t.right):a<0?(i=t.right,t.right=null,n=t):(n=t.left,t.left=null,i=t)}return{left:n,right:i}}function Cq(e,t,r){return t===null?e:(e===null||(t=fl(e.key,t,r),t.left=e),t)}function ox(e,t,r,n,i){if(e){n(""+t+(r?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+i(e)+`
`);var a=t+(r?"    ":"\u2502   ");e.left&&ox(e.left,a,!1,n,i),e.right&&ox(e.right,a,!0,n,i)}}var kE=function(){function e(t){t===void 0&&(t=bq),this._root=null,this._size=0,this._comparator=t}return e.prototype.insert=function(t,r){return this._size++,this._root=G_(t,r,this._root,this._comparator)},e.prototype.add=function(t,r){var n=new bl(t,r);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,a=fl(t,this._root,i),o=i(t,a.key);return o===0?this._root=a:(o<0?(n.left=a.left,n.right=a,a.left=null):o>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},e.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},e.prototype._remove=function(t,r,n){var i;if(r===null)return null;r=fl(t,r,n);var a=n(t,r.key);return a===0?(r.left===null?i=r.right:(i=fl(t,r.left,n),i.right=r.right),this._size--,i):r},e.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=fl(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},e.prototype.findStatic=function(t){for(var r=this._root,n=this._comparator;r;){var i=n(t,r.key);if(i===0)return r;i<0?r=r.left:r=r.right}return null},e.prototype.find=function(t){return this._root&&(this._root=fl(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},e.prototype.contains=function(t){for(var r=this._root,n=this._comparator;r;){var i=n(t,r.key);if(i===0)return!0;i<0?r=r.left:r=r.right}return!1},e.prototype.forEach=function(t,r){for(var n=this._root,i=[],a=!1;!a;)n!==null?(i.push(n),n=n.left):i.length!==0?(n=i.pop(),t.call(r,n),n=n.right):a=!0;return this},e.prototype.range=function(t,r,n,i){for(var a=[],o=this._comparator,u=this._root,s;a.length!==0||u;)if(u)a.push(u),u=u.left;else{if(u=a.pop(),s=o(u.key,r),s>0)break;if(o(u.key,t)>=0&&n.call(i,u))return this;u=u.right}return this},e.prototype.keys=function(){var t=[];return this.forEach(function(r){var n=r.key;return t.push(n)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(r){var n=r.data;return t.push(n)}),t},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},e.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},e.prototype.at=function(t){for(var r=this._root,n=!1,i=0,a=[];!n;)if(r)a.push(r),r=r.left;else if(a.length>0){if(r=a.pop(),i===t)return r;i++,r=r.right}else n=!0;return null},e.prototype.next=function(t){var r=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;r;){var a=i(t.key,r.key);if(a===0)break;a<0?(n=r,r=r.left):r=r.right}return n},e.prototype.prev=function(t){var r=this._root,n=null;if(t.left!==null){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;r;){var a=i(t.key,r.key);if(a===0)break;a<0?r=r.left:(n=r,r=r.right)}return n},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return Sq(this._root)},e.prototype.load=function(t,r,n){r===void 0&&(r=[]),n===void 0&&(n=!1);var i=t.length,a=this._comparator;if(n&&lx(t,r,0,i-1,a),this._root===null)this._root=ux(t,r,0,i),this._size=i;else{var o=Tq(this.toList(),Aq(t,r),a);i=this._size+i,this._root=sx({head:o},0,i)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){t===void 0&&(t=function(n){return String(n.key)});var r=[];return ox(this._root,"",!0,function(n){return r.push(n)},t),r.join("")},e.prototype.update=function(t,r,n){var i=this._comparator,a=k3(t,this._root,i),o=a.left,u=a.right;i(t,r)<0?u=G_(r,n,u,i):o=G_(r,n,o,i),this._root=Cq(o,u,i)},e.prototype.split=function(t){return k3(t,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var t;return Eq(this,function(r){switch(r.label){case 0:t=this.minNode(),r.label=1;case 1:return t?[4,t]:[3,3];case 2:return r.sent(),t=this.next(t),[3,1];case 3:return[2]}})},e}();function ux(e,t,r,n){var i=n-r;if(i>0){var a=r+Math.floor(i/2),o=e[a],u=t[a],s=new bl(o,u);return s.left=ux(e,t,r,a),s.right=ux(e,t,a+1,n),s}return null}function Aq(e,t){for(var r=new bl(null,null),n=r,i=0;i<e.length;i++)n=n.next=new bl(e[i],t[i]);return n.next=null,r.next}function Sq(e){for(var t=e,r=[],n=!1,i=new bl(null,null),a=i;!n;)t?(r.push(t),t=t.left):r.length>0?(t=a=a.next=r.pop(),t=t.right):n=!0;return a.next=null,i.next}function sx(e,t,r){var n=r-t;if(n>0){var i=t+Math.floor(n/2),a=sx(e,t,i),o=e.head;return o.left=a,e.head=e.head.next,o.right=sx(e,i+1,r),o}return null}function Tq(e,t,r){for(var n=new bl(null,null),i=n,a=e,o=t;a!==null&&o!==null;)r(a.key,o.key)<0?(i.next=a,a=a.next):(i.next=o,o=o.next),i=i.next;return a!==null?i.next=a:o!==null&&(i.next=o),n.next}function lx(e,t,r,n,i){if(!(r>=n)){for(var a=e[r+n>>1],o=r-1,u=n+1;;){do o++;while(i(e[o],a)<0);do u--;while(i(e[u],a)>0);if(o>=u)break;var s=e[o];e[o]=e[u],e[u]=s,s=t[o],t[o]=t[u],t[u]=s}lx(e,t,r,u,i),lx(e,t,u+1,n,i)}}function so(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vi(e,t,r){return t&&P3(e.prototype,t),r&&P3(e,r),e}var fd=function(t,r){return t.ll.x<=r.x&&r.x<=t.ur.x&&t.ll.y<=r.y&&r.y<=t.ur.y},cx=function(t,r){if(r.ur.x<t.ll.x||t.ur.x<r.ll.x||r.ur.y<t.ll.y||t.ur.y<r.ll.y)return null;var n=t.ll.x<r.ll.x?r.ll.x:t.ll.x,i=t.ur.x<r.ur.x?t.ur.x:r.ur.x,a=t.ll.y<r.ll.y?r.ll.y:t.ll.y,o=t.ur.y<r.ur.y?t.ur.y:r.ur.y;return{ll:{x:n,y:a},ur:{x:i,y:o}}},hl=Number.EPSILON;hl===void 0&&(hl=Math.pow(2,-52));var wq=hl*hl,fx=function(t,r){if(-hl<t&&t<hl&&-hl<r&&r<hl)return 0;var n=t-r;return n*n<wq*t*r?0:t<r?-1:1},Mq=function(){function e(){so(this,e),this.reset()}return Vi(e,[{key:"reset",value:function(){this.xRounder=new D3,this.yRounder=new D3}},{key:"round",value:function(r,n){return{x:this.xRounder.round(r),y:this.yRounder.round(n)}}}]),e}(),D3=function(){function e(){so(this,e),this.tree=new kE,this.round(0)}return Vi(e,[{key:"round",value:function(r){var n=this.tree.add(r),i=this.tree.prev(n);if(i!==null&&fx(n.key,i.key)===0)return this.tree.remove(r),i.key;var a=this.tree.next(n);return a!==null&&fx(n.key,a.key)===0?(this.tree.remove(r),a.key):r}}]),e}(),s0=new Mq,Pd=function(t,r){return t.x*r.y-t.y*r.x},A7=function(t,r){return t.x*r.x+t.y*r.y},B3=function(t,r,n){var i={x:r.x-t.x,y:r.y-t.y},a={x:n.x-t.x,y:n.y-t.y},o=Pd(i,a);return fx(o,0)},Zg=function(t){return Math.sqrt(A7(t,t))},Rq=function(t,r,n){var i={x:r.x-t.x,y:r.y-t.y},a={x:n.x-t.x,y:n.y-t.y};return Pd(a,i)/Zg(a)/Zg(i)},Oq=function(t,r,n){var i={x:r.x-t.x,y:r.y-t.y},a={x:n.x-t.x,y:n.y-t.y};return A7(a,i)/Zg(a)/Zg(i)},N3=function(t,r,n){return r.y===0?null:{x:t.x+r.x/r.y*(n-t.y),y:n}},U3=function(t,r,n){return r.x===0?null:{x:n,y:t.y+r.y/r.x*(n-t.x)}},Lq=function(t,r,n,i){if(r.x===0)return U3(n,i,t.x);if(i.x===0)return U3(t,r,n.x);if(r.y===0)return N3(n,i,t.y);if(i.y===0)return N3(t,r,n.y);var a=Pd(r,i);if(a==0)return null;var o={x:n.x-t.x,y:n.y-t.y},u=Pd(o,r)/a,s=Pd(o,i)/a,l=t.x+s*r.x,f=n.x+u*i.x,h=t.y+s*r.y,d=n.y+u*i.y,v=(l+f)/2,m=(h+d)/2;return{x:v,y:m}},cu=function(){Vi(e,null,[{key:"compare",value:function(r,n){var i=e.comparePoints(r.point,n.point);return i!==0?i:(r.point!==n.point&&r.link(n),r.isLeft!==n.isLeft?r.isLeft?1:-1:qg.compare(r.segment,n.segment))}},{key:"comparePoints",value:function(r,n){return r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0}}]);function e(t,r){so(this,e),t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=r}return Vi(e,[{key:"link",value:function(r){if(r.point===this.point)throw new Error("Tried to link already linked events");for(var n=r.point.events,i=0,a=n.length;i<a;i++){var o=n[i];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var r=this.point.events.length,n=0;n<r;n++){var i=this.point.events[n];if(i.segment.consumedBy===void 0)for(var a=n+1;a<r;a++){var o=this.point.events[a];o.consumedBy===void 0&&i.otherSE.point.events===o.otherSE.point.events&&i.segment.consume(o.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var r=[],n=0,i=this.point.events.length;n<i;n++){var a=this.point.events[n];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&r.push(a)}return r}},{key:"getLeftmostComparator",value:function(r){var n=this,i=new Map,a=function(u){var s=u.otherSE;i.set(u,{sine:Rq(n.point,r.point,s.point),cosine:Oq(n.point,r.point,s.point)})};return function(o,u){i.has(o)||a(o),i.has(u)||a(u);var s=i.get(o),l=s.sine,f=s.cosine,h=i.get(u),d=h.sine,v=h.cosine;return l>=0&&d>=0?f<v?1:f>v?-1:0:l<0&&d<0?f<v?-1:f>v?1:0:d<l?-1:d>l?1:0}}}]),e}(),Fq=0,qg=function(){Vi(e,null,[{key:"compare",value:function(r,n){var i=r.leftSE.point.x,a=n.leftSE.point.x,o=r.rightSE.point.x,u=n.rightSE.point.x;if(u<i)return 1;if(o<a)return-1;var s=r.leftSE.point.y,l=n.leftSE.point.y,f=r.rightSE.point.y,h=n.rightSE.point.y;if(i<a){if(l<s&&l<f)return 1;if(l>s&&l>f)return-1;var d=r.comparePoint(n.leftSE.point);if(d<0)return 1;if(d>0)return-1;var v=n.comparePoint(r.rightSE.point);return v!==0?v:-1}if(i>a){if(s<l&&s<h)return-1;if(s>l&&s>h)return 1;var m=n.comparePoint(r.leftSE.point);if(m!==0)return m;var y=r.comparePoint(n.rightSE.point);return y<0?1:y>0?-1:1}if(s<l)return-1;if(s>l)return 1;if(o<u){var _=n.comparePoint(r.rightSE.point);if(_!==0)return _}if(o>u){var E=r.comparePoint(n.rightSE.point);if(E<0)return 1;if(E>0)return-1}if(o!==u){var S=f-s,A=o-i,M=h-l,O=u-a;if(S>A&&M<O)return 1;if(S<A&&M>O)return-1}return o>u?1:o<u||f<h?-1:f>h?1:r.id<n.id?-1:r.id>n.id?1:0}}]);function e(t,r,n,i){so(this,e),this.id=++Fq,this.leftSE=t,t.segment=this,t.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=t,this.rings=n,this.windings=i}return Vi(e,[{key:"replaceRightSE",value:function(r){this.rightSE=r,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var r=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:r<n?r:n},ur:{x:this.rightSE.point.x,y:r>n?r:n}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(r){return r.x===this.leftSE.point.x&&r.y===this.leftSE.point.y||r.x===this.rightSE.point.x&&r.y===this.rightSE.point.y}},{key:"comparePoint",value:function(r){if(this.isAnEndpoint(r))return 0;var n=this.leftSE.point,i=this.rightSE.point,a=this.vector();if(n.x===i.x)return r.x===n.x?0:r.x<n.x?1:-1;var o=(r.y-n.y)/a.y,u=n.x+o*a.x;if(r.x===u)return 0;var s=(r.x-n.x)/a.x,l=n.y+s*a.y;return r.y===l?0:r.y<l?-1:1}},{key:"getIntersection",value:function(r){var n=this.bbox(),i=r.bbox(),a=cx(n,i);if(a===null)return null;var o=this.leftSE.point,u=this.rightSE.point,s=r.leftSE.point,l=r.rightSE.point,f=fd(n,s)&&this.comparePoint(s)===0,h=fd(i,o)&&r.comparePoint(o)===0,d=fd(n,l)&&this.comparePoint(l)===0,v=fd(i,u)&&r.comparePoint(u)===0;if(h&&f)return v&&!d?u:!v&&d?l:null;if(h)return d&&o.x===l.x&&o.y===l.y?null:o;if(f)return v&&u.x===s.x&&u.y===s.y?null:s;if(v&&d)return null;if(v)return u;if(d)return l;var m=Lq(o,this.vector(),s,r.vector());return m===null||!fd(a,m)?null:s0.round(m.x,m.y)}},{key:"split",value:function(r){var n=[],i=r.events!==void 0,a=new cu(r,!0),o=new cu(r,!1),u=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(a);var s=new e(a,u,this.rings.slice(),this.windings.slice());return cu.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),cu.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(a.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var r=this.rightSE;this.rightSE=this.leftSE,this.leftSE=r,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var n=0,i=this.windings.length;n<i;n++)this.windings[n]*=-1}},{key:"consume",value:function(r){for(var n=this,i=r;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var a=e.compare(n,i);if(a!==0){if(a>0){var o=n;n=i,i=o}if(n.prev===i){var u=n;n=i,i=u}for(var s=0,l=i.rings.length;s<l;s++){var f=i.rings[s],h=i.windings[s],d=n.rings.indexOf(f);d===-1?(n.rings.push(f),n.windings.push(h)):n.windings[d]+=h}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var r=this.prev.consumedBy||this.prev;this._beforeState=r.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var r=this.beforeState();this._afterState={rings:r.rings.slice(0),windings:r.windings.slice(0),multiPolys:[]};for(var n=this._afterState.rings,i=this._afterState.windings,a=this._afterState.multiPolys,o=0,u=this.rings.length;o<u;o++){var s=this.rings[o],l=this.windings[o],f=n.indexOf(s);f===-1?(n.push(s),i.push(l)):i[f]+=l}for(var h=[],d=[],v=0,m=n.length;v<m;v++)if(i[v]!==0){var y=n[v],_=y.poly;if(d.indexOf(_)===-1)if(y.isExterior)h.push(_);else{d.indexOf(_)===-1&&d.push(_);var E=h.indexOf(y.poly);E!==-1&&h.splice(E,1)}}for(var S=0,A=h.length;S<A;S++){var M=h[S].multiPoly;a.indexOf(M)===-1&&a.push(M)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var r=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Bo.type){case"union":{var i=r.length===0,a=n.length===0;this._isInResult=i!==a;break}case"intersection":{var o,u;r.length<n.length?(o=r.length,u=n.length):(o=n.length,u=r.length),this._isInResult=u===Bo.numMultiPolys&&o<u;break}case"xor":{var s=Math.abs(r.length-n.length);this._isInResult=s%2===1;break}case"difference":{var l=function(h){return h.length===1&&h[0].isSubject};this._isInResult=l(r)!==l(n);break}default:throw new Error("Unrecognized operation type found ".concat(Bo.type))}return this._isInResult}}],[{key:"fromRing",value:function(r,n,i){var a,o,u,s=cu.comparePoints(r,n);if(s<0)a=r,o=n,u=1;else if(s>0)a=n,o=r,u=-1;else throw new Error("Tried to create degenerate segment at [".concat(r.x,", ").concat(r.y,"]"));var l=new cu(a,!0),f=new cu(o,!1);return new e(l,f,[i],[u])}}]),e}(),z3=function(){function e(t,r,n){if(so(this,e),!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=n,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=s0.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var a=i,o=1,u=t.length;o<u;o++){if(typeof t[o][0]!="number"||typeof t[o][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var s=s0.round(t[o][0],t[o][1]);s.x===a.x&&s.y===a.y||(this.segments.push(qg.fromRing(a,s,this)),s.x<this.bbox.ll.x&&(this.bbox.ll.x=s.x),s.y<this.bbox.ll.y&&(this.bbox.ll.y=s.y),s.x>this.bbox.ur.x&&(this.bbox.ur.x=s.x),s.y>this.bbox.ur.y&&(this.bbox.ur.y=s.y),a=s)}(i.x!==a.x||i.y!==a.y)&&this.segments.push(qg.fromRing(a,i,this))}return Vi(e,[{key:"getSweepEvents",value:function(){for(var r=[],n=0,i=this.segments.length;n<i;n++){var a=this.segments[n];r.push(a.leftSE),r.push(a.rightSE)}return r}}]),e}(),Iq=function(){function e(t,r){if(so(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new z3(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,i=t.length;n<i;n++){var a=new z3(t[n],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=r}return Vi(e,[{key:"getSweepEvents",value:function(){for(var r=this.exteriorRing.getSweepEvents(),n=0,i=this.interiorRings.length;n<i;n++)for(var a=this.interiorRings[n].getSweepEvents(),o=0,u=a.length;o<u;o++)r.push(a[o]);return r}}]),e}(),$3=function(){function e(t,r){if(so(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,i=t.length;n<i;n++){var a=new Iq(t[n],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=r}return Vi(e,[{key:"getSweepEvents",value:function(){for(var r=[],n=0,i=this.polys.length;n<i;n++)for(var a=this.polys[n].getSweepEvents(),o=0,u=a.length;o<u;o++)r.push(a[o]);return r}}]),e}(),kq=function(){Vi(e,null,[{key:"factory",value:function(r){for(var n=[],i=0,a=r.length;i<a;i++){var o=r[i];if(!(!o.isInResult()||o.ringOut)){for(var u=null,s=o.leftSE,l=o.rightSE,f=[s],h=s.point,d=[];u=s,s=l,f.push(s),s.point!==h;)for(;;){var v=s.getAvailableLinkedEvents();if(v.length===0){var m=f[0].point,y=f[f.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(m.x,",")+" ".concat(m.y,"]. Last matching segment found ends at")+" [".concat(y.x,", ").concat(y.y,"]."))}if(v.length===1){l=v[0].otherSE;break}for(var _=null,E=0,S=d.length;E<S;E++)if(d[E].point===s.point){_=E;break}if(_!==null){var A=d.splice(_)[0],M=f.splice(A.index);M.unshift(M[0].otherSE),n.push(new e(M.reverse()));continue}d.push({index:f.length,point:s.point});var O=s.getLeftmostComparator(u);l=v.sort(O)[0].otherSE;break}n.push(new e(f))}}return n}}]);function e(t){so(this,e),this.events=t;for(var r=0,n=t.length;r<n;r++)t[r].segment.ringOut=this;this.poly=null}return Vi(e,[{key:"getGeom",value:function(){for(var r=this.events[0].point,n=[r],i=1,a=this.events.length-1;i<a;i++){var o=this.events[i].point,u=this.events[i+1].point;B3(o,r,u)!==0&&(n.push(o),r=o)}if(n.length===1)return null;var s=n[0],l=n[1];B3(s,r,l)===0&&n.shift(),n.push(n[0]);for(var f=this.isExteriorRing()?1:-1,h=this.isExteriorRing()?0:n.length-1,d=this.isExteriorRing()?n.length:-1,v=[],m=h;m!=d;m+=f)v.push([n[m].x,n[m].y]);return v}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var r=this.enclosingRing();this._isExteriorRing=r?!r.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var r=this.events[0],n=1,i=this.events.length;n<i;n++){var a=this.events[n];cu.compare(r,a)>0&&(r=a)}for(var o=r.segment.prevInResult(),u=o?o.prevInResult():null;;){if(!o)return null;if(!u)return o.ringOut;if(u.ringOut!==o.ringOut)return u.ringOut.enclosingRing()!==o.ringOut?o.ringOut:o.ringOut.enclosingRing();o=u.prevInResult(),u=o?o.prevInResult():null}}}]),e}(),G3=function(){function e(t){so(this,e),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}return Vi(e,[{key:"addInterior",value:function(r){this.interiorRings.push(r),r.poly=this}},{key:"getGeom",value:function(){var r=[this.exteriorRing.getGeom()];if(r[0]===null)return null;for(var n=0,i=this.interiorRings.length;n<i;n++){var a=this.interiorRings[n].getGeom();a!==null&&r.push(a)}return r}}]),e}(),Pq=function(){function e(t){so(this,e),this.rings=t,this.polys=this._composePolys(t)}return Vi(e,[{key:"getGeom",value:function(){for(var r=[],n=0,i=this.polys.length;n<i;n++){var a=this.polys[n].getGeom();a!==null&&r.push(a)}return r}},{key:"_composePolys",value:function(r){for(var n=[],i=0,a=r.length;i<a;i++){var o=r[i];if(!o.poly)if(o.isExteriorRing())n.push(new G3(o));else{var u=o.enclosingRing();u.poly||n.push(new G3(u)),u.poly.addInterior(o)}}return n}}]),e}(),Dq=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qg.compare;so(this,e),this.queue=t,this.tree=new kE(r),this.segments=[]}return Vi(e,[{key:"process",value:function(r){var n=r.segment,i=[];if(r.consumedBy)return r.isLeft?this.queue.remove(r.otherSE):this.tree.remove(n),i;var a=r.isLeft?this.tree.insert(n):this.tree.find(n);if(!a)throw new Error("Unable to find segment #".concat(n.id," ")+"[".concat(n.leftSE.point.x,", ").concat(n.leftSE.point.y,"] -> ")+"[".concat(n.rightSE.point.x,", ").concat(n.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var o=a,u=a,s=void 0,l=void 0;s===void 0;)o=this.tree.prev(o),o===null?s=null:o.key.consumedBy===void 0&&(s=o.key);for(;l===void 0;)u=this.tree.next(u),u===null?l=null:u.key.consumedBy===void 0&&(l=u.key);if(r.isLeft){var f=null;if(s){var h=s.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(f=h),!s.isAnEndpoint(h)))for(var d=this._splitSafely(s,h),v=0,m=d.length;v<m;v++)i.push(d[v])}var y=null;if(l){var _=l.getIntersection(n);if(_!==null&&(n.isAnEndpoint(_)||(y=_),!l.isAnEndpoint(_)))for(var E=this._splitSafely(l,_),S=0,A=E.length;S<A;S++)i.push(E[S])}if(f!==null||y!==null){var M=null;if(f===null)M=y;else if(y===null)M=f;else{var O=cu.comparePoints(f,y);M=O<=0?f:y}this.queue.remove(n.rightSE),i.push(n.rightSE);for(var j=n.split(M),q=0,Y=j.length;q<Y;q++)i.push(j[q])}i.length>0?(this.tree.remove(n),i.push(r)):(this.segments.push(n),n.prev=s)}else{if(s&&l){var ne=s.getIntersection(l);if(ne!==null){if(!s.isAnEndpoint(ne))for(var X=this._splitSafely(s,ne),$=0,K=X.length;$<K;$++)i.push(X[$]);if(!l.isAnEndpoint(ne))for(var ue=this._splitSafely(l,ne),de=0,pe=ue.length;de<pe;de++)i.push(ue[de])}}this.tree.remove(n)}return i}},{key:"_splitSafely",value:function(r,n){this.tree.remove(r);var i=r.rightSE;this.queue.remove(i);var a=r.split(n);return a.push(i),r.consumedBy===void 0&&this.tree.insert(r),a}}]),e}(),H3=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Bq=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Nq=function(){function e(){so(this,e)}return Vi(e,[{key:"run",value:function(r,n,i){Bo.type=r,s0.reset();for(var a=[new $3(n,!0)],o=0,u=i.length;o<u;o++)a.push(new $3(i[o],!1));if(Bo.numMultiPolys=a.length,Bo.type==="difference")for(var s=a[0],l=1;l<a.length;)cx(a[l].bbox,s.bbox)!==null?l++:a.splice(l,1);if(Bo.type==="intersection"){for(var f=0,h=a.length;f<h;f++)for(var d=a[f],v=f+1,m=a.length;v<m;v++)if(cx(d.bbox,a[v].bbox)===null)return[]}for(var y=new kE(cu.compare),_=0,E=a.length;_<E;_++)for(var S=a[_].getSweepEvents(),A=0,M=S.length;A<M;A++)if(y.insert(S[A]),y.size>H3)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var O=new Dq(y),j=y.size,q=y.pop();q;){var Y=q.key;if(y.size===j){var ne=Y.segment;throw new Error("Unable to pop() ".concat(Y.isLeft?"left":"right"," SweepEvent ")+"[".concat(Y.point.x,", ").concat(Y.point.y,"] from segment #").concat(ne.id," ")+"[".concat(ne.leftSE.point.x,", ").concat(ne.leftSE.point.y,"] -> ")+"[".concat(ne.rightSE.point.x,", ").concat(ne.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(y.size>H3)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(O.segments.length>Bq)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var X=O.process(Y),$=0,K=X.length;$<K;$++){var ue=X[$];ue.consumedBy===void 0&&y.insert(ue)}j=y.size,q=y.pop()}s0.reset();var de=kq.factory(O.segments),pe=new Pq(de);return pe.getGeom()}}]),e}(),Bo=new Nq,Uq=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Bo.run("union",t,n)},zq=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Bo.run("intersection",t,n)},$q=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Bo.run("xor",t,n)},Gq=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Bo.run("difference",t,n)},Hq={union:Uq,intersection:zq,xor:$q,difference:Gq};function Vq(e,t,r){r===void 0&&(r={});var n=nb(e),i=nb(t),a=Hq.union(n.coordinates,i.coordinates);return a.length===0?null:a.length===1?cm(a[0],r.properties):dI(a,r.properties)}var jq=function(){function e(){ke(this,e)}return Pe(e,[{key:"getCombineFeature",value:function(r){var n=null,i=r[0];return r.map(function(a){var o=cm(a.coordinates);n===null?n=o:n=Vq(n,o)}),i&&(n.properties=be({},i)),n}}]),e}(),hd="select",pd="active",Wq=function(){function e(t){var r=t.layerService,n=t.tileLayerService,i=t.parent;ke(this,e),T(this,"tilePickID",new Map),this.layerService=r,this.tileLayerService=n,this.parent=i,this.tileSourceService=new jq}return Pe(e,[{key:"pickRender",value:function(r){var n=this.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(n){var i=n.getMainLayer();i==null||i.layerPickService.pickRender(r)}}},{key:"pick",value:function(r,n){var i=this.parent.getContainer(),a=i.get(Oe.IPickingService);if(r.type==="RasterLayer"){var o=this.tileLayerService.getVisibleTileBylngLat(n.lngLat);if(o&&o.getMainLayer()!==void 0){var u=o.getMainLayer();return u.layerPickService.pickRasterLayer(u,n,this.parent)}return!1}return this.pickRender(n),a.pickFromPickingFBO(r,n)}},{key:"selectFeature",value:function(r){var n=ir(r,3),i=n[0],a=n[1],o=n[2],u=this.color2PickId(i,a,o);this.tilePickID.set(hd,u),this.updateHighLight(i,a,o,hd)}},{key:"highlightPickedFeature",value:function(r){var n=ir(r,3),i=n[0],a=n[1],o=n[2],u=this.color2PickId(i,a,o);this.tilePickID.set(pd,u),this.updateHighLight(i,a,o,pd)}},{key:"updateHighLight",value:function(r,n,i,a){this.tileLayerService.tiles.map(function(o){var u=o.getMainLayer();switch(a){case hd:u==null||u.hooks.beforeSelect.call([r,n,i]);break;case pd:u==null||u.hooks.beforeHighlight.call([r,n,i]);break}})}},{key:"setPickState",value:function(){var r=this.tilePickID.get(hd),n=this.tilePickID.get(pd);if(r){var i=this.pickId2Color(r),a=ir(i,3),o=a[0],u=a[1],s=a[2];this.updateHighLight(o,u,s,hd);return}if(n){var l=this.pickId2Color(n),f=ir(l,3),h=f[0],d=f[1],v=f[2];this.updateHighLight(h,d,v,pd);return}}},{key:"color2PickId",value:function(r,n,i){return Bc(new Uint8Array([r,n,i]))}},{key:"pickId2Color",value:function(r){return ss(r)}},{key:"getFeatureById",value:function(r){var n=this.tileLayerService.getTiles().filter(function(a){return a.visible}),i=[];return n.map(function(a){i.push.apply(i,It(a.getFeatureById(r)))}),i.length<=0?null:[]}},{key:"pickRasterLayer",value:function(r,n,i){return!1}}]),e}();function Xq(e){return e==="PolygonLayer"?GM:e==="LineLayer"?EE:Bg}function Yq(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}var qc=function(){function e(t,r){ke(this,e),T(this,"visible",!0),T(this,"layers",[]),T(this,"isLoaded",!1),this.parent=r,this.sourceTile=t,this.x=t.x,this.y=t.y,this.z=t.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}return Pe(e,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(r){var n=ir(this.sourceTile.bounds,4),i=n[0],a=n[1],o=n[2],u=n[3],s=r.lng,l=r.lat;return s>=i&&s<=o&&l>=a&&l<=u}},{key:"getLayerOptions",value:function(){var r=this.parent.getLayerConfig();return be(be({},r),{},{autoFit:!1,mask:Yq(this.parent.type)||r.mask})}},{key:"addMask",value:function(){var t=Ie(H.mark(function n(i,a){var o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=Dg(this.parent.sceneContainer),a.setContainer(o,this.parent.sceneContainer),s.next=4,a.init();case 4:i.addMaskLayer(a);case 5:case"end":return s.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"addLayer",value:function(){var t=Ie(H.mark(function n(i){var a;return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i.isTileLayer=!0,a=Dg(this.parent.sceneContainer),i.setContainer(a,this.parent.sceneContainer),this.layers.push(i),u.next=6,i.init();case 6:case"end":return u.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"updateVisible",value:function(r){this.visible=r,this.updateOptions("visible",r)}},{key:"updateOptions",value:function(r,n){this.layers.forEach(function(i){i.updateLayerConfig(T({},r,n))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(r){return[]}},{key:"getFeatureById",value:function(r){return[]}},{key:"destroy",value:function(){this.layers.forEach(function(r){return r.destroy()})}}]),e}();function Zq(e){var t=qq();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function qq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rg=function(e){Ut(r,e);var t=Zq(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l,f;return H.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=Xq(this.parent.type),l=this.getSourceOption(),l){d.next=7;break}return this.isLoaded=!0,d.abrupt("return");case 7:if(f=new s(be({},u)).source(l.data,l.options),Object.keys(o).forEach(function(v){var m,y,_=v;f[_]((m=o[_])===null||m===void 0?void 0:m.field,(y=o[_])===null||y===void 0?void 0:y.values)}),!u.mask){d.next=12;break}return d.next=12,this.addTileMask(f);case 12:return d.next=14,this.addLayer(f);case 14:this.setLayerMinMaxZoom(f),this.isLoaded=!0;case 16:case"end":return d.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addTileMask",value:function(){var n=Ie(H.mark(function a(o){var u;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u=new CE({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}),l.next=3,this.addMask(o,u);case 3:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.parent.getLayerConfig(),o=a.sourceLayer,u=o===void 0?"defaultLayer":o,s=a.featureId,l=s===void 0?"id":s,f=this.getFeatures(u);return{data:{type:"FeatureCollection",features:f},options:{parser:{type:"geojson",featureId:l},transforms:i.transforms}}}},{key:"setLayerMinMaxZoom",value:function(i){i.getModelType()==="text"&&i.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(i){var a=this.sourceTile.data;return a.getTileData(i)}},{key:"getFeatureById",value:function(i){var a=this.getMainLayer();return a?a.getSource().data.dataArray.filter(function(o){return o._id===i}):[]}}]),r}(qc);function Kq(e){var t=Qq();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function Qq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Jq=function(e){Ut(r,e);var t=Kq(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.getSourceOption(),u=o.data.features[0].properties,s=new EE().source(o.data,o.options).size(1).shape("line").color("red"),l=new Bg({minZoom:this.z-1,maxZoom:this.z+1}).source([u],{parser:{type:"json",x:"textLng",y:"textLat"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),h.next=6,this.addLayer(s);case 6:return h.next=8,this.addLayer(l);case 8:this.isLoaded=!0;case 9:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:a},options:{parser:{type:"geojson"},transforms:i.transforms}}}}]),r}(qc);function eK(e){var t=tK();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function tK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rK=function(e){Ut(r,e);var t=eK(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new gV(be({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(d){var v,m,y=d;l[y]((v=o[y])===null||v===void 0?void 0:v.field,(m=o[y])===null||m===void 0?void 0:m.values)}),h.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}]),r}(qc),nK=["rasterData"];function iK(e){var t=aK();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function aK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oK={positions:[0,1],colors:["#000","#fff"]},uK=function(e){Ut(r,e);var t=iK(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),this.colorTexture=this.parent.textureService.getColorTexture(u.rampColors),l=new bE(be(be({},u),{},{colorTexture:this.colorTexture})).source(s.data,s.options),o&&Object.keys(o).forEach(function(d){var v,m,y=d;l[y]((v=o[y])===null||v===void 0?void 0:v.field,(m=o[y])===null||m===void 0?void 0:m.values)}),h.next=8,this.addLayer(l);case 8:this.isLoaded=!0;case 9:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.sourceTile.data.data,o=a.rasterData,u=la(a,nK);return{data:o,options:{parser:be({type:"raster",extent:this.sourceTile.bounds},u),transforms:i.transforms}}}},{key:"styleUpdate",value:function(){for(var i=this,a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];var s=o.rampColors,l=s===void 0?oK:s;this.colorTexture=this.parent.textureService.getColorTexture(l),this.layers.forEach(function(f){return f.style({colorTexture:i.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(i){return i.destroy()})}}]),r}(qc),sK=["rasterData"];function lK(e){var t=cK();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function cK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fK=function(e){Ut(r,e);var t=lK(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new bE(be({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(d){var v,m,y=d;l[y]((v=o[y])===null||v===void 0?void 0:v.field,(m=o[y])===null||m===void 0?void 0:m.values)}),h.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.sourceTile.data.data,o=a.rasterData,u=la(a,sK);return{data:o,options:{parser:be({type:"rasterRgb",extent:this.sourceTile.bounds},u),transforms:i.transforms}}}}]),r}(qc);function hK(e){var t=pK();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function pK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dK=function(e){Ut(r,e);var t=hK(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new bE(be({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(d){var v,m,y=d;l[y]((v=o[y])===null||v===void 0?void 0:v.field,(m=o[y])===null||m===void 0?void 0:m.values)}),h.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}]),r}(qc);function vK(e){var t=gK();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function gK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mK=function(e){Ut(r,e);var t=vK(r);function r(){return ke(this,r),t.apply(this,arguments)}return Pe(r,[{key:"initTileLayer",value:function(){var n=Ie(H.mark(function a(){var o,u,s,l;return H.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new CE(be({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(d){var v,m,y=d;l[y]((v=o[y])===null||v===void 0?void 0:v.field,(m=o[y])===null||m===void 0?void 0:m.values)}),h.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return h.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getFeatures",value:function(i){if(!i)return[];var a=this.sourceTile.data;return a.getTileData(i)}},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.parent.getLayerConfig(),o=a.sourceLayer,u=a.featureId,s=this.getFeatures(o);return{data:{type:"FeatureCollection",features:s},options:{parser:{type:"geojson",featureId:u},transforms:i.transforms}}}}]),r}(qc);function yK(e){var t=e.type;switch(t){case"PolygonLayer":return rg;case"LineLayer":return rg;case"PointLayer":return rg;case"TileDebugLayer":return Jq;case"MaskLayer":return mK;case"RasterLayer":var r=e.getSource().parser.dataType;switch(r){case"rgb":return fK;case"arraybuffer":return uK;case"terrainRGB":return dK;default:return rK}default:return rg}}var _K=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive"],V3=function(){function e(t){ke(this,e),T(this,"initedTileset",!1),T(this,"viewchange",tt.exports.debounce(this.mapchange,24)),this.parent=t;var r=this.parent.getContainer();this.rendererService=r.get(Oe.IRendererService),this.layerService=r.get(Oe.ILayerService),this.mapService=r.get(Oe.IMapService),this.pickingService=r.get(Oe.IPickingService),this.tileLayerService=new xq({rendererService:this.rendererService,layerService:this.layerService,parent:t}),this.tilePickService=new Wq({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:t}),this.parent.setLayerPickService(this.tilePickService),this.proxy(t),this.initTileSetManager()}return Pe(e,[{key:"initTileSetManager",value:function(){var r,n=this.parent.getSource();this.tilesetManager=n.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var i=this.getCurrentView(),a=i.latLonBounds,o=i.zoom;(r=this.tilesetManager)===null||r===void 0||r.update(o,a)}},{key:"mapchange",value:function(){var r,n=this.getCurrentView(),i=n.latLonBounds,a=n.zoom;if(this.mapService.version==="GAODE1.x"){var o=this.parent.getLayerConfig(),u=o.visible;a<3&&u?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):a>=3&&!u&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===a&&this.lastViewStates.latLonBounds.toString()===i.toString()||(this.lastViewStates={zoom:a,latLonBounds:i},(r=this.tilesetManager)===null||r===void 0||r.throttleUpdate(a,i))}},{key:"getCurrentView",value:function(){var r=this.mapService.getBounds(),n=[r[0][0],r[0][1],r[1][0],r[1][1]],i=this.mapService.getZoom();return{latLonBounds:n,zoom:i}}},{key:"bindTilesetEvent",value:function(){var r=this;this.tilesetManager.on("tile-loaded",function(n){}),this.tilesetManager.on("tile-unload",function(n){r.tileUnLoad(n)}),this.tilesetManager.on("tile-error",function(n,i){r.tileError(n)}),this.tilesetManager.on("tile-update",function(){r.tileUpdate()}),this.mapService.on("zoomend",function(){return r.mapchange()}),this.mapService.on("moveend",function(){return r.viewchange()})}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"tileLoaded",value:function(r){}},{key:"tileError",value:function(r){console.warn("error:",r)}},{key:"destroy",value:function(){var r;(r=this.tilesetManager)===null||r===void 0||r.destroy(),this.tileLayerService.destroy()}},{key:"tileUnLoad",value:function(r){this.tileLayerService.removeTile(r.key)}},{key:"tileUpdate",value:function(){var t=Ie(H.mark(function n(){var i=this,a,o;return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.tilesetManager){s.next=2;break}return s.abrupt("return");case 2:return a=this.parent.getMinZoom(),o=this.parent.getMaxZoom(),s.next=6,Promise.all(this.tilesetManager.tiles.filter(function(l){return l.isLoaded}).filter(function(l){return l.isVisibleChange}).filter(function(l){return l.data}).filter(function(l){return l.z>=a&&l.z<o}).map(function(){var l=Ie(H.mark(function f(h){var d,v;return H.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(i.tileLayerService.hasTile(h.key)){y.next=9;break}return d=yK(i.parent),v=new d(h,i.parent),y.next=5,v.initTileLayer();case 5:i.tilePickService.setPickState(),v.getLayers().length!==0&&(i.tileLayerService.addTile(v),i.tileLayerService.updateTileVisible(h),i.layerService.reRender()),y.next=12;break;case 9:i.tileLayerService.updateTileVisible(h),i.tilePickService.setPickState(),i.layerService.reRender();case 12:case"end":return y.stop()}},f)}));return function(f){return l.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return s.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"setPickState",value:function(r){}},{key:"pickRender",value:function(r){this.tilePickService.pickRender(r)}},{key:"selectFeature",value:function(r){this.tilePickService.selectFeature(r)}},{key:"highlightPickedFeature",value:function(r){this.tilePickService.highlightPickedFeature(r)}},{key:"proxy",value:function(r){var n=this;_K.forEach(function(i){var a=r[i].bind(r);r[i]=function(){for(var o=arguments.length,u=new Array(o),s=0;s<o;s++)u[s]=arguments[s];return a.apply(void 0,u),n.getLayers().map(function(l){l[i].apply(l,u)}),i==="style"&&n.getTiles().forEach(function(l){return l.styleUpdate.apply(l,u)}),r}})}}]),e}(),j3,W3,xK=(j3=xr(),j3(W3=function(){function e(){ke(this,e)}return Pe(e,[{key:"initLayerModel",value:function(){var t=Ie(H.mark(function n(i){return H.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i.prepareBuildModel(),o.next=3,i.buildModels();case 3:i.styleNeedUpdate=!1;case 4:case"end":return o.stop()}},n)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"prepareLayerModel",value:function(){var t=Ie(H.mark(function n(i){return H.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i.prepareBuildModel(),o.next=3,i.buildModels();case 3:case"end":return o.stop()}},n)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"apply",value:function(r){var n=this;r.hooks.init.tapPromise("LayerModelPlugin",Ie(H.mark(function i(){return H.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!r.getSource().isTile){o.next=4;break}return r.prepareBuildModel(),r.tileLayer=new V3(r),o.abrupt("return");case 4:return o.next=6,n.initLayerModel(r);case 6:case"end":return o.stop()}},i)}))),r.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var i=Ie(H.mark(function a(o){return H.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o){s.next=2;break}return s.abrupt("return",!1);case 2:if(!r.getSource().isTile){s.next=5;break}return r.tileLayer=new V3(r),s.abrupt("return",!1);case 5:return s.next=7,n.prepareLayerModel(r);case 7:return s.abrupt("return",!0);case 8:case"end":return s.stop()}},a)}));return function(a){return i.apply(this,arguments)}}())}}]),e}())||W3),X3,Y3,EK=(X3=xr(),X3(Y3=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r){r.hooks.afterInit.tap("LayerStylePlugin",function(){var n=r.getLayerConfig(),i=n.autoFit,a=n.fitBoundsOptions;i&&r.fitBounds(a)})}}]),e}())||Y3),Z3,q3,bK=["type"],K3={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},CK={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},AK={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},SK={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function TK(e){var t={u_DirectionalLights:new Array(3).fill(be({},AK)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(be({},SK)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[CK]),e.forEach(function(r){var n=r.type,i=n===void 0?"directional":n,a=la(r,bK),o=K3[i].lights,u=K3[i].num,s=t[u];t[o][s]=be(be({},t[o][s]),a),t[u]++}),t}var wK=(Z3=xr(),Z3(q3=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("LightingPlugin",function(){var n=r.getLayerConfig(),i=n.enableLighting;i&&r.models.forEach(function(a){return a.addUniforms(be({},TK()))})})}}]),e}())||q3),Q3,J3,MK=(Q3=xr(),Q3(J3=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r,n){var i=this,a=n.rendererService,o=n.postProcessingPassFactory,u=n.normalPassFactory;r.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var s=r.getLayerConfig(),l=s.enableMultiPassRenderer,f=s.passes,h=f===void 0?[]:f;i.enabled=!!l&&r.getLayerConfig().enableMultiPassRenderer!==!1,i.enabled&&(r.multiPassRenderer=SM(r,h,o,u),r.multiPassRenderer.setRenderFlag(!0))}),r.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(i.enabled){var s=a.getViewportSize(),l=s.width,f=s.height;r.multiPassRenderer.resize(l,f)}})}}]),e}())||J3),ew,tw,ng={NONE:0,ENCODE:1,HIGHLIGHT:2},RK=(ew=xr(),ew(tw=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r,n){var i=n.styleAttributeService;r.hooks.init.tapPromise("PixelPickingPlugin",function(){var a=r.getLayerConfig(),o=a.enablePicking;i.registerStyleAttribute({name:"pickingColor",type:Ft.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:w.FLOAT},size:3,update:function(s){var l=s.id;return o?ss(l):[0,0,0]}}})}),r.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var a=r.getLayerConfig(),o=a.enablePicking;o&&r.isVisible()&&r.models.forEach(function(u){return u.addUniforms({u_PickingStage:ng.ENCODE})})}),r.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var a=r.getLayerConfig(),o=a.enablePicking;o&&r.isVisible()&&r.models.forEach(function(u){return u.addUniforms({u_PickingStage:ng.HIGHLIGHT})})}),r.hooks.beforeHighlight.tap("PixelPickingPlugin",function(a){var o=r.getLayerConfig(),u=o.highlightColor,s=o.activeMix,l=s===void 0?0:s,f=typeof u=="string"?$r(u):u||[1,0,0,1];r.updateLayerConfig({pickedFeatureID:Bc(new Uint8Array(a))}),r.models.forEach(function(h){return h.addUniforms({u_PickingStage:ng.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:f.map(function(d){return d*255}),u_activeMix:l})})}),r.hooks.beforeSelect.tap("PixelPickingPlugin",function(a){var o=r.getLayerConfig(),u=o.selectColor,s=o.selectMix,l=s===void 0?0:s,f=typeof u=="string"?$r(u):u||[1,0,0,1];r.updateLayerConfig({pickedFeatureID:Bc(new Uint8Array(a))}),r.models.forEach(function(h){return h.addUniforms({u_PickingStage:ng.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:f.map(function(d){return d*255}),u_activeMix:l,u_CurrentSelectedId:a,u_SelectColor:f.map(function(d){return d*255}),u_EnableSelect:1})})})}}]),e}())||tw),OK=["mvt","geojsonvt","testTile"];function LK(e){var t=e.getSource();return OK.includes(t.parser.type)}var rw,nw,FK=(rw=xr(),rw(nw=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){LK(r)||i.registerBuiltinAttributes(a,r)})}},{key:"registerBuiltinAttributes",value:function(r,n){if(n.type==="MaskLayer"){this.registerPositionAttribute(r);return}this.registerPositionAttribute(r),this.registerFilterAttribute(r),this.registerColorAttribute(r),this.registerVertexIdAttribute(r)}},{key:"registerPositionAttribute",value:function(r){r.registerStyleAttribute({name:"position",type:Ft.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:w.FLOAT},size:3,update:function(i,a,o){return o.length===2?[o[0],o[1],0]:[o[0],o[1],o[2]]}}})}},{key:"registerFilterAttribute",value:function(r){r.registerStyleAttribute({name:"filter",type:Ft.Attribute,descriptor:{name:"filter",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(i){var a=i.filter;return a?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(r){r.registerStyleAttribute({name:"color",type:Ft.Attribute,descriptor:{name:"a_Color",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:4,update:function(i){var a=i.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(r){r.registerStyleAttribute({name:"vertexId",type:Ft.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:w.DYNAMIC_DRAW,data:[],type:w.FLOAT},size:1,update:function(i,a){return[a]}}})}}]),e}())||nw),iw,aw,ow,uw,sw,lw,oh,cw,fw,hw,pw,IK=(iw=xr(),aw=kr(Oe.ICameraService),ow=kr(Oe.ICoordinateSystemService),uw=kr(Oe.IRendererService),sw=kr(Oe.IMapService),iw(lw=(oh=function(){function e(){ke(this,e),Mr(this,"cameraService",cw,this),Mr(this,"coordinateSystemService",fw,this),Mr(this,"rendererService",hw,this),Mr(this,"mapService",pw,this)}return Pe(e,[{key:"apply",value:function(r){var n=this,i=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o=[0,0];r.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var u=r.getLayerConfig().tileOrigin;n.coordinateSystemService.refresh(u),i==="GAODE2.x"&&(n.setLayerCenter(r),a=n.mapService.map.customCoords.getMVPMatrix(),o=n.mapService.getCustomCoordCenter());var s=n.rendererService.getViewportSize(),l=s.width,f=s.height;r.models.forEach(function(h){var d;h.addUniforms((d={},T(d,xc.ProjectionMatrix,n.cameraService.getProjectionMatrix()),T(d,xc.ViewMatrix,n.cameraService.getViewMatrix()),T(d,xc.ViewProjectionMatrix,n.cameraService.getViewProjectionMatrix()),T(d,xc.Zoom,n.cameraService.getZoom()),T(d,xc.ZoomScale,n.cameraService.getZoomScale()),T(d,xc.FocalDistance,n.cameraService.getFocalDistance()),T(d,xc.CameraPosition,n.cameraService.getCameraPosition()),T(d,yc.CoordinateSystem,n.coordinateSystemService.getCoordinateSystem()),T(d,yc.ViewportCenter,n.coordinateSystemService.getViewportCenter()),T(d,yc.ViewportCenterProjection,n.coordinateSystemService.getViewportCenterProjection()),T(d,yc.PixelsPerDegree,n.coordinateSystemService.getPixelsPerDegree()),T(d,yc.PixelsPerDegree2,n.coordinateSystemService.getPixelsPerDegree2()),T(d,yc.PixelsPerMeter,n.coordinateSystemService.getPixelsPerMeter()),T(d,yc.Mvp,a),T(d,"u_SceneCenterMKT",o),T(d,"u_ViewportSize",[l,f]),T(d,"u_ModelMatrix",n.cameraService.getModelMatrix()),T(d,"u_DevicePixelRatio",en.devicePixelRatio),T(d,"u_PickingBuffer",r.getLayerConfig().pickingBuffer||0),T(d,"u_shaderPick",Number(r.getShaderPickStat())),d))})})}},{key:"setLayerCenter",value:function(r){r.coordCenter===void 0&&(r.coordCenter=r.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(r.coordCenter)}}]),e}(),cw=wr(oh.prototype,"cameraService",[aw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fw=wr(oh.prototype,"coordinateSystemService",[ow],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hw=wr(oh.prototype,"rendererService",[uw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pw=wr(oh.prototype,"mapService",[sw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oh))||lw),dw,vw,kK=(dw=xr(),dw(vw=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("UpdateModelPlugin",function(){r.layerModel&&r.layerModel.needUpdate()}),r.hooks.afterRender.tap("UpdateModelPlugin",function(){r.layerModelNeedUpdate=!1})}}]),e}())||vw),gw,mw,PK=(gw=xr(),gw(mw=function(){function e(){ke(this,e)}return Pe(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){i.initStyleAttribute(r,{styleAttributeService:a})}),r.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){r.layerModelNeedUpdate||r.inited&&i.updateStyleAttribute(r,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(r,n){var i=n.styleAttributeService,a=i.getLayerStyleAttributes()||[],o=i.getLayerStyleAttribute("filter");if(o&&o.needRegenerateVertices){r.layerModelNeedUpdate=!0,a.forEach(function(u){return u.needRegenerateVertices=!1});return}a.filter(function(u){return u.needRegenerateVertices}).forEach(function(u){i.updateAttributeByFeatureRange(u.name,r.getEncodedData(),u.featureRange.startIndex,u.featureRange.endIndex,r),u.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(r,n){var i=n.styleAttributeService,a=i.getLayerStyleAttributes()||[];a.filter(function(o){return o.needRegenerateVertices}).forEach(function(o){i.updateAttributeByFeatureRange(o.name,r.getEncodedData(),o.featureRange.startIndex,o.featureRange.endIndex),o.needRegenerateVertices=!1})}}]),e}())||mw);wi.bind(Oe.ILayerPlugin).to(aY).inRequestScope();wi.bind(Oe.ILayerPlugin).to(FK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(yq).inRequestScope();wi.bind(Oe.ILayerPlugin).to(iY).inRequestScope();wi.bind(Oe.ILayerPlugin).to(EK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(PK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(kK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(MK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(IK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(_q).inRequestScope();wi.bind(Oe.ILayerPlugin).to(wK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(RK).inRequestScope();wi.bind(Oe.ILayerPlugin).to(xK).inRequestScope();var S7={exports:{}},H_={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},V_="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",DK={5:V_,"5module":V_+" export import",6:V_+" const class extends export import super"},BK=/^in(stanceof)?$/,PE="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",T7="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",NK=new RegExp("["+PE+"]"),UK=new RegExp("["+PE+T7+"]");PE=T7=null;var w7=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],zK=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function hx(e,t){for(var r=65536,n=0;n<t.length;n+=2){if(r+=t[n],r>e)return!1;if(r+=t[n+1],r>=e)return!0}}function Cl(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&NK.test(String.fromCharCode(e)):t===!1?!1:hx(e,w7)}function Bh(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&UK.test(String.fromCharCode(e)):t===!1?!1:hx(e,w7)||hx(e,zK)}var Qr=function(t,r){r===void 0&&(r={}),this.label=t,this.keyword=r.keyword,this.beforeExpr=!!r.beforeExpr,this.startsExpr=!!r.startsExpr,this.isLoop=!!r.isLoop,this.isAssign=!!r.isAssign,this.prefix=!!r.prefix,this.postfix=!!r.postfix,this.binop=r.binop||null,this.updateContext=null};function Ka(e,t){return new Qr(e,{beforeExpr:!0,binop:t})}var Qa={beforeExpr:!0},Ma={startsExpr:!0},DE={};function Vr(e,t){return t===void 0&&(t={}),t.keyword=e,DE[e]=new Qr(e,t)}var U={num:new Qr("num",Ma),regexp:new Qr("regexp",Ma),string:new Qr("string",Ma),name:new Qr("name",Ma),eof:new Qr("eof"),bracketL:new Qr("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Qr("]"),braceL:new Qr("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Qr("}"),parenL:new Qr("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Qr(")"),comma:new Qr(",",Qa),semi:new Qr(";",Qa),colon:new Qr(":",Qa),dot:new Qr("."),question:new Qr("?",Qa),questionDot:new Qr("?."),arrow:new Qr("=>",Qa),template:new Qr("template"),invalidTemplate:new Qr("invalidTemplate"),ellipsis:new Qr("...",Qa),backQuote:new Qr("`",Ma),dollarBraceL:new Qr("${",{beforeExpr:!0,startsExpr:!0}),eq:new Qr("=",{beforeExpr:!0,isAssign:!0}),assign:new Qr("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Qr("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Qr("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ka("||",1),logicalAND:Ka("&&",2),bitwiseOR:Ka("|",3),bitwiseXOR:Ka("^",4),bitwiseAND:Ka("&",5),equality:Ka("==/!=/===/!==",6),relational:Ka("</>/<=/>=",7),bitShift:Ka("<</>>/>>>",8),plusMin:new Qr("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ka("%",10),star:Ka("*",10),slash:Ka("/",10),starstar:new Qr("**",{beforeExpr:!0}),coalesce:Ka("??",1),_break:Vr("break"),_case:Vr("case",Qa),_catch:Vr("catch"),_continue:Vr("continue"),_debugger:Vr("debugger"),_default:Vr("default",Qa),_do:Vr("do",{isLoop:!0,beforeExpr:!0}),_else:Vr("else",Qa),_finally:Vr("finally"),_for:Vr("for",{isLoop:!0}),_function:Vr("function",Ma),_if:Vr("if"),_return:Vr("return",Qa),_switch:Vr("switch"),_throw:Vr("throw",Qa),_try:Vr("try"),_var:Vr("var"),_const:Vr("const"),_while:Vr("while",{isLoop:!0}),_with:Vr("with"),_new:Vr("new",{beforeExpr:!0,startsExpr:!0}),_this:Vr("this",Ma),_super:Vr("super",Ma),_class:Vr("class",Ma),_extends:Vr("extends",Qa),_export:Vr("export"),_import:Vr("import",Ma),_null:Vr("null",Ma),_true:Vr("true",Ma),_false:Vr("false",Ma),_in:Vr("in",{beforeExpr:!0,binop:7}),_instanceof:Vr("instanceof",{beforeExpr:!0,binop:7}),_typeof:Vr("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Vr("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Vr("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},lo=/\r\n?|\n|\u2028|\u2029/,l0=new RegExp(lo.source,"g");function y0(e,t){return e===10||e===13||!t&&(e===8232||e===8233)}var M7=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,no=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,R7=Object.prototype,$K=R7.hasOwnProperty,GK=R7.toString;function Lm(e,t){return $K.call(e,t)}var yw=Array.isArray||function(e){return GK.call(e)==="[object Array]"};function Ic(e){return new RegExp("^(?:"+e.replace(/ /g,"|")+")$")}var c0=function(t,r){this.line=t,this.column=r};c0.prototype.offset=function(t){return new c0(this.line,this.column+t)};var Fm=function(t,r,n){this.start=r,this.end=n,t.sourceFile!==null&&(this.source=t.sourceFile)};function O7(e,t){for(var r=1,n=0;;){l0.lastIndex=n;var i=l0.exec(e);if(i&&i.index<t)++r,n=i.index+i[0].length;else return new c0(r,t-n)}}var px={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function HK(e){var t={};for(var r in px)t[r]=e&&Lm(e,r)?e[r]:px[r];if(t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),yw(t.onToken)){var n=t.onToken;t.onToken=function(i){return n.push(i)}}return yw(t.onComment)&&(t.onComment=VK(t,t.onComment)),t}function VK(e,t){return function(r,n,i,a,o,u){var s={type:r?"Block":"Line",value:n,start:i,end:a};e.locations&&(s.loc=new Fm(this,o,u)),e.ranges&&(s.range=[i,a]),t.push(s)}}var f0=1,_0=2,BE=f0|_0,L7=4,F7=8,I7=16,k7=32,P7=64,D7=128;function NE(e,t){return _0|(e?L7:0)|(t?F7:0)}var _w=0,UE=1,os=2,B7=3,N7=4,U7=5,Qn=function(t,r,n){this.options=t=HK(t),this.sourceFile=t.sourceFile,this.keywords=Ic(DK[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var i="";if(t.allowReserved!==!0){for(var a=t.ecmaVersion;!(i=H_[a]);a--);t.sourceType==="module"&&(i+=" await")}this.reservedWords=Ic(i);var o=(i?i+" ":"")+H_.strict;this.reservedWordsStrict=Ic(o),this.reservedWordsStrictBind=Ic(o+" "+H_.strictBind),this.input=String(r),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf(`
`,n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(lo).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=U.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(f0),this.regexpState=null},Kc={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Qn.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};Kc.inFunction.get=function(){return(this.currentVarScope().flags&_0)>0};Kc.inGenerator.get=function(){return(this.currentVarScope().flags&F7)>0};Kc.inAsync.get=function(){return(this.currentVarScope().flags&L7)>0};Kc.allowSuper.get=function(){return(this.currentThisScope().flags&P7)>0};Kc.allowDirectSuper.get=function(){return(this.currentThisScope().flags&D7)>0};Kc.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Qn.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&_0)>0};Qn.extend=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];for(var n=this,i=0;i<t.length;i++)n=t[i](n);return n};Qn.parse=function(t,r){return new this(r,t).parse()};Qn.parseExpressionAt=function(t,r,n){var i=new this(n,t,r);return i.nextToken(),i.parseExpression()};Qn.tokenizer=function(t,r){return new this(r,t)};Object.defineProperties(Qn.prototype,Kc);var Wi=Qn.prototype,jK=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;Wi.strictDirective=function(e){for(;;){no.lastIndex=e,e+=no.exec(this.input)[0].length;var t=jK.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){no.lastIndex=e+t[0].length;var r=no.exec(this.input),n=r.index+r[0].length,i=this.input.charAt(n);return i===";"||i==="}"||lo.test(r[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||i==="!"&&this.input.charAt(n+1)==="=")}e+=t[0].length,no.lastIndex=e,e+=no.exec(this.input)[0].length,this.input[e]===";"&&e++}};Wi.eat=function(e){return this.type===e?(this.next(),!0):!1};Wi.isContextual=function(e){return this.type===U.name&&this.value===e&&!this.containsEsc};Wi.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};Wi.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};Wi.canInsertSemicolon=function(){return this.type===U.eof||this.type===U.braceR||lo.test(this.input.slice(this.lastTokEnd,this.start))};Wi.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Wi.semicolon=function(){!this.eat(U.semi)&&!this.insertSemicolon()&&this.unexpected()};Wi.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};Wi.expect=function(e){this.eat(e)||this.unexpected()};Wi.unexpected=function(e){this.raise(e!=null?e:this.start,"Unexpected token")};function Im(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Wi.checkPatternErrors=function(e,t){if(!!e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var r=t?e.parenthesizedAssign:e.parenthesizedBind;r>-1&&this.raiseRecoverable(r,"Parenthesized pattern")}};Wi.checkExpressionErrors=function(e,t){if(!e)return!1;var r=e.shorthandAssign,n=e.doubleProto;if(!t)return r>=0||n>=0;r>=0&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns"),n>=0&&this.raiseRecoverable(n,"Redefinition of __proto__ property")};Wi.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Wi.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var Rr=Qn.prototype;Rr.parseTopLevel=function(e){var t={};for(e.body||(e.body=[]);this.type!==U.eof;){var r=this.parseStatement(null,!0,t);e.body.push(r)}if(this.inModule)for(var n=0,i=Object.keys(this.undefinedExports);n<i.length;n+=1){var a=i[n];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var zE={kind:"loop"},WK={kind:"switch"};Rr.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;no.lastIndex=this.pos;var t=no.exec(this.input),r=this.pos+t[0].length,n=this.input.charCodeAt(r);if(n===91)return!0;if(e)return!1;if(n===123)return!0;if(Cl(n,!0)){for(var i=r+1;Bh(this.input.charCodeAt(i),!0);)++i;var a=this.input.slice(r,i);if(!BK.test(a))return!0}return!1};Rr.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;no.lastIndex=this.pos;var e=no.exec(this.input),t=this.pos+e[0].length;return!lo.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!Bh(this.input.charAt(t+8)))};Rr.parseStatement=function(e,t,r){var n=this.type,i=this.startNode(),a;switch(this.isLet(e)&&(n=U._var,a="let"),n){case U._break:case U._continue:return this.parseBreakContinueStatement(i,n.keyword);case U._debugger:return this.parseDebuggerStatement(i);case U._do:return this.parseDoStatement(i);case U._for:return this.parseForStatement(i);case U._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(i,!1,!e);case U._class:return e&&this.unexpected(),this.parseClass(i,!0);case U._if:return this.parseIfStatement(i);case U._return:return this.parseReturnStatement(i);case U._switch:return this.parseSwitchStatement(i);case U._throw:return this.parseThrowStatement(i);case U._try:return this.parseTryStatement(i);case U._const:case U._var:return a=a||this.value,e&&a!=="var"&&this.unexpected(),this.parseVarStatement(i,a);case U._while:return this.parseWhileStatement(i);case U._with:return this.parseWithStatement(i);case U.braceL:return this.parseBlock(!0,i);case U.semi:return this.parseEmptyStatement(i);case U._export:case U._import:if(this.options.ecmaVersion>10&&n===U._import){no.lastIndex=this.pos;var o=no.exec(this.input),u=this.pos+o[0].length,s=this.input.charCodeAt(u);if(s===40||s===46)return this.parseExpressionStatement(i,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),n===U._import?this.parseImport(i):this.parseExport(i,r);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(i,!0,!e);var l=this.value,f=this.parseExpression();return n===U.name&&f.type==="Identifier"&&this.eat(U.colon)?this.parseLabeledStatement(i,l,f,e):this.parseExpressionStatement(i,f)}};Rr.parseBreakContinueStatement=function(e,t){var r=t==="break";this.next(),this.eat(U.semi)||this.insertSemicolon()?e.label=null:this.type!==U.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var n=0;n<this.labels.length;++n){var i=this.labels[n];if((e.label==null||i.name===e.label.name)&&(i.kind!=null&&(r||i.kind==="loop")||e.label&&r))break}return n===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,r?"BreakStatement":"ContinueStatement")};Rr.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};Rr.parseDoStatement=function(e){return this.next(),this.labels.push(zE),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(U._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(U.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};Rr.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(zE),this.enterScope(0),this.expect(U.parenL),this.type===U.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var r=this.isLet();if(this.type===U._var||this.type===U._const||r){var n=this.startNode(),i=r?"let":this.value;return this.next(),this.parseVar(n,!0,i),this.finishNode(n,"VariableDeclaration"),(this.type===U._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&n.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===U._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,n)):(t>-1&&this.unexpected(t),this.parseFor(e,n))}var a=new Im,o=this.parseExpression(!0,a);return this.type===U._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===U._in?t>-1&&this.unexpected(t):e.await=t>-1),this.toAssignable(o,!1,a),this.checkLVal(o),this.parseForIn(e,o)):(this.checkExpressionErrors(a,!0),t>-1&&this.unexpected(t),this.parseFor(e,o))};Rr.parseFunctionStatement=function(e,t,r){return this.next(),this.parseFunction(e,Dd|(r?0:dx),!1,t)};Rr.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(U._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};Rr.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(U.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};Rr.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(U.braceL),this.labels.push(WK),this.enterScope(0);for(var t,r=!1;this.type!==U.braceR;)if(this.type===U._case||this.type===U._default){var n=this.type===U._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),n?t.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(U.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};Rr.parseThrowStatement=function(e){return this.next(),lo.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var XK=[];Rr.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===U._catch){var t=this.startNode();if(this.next(),this.eat(U.parenL)){t.param=this.parseBindingAtom();var r=t.param.type==="Identifier";this.enterScope(r?k7:0),this.checkLVal(t.param,r?N7:os),this.expect(U.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0);t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(U._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};Rr.parseVarStatement=function(e,t){return this.next(),this.parseVar(e,!1,t),this.semicolon(),this.finishNode(e,"VariableDeclaration")};Rr.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(zE),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};Rr.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};Rr.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};Rr.parseLabeledStatement=function(e,t,r,n){for(var i=0,a=this.labels;i<a.length;i+=1){var o=a[i];o.name===t&&this.raise(r.start,"Label '"+t+"' is already declared")}for(var u=this.type.isLoop?"loop":this.type===U._switch?"switch":null,s=this.labels.length-1;s>=0;s--){var l=this.labels[s];if(l.statementStart===e.start)l.statementStart=this.start,l.kind=u;else break}return this.labels.push({name:t,kind:u,statementStart:this.start}),e.body=this.parseStatement(n?n.indexOf("label")===-1?n+"label":n:"label"),this.labels.pop(),e.label=r,this.finishNode(e,"LabeledStatement")};Rr.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};Rr.parseBlock=function(e,t,r){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(U.braceL),e&&this.enterScope(0);this.type!==U.braceR;){var n=this.parseStatement(null);t.body.push(n)}return r&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};Rr.parseFor=function(e,t){return e.init=t,this.expect(U.semi),e.test=this.type===U.semi?null:this.parseExpression(),this.expect(U.semi),e.update=this.type===U.parenR?null:this.parseExpression(),this.expect(U.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};Rr.parseForIn=function(e,t){var r=this.type===U._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!r||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")?this.raise(t.start,(r?"for-in":"for-of")+" loop variable declaration may not have an initializer"):t.type==="AssignmentPattern"&&this.raise(t.start,"Invalid left-hand side in for-loop"),e.left=t,e.right=r?this.parseExpression():this.parseMaybeAssign(),this.expect(U.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,r?"ForInStatement":"ForOfStatement")};Rr.parseVar=function(e,t,r){for(e.declarations=[],e.kind=r;;){var n=this.startNode();if(this.parseVarId(n,r),this.eat(U.eq)?n.init=this.parseMaybeAssign(t):r==="const"&&!(this.type===U._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():n.id.type!=="Identifier"&&!(t&&(this.type===U._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):n.init=null,e.declarations.push(this.finishNode(n,"VariableDeclarator")),!this.eat(U.comma))break}return e};Rr.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLVal(e.id,t==="var"?UE:os,!1)};var Dd=1,dx=2,z7=4;Rr.parseFunction=function(e,t,r,n){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!n)&&(this.type===U.star&&t&dx&&this.unexpected(),e.generator=this.eat(U.star)),this.options.ecmaVersion>=8&&(e.async=!!n),t&Dd&&(e.id=t&z7&&this.type!==U.name?null:this.parseIdent(),e.id&&!(t&dx)&&this.checkLVal(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?UE:os:B7));var i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(NE(e.async,e.generator)),t&Dd||(e.id=this.type===U.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,r,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(e,t&Dd?"FunctionDeclaration":"FunctionExpression")};Rr.parseFunctionParams=function(e){this.expect(U.parenL),e.params=this.parseBindingList(U.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Rr.parseClass=function(e,t){this.next();var r=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var n=this.startNode(),i=!1;for(n.body=[],this.expect(U.braceL);this.type!==U.braceR;){var a=this.parseClassElement(e.superClass!==null);a&&(n.body.push(a),a.type==="MethodDefinition"&&a.kind==="constructor"&&(i&&this.raise(a.start,"Duplicate constructor in the same class"),i=!0))}return this.strict=r,this.next(),e.body=this.finishNode(n,"ClassBody"),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};Rr.parseClassElement=function(e){var t=this;if(this.eat(U.semi))return null;var r=this.startNode(),n=function(s,l){l===void 0&&(l=!1);var f=t.start,h=t.startLoc;return t.eatContextual(s)?t.type!==U.parenL&&(!l||!t.canInsertSemicolon())?!0:(r.key&&t.unexpected(),r.computed=!1,r.key=t.startNodeAt(f,h),r.key.name=s,t.finishNode(r.key,"Identifier"),!1):!1};r.kind="method",r.static=n("static");var i=this.eat(U.star),a=!1;i||(this.options.ecmaVersion>=8&&n("async",!0)?(a=!0,i=this.options.ecmaVersion>=9&&this.eat(U.star)):n("get")?r.kind="get":n("set")&&(r.kind="set")),r.key||this.parsePropertyName(r);var o=r.key,u=!1;return!r.computed&&!r.static&&(o.type==="Identifier"&&o.name==="constructor"||o.type==="Literal"&&o.value==="constructor")?(r.kind!=="method"&&this.raise(o.start,"Constructor can't have get/set modifier"),i&&this.raise(o.start,"Constructor can't be a generator"),a&&this.raise(o.start,"Constructor can't be an async method"),r.kind="constructor",u=e):r.static&&o.type==="Identifier"&&o.name==="prototype"&&this.raise(o.start,"Classes may not have a static property named prototype"),this.parseClassMethod(r,i,a,u),r.kind==="get"&&r.value.params.length!==0&&this.raiseRecoverable(r.value.start,"getter should have no params"),r.kind==="set"&&r.value.params.length!==1&&this.raiseRecoverable(r.value.start,"setter should have exactly one param"),r.kind==="set"&&r.value.params[0].type==="RestElement"&&this.raiseRecoverable(r.value.params[0].start,"Setter cannot use rest params"),r};Rr.parseClassMethod=function(e,t,r,n){return e.value=this.parseMethod(t,r,n),this.finishNode(e,"MethodDefinition")};Rr.parseClassId=function(e,t){this.type===U.name?(e.id=this.parseIdent(),t&&this.checkLVal(e.id,os,!1)):(t===!0&&this.unexpected(),e.id=null)};Rr.parseClassSuper=function(e){e.superClass=this.eat(U._extends)?this.parseExprSubscripts():null};Rr.parseExport=function(e,t){if(this.next(),this.eat(U.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseIdent(!0),this.checkExport(t,e.exported.name,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==U.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(U._default)){this.checkExport(t,"default",this.lastTokStart);var r;if(this.type===U._function||(r=this.isAsyncFunction())){var n=this.startNode();this.next(),r&&this.next(),e.declaration=this.parseFunction(n,Dd|z7,!1,r)}else if(this.type===U._class){var i=this.startNode();e.declaration=this.parseClass(i,"nullableID")}else e.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(null),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id.name,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==U.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var a=0,o=e.specifiers;a<o.length;a+=1){var u=o[a];this.checkUnreserved(u.local),this.checkLocalExport(u.local)}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};Rr.checkExport=function(e,t,r){!e||(Lm(e,t)&&this.raiseRecoverable(r,"Duplicate export '"+t+"'"),e[t]=!0)};Rr.checkPatternExport=function(e,t){var r=t.type;if(r==="Identifier")this.checkExport(e,t.name,t.start);else if(r==="ObjectPattern")for(var n=0,i=t.properties;n<i.length;n+=1){var a=i[n];this.checkPatternExport(e,a)}else if(r==="ArrayPattern")for(var o=0,u=t.elements;o<u.length;o+=1){var s=u[o];s&&this.checkPatternExport(e,s)}else r==="Property"?this.checkPatternExport(e,t.value):r==="AssignmentPattern"?this.checkPatternExport(e,t.left):r==="RestElement"?this.checkPatternExport(e,t.argument):r==="ParenthesizedExpression"&&this.checkPatternExport(e,t.expression)};Rr.checkVariableExport=function(e,t){if(!!e)for(var r=0,n=t;r<n.length;r+=1){var i=n[r];this.checkPatternExport(e,i.id)}};Rr.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Rr.parseExportSpecifiers=function(e){var t=[],r=!0;for(this.expect(U.braceL);!this.eat(U.braceR);){if(r)r=!1;else if(this.expect(U.comma),this.afterTrailingComma(U.braceR))break;var n=this.startNode();n.local=this.parseIdent(!0),n.exported=this.eatContextual("as")?this.parseIdent(!0):n.local,this.checkExport(e,n.exported.name,n.exported.start),t.push(this.finishNode(n,"ExportSpecifier"))}return t};Rr.parseImport=function(e){return this.next(),this.type===U.string?(e.specifiers=XK,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===U.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};Rr.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===U.name){var r=this.startNode();if(r.local=this.parseIdent(),this.checkLVal(r.local,os),e.push(this.finishNode(r,"ImportDefaultSpecifier")),!this.eat(U.comma))return e}if(this.type===U.star){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLVal(n.local,os),e.push(this.finishNode(n,"ImportNamespaceSpecifier")),e}for(this.expect(U.braceL);!this.eat(U.braceR);){if(t)t=!1;else if(this.expect(U.comma),this.afterTrailingComma(U.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,os),e.push(this.finishNode(i,"ImportSpecifier"))}return e};Rr.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};Rr.isDirectiveCandidate=function(e){return e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var fs=Qn.prototype;fs.toAssignable=function(e,t,r){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",r&&this.checkPatternErrors(r,!0);for(var n=0,i=e.properties;n<i.length;n+=1){var a=i[n];this.toAssignable(a,t),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",r&&this.checkPatternErrors(r,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,r);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else r&&this.checkPatternErrors(r,!0);return e};fs.toAssignableList=function(e,t){for(var r=e.length,n=0;n<r;n++){var i=e[n];i&&this.toAssignable(i,t)}if(r){var a=e[r-1];this.options.ecmaVersion===6&&t&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return e};fs.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};fs.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==U.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};fs.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case U.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(U.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case U.braceL:return this.parseObj(!0)}return this.parseIdent()};fs.parseBindingList=function(e,t,r){for(var n=[],i=!0;!this.eat(e);)if(i?i=!1:this.expect(U.comma),t&&this.type===U.comma)n.push(null);else{if(r&&this.afterTrailingComma(e))break;if(this.type===U.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),n.push(a),this.type===U.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else{var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),n.push(o)}}return n};fs.parseBindingListItem=function(e){return e};fs.parseMaybeDefault=function(e,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(U.eq))return r;var n=this.startNodeAt(e,t);return n.left=r,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")};fs.checkLVal=function(e,t,r){switch(t===void 0&&(t=_w),e.type){case"Identifier":t===os&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(t?"Binding ":"Assigning to ")+e.name+" in strict mode"),r&&(Lm(r,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),r[e.name]=!0),t!==_w&&t!==U7&&this.declareName(e.name,t,e.start);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":t&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ObjectPattern":for(var n=0,i=e.properties;n<i.length;n+=1){var a=i[n];this.checkLVal(a,t,r)}break;case"Property":this.checkLVal(e.value,t,r);break;case"ArrayPattern":for(var o=0,u=e.elements;o<u.length;o+=1){var s=u[o];s&&this.checkLVal(s,t,r)}break;case"AssignmentPattern":this.checkLVal(e.left,t,r);break;case"RestElement":this.checkLVal(e.argument,t,r);break;case"ParenthesizedExpression":this.checkLVal(e.expression,t,r);break;default:this.raise(e.start,(t?"Binding":"Assigning to")+" rvalue")}};var Br=Qn.prototype;Br.checkPropClash=function(e,t,r){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var n=e.key,i;switch(n.type){case"Identifier":i=n.name;break;case"Literal":i=String(n.value);break;default:return}var a=e.kind;if(this.options.ecmaVersion>=6){i==="__proto__"&&a==="init"&&(t.proto&&(r?r.doubleProto<0&&(r.doubleProto=n.start):this.raiseRecoverable(n.start,"Redefinition of __proto__ property")),t.proto=!0);return}i="$"+i;var o=t[i];if(o){var u;a==="init"?u=this.strict&&o.init||o.get||o.set:u=o.init||o[a],u&&this.raiseRecoverable(n.start,"Redefinition of property")}else o=t[i]={init:!1,get:!1,set:!1};o[a]=!0}};Br.parseExpression=function(e,t){var r=this.start,n=this.startLoc,i=this.parseMaybeAssign(e,t);if(this.type===U.comma){var a=this.startNodeAt(r,n);for(a.expressions=[i];this.eat(U.comma);)a.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(a,"SequenceExpression")}return i};Br.parseMaybeAssign=function(e,t,r){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var n=!1,i=-1,a=-1;t?(i=t.parenthesizedAssign,a=t.trailingComma,t.parenthesizedAssign=t.trailingComma=-1):(t=new Im,n=!0);var o=this.start,u=this.startLoc;(this.type===U.parenL||this.type===U.name)&&(this.potentialArrowAt=this.start);var s=this.parseMaybeConditional(e,t);if(r&&(s=r.call(this,s,o,u)),this.type.isAssign){var l=this.startNodeAt(o,u);return l.operator=this.value,l.left=this.type===U.eq?this.toAssignable(s,!1,t):s,n||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=l.left.start&&(t.shorthandAssign=-1),this.checkLVal(s),this.next(),l.right=this.parseMaybeAssign(e),this.finishNode(l,"AssignmentExpression")}else n&&this.checkExpressionErrors(t,!0);return i>-1&&(t.parenthesizedAssign=i),a>-1&&(t.trailingComma=a),s};Br.parseMaybeConditional=function(e,t){var r=this.start,n=this.startLoc,i=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return i;if(this.eat(U.question)){var a=this.startNodeAt(r,n);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(U.colon),a.alternate=this.parseMaybeAssign(e),this.finishNode(a,"ConditionalExpression")}return i};Br.parseExprOps=function(e,t){var r=this.start,n=this.startLoc,i=this.parseMaybeUnary(t,!1);return this.checkExpressionErrors(t)||i.start===r&&i.type==="ArrowFunctionExpression"?i:this.parseExprOp(i,r,n,-1,e)};Br.parseExprOp=function(e,t,r,n,i){var a=this.type.binop;if(a!=null&&(!i||this.type!==U._in)&&a>n){var o=this.type===U.logicalOR||this.type===U.logicalAND,u=this.type===U.coalesce;u&&(a=U.logicalAND.binop);var s=this.value;this.next();var l=this.start,f=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1),l,f,a,i),d=this.buildBinary(t,r,e,h,s,o||u);return(o&&this.type===U.coalesce||u&&(this.type===U.logicalOR||this.type===U.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,t,r,n,i)}return e};Br.buildBinary=function(e,t,r,n,i,a){var o=this.startNodeAt(e,t);return o.left=r,o.operator=i,o.right=n,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")};Br.parseMaybeUnary=function(e,t){var r=this.start,n=this.startLoc,i;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))i=this.parseAwait(),t=!0;else if(this.type.prefix){var a=this.startNode(),o=this.type===U.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),o?this.checkLVal(a.argument):this.strict&&a.operator==="delete"&&a.argument.type==="Identifier"?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):t=!0,i=this.finishNode(a,o?"UpdateExpression":"UnaryExpression")}else{if(i=this.parseExprSubscripts(e),this.checkExpressionErrors(e))return i;for(;this.type.postfix&&!this.canInsertSemicolon();){var u=this.startNodeAt(r,n);u.operator=this.value,u.prefix=!1,u.argument=i,this.checkLVal(i),this.next(),i=this.finishNode(u,"UpdateExpression")}}return!t&&this.eat(U.starstar)?this.buildBinary(r,n,i,this.parseMaybeUnary(null,!1),"**",!1):i};Br.parseExprSubscripts=function(e){var t=this.start,r=this.startLoc,n=this.parseExprAtom(e);if(n.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return n;var i=this.parseSubscripts(n,t,r);return e&&i.type==="MemberExpression"&&(e.parenthesizedAssign>=i.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=i.start&&(e.parenthesizedBind=-1)),i};Br.parseSubscripts=function(e,t,r,n){for(var i=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,a=!1;;){var o=this.parseSubscript(e,t,r,n,i,a);if(o.optional&&(a=!0),o===e||o.type==="ArrowFunctionExpression"){if(a){var u=this.startNodeAt(t,r);u.expression=o,o=this.finishNode(u,"ChainExpression")}return o}e=o}};Br.parseSubscript=function(e,t,r,n,i,a){var o=this.options.ecmaVersion>=11,u=o&&this.eat(U.questionDot);n&&u&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var s=this.eat(U.bracketL);if(s||u&&this.type!==U.parenL&&this.type!==U.backQuote||this.eat(U.dot)){var l=this.startNodeAt(t,r);l.object=e,l.property=s?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),l.computed=!!s,s&&this.expect(U.bracketR),o&&(l.optional=u),e=this.finishNode(l,"MemberExpression")}else if(!n&&this.eat(U.parenL)){var f=new Im,h=this.yieldPos,d=this.awaitPos,v=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(U.parenR,this.options.ecmaVersion>=8,!1,f);if(i&&!u&&!this.canInsertSemicolon()&&this.eat(U.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=h,this.awaitPos=d,this.awaitIdentPos=v,this.parseArrowExpression(this.startNodeAt(t,r),m,!0);this.checkExpressionErrors(f,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=d||this.awaitPos,this.awaitIdentPos=v||this.awaitIdentPos;var y=this.startNodeAt(t,r);y.callee=e,y.arguments=m,o&&(y.optional=u),e=this.finishNode(y,"CallExpression")}else if(this.type===U.backQuote){(u||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var _=this.startNodeAt(t,r);_.tag=e,_.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(_,"TaggedTemplateExpression")}return e};Br.parseExprAtom=function(e){this.type===U.slash&&this.readRegexp();var t,r=this.potentialArrowAt===this.start;switch(this.type){case U._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),t=this.startNode(),this.next(),this.type===U.parenL&&!this.allowDirectSuper&&this.raise(t.start,"super() call outside constructor of a subclass"),this.type!==U.dot&&this.type!==U.bracketL&&this.type!==U.parenL&&this.unexpected(),this.finishNode(t,"Super");case U._this:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case U.name:var n=this.start,i=this.startLoc,a=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&o.name==="async"&&!this.canInsertSemicolon()&&this.eat(U._function))return this.parseFunction(this.startNodeAt(n,i),0,!1,!0);if(r&&!this.canInsertSemicolon()){if(this.eat(U.arrow))return this.parseArrowExpression(this.startNodeAt(n,i),[o],!1);if(this.options.ecmaVersion>=8&&o.name==="async"&&this.type===U.name&&!a)return o=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(U.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,i),[o],!0)}return o;case U.regexp:var u=this.value;return t=this.parseLiteral(u.value),t.regex={pattern:u.pattern,flags:u.flags},t;case U.num:case U.string:return this.parseLiteral(this.value);case U._null:case U._true:case U._false:return t=this.startNode(),t.value=this.type===U._null?null:this.type===U._true,t.raw=this.type.keyword,this.next(),this.finishNode(t,"Literal");case U.parenL:var s=this.start,l=this.parseParenAndDistinguishExpression(r);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(l)&&(e.parenthesizedAssign=s),e.parenthesizedBind<0&&(e.parenthesizedBind=s)),l;case U.bracketL:return t=this.startNode(),this.next(),t.elements=this.parseExprList(U.bracketR,!0,!0,e),this.finishNode(t,"ArrayExpression");case U.braceL:return this.parseObj(!1,e);case U._function:return t=this.startNode(),this.next(),this.parseFunction(t,0);case U._class:return this.parseClass(this.startNode(),!1);case U._new:return this.parseNew();case U.backQuote:return this.parseTemplate();case U._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}};Br.parseExprImport=function(){var e=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var t=this.parseIdent(!0);switch(this.type){case U.parenL:return this.parseDynamicImport(e);case U.dot:return e.meta=t,this.parseImportMeta(e);default:this.unexpected()}};Br.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(U.parenR)){var t=this.start;this.eat(U.comma)&&this.eat(U.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};Br.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};Br.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};Br.parseParenExpression=function(){this.expect(U.parenL);var e=this.parseExpression();return this.expect(U.parenR),e};Br.parseParenAndDistinguishExpression=function(e){var t=this.start,r=this.startLoc,n,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a=this.start,o=this.startLoc,u=[],s=!0,l=!1,f=new Im,h=this.yieldPos,d=this.awaitPos,v;for(this.yieldPos=0,this.awaitPos=0;this.type!==U.parenR;)if(s?s=!1:this.expect(U.comma),i&&this.afterTrailingComma(U.parenR,!0)){l=!0;break}else if(this.type===U.ellipsis){v=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===U.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else u.push(this.parseMaybeAssign(!1,f,this.parseParenItem));var m=this.start,y=this.startLoc;if(this.expect(U.parenR),e&&!this.canInsertSemicolon()&&this.eat(U.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=d,this.parseParenArrowList(t,r,u);(!u.length||l)&&this.unexpected(this.lastTokStart),v&&this.unexpected(v),this.checkExpressionErrors(f,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=d||this.awaitPos,u.length>1?(n=this.startNodeAt(a,o),n.expressions=u,this.finishNodeAt(n,"SequenceExpression",m,y)):n=u[0]}else n=this.parseParenExpression();if(this.options.preserveParens){var _=this.startNodeAt(t,r);return _.expression=n,this.finishNode(_,"ParenthesizedExpression")}else return n};Br.parseParenItem=function(e){return e};Br.parseParenArrowList=function(e,t,r){return this.parseArrowExpression(this.startNodeAt(e,t),r)};var YK=[];Br.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode(),t=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(U.dot)){e.meta=t;var r=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),r&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(e.start,"'new.target' can only be used in functions"),this.finishNode(e,"MetaProperty")}var n=this.start,i=this.startLoc,a=this.type===U._import;return e.callee=this.parseSubscripts(this.parseExprAtom(),n,i,!0),a&&e.callee.type==="ImportExpression"&&this.raise(n,"Cannot use new with import()"),this.eat(U.parenL)?e.arguments=this.parseExprList(U.parenR,this.options.ecmaVersion>=8,!1):e.arguments=YK,this.finishNode(e,"NewExpression")};Br.parseTemplateElement=function(e){var t=e.isTagged,r=this.startNode();return this.type===U.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),r.value={raw:this.value,cooked:null}):r.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),r.tail=this.type===U.backQuote,this.finishNode(r,"TemplateElement")};Br.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var r=this.startNode();this.next(),r.expressions=[];var n=this.parseTemplateElement({isTagged:t});for(r.quasis=[n];!n.tail;)this.type===U.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(U.dollarBraceL),r.expressions.push(this.parseExpression()),this.expect(U.braceR),r.quasis.push(n=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(r,"TemplateLiteral")};Br.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===U.name||this.type===U.num||this.type===U.string||this.type===U.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===U.star)&&!lo.test(this.input.slice(this.lastTokEnd,this.start))};Br.parseObj=function(e,t){var r=this.startNode(),n=!0,i={};for(r.properties=[],this.next();!this.eat(U.braceR);){if(n)n=!1;else if(this.expect(U.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(U.braceR))break;var a=this.parseProperty(e,t);e||this.checkPropClash(a,i,t),r.properties.push(a)}return this.finishNode(r,e?"ObjectPattern":"ObjectExpression")};Br.parseProperty=function(e,t){var r=this.startNode(),n,i,a,o;if(this.options.ecmaVersion>=9&&this.eat(U.ellipsis))return e?(r.argument=this.parseIdent(!1),this.type===U.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(r,"RestElement")):(this.type===U.parenL&&t&&(t.parenthesizedAssign<0&&(t.parenthesizedAssign=this.start),t.parenthesizedBind<0&&(t.parenthesizedBind=this.start)),r.argument=this.parseMaybeAssign(!1,t),this.type===U.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(r,"SpreadElement"));this.options.ecmaVersion>=6&&(r.method=!1,r.shorthand=!1,(e||t)&&(a=this.start,o=this.startLoc),e||(n=this.eat(U.star)));var u=this.containsEsc;return this.parsePropertyName(r),!e&&!u&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(r)?(i=!0,n=this.options.ecmaVersion>=9&&this.eat(U.star),this.parsePropertyName(r,t)):i=!1,this.parsePropertyValue(r,e,n,i,a,o,t,u),this.finishNode(r,"Property")};Br.parsePropertyValue=function(e,t,r,n,i,a,o,u){if((r||n)&&this.type===U.colon&&this.unexpected(),this.eat(U.colon))e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===U.parenL)t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(r,n);else if(!t&&!u&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==U.comma&&this.type!==U.braceR&&this.type!==U.eq){(r||n)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var s=e.kind==="get"?0:1;if(e.value.params.length!==s){var l=e.value.start;e.kind==="get"?this.raiseRecoverable(l,"getter should have no params"):this.raiseRecoverable(l,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((r||n)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=i),e.kind="init",t?e.value=this.parseMaybeDefault(i,a,e.key):this.type===U.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(i,a,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected()};Br.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(U.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(U.bracketR),e.key;e.computed=!1}return e.key=this.type===U.num||this.type===U.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Br.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};Br.parseMethod=function(e,t,r){var n=this.startNode(),i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(n),this.options.ecmaVersion>=6&&(n.generator=e),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(NE(t,n.generator)|P7|(r?D7:0)),this.expect(U.parenL),n.params=this.parseBindingList(U.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1,!0),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(n,"FunctionExpression")};Br.parseArrowExpression=function(e,t,r){var n=this.yieldPos,i=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(NE(r,!1)|I7),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1),this.yieldPos=n,this.awaitPos=i,this.awaitIdentPos=a,this.finishNode(e,"ArrowFunctionExpression")};Br.parseFunctionBody=function(e,t,r){var n=t&&this.type!==U.braceL,i=this.strict,a=!1;if(n)e.body=this.parseMaybeAssign(),e.expression=!0,this.checkParams(e,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!i||o)&&(a=this.strictDirective(this.end),a&&o&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var u=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(e,!i&&!a&&!t&&!r&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLVal(e.id,U7),e.body=this.parseBlock(!1,void 0,a&&!i),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=u}this.exitScope()};Br.isSimpleParamList=function(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(n.type!=="Identifier")return!1}return!0};Br.checkParams=function(e,t){for(var r={},n=0,i=e.params;n<i.length;n+=1){var a=i[n];this.checkLVal(a,UE,t?null:r)}};Br.parseExprList=function(e,t,r,n){for(var i=[],a=!0;!this.eat(e);){if(a)a=!1;else if(this.expect(U.comma),t&&this.afterTrailingComma(e))break;var o=void 0;r&&this.type===U.comma?o=null:this.type===U.ellipsis?(o=this.parseSpread(n),n&&this.type===U.comma&&n.trailingComma<0&&(n.trailingComma=this.start)):o=this.parseMaybeAssign(!1,n),i.push(o)}return i};Br.checkUnreserved=function(e){var t=e.start,r=e.end,n=e.name;if(this.inGenerator&&n==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&n==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(n)&&this.raise(t,"Unexpected keyword '"+n+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,r).indexOf("\\")!==-1)){var i=this.strict?this.reservedWordsStrict:this.reservedWords;i.test(n)&&(!this.inAsync&&n==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+n+"' is reserved"))}};Br.parseIdent=function(e,t){var r=this.startNode();return this.type===U.name?r.name=this.value:this.type.keyword?(r.name=this.type.keyword,(r.name==="class"||r.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!e),this.finishNode(r,"Identifier"),e||(this.checkUnreserved(r),r.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r.start)),r};Br.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===U.semi||this.canInsertSemicolon()||this.type!==U.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(U.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};Br.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!1),this.finishNode(e,"AwaitExpression")};var Kg=Qn.prototype;Kg.raise=function(e,t){var r=O7(this.input,e);t+=" ("+r.line+":"+r.column+")";var n=new SyntaxError(t);throw n.pos=e,n.loc=r,n.raisedAt=this.pos,n};Kg.raiseRecoverable=Kg.raise;Kg.curPosition=function(){if(this.options.locations)return new c0(this.curLine,this.pos-this.lineStart)};var Tl=Qn.prototype,ZK=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};Tl.enterScope=function(e){this.scopeStack.push(new ZK(e))};Tl.exitScope=function(){this.scopeStack.pop()};Tl.treatFunctionsAsVarInScope=function(e){return e.flags&_0||!this.inModule&&e.flags&f0};Tl.declareName=function(e,t,r){var n=!1;if(t===os){var i=this.currentScope();n=i.lexical.indexOf(e)>-1||i.functions.indexOf(e)>-1||i.var.indexOf(e)>-1,i.lexical.push(e),this.inModule&&i.flags&f0&&delete this.undefinedExports[e]}else if(t===N7){var a=this.currentScope();a.lexical.push(e)}else if(t===B7){var o=this.currentScope();this.treatFunctionsAsVar?n=o.lexical.indexOf(e)>-1:n=o.lexical.indexOf(e)>-1||o.var.indexOf(e)>-1,o.functions.push(e)}else for(var u=this.scopeStack.length-1;u>=0;--u){var s=this.scopeStack[u];if(s.lexical.indexOf(e)>-1&&!(s.flags&k7&&s.lexical[0]===e)||!this.treatFunctionsAsVarInScope(s)&&s.functions.indexOf(e)>-1){n=!0;break}if(s.var.push(e),this.inModule&&s.flags&f0&&delete this.undefinedExports[e],s.flags&BE)break}n&&this.raiseRecoverable(r,"Identifier '"+e+"' has already been declared")};Tl.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};Tl.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Tl.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&BE)return t}};Tl.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&BE&&!(t.flags&I7))return t}};var $E=function(t,r,n){this.type="",this.start=r,this.end=0,t.options.locations&&(this.loc=new Fm(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[r,0])},km=Qn.prototype;km.startNode=function(){return new $E(this,this.start,this.startLoc)};km.startNodeAt=function(e,t){return new $E(this,e,t)};function $7(e,t,r,n){return e.type=t,e.end=r,this.options.locations&&(e.loc.end=n),this.options.ranges&&(e.range[1]=r),e}km.finishNode=function(e,t){return $7.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};km.finishNodeAt=function(e,t,r,n){return $7.call(this,e,t,r,n)};var Oo=function(t,r,n,i,a){this.token=t,this.isExpr=!!r,this.preserveSpace=!!n,this.override=i,this.generator=!!a},Wn={b_stat:new Oo("{",!1),b_expr:new Oo("{",!0),b_tmpl:new Oo("${",!1),p_stat:new Oo("(",!1),p_expr:new Oo("(",!0),q_tmpl:new Oo("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new Oo("function",!1),f_expr:new Oo("function",!0),f_expr_gen:new Oo("function",!0,!1,null,!0),f_gen:new Oo("function",!1,!1,null,!0)},Pm=Qn.prototype;Pm.initialContext=function(){return[Wn.b_stat]};Pm.braceIsBlock=function(e){var t=this.curContext();return t===Wn.f_expr||t===Wn.f_stat?!0:e===U.colon&&(t===Wn.b_stat||t===Wn.b_expr)?!t.isExpr:e===U._return||e===U.name&&this.exprAllowed?lo.test(this.input.slice(this.lastTokEnd,this.start)):e===U._else||e===U.semi||e===U.eof||e===U.parenR||e===U.arrow?!0:e===U.braceL?t===Wn.b_stat:e===U._var||e===U._const||e===U.name?!1:!this.exprAllowed};Pm.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};Pm.updateContext=function(e){var t,r=this.type;r.keyword&&e===U.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,e):this.exprAllowed=r.beforeExpr};U.parenR.updateContext=U.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===Wn.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};U.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?Wn.b_stat:Wn.b_expr),this.exprAllowed=!0};U.dollarBraceL.updateContext=function(){this.context.push(Wn.b_tmpl),this.exprAllowed=!0};U.parenL.updateContext=function(e){var t=e===U._if||e===U._for||e===U._with||e===U._while;this.context.push(t?Wn.p_stat:Wn.p_expr),this.exprAllowed=!0};U.incDec.updateContext=function(){};U._function.updateContext=U._class.updateContext=function(e){e.beforeExpr&&e!==U.semi&&e!==U._else&&!(e===U._return&&lo.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===U.colon||e===U.braceL)&&this.curContext()===Wn.b_stat)?this.context.push(Wn.f_expr):this.context.push(Wn.f_stat),this.exprAllowed=!1};U.backQuote.updateContext=function(){this.curContext()===Wn.q_tmpl?this.context.pop():this.context.push(Wn.q_tmpl),this.exprAllowed=!1};U.star.updateContext=function(e){if(e===U._function){var t=this.context.length-1;this.context[t]===Wn.f_expr?this.context[t]=Wn.f_expr_gen:this.context[t]=Wn.f_gen}this.exprAllowed=!0};U.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==U.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var G7="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",H7=G7+" Extended_Pictographic",qK=H7,KK={9:G7,10:H7,11:qK},xw="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",V7="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",j7=V7+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",QK=j7+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",JK={9:V7,10:j7,11:QK},W7={};function GE(e){var t=W7[e]={binary:Ic(KK[e]+" "+xw),nonBinary:{General_Category:Ic(xw),Script:Ic(JK[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}GE(9);GE(10);GE(11);var hr=Qn.prototype,hs=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":""),this.unicodeProperties=W7[t.options.ecmaVersion>=11?11:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};hs.prototype.reset=function(t,r,n){var i=n.indexOf("u")!==-1;this.start=t|0,this.source=r+"",this.flags=n,this.switchU=i&&this.parser.options.ecmaVersion>=6,this.switchN=i&&this.parser.options.ecmaVersion>=9};hs.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};hs.prototype.at=function(t,r){r===void 0&&(r=!1);var n=this.source,i=n.length;if(t>=i)return-1;var a=n.charCodeAt(t);if(!(r||this.switchU)||a<=55295||a>=57344||t+1>=i)return a;var o=n.charCodeAt(t+1);return o>=56320&&o<=57343?(a<<10)+o-56613888:a};hs.prototype.nextIndex=function(t,r){r===void 0&&(r=!1);var n=this.source,i=n.length;if(t>=i)return i;var a=n.charCodeAt(t),o;return!(r||this.switchU)||a<=55295||a>=57344||t+1>=i||(o=n.charCodeAt(t+1))<56320||o>57343?t+1:t+2};hs.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};hs.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};hs.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};hs.prototype.eat=function(t,r){return r===void 0&&(r=!1),this.current(r)===t?(this.advance(r),!0):!1};function Qg(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}hr.validateRegExpFlags=function(e){for(var t=e.validFlags,r=e.flags,n=0;n<r.length;n++){var i=r.charAt(n);t.indexOf(i)===-1&&this.raise(e.start,"Invalid regular expression flag"),r.indexOf(i,n+1)>-1&&this.raise(e.start,"Duplicate regular expression flag")}};hr.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&e.groupNames.length>0&&(e.switchN=!0,this.regexp_pattern(e))};hr.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames.length=0,e.backReferenceNames.length=0,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,r=e.backReferenceNames;t<r.length;t+=1){var n=r[t];e.groupNames.indexOf(n)===-1&&e.raise("Invalid named capture referenced")}};hr.regexp_disjunction=function(e){for(this.regexp_alternative(e);e.eat(124);)this.regexp_alternative(e);this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};hr.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};hr.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};hr.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var r=!1;if(this.options.ecmaVersion>=9&&(r=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!r,!0}return e.pos=t,!1};hr.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};hr.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};hr.regexp_eatBracedQuantifier=function(e,t){var r=e.pos;if(e.eat(123)){var n=0,i=-1;if(this.regexp_eatDecimalDigits(e)&&(n=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue),e.eat(125)))return i!==-1&&i<n&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=r}return!1};hr.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};hr.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};hr.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1};hr.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};hr.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};hr.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};hr.regexp_eatSyntaxCharacter=function(e){var t=e.current();return X7(t)?(e.lastIntValue=t,e.advance(),!0):!1};function X7(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}hr.regexp_eatPatternCharacters=function(e){for(var t=e.pos,r=0;(r=e.current())!==-1&&!X7(r);)e.advance();return e.pos!==t};hr.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};hr.regexp_groupSpecifier=function(e){if(e.eat(63)){if(this.regexp_eatGroupName(e)){e.groupNames.indexOf(e.lastStringValue)!==-1&&e.raise("Duplicate capture group name"),e.groupNames.push(e.lastStringValue);return}e.raise("Invalid group")}};hr.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};hr.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=Qg(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=Qg(e.lastIntValue);return!0}return!1};hr.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,n=e.current(r);return e.advance(r),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(n=e.lastIntValue),eQ(n)?(e.lastIntValue=n,!0):(e.pos=t,!1)};function eQ(e){return Cl(e,!0)||e===36||e===95}hr.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,n=e.current(r);return e.advance(r),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(n=e.lastIntValue),tQ(n)?(e.lastIntValue=n,!0):(e.pos=t,!1)};function tQ(e){return Bh(e,!0)||e===36||e===95||e===8204||e===8205}hr.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};hr.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var r=e.lastIntValue;if(e.switchU)return r>e.maxBackReference&&(e.maxBackReference=r),!0;if(r<=e.numCapturingParens)return!0;e.pos=t}return!1};hr.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};hr.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};hr.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};hr.regexp_eatZero=function(e){return e.current()===48&&!Dm(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};hr.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};hr.regexp_eatControlLetter=function(e){var t=e.current();return Y7(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function Y7(e){return e>=65&&e<=90||e>=97&&e<=122}hr.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var r=e.pos,n=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var i=e.lastIntValue;if(n&&i>=55296&&i<=56319){var a=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=(i-55296)*1024+(o-56320)+65536,!0}e.pos=a,e.lastIntValue=i}return!0}if(n&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&rQ(e.lastIntValue))return!0;n&&e.raise("Invalid unicode escape"),e.pos=r}return!1};function rQ(e){return e>=0&&e<=1114111}hr.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};hr.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};hr.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(nQ(t))return e.lastIntValue=-1,e.advance(),!0;if(e.switchU&&this.options.ecmaVersion>=9&&(t===80||t===112)){if(e.lastIntValue=-1,e.advance(),e.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(e)&&e.eat(125))return!0;e.raise("Invalid property name")}return!1};function nQ(e){return e===100||e===68||e===115||e===83||e===119||e===87}hr.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var r=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var n=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,r,n),!0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,i),!0}return!1};hr.regexp_validateUnicodePropertyNameAndValue=function(e,t,r){Lm(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(r)||e.raise("Invalid property value")};hr.regexp_validateUnicodePropertyNameOrValue=function(e,t){e.unicodeProperties.binary.test(t)||e.raise("Invalid property name")};hr.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";Z7(t=e.current());)e.lastStringValue+=Qg(t),e.advance();return e.lastStringValue!==""};function Z7(e){return Y7(e)||e===95}hr.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";iQ(t=e.current());)e.lastStringValue+=Qg(t),e.advance();return e.lastStringValue!==""};function iQ(e){return Z7(e)||Dm(e)}hr.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};hr.regexp_eatCharacterClass=function(e){if(e.eat(91)){if(e.eat(94),this.regexp_classRanges(e),e.eat(93))return!0;e.raise("Unterminated character class")}return!1};hr.regexp_classRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var r=e.lastIntValue;e.switchU&&(t===-1||r===-1)&&e.raise("Invalid character class"),t!==-1&&r!==-1&&t>r&&e.raise("Range out of order in character class")}}};hr.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var r=e.current();(r===99||Q7(r))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var n=e.current();return n!==93?(e.lastIntValue=n,e.advance(),!0):!1};hr.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};hr.regexp_eatClassControlLetter=function(e){var t=e.current();return Dm(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};hr.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};hr.regexp_eatDecimalDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;Dm(r=e.current());)e.lastIntValue=10*e.lastIntValue+(r-48),e.advance();return e.pos!==t};function Dm(e){return e>=48&&e<=57}hr.regexp_eatHexDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;q7(r=e.current());)e.lastIntValue=16*e.lastIntValue+K7(r),e.advance();return e.pos!==t};function q7(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function K7(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}hr.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var r=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+r*8+e.lastIntValue:e.lastIntValue=t*8+r}else e.lastIntValue=t;return!0}return!1};hr.regexp_eatOctalDigit=function(e){var t=e.current();return Q7(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function Q7(e){return e>=48&&e<=55}hr.regexp_eatFixedHexDigits=function(e,t){var r=e.pos;e.lastIntValue=0;for(var n=0;n<t;++n){var i=e.current();if(!q7(i))return e.pos=r,!1;e.lastIntValue=16*e.lastIntValue+K7(i),e.advance()}return!0};var HE=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new Fm(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Gr=Qn.prototype;Gr.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new HE(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Gr.getToken=function(){return this.next(),new HE(this)};typeof Symbol<"u"&&(Gr[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===U.eof,value:t}}}});Gr.curContext=function(){return this.context[this.context.length-1]};Gr.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(U.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};Gr.readToken=function(e){return Cl(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};Gr.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=57344)return e;var t=this.input.charCodeAt(this.pos+1);return(e<<10)+t-56613888};Gr.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(r===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations){l0.lastIndex=t;for(var n;(n=l0.exec(this.input))&&n.index<this.pos;)++this.curLine,this.lineStart=n.index+n[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,r),t,this.pos,e,this.curPosition())};Gr.skipLineComment=function(e){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!y0(n);)n=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,r,this.curPosition())};Gr.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&M7.test(String.fromCharCode(e)))++this.pos;else break e}}};Gr.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=e,this.value=t,this.updateContext(r)};Gr.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(U.ellipsis)):(++this.pos,this.finishToken(U.dot))};Gr.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(U.assign,2):this.finishOp(U.slash,1)};Gr.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),r=1,n=e===42?U.star:U.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++r,n=U.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(U.assign,r+1):this.finishOp(n,r)};Gr.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(U.assign,3)}return this.finishOp(e===124?U.logicalOR:U.logicalAND,2)}return t===61?this.finishOp(U.assign,2):this.finishOp(e===124?U.bitwiseOR:U.bitwiseAND,1)};Gr.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(U.assign,2):this.finishOp(U.bitwiseXOR,1)};Gr.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lo.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(U.incDec,2):t===61?this.finishOp(U.assign,2):this.finishOp(U.plusMin,1)};Gr.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),r=1;return t===e?(r=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+r)===61?this.finishOp(U.assign,r+1):this.finishOp(U.bitShift,r)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(r=2),this.finishOp(U.relational,r))};Gr.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(U.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(U.arrow)):this.finishOp(e===61?U.eq:U.prefix,1)};Gr.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var r=this.input.charCodeAt(this.pos+2);if(r<48||r>57)return this.finishOp(U.questionDot,2)}if(t===63){if(e>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(U.assign,3)}return this.finishOp(U.coalesce,2)}}return this.finishOp(U.question,1)};Gr.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(U.parenL);case 41:return++this.pos,this.finishToken(U.parenR);case 59:return++this.pos,this.finishToken(U.semi);case 44:return++this.pos,this.finishToken(U.comma);case 91:return++this.pos,this.finishToken(U.bracketL);case 93:return++this.pos,this.finishToken(U.bracketR);case 123:return++this.pos,this.finishToken(U.braceL);case 125:return++this.pos,this.finishToken(U.braceR);case 58:return++this.pos,this.finishToken(U.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(U.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(U.prefix,1)}this.raise(this.pos,"Unexpected character '"+VE(e)+"'")};Gr.finishOp=function(e,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,r)};Gr.readRegexp=function(){for(var e,t,r=this.pos;;){this.pos>=this.input.length&&this.raise(r,"Unterminated regular expression");var n=this.input.charAt(this.pos);if(lo.test(n)&&this.raise(r,"Unterminated regular expression"),e)e=!1;else{if(n==="[")t=!0;else if(n==="]"&&t)t=!1;else if(n==="/"&&!t)break;e=n==="\\"}++this.pos}var i=this.input.slice(r,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var u=this.regexpState||(this.regexpState=new hs(this));u.reset(r,i,o),this.validateRegExpFlags(u),this.validateRegExpPattern(u);var s=null;try{s=new RegExp(i,o)}catch{}return this.finishToken(U.regexp,{pattern:i,flags:o,value:s})};Gr.readInt=function(e,t,r){for(var n=this.options.ecmaVersion>=12&&t===void 0,i=r&&this.input.charCodeAt(this.pos)===48,a=this.pos,o=0,u=0,s=0,l=t==null?1/0:t;s<l;++s,++this.pos){var f=this.input.charCodeAt(this.pos),h=void 0;if(n&&f===95){i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),u===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),s===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),u=f;continue}if(f>=97?h=f-97+10:f>=65?h=f-65+10:f>=48&&f<=57?h=f-48:h=1/0,h>=e)break;u=f,o=o*e+h}return n&&u===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||t!=null&&this.pos-a!==t?null:o};function aQ(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function J7(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}Gr.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var r=this.readInt(e);return r==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(r=J7(this.input.slice(t,this.pos)),++this.pos):Cl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(U.num,r)};Gr.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var r=this.pos-t>=2&&this.input.charCodeAt(t)===48;r&&this.strict&&this.raise(t,"Invalid number");var n=this.input.charCodeAt(this.pos);if(!r&&!e&&this.options.ecmaVersion>=11&&n===110){var i=J7(this.input.slice(t,this.pos));return++this.pos,Cl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(U.num,i)}r&&/[89]/.test(this.input.slice(t,this.pos))&&(r=!1),n===46&&!r&&(++this.pos,this.readInt(10),n=this.input.charCodeAt(this.pos)),(n===69||n===101)&&!r&&(n=this.input.charCodeAt(++this.pos),(n===43||n===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Cl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=aQ(this.input.slice(t,this.pos),r);return this.finishToken(U.num,a)};Gr.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(r,"Code point out of bounds")}else t=this.readHexChar(4);return t};function VE(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}Gr.readString=function(e){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===e)break;n===92?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):(y0(n,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(U.string,t)};var e6={};Gr.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===e6)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};Gr.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw e6;this.raise(e,t)};Gr.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(r===96||r===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===U.template||this.type===U.invalidTemplate)?r===36?(this.pos+=2,this.finishToken(U.dollarBraceL)):(++this.pos,this.finishToken(U.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(U.template,e));if(r===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(y0(r)){switch(e+=this.input.slice(t,this.pos),++this.pos,r){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(r);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};Gr.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(U.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")};Gr.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return VE(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(e){var r=this.pos-1;return this.invalidStringToken(r,"Invalid escape sequence in template string"),null}default:if(t>=48&&t<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(n,8);return i>255&&(n=n.slice(0,-1),i=parseInt(n,8)),this.pos+=n.length-1,t=this.input.charCodeAt(this.pos),(n!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-n.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return y0(t)?"":String.fromCharCode(t)}};Gr.readHexChar=function(e){var t=this.pos,r=this.readInt(16,e);return r===null&&this.invalidStringToken(t,"Bad character escape sequence"),r};Gr.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,r=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(Bh(i,n))this.pos+=i<=65535?1:2;else if(i===92){this.containsEsc=!0,e+=this.input.slice(r,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?Cl:Bh)(o,n)||this.invalidStringToken(a,"Invalid Unicode escape"),e+=VE(o),r=this.pos}else break;t=!1}return e+this.input.slice(r,this.pos)};Gr.readWord=function(){var e=this.readWord1(),t=U.name;return this.keywords.test(e)&&(t=DE[e]),this.finishToken(t,e)};var oQ="7.4.1";Qn.acorn={Parser:Qn,version:oQ,defaultOptions:px,Position:c0,SourceLocation:Fm,getLineInfo:O7,Node:$E,TokenType:Qr,tokTypes:U,keywordTypes:DE,TokContext:Oo,tokContexts:Wn,isIdentifierChar:Bh,isIdentifierStart:Cl,Token:HE,isNewLine:y0,lineBreak:lo,lineBreakG:l0,nonASCIIwhitespace:M7};function uQ(e,t){return Qn.parse(e,t)}function Qc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Nh(e){var t=typeof Map=="function"?new Map:void 0;return Nh=function(n){if(n===null||!lQ(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,i)}function i(){return xg(n,arguments,vx(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Jg(i,n)},Nh(e)}function sQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function xg(e,t,r){return sQ()?xg=Reflect.construct:xg=function(i,a,o){var u=[null];u.push.apply(u,a);var s=Function.bind.apply(i,u),l=new s;return o&&Jg(l,o.prototype),l},xg.apply(null,arguments)}function lQ(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Jg(e,t){return Jg=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Jg(e,t)}function vx(e){return vx=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},vx(e)}var cQ=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(Nh(Error)),fQ=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(Nh(SyntaxError)),gx=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(Nh(ReferenceError)),hQ=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(Nh(TypeError)),mx=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(cQ),pQ=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(fQ),Lo=function(e){Qc(t,e);function t(){return e.apply(this,arguments)||this}return t}(gx),Ri={UnknownError:[3001,"%0",mx],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",mx],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Lo],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Lo],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Lo],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Lo],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Lo],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Lo],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Lo],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Lo],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Lo],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Lo],FunctionUndefinedReferenceError:[2001,"%0 is not a function",gx],VariableUndefinedReferenceError:[2002,"%0 is not defined",gx],IsNotConstructor:[2003,"%0 is not a constructor",hQ]};function dQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Eg(e,t,r){return dQ()?Eg=Reflect.construct:Eg=function(i,a,o){var u=[null];u.push.apply(u,a);var s=Function.bind.apply(i,u),l=new s;return o&&yx(l,o.prototype),l},Eg.apply(null,arguments)}function yx(e,t){return yx=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},yx(e,t)}var vQ="0.0.3";function Ew(e,t){Object.defineProperty(e,"name",{value:t,writable:!1,enumerable:!1,configurable:!0})}var gQ=Object.prototype.hasOwnProperty,bc=Symbol("Break"),Cc=Symbol("Continue"),bw=Symbol("DefaultCase"),li=Symbol("EmptyStatementReturn"),Cw=Symbol("WithScopeName"),Aw=Symbol("SuperScopeName"),Sw=Symbol("RootScopeName"),Tw=Symbol("GlobalScopeName");function j_(e){return typeof e=="function"}var ll=function(){function e(r){this.interpreter=r}var t=e.prototype;return t.generator=function(){var n=this.interpreter;function i(){return this.getCurrentScope()}function a(){return this.getGlobalScope()}function o(){return this.getCurrentContext()}return{getOptions:n.getOptions.bind(n),getCurrentScope:i.bind(n),getGlobalScope:a.bind(n),getCurrentContext:o.bind(n),getExecStartTime:n.getExecStartTime.bind(n)}},e}();function jE(e,t,r){if(r===void 0&&(r=!0),!(e instanceof ll))throw new Error("Illegal call");if(typeof t!="string")return t;if(!!t){var n=e.generator(),i=n.getOptions(),a={timeout:i.timeout,_initEnv:function(){r||this.setCurrentContext(n.getCurrentContext()),this.execStartTime=n.getExecStartTime(),this.execEndTime=this.execStartTime}},o=r?n.getGlobalScope():n.getCurrentScope(),u=new Uo(o,a);return u.evaluate(t)}}Object.defineProperty(jE,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function WE(e){if(!(e instanceof ll))throw new Error("Illegal call");for(var t=e.generator(),r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=n.pop(),o=new Uo(t.getGlobalScope(),t.getOptions()),u=`
		    (function anonymous(`+n.join(",")+`){
		        `+a+`
		    });
		    `;return o.evaluate(u)}Object.defineProperty(WE,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var iu=function(t){this.value=t},Ac=function(t){this.value=t},al=function(t){this.value=t},lh=function(t,r,n){r===void 0&&(r=null),this.name=n,this.parent=r,this.data=t,this.labelStack=[]};function ig(){}function mQ(e,t){return e===void 0&&(e=null),new lh(Object.create(null),e,t)}function yQ(e){return Object.create(e)}var Cu={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:jE,Function:WE};typeof JSON<"u"&&(Cu.JSON=JSON);typeof Promise<"u"&&(Cu.Promise=Promise);typeof Set<"u"&&(Cu.Set=Set);typeof Map<"u"&&(Cu.Map=Map);typeof Symbol<"u"&&(Cu.Symbol=Symbol);typeof Proxy<"u"&&(Cu.Proxy=Proxy);typeof WeakMap<"u"&&(Cu.WeakMap=WeakMap);typeof WeakSet<"u"&&(Cu.WeakSet=WeakSet);typeof Reflect<"u"&&(Cu.Reflect=Reflect);var Uo=function(){function e(r,n){r===void 0&&(r=e.global),n===void 0&&(n={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:n.ecmaVersion||e.ecmaVersion,timeout:n.timeout||0,rootContext:n.rootContext,globalContextInFunction:n.globalContextInFunction===void 0?e.globalContextInFunction:n.globalContextInFunction,_initEnv:n._initEnv},this.context=r||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var t=e.prototype;return t.initEnvironment=function(n){var i;if(n instanceof lh)i=n;else{var a=null,o=this.createSuperScope(n);this.options.rootContext&&(a=new lh(yQ(this.options.rootContext),o,Sw)),i=new lh(n,a||o,Tw)}this.globalScope=i,this.currentScope=this.globalScope,this.globalContext=i.data,this.currentContext=i.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var u=this.options._initEnv;u&&u.call(this)},t.getExecStartTime=function(){return this.execStartTime},t.getExecutionTime=function(){return this.execEndTime-this.execStartTime},t.setExecTimeout=function(n){n===void 0&&(n=0),this.options.timeout=n},t.getOptions=function(){return this.options},t.getGlobalScope=function(){return this.globalScope},t.getCurrentScope=function(){return this.currentScope},t.getCurrentContext=function(){return this.currentContext},t.isInterruptThrow=function(n){return n instanceof mx||n instanceof Lo||n instanceof pQ},t.createSuperScope=function(n){var i=Object.assign({},Cu),a=Object.keys(i);return a.forEach(function(o){o in n&&delete i[o]}),new lh(i,null,Aw)},t.setCurrentContext=function(n){this.currentContext=n},t.setCurrentScope=function(n){this.currentScope=n},t.evaluate=function(n){n===void 0&&(n="");var i;if(!!n)return i=uQ(n,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||e.ecmaVersion}),this.evaluateNode(i,n)},t.appendCode=function(n){return this.evaluate(n)},t.evaluateNode=function(n,i){var a=this;i===void 0&&(i=""),this.value=void 0,this.source=i,this.sourceList.push(i),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var o=this.getCurrentScope(),u=this.getCurrentContext(),s=o.labelStack.concat([]),l=this.callStack.concat([]),f=function(){a.setCurrentScope(o),a.setCurrentContext(u),o.labelStack=s,a.callStack=l};try{var h=this.createClosure(n);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),h()}catch(d){throw d}finally{f(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},t.createErrorMessage=function(n,i,a){var o=n[1].replace("%0",String(i));return a!==null&&(o+=this.getNodePosition(a||this.lastExecNode)),o},t.createError=function(n,i){return new i(n)},t.createThrowError=function(n,i){return this.createError(n,i)},t.createInternalThrowError=function(n,i,a){return this.createError(this.createErrorMessage(n,i,a),n[2])},t.checkTimeout=function(){if(!this.isRunning)return!1;var n=this.options.timeout||0,i=Date.now();return i-this.execStartTime>n},t.getNodePosition=function(n){if(n){var i="";return n.loc?" ["+n.loc.start.line+":"+n.loc.start.column+"]"+i:""}return""},t.createClosure=function(n){var i=this,a;switch(n.type){case"BinaryExpression":a=this.binaryExpressionHandler(n);break;case"LogicalExpression":a=this.logicalExpressionHandler(n);break;case"UnaryExpression":a=this.unaryExpressionHandler(n);break;case"UpdateExpression":a=this.updateExpressionHandler(n);break;case"ObjectExpression":a=this.objectExpressionHandler(n);break;case"ArrayExpression":a=this.arrayExpressionHandler(n);break;case"CallExpression":a=this.callExpressionHandler(n);break;case"NewExpression":a=this.newExpressionHandler(n);break;case"MemberExpression":a=this.memberExpressionHandler(n);break;case"ThisExpression":a=this.thisExpressionHandler(n);break;case"SequenceExpression":a=this.sequenceExpressionHandler(n);break;case"Literal":a=this.literalHandler(n);break;case"Identifier":a=this.identifierHandler(n);break;case"AssignmentExpression":a=this.assignmentExpressionHandler(n);break;case"FunctionDeclaration":a=this.functionDeclarationHandler(n);break;case"VariableDeclaration":a=this.variableDeclarationHandler(n);break;case"BlockStatement":case"Program":a=this.programHandler(n);break;case"ExpressionStatement":a=this.expressionStatementHandler(n);break;case"EmptyStatement":a=this.emptyStatementHandler(n);break;case"ReturnStatement":a=this.returnStatementHandler(n);break;case"FunctionExpression":a=this.functionExpressionHandler(n);break;case"IfStatement":a=this.ifStatementHandler(n);break;case"ConditionalExpression":a=this.conditionalExpressionHandler(n);break;case"ForStatement":a=this.forStatementHandler(n);break;case"WhileStatement":a=this.whileStatementHandler(n);break;case"DoWhileStatement":a=this.doWhileStatementHandler(n);break;case"ForInStatement":a=this.forInStatementHandler(n);break;case"WithStatement":a=this.withStatementHandler(n);break;case"ThrowStatement":a=this.throwStatementHandler(n);break;case"TryStatement":a=this.tryStatementHandler(n);break;case"ContinueStatement":a=this.continueStatementHandler(n);break;case"BreakStatement":a=this.breakStatementHandler(n);break;case"SwitchStatement":a=this.switchStatementHandler(n);break;case"LabeledStatement":a=this.labeledStatementHandler(n);break;case"DebuggerStatement":a=this.debuggerStatementHandler(n);break;default:throw this.createInternalThrowError(Ri.NodeTypeSyntaxError,n.type,n)}return function(){var o=i.options.timeout;if(o&&o>0&&i.checkTimeout())throw i.createInternalThrowError(Ri.ExecutionTimeOutError,o,null);return i.lastExecNode=n,a.apply(void 0,arguments)}},t.binaryExpressionHandler=function(n){var i=this,a=this.createClosure(n.left),o=this.createClosure(n.right);return function(){var u=a(),s=o();switch(n.operator){case"==":return u==s;case"!=":return u!=s;case"===":return u===s;case"!==":return u!==s;case"<":return u<s;case"<=":return u<=s;case">":return u>s;case">=":return u>=s;case"<<":return u<<s;case">>":return u>>s;case">>>":return u>>>s;case"+":return u+s;case"-":return u-s;case"*":return u*s;case"**":return Math.pow(u,s);case"/":return u/s;case"%":return u%s;case"|":return u|s;case"^":return u^s;case"&":return u&s;case"in":return u in s;case"instanceof":return u instanceof s;default:throw i.createInternalThrowError(Ri.BinaryOperatorSyntaxError,n.operator,n)}}},t.logicalExpressionHandler=function(n){var i=this,a=this.createClosure(n.left),o=this.createClosure(n.right);return function(){switch(n.operator){case"||":return a()||o();case"&&":return a()&&o();default:throw i.createInternalThrowError(Ri.LogicalOperatorSyntaxError,n.operator,n)}}},t.unaryExpressionHandler=function(n){var i=this;switch(n.operator){case"delete":var a=this.createObjectGetter(n.argument),o=this.createNameGetter(n.argument);return function(){var f=a(),h=o();return delete f[h]};default:var u;if(n.operator==="typeof"&&n.argument.type==="Identifier"){var s=this.createObjectGetter(n.argument),l=this.createNameGetter(n.argument);u=function(){return s()[l()]}}else u=this.createClosure(n.argument);return function(){var f=u();switch(n.operator){case"-":return-f;case"+":return+f;case"!":return!f;case"~":return~f;case"void":return;case"typeof":return typeof f;default:throw i.createInternalThrowError(Ri.UnaryOperatorSyntaxError,n.operator,n)}}}},t.updateExpressionHandler=function(n){var i=this,a=this.createObjectGetter(n.argument),o=this.createNameGetter(n.argument);return function(){var u=a(),s=o();switch(i.assertVariable(u,s,n),n.operator){case"++":return n.prefix?++u[s]:u[s]++;case"--":return n.prefix?--u[s]:u[s]--;default:throw i.createInternalThrowError(Ri.UpdateOperatorSyntaxError,n.operator,n)}}},t.objectExpressionHandler=function(n){var i=this,a=[];function o(s){return s.type==="Identifier"?s.name:s.type==="Literal"?s.value:this.throwError(Ri.ObjectStructureSyntaxError,s.type,s)}var u=Object.create(null);return n.properties.forEach(function(s){var l=s.kind,f=o(s.key);(!u[f]||l==="init")&&(u[f]={}),u[f][l]=i.createClosure(s.value),a.push({key:f,property:s})}),function(){for(var s={},l=a.length,f=0;f<l;f++){var h=a[f],d=h.key,v=u[d],m=v.init?v.init():void 0,y=v.get?v.get():function(){},_=v.set?v.set():function(M){};if("set"in v||"get"in v){var E={configurable:!0,enumerable:!0,get:y,set:_};Object.defineProperty(s,d,E)}else{var S=h.property,A=S.kind;S.key.type==="Identifier"&&S.value.type==="FunctionExpression"&&A==="init"&&!S.value.id&&Ew(m,S.key.name),s[d]=m}}return s}},t.arrayExpressionHandler=function(n){var i=this,a=n.elements.map(function(o){return o&&i.createClosure(o)});return function(){for(var o=a.length,u=Array(o),s=0;s<o;s++){var l=a[s];l&&(u[s]=l())}return u}},t.safeObjectGet=function(n,i,a){return n[i]},t.createCallFunctionGetter=function(n){var i=this;switch(n.type){case"MemberExpression":var a=this.createClosure(n.object),o=this.createMemberKeyGetter(n),u=this.source;return function(){var l=a(),f=o(),h=i.safeObjectGet(l,f,n);if(!h||!j_(h)){var d=u.slice(n.start,n.end);throw i.createInternalThrowError(Ri.FunctionUndefinedReferenceError,d,n)}return h.__IS_EVAL_FUNC?function(v){return h(new ll(i),v,!0)}:h.__IS_FUNCTION_FUNC?function(){for(var v=arguments.length,m=new Array(v),y=0;y<v;y++)m[y]=arguments[y];return h.apply(void 0,[new ll(i)].concat(m))}:h.bind(l)};default:var s=this.createClosure(n);return function(){var l="";n.type==="Identifier"&&(l=n.name);var f=s();if(!f||!j_(f))throw i.createInternalThrowError(Ri.FunctionUndefinedReferenceError,l,n);if(n.type==="Identifier"&&f.__IS_EVAL_FUNC&&l==="eval")return function(v){var m=i.getScopeFromName(l,i.getCurrentScope()),y=m.name===Aw||m.name===Tw||m.name===Sw;return f(new ll(i),v,!y)};if(f.__IS_EVAL_FUNC)return function(v){return f(new ll(i),v,!0)};if(f.__IS_FUNCTION_FUNC)return function(){for(var v=arguments.length,m=new Array(v),y=0;y<v;y++)m[y]=arguments[y];return f.apply(void 0,[new ll(i)].concat(m))};var h=i.options.globalContextInFunction;if(n.type==="Identifier"){var d=i.getIdentifierScope(n);d.name===Cw&&(h=d.data)}return f.bind(h)}}},t.callExpressionHandler=function(n){var i=this,a=this.createCallFunctionGetter(n.callee),o=n.arguments.map(function(u){return i.createClosure(u)});return function(){return a().apply(void 0,o.map(function(u){return u()}))}},t.functionExpressionHandler=function(n){var i=this,a=this,o=this.source,u=this.collectDeclVars,s=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var l=n.id?n.id.name:"",f=n.params.length,h=n.params.map(function(y){return i.createParamNameGetter(y)}),d=this.createClosure(n.body),v=this.collectDeclVars,m=this.collectDeclFuncs;return this.collectDeclVars=u,this.collectDeclFuncs=s,function(){var y=a.getCurrentScope(),_=function E(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];a.callStack.push(""+l);var O=a.getCurrentScope(),j=mQ(y,"FunctionScope("+l+")");a.setCurrentScope(j),a.addDeclarationsToScope(v,m,j),l&&(j.data[l]=E),j.data.arguments=arguments,h.forEach(function(ne,X){j.data[ne()]=A[X]});var q=a.getCurrentContext();a.setCurrentContext(this);var Y=d();if(a.setCurrentContext(q),a.setCurrentScope(O),a.callStack.pop(),Y instanceof iu)return Y.value};return Ew(_,l),Object.defineProperty(_,"length",{value:f,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(_,"toString",{value:function(){return o.slice(n.start,n.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(_,"valueOf",{value:function(){return o.slice(n.start,n.end)},writable:!0,configurable:!0,enumerable:!1}),_}},t.newExpressionHandler=function(n){var i=this,a=this.source,o=this.createClosure(n.callee),u=n.arguments.map(function(s){return i.createClosure(s)});return function(){var s=o();if(!j_(s)||s.__IS_EVAL_FUNC){var l=n.callee,f=a.slice(l.start,l.end);throw i.createInternalThrowError(Ri.IsNotConstructor,f,n)}return s.__IS_FUNCTION_FUNC?s.apply(void 0,[new ll(i)].concat(u.map(function(h){return h()}))):Eg(s,u.map(function(h){return h()}))}},t.memberExpressionHandler=function(n){var i=this.createClosure(n.object),a=this.createMemberKeyGetter(n);return function(){var o=i(),u=a();return o[u]}},t.thisExpressionHandler=function(n){var i=this;return function(){return i.getCurrentContext()}},t.sequenceExpressionHandler=function(n){var i=this,a=n.expressions.map(function(o){return i.createClosure(o)});return function(){for(var o,u=a.length,s=0;s<u;s++){var l=a[s];o=l()}return o}},t.literalHandler=function(n){return function(){return n.regex?new RegExp(n.regex.pattern,n.regex.flags):n.value}},t.identifierHandler=function(n){var i=this;return function(){var a=i.getCurrentScope(),o=i.getScopeDataFromName(n.name,a);return i.assertVariable(o,n.name,n),o[n.name]}},t.getIdentifierScope=function(n){var i=this.getCurrentScope(),a=this.getScopeFromName(n.name,i);return a},t.assignmentExpressionHandler=function(n){var i=this;n.left.type==="Identifier"&&n.right.type==="FunctionExpression"&&!n.right.id&&(n.right.id={type:"Identifier",name:n.left.name});var a=this.createObjectGetter(n.left),o=this.createNameGetter(n.left),u=this.createClosure(n.right);return function(){var s=a(),l=o(),f=u();switch(n.operator!=="="&&i.assertVariable(s,l,n),n.operator){case"=":return s[l]=f;case"+=":return s[l]+=f;case"-=":return s[l]-=f;case"*=":return s[l]*=f;case"**=":return s[l]=Math.pow(s[l],f);case"/=":return s[l]/=f;case"%=":return s[l]%=f;case"<<=":return s[l]<<=f;case">>=":return s[l]>>=f;case">>>=":return s[l]>>>=f;case"&=":return s[l]&=f;case"^=":return s[l]^=f;case"|=":return s[l]|=f;default:throw i.createInternalThrowError(Ri.AssignmentExpressionSyntaxError,n.type,n)}}},t.functionDeclarationHandler=function(n){if(n.id){var i=this.functionExpressionHandler(n);Object.defineProperty(i,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(n.id.name,i)}return function(){return li}},t.getVariableName=function(n){if(n.type==="Identifier")return n.name;throw this.createInternalThrowError(Ri.VariableTypeSyntaxError,n.type,n)},t.variableDeclarationHandler=function(n){for(var i=this,a,o=[],u=0;u<n.declarations.length;u++){var s=n.declarations[u];this.varDeclaration(this.getVariableName(s.id)),s.init&&o.push({type:"AssignmentExpression",operator:"=",left:s.id,right:s.init})}return o.length&&(a=this.createClosure({type:"BlockStatement",body:o})),function(){if(a){var l=i.isVarDeclMode;i.isVarDeclMode=!0,a(),i.isVarDeclMode=l}return li}},t.assertVariable=function(n,i,a){if(n===this.globalScope.data&&!(i in n))throw this.createInternalThrowError(Ri.VariableUndefinedReferenceError,i,a)},t.programHandler=function(n){var i=this,a=n.body.map(function(o){return i.createClosure(o)});return function(){for(var o=li,u=0;u<a.length;u++){var s=a[u],l=i.setValue(s());if(l!==li&&(o=l,o instanceof iu||o instanceof Ac||o instanceof al||o===bc||o===Cc))break}return o}},t.expressionStatementHandler=function(n){return this.createClosure(n.expression)},t.emptyStatementHandler=function(n){return function(){return li}},t.returnStatementHandler=function(n){var i=n.argument?this.createClosure(n.argument):ig;return function(){return new iu(i())}},t.ifStatementHandler=function(n){var i=this.createClosure(n.test),a=this.createClosure(n.consequent),o=n.alternate?this.createClosure(n.alternate):function(){return li};return function(){return i()?a():o()}},t.conditionalExpressionHandler=function(n){return this.ifStatementHandler(n)},t.forStatementHandler=function(n){var i=this,a=ig,o=n.test?this.createClosure(n.test):function(){return!0},u=ig,s=this.createClosure(n.body);return n.type==="ForStatement"&&(a=n.init?this.createClosure(n.init):a,u=n.update?this.createClosure(n.update):ig),function(l){var f,h=li,d=n.type==="DoWhileStatement";for(l&&l.type==="LabeledStatement"&&(f=l.label.name),a();d||o();u()){d=!1;var v=i.setValue(s());if(!(v===li||v===Cc)){if(v===bc)break;if(h=v,h instanceof al&&h.value===f){h=li;continue}if(h instanceof iu||h instanceof Ac||h instanceof al)break}}return h}},t.whileStatementHandler=function(n){return this.forStatementHandler(n)},t.doWhileStatementHandler=function(n){return this.forStatementHandler(n)},t.forInStatementHandler=function(n){var i=this,a=n.left,o=this.createClosure(n.right),u=this.createClosure(n.body);return n.left.type==="VariableDeclaration"&&(this.createClosure(n.left)(),a=n.left.declarations[0].id),function(s){var l,f=li,h;s&&s.type==="LabeledStatement"&&(l=s.label.name);var d=o();for(h in d){i.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:a,right:{type:"Literal",value:h}})();var v=i.setValue(u());if(!(v===li||v===Cc)){if(v===bc)break;if(f=v,f instanceof al&&f.value===l){f=li;continue}if(f instanceof iu||f instanceof Ac||f instanceof al)break}}return f}},t.withStatementHandler=function(n){var i=this,a=this.createClosure(n.object),o=this.createClosure(n.body);return function(){var u=a(),s=i.getCurrentScope(),l=new lh(u,s,Cw);i.setCurrentScope(l);var f=i.setValue(o());return i.setCurrentScope(s),f}},t.throwStatementHandler=function(n){var i=this,a=this.createClosure(n.argument);return function(){throw i.setValue(void 0),a()}},t.tryStatementHandler=function(n){var i=this,a=this.createClosure(n.block),o=n.handler?this.catchClauseHandler(n.handler):null,u=n.finalizer?this.createClosure(n.finalizer):null;return function(){var s=i.getCurrentScope(),l=i.getCurrentContext(),f=s.labelStack.concat([]),h=i.callStack.concat([]),d=li,v,m,y=function(){i.setCurrentScope(s),i.setCurrentContext(l),s.labelStack=f,i.callStack=h};try{d=i.setValue(a()),d instanceof iu&&(v=d)}catch(_){if(y(),i.isInterruptThrow(_))throw _;if(o)try{d=i.setValue(o(_)),d instanceof iu&&(v=d)}catch(E){if(y(),i.isInterruptThrow(E))throw E;m=E}}if(u)try{d=u(),d instanceof iu&&(v=d)}catch(_){if(y(),i.isInterruptThrow(_))throw _;m=_}if(m)throw m;return v||d}},t.catchClauseHandler=function(n){var i=this,a=this.createParamNameGetter(n.param),o=this.createClosure(n.body);return function(u){var s,l=i.getCurrentScope(),f=l.data,h=a(),d=gQ.call(f,h),v=f[h];return f[h]=u,s=o(),d?f[h]=v:delete f[h],s}},t.continueStatementHandler=function(n){return function(){return n.label?new al(n.label.name):Cc}},t.breakStatementHandler=function(n){return function(){return n.label?new Ac(n.label.name):bc}},t.switchStatementHandler=function(n){var i=this,a=this.createClosure(n.discriminant),o=n.cases.map(function(u){return i.switchCaseHandler(u)});return function(){for(var u=a(),s=!1,l,f,h,d=0;d<o.length;d++){var v=o[d](),m=v.testClosure();if(m===bw){h=v;continue}if(s||m===u){if(s=!0,f=i.setValue(v.bodyClosure()),f===li)continue;if(f===bc||(l=f,l instanceof iu||l instanceof Ac||l instanceof al||l===Cc))break}}if(!s&&h){f=i.setValue(h.bodyClosure());var y=f===li||f===bc||f===Cc;y||(l=f)}return l}},t.switchCaseHandler=function(n){var i=n.test?this.createClosure(n.test):function(){return bw},a=this.createClosure({type:"BlockStatement",body:n.consequent});return function(){return{testClosure:i,bodyClosure:a}}},t.labeledStatementHandler=function(n){var i=this,a=n.label.name,o=this.createClosure(n.body);return function(){var u,s=i.getCurrentScope();return s.labelStack.push(a),u=o(n),u instanceof Ac&&u.value===a&&(u=li),s.labelStack.pop(),u}},t.debuggerStatementHandler=function(n){return function(){debugger;return li}},t.createParamNameGetter=function(n){if(n.type==="Identifier")return function(){return n.name};throw this.createInternalThrowError(Ri.ParamTypeSyntaxError,n.type,n)},t.createObjectKeyGetter=function(n){var i;return n.type==="Identifier"?i=function(){return n.name}:i=this.createClosure(n),function(){return i()}},t.createMemberKeyGetter=function(n){return n.computed?this.createClosure(n.property):this.createObjectKeyGetter(n.property)},t.createObjectGetter=function(n){var i=this;switch(n.type){case"Identifier":return function(){return i.getScopeDataFromName(n.name,i.getCurrentScope())};case"MemberExpression":return this.createClosure(n.object);default:throw this.createInternalThrowError(Ri.AssignmentTypeSyntaxError,n.type,n)}},t.createNameGetter=function(n){switch(n.type){case"Identifier":return function(){return n.name};case"MemberExpression":return this.createMemberKeyGetter(n);default:throw this.createInternalThrowError(Ri.AssignmentTypeSyntaxError,n.type,n)}},t.varDeclaration=function(n){var i=this.collectDeclVars;i[n]=void 0},t.funcDeclaration=function(n,i){var a=this.collectDeclFuncs;a[n]=i},t.addDeclarationsToScope=function(n,i,a){var o=a.data;for(var u in i){var s=i[u];o[u]=s&&s()}for(var l in n)l in o||(o[l]=void 0)},t.getScopeValue=function(n,i){var a=this.getScopeFromName(n,i);return a.data[n]},t.getScopeDataFromName=function(n,i){return this.getScopeFromName(n,i).data},t.getScopeFromName=function(n,i){var a=i;do if(n in a.data)return a;while(a=a.parent);return this.globalScope},t.setValue=function(n){var i=this.callStack.length;return this.isVarDeclMode||i||n===li||n===bc||n===Cc||n instanceof Ac||n instanceof al||(this.value=n instanceof iu?n.value:n),n},t.getValue=function(){return this.value},e}();Uo.version=vQ;Uo.eval=jE;Uo.Function=WE;Uo.ecmaVersion=5;Uo.globalContextInFunction=void 0;Uo.global=Object.create(null);function _Q(e){return e===void 0&&(e=Object.create(null)),e}function t6(e,t,r){t===void 0&&(t=[]),r===void 0&&(r={});var n=r.parsingContext,i=r.timeout===void 0?0:r.timeout,a=`
    (function anonymous(`+t.join(",")+`){
         `+e+`
    });
    `,o=new Uo(n,{ecmaVersion:r.ecmaVersion,timeout:i,rootContext:r.rootContext,globalContextInFunction:r.globalContextInFunction});return o.evaluate(a)}function h0(e,t,r){var n=new Uo(t,r);return n.evaluate(e)}var xQ=h0,EQ=function(){function e(r){this._code=r}var t=e.prototype;return t.runInContext=function(n){return h0(this._code,n)},t.runInNewContext=function(n){return h0(this._code,n)},e}();const bQ=Object.freeze(Object.defineProperty({__proto__:null,createContext:_Q,compileFunction:t6,runInContext:h0,runInNewContext:xQ,Script:EQ},Symbol.toStringTag,{value:"Module"})),ww=function(e,t,r){return h0(e,t,r)};function CQ(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.pop();return t6(n||"",t)}const AQ=Object.freeze(Object.defineProperty({__proto__:null,Interpreter:Uo,vm:bQ,evaluate:ww,Function:CQ,default:ww},Symbol.toStringTag,{value:"Module"})),SQ=fI(AQ);(function(e,t){(function(r,n){e.exports=n(SQ)})(du,function(r){var n=function(b){return b instanceof Uint8Array||b instanceof Uint16Array||b instanceof Uint32Array||b instanceof Int8Array||b instanceof Int16Array||b instanceof Int32Array||b instanceof Float32Array||b instanceof Float64Array||b instanceof Uint8ClampedArray},i=function(b,P){for(var W=Object.keys(P),Ae=0;Ae<W.length;++Ae)b[W[Ae]]=P[W[Ae]];return b},a=`
`;function o(b){return typeof atob<"u"?atob(b):"base64:"+b}function u(b){var P=new Error("(regl) "+b);throw console.error(P),P}function s(b,P){b||u(P)}function l(b){return b?": "+b:""}function f(b,P,W){b in P||u("unknown parameter ("+b+")"+l(W)+". possible values: "+Object.keys(P).join())}function h(b,P){n(b)||u("invalid parameter type"+l(P)+". must be a typed array")}function d(b,P){switch(P){case"number":return typeof b=="number";case"object":return typeof b=="object";case"string":return typeof b=="string";case"boolean":return typeof b=="boolean";case"function":return typeof b=="function";case"undefined":return typeof b>"u";case"symbol":return typeof b=="symbol"}}function v(b,P,W){d(b,P)||u("invalid parameter type"+l(W)+". expected "+P+", got "+typeof b)}function m(b,P){b>=0&&(b|0)===b||u("invalid parameter type, ("+b+")"+l(P)+". must be a nonnegative integer")}function y(b,P,W){P.indexOf(b)<0&&u("invalid value"+l(W)+". must be one of: "+P)}var _=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function E(b){Object.keys(b).forEach(function(P){_.indexOf(P)<0&&u('invalid regl constructor argument "'+P+'". must be one of '+_)})}function S(b,P){for(b=b+"";b.length<P;)b=" "+b;return b}function A(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function M(b,P){this.number=b,this.line=P,this.errors=[]}function O(b,P,W){this.file=b,this.line=P,this.message=W}function j(){var b=new Error,P=(b.stack||b).toString(),W=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(P);if(W)return W[1];var Ae=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(P);return Ae?Ae[1]:"unknown"}function q(){var b=new Error,P=(b.stack||b).toString(),W=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(P);if(W)return W[1];var Ae=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(P);return Ae?Ae[1]:"unknown"}function Y(b,P){var W=b.split(`
`),Ae=1,Ue=0,Ee={unknown:new A,0:new A};Ee.unknown.name=Ee[0].name=P||j(),Ee.unknown.lines.push(new M(0,""));for(var Fe=0;Fe<W.length;++Fe){var He=W[Fe],qe=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(He);if(qe)switch(qe[1]){case"line":var ot=/(\d+)(\s+\d+)?/.exec(qe[2]);ot&&(Ae=ot[1]|0,ot[2]&&(Ue=ot[2]|0,Ue in Ee||(Ee[Ue]=new A)));break;case"define":var lt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(qe[2]);lt&&(Ee[Ue].name=lt[1]?o(lt[2]):lt[2]);break}Ee[Ue].lines.push(new M(Ae++,He))}return Object.keys(Ee).forEach(function(Ke){var rt=Ee[Ke];rt.lines.forEach(function(Ze){rt.index[Ze.number]=Ze})}),Ee}function ne(b){var P=[];return b.split(`
`).forEach(function(W){if(!(W.length<5)){var Ae=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(W);Ae?P.push(new O(Ae[1]|0,Ae[2]|0,Ae[3].trim())):W.length>0&&P.push(new O("unknown",0,W))}}),P}function X(b,P){P.forEach(function(W){var Ae=b[W.file];if(Ae){var Ue=Ae.index[W.line];if(Ue){Ue.errors.push(W),Ae.hasErrors=!0;return}}b.unknown.hasErrors=!0,b.unknown.lines[0].errors.push(W)})}function $(b,P,W,Ae,Ue){if(!b.getShaderParameter(P,b.COMPILE_STATUS)){var Ee=b.getShaderInfoLog(P),Fe=Ae===b.FRAGMENT_SHADER?"fragment":"vertex";Me(W,"string",Fe+" shader source must be a string",Ue);var He=Y(W,Ue),qe=ne(Ee);X(He,qe),Object.keys(He).forEach(function(ot){var lt=He[ot];if(!lt.hasErrors)return;var Ke=[""],rt=[""];function Ze(st,ce){Ke.push(st),rt.push(ce||"")}Ze("file number "+ot+": "+lt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),lt.lines.forEach(function(st){if(st.errors.length>0){Ze(S(st.number,4)+"|  ","background-color:yellow; font-weight:bold"),Ze(st.line+a,"color:red; background-color:yellow; font-weight:bold");var ce=0;st.errors.forEach(function(Re){var it=Re.message,bt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(it);if(bt){var We=bt[1];switch(it=bt[2],We){case"assign":We="=";break}ce=Math.max(st.line.indexOf(We,ce),0)}else ce=0;Ze(S("| ",6)),Ze(S("^^^",ce+3)+a,"font-weight:bold"),Ze(S("| ",6)),Ze(it+a,"font-weight:bold")}),Ze(S("| ",6)+a)}else Ze(S(st.number,4)+"|  "),Ze(st.line+a,"color:red")}),typeof document<"u"&&!window.chrome?(rt[0]=Ke.join("%c"),console.log.apply(console,rt)):console.log(Ke.join(""))}),s.raise("Error compiling "+Fe+" shader, "+He[0].name)}}function K(b,P,W,Ae,Ue){if(!b.getProgramParameter(P,b.LINK_STATUS)){var Ee=b.getProgramInfoLog(P),Fe=Y(W,Ue),He=Y(Ae,Ue),qe='Error linking program with vertex shader, "'+He[0].name+'", and fragment shader "'+Fe[0].name+'"';typeof document<"u"?console.log("%c"+qe+a+"%c"+Ee,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(qe+a+Ee),s.raise(qe)}}function ue(b){b._commandRef=j()}function de(b,P,W,Ae){ue(b);function Ue(qe){return qe?Ae.id(qe):0}b._fragId=Ue(b.static.frag),b._vertId=Ue(b.static.vert);function Ee(qe,ot){Object.keys(ot).forEach(function(lt){qe[Ae.id(lt)]=!0})}var Fe=b._uniformSet={};Ee(Fe,P.static),Ee(Fe,P.dynamic);var He=b._attributeSet={};Ee(He,W.static),Ee(He,W.dynamic),b._hasCount="count"in b.static||"count"in b.dynamic||"elements"in b.static||"elements"in b.dynamic}function pe(b,P){var W=q();u(b+" in command "+(P||j())+(W==="unknown"?"":" called from "+W))}function le(b,P,W){b||pe(P,W||j())}function ve(b,P,W,Ae){b in P||pe("unknown parameter ("+b+")"+l(W)+". possible values: "+Object.keys(P).join(),Ae||j())}function Me(b,P,W,Ae){d(b,P)||pe("invalid parameter type"+l(W)+". expected "+P+", got "+typeof b,Ae||j())}function Ne(b){b()}function Xe(b,P,W){b.texture?y(b.texture._texture.internalformat,P,"unsupported texture format for attachment"):y(b.renderbuffer._renderbuffer.format,W,"unsupported renderbuffer format for attachment")}var ct=33071,$t=9728,Qt=9984,Zt=9985,jt=9986,Cr=9987,gn=5120,ii=5121,Mt=5122,qt=5123,ar=5124,k=5125,ae=5126,_e=32819,Ge=32820,je=33635,Qe=34042,Ot=36193,Je={};Je[gn]=Je[ii]=1,Je[Mt]=Je[qt]=Je[Ot]=Je[je]=Je[_e]=Je[Ge]=2,Je[ar]=Je[k]=Je[ae]=Je[Qe]=4;function yt(b,P){return b===Ge||b===_e||b===je?2:b===Qe?4:Je[b]*P}function et(b){return!(b&b-1)&&!!b}function Wt(b,P,W){var Ae,Ue=P.width,Ee=P.height,Fe=P.channels;s(Ue>0&&Ue<=W.maxTextureSize&&Ee>0&&Ee<=W.maxTextureSize,"invalid texture shape"),(b.wrapS!==ct||b.wrapT!==ct)&&s(et(Ue)&&et(Ee),"incompatible wrap mode for texture, both width and height must be power of 2"),P.mipmask===1?Ue!==1&&Ee!==1&&s(b.minFilter!==Qt&&b.minFilter!==jt&&b.minFilter!==Zt&&b.minFilter!==Cr,"min filter requires mipmap"):(s(et(Ue)&&et(Ee),"texture must be a square power of 2 to support mipmapping"),s(P.mipmask===(Ue<<1)-1,"missing or incomplete mipmap data")),P.type===ae&&(W.extensions.indexOf("oes_texture_float_linear")<0&&s(b.minFilter===$t&&b.magFilter===$t,"filter not supported, must enable oes_texture_float_linear"),s(!b.genMipmaps,"mipmap generation not supported with float textures"));var He=P.images;for(Ae=0;Ae<16;++Ae)if(He[Ae]){var qe=Ue>>Ae,ot=Ee>>Ae;s(P.mipmask&1<<Ae,"missing mipmap data");var lt=He[Ae];if(s(lt.width===qe&&lt.height===ot,"invalid shape for mip images"),s(lt.format===P.format&&lt.internalformat===P.internalformat&&lt.type===P.type,"incompatible type for mip image"),!lt.compressed)if(lt.data){var Ke=Math.ceil(yt(lt.type,Fe)*qe/lt.unpackAlignment)*lt.unpackAlignment;s(lt.data.byteLength===Ke*ot,"invalid data for image, buffer size is inconsistent with image format")}else lt.element||lt.copy}else b.genMipmaps||s((P.mipmask&1<<Ae)===0,"extra mipmap data");P.compressed&&s(!b.genMipmaps,"mipmap generation for compressed images not supported")}function Gt(b,P,W,Ae){var Ue=b.width,Ee=b.height,Fe=b.channels;s(Ue>0&&Ue<=Ae.maxTextureSize&&Ee>0&&Ee<=Ae.maxTextureSize,"invalid texture shape"),s(Ue===Ee,"cube map must be square"),s(P.wrapS===ct&&P.wrapT===ct,"wrap mode not supported by cube map");for(var He=0;He<W.length;++He){var qe=W[He];s(qe.width===Ue&&qe.height===Ee,"inconsistent cube map face shape"),P.genMipmaps&&(s(!qe.compressed,"can not generate mipmap for compressed textures"),s(qe.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var ot=qe.images,lt=0;lt<16;++lt){var Ke=ot[lt];if(Ke){var rt=Ue>>lt,Ze=Ee>>lt;s(qe.mipmask&1<<lt,"missing mipmap data"),s(Ke.width===rt&&Ke.height===Ze,"invalid shape for mip images"),s(Ke.format===b.format&&Ke.internalformat===b.internalformat&&Ke.type===b.type,"incompatible type for mip image"),Ke.compressed||(Ke.data?s(Ke.data.byteLength===rt*Ze*Math.max(yt(Ke.type,Fe),Ke.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ke.element||Ke.copy)}}}}var C=i(s,{optional:Ne,raise:u,commandRaise:pe,command:le,parameter:f,commandParameter:ve,constructor:E,type:v,commandType:Me,isTypedArray:h,nni:m,oneOf:y,shaderError:$,linkError:K,callSite:q,saveCommandRef:ue,saveDrawInfo:de,framebufferFormat:Xe,guessCommand:j,texture2D:Wt,textureCube:Gt}),Se=0,$e=0,ft=5,St=6;function pr(b,P){this.id=Se++,this.type=b,this.data=P}function rr(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function sr(b){if(b.length===0)return[];var P=b.charAt(0),W=b.charAt(b.length-1);if(b.length>1&&P===W&&(P==='"'||P==="'"))return['"'+rr(b.substr(1,b.length-2))+'"'];var Ae=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b);if(Ae)return sr(b.substr(0,Ae.index)).concat(sr(Ae[1])).concat(sr(b.substr(Ae.index+Ae[0].length)));var Ue=b.split(".");if(Ue.length===1)return['"'+rr(b)+'"'];for(var Ee=[],Fe=0;Fe<Ue.length;++Fe)Ee=Ee.concat(sr(Ue[Fe]));return Ee}function Jt(b){return"["+sr(b).join("][")+"]"}function Er(b,P){return new pr(b,Jt(P+""))}function Ar(b){return typeof b=="function"&&!b._reglType||b instanceof pr}function Yr(b,P){if(typeof b=="function")return new pr($e,b);if(typeof b=="number"||typeof b=="boolean")return new pr(ft,b);if(Array.isArray(b))return new pr(St,b.map(function(W,Ae){return Yr(W,P+"["+Ae+"]")}));if(b instanceof pr)return b;C(!1,"invalid option type in uniform "+P)}var Zr={DynamicVariable:pr,define:Er,isDynamic:Ar,unbox:Yr,accessor:Jt},Da={next:typeof requestAnimationFrame=="function"?function(b){return requestAnimationFrame(b)}:function(b){return setTimeout(b,16)},cancel:typeof cancelAnimationFrame=="function"?function(b){return cancelAnimationFrame(b)}:clearTimeout},Wh=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Jc=Wh?function(){return+new Date}:typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Xh(){var b={"":0},P=[""];return{id:function(W){var Ae=b[W];return Ae||(Ae=b[W]=P.length,P.push(W),Ae)},str:function(W){return P[W]}}}function Au(b,P,W){var Ae=document.createElement("canvas");i(Ae.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),b.appendChild(Ae),b===document.body&&(Ae.style.position="absolute",i(b.style,{margin:0,padding:0}));function Ue(){var He=window.innerWidth,qe=window.innerHeight;if(b!==document.body){var ot=Ae.getBoundingClientRect();He=ot.right-ot.left,qe=ot.bottom-ot.top}Ae.width=W*He,Ae.height=W*qe}var Ee;b!==document.body&&typeof ResizeObserver=="function"?(Ee=new ResizeObserver(function(){setTimeout(Ue)}),Ee.observe(b)):window.addEventListener("resize",Ue,!1);function Fe(){Ee?Ee.disconnect():window.removeEventListener("resize",Ue),b.removeChild(Ae)}return Ue(),{canvas:Ae,onDestroy:Fe}}function ef(b,P){function W(Ae){try{return b.getContext(Ae,P)}catch{return null}}return W("webgl")||W("experimental-webgl")||W("webgl-experimental")}function Yh(b){return typeof b.nodeName=="string"&&typeof b.appendChild=="function"&&typeof b.getBoundingClientRect=="function"}function tf(b){return typeof b.drawArrays=="function"||typeof b.drawElements=="function"}function wl(b){return typeof b=="string"?b.split():(C(Array.isArray(b),"invalid extension array"),b)}function ps(b){return typeof b=="string"?(C(typeof document<"u","not supported outside of DOM"),document.querySelector(b)):b}function rf(b){var P=b||{},W,Ae,Ue,Ee,Fe={},He=[],qe=[],ot=typeof window>"u"?1:window.devicePixelRatio,lt=!1,Ke=function(st){st&&C.raise(st)},rt=function(){};if(typeof P=="string"?(C(typeof document<"u","selector queries only supported in DOM environments"),W=document.querySelector(P),C(W,"invalid query string for element")):typeof P=="object"?Yh(P)?W=P:tf(P)?(Ee=P,Ue=Ee.canvas):(C.constructor(P),"gl"in P?Ee=P.gl:"canvas"in P?Ue=ps(P.canvas):"container"in P&&(Ae=ps(P.container)),"attributes"in P&&(Fe=P.attributes,C.type(Fe,"object","invalid context attributes")),"extensions"in P&&(He=wl(P.extensions)),"optionalExtensions"in P&&(qe=wl(P.optionalExtensions)),"onDone"in P&&(C.type(P.onDone,"function","invalid or missing onDone callback"),Ke=P.onDone),"profile"in P&&(lt=!!P.profile),"pixelRatio"in P&&(ot=+P.pixelRatio,C(ot>0,"invalid pixel ratio"))):C.raise("invalid arguments to regl"),W&&(W.nodeName.toLowerCase()==="canvas"?Ue=W:Ae=W),!Ee){if(!Ue){C(typeof document<"u","must manually specify webgl context outside of DOM environments");var Ze=Au(Ae||document.body,Ke,ot);if(!Ze)return null;Ue=Ze.canvas,rt=Ze.onDestroy}Fe.premultipliedAlpha===void 0&&(Fe.premultipliedAlpha=!0),Ee=ef(Ue,Fe)}return Ee?{gl:Ee,canvas:Ue,container:Ae,extensions:He,optionalExtensions:qe,pixelRatio:ot,profile:lt,onDone:Ke,onDestroy:rt}:(rt(),Ke("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Zh(b,P){var W={};function Ae(He){C.type(He,"string","extension name must be string");var qe=He.toLowerCase(),ot;try{ot=W[qe]=Ue(He)}catch{}return!!ot}function Ue(He){return b.getExtension(He)?b.getExtension(He):b.getExtension(He.toLowerCase())?b.getExtension(He.toLowerCase()):null}for(var Ee=0;Ee<P.extensions.length;++Ee){var Fe=P.extensions[Ee];if(!Ae(Fe))return P.onDestroy(),P.onDone('"'+Fe+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return P.optionalExtensions.forEach(Ae),{extensions:W,restore:function(){Object.keys(W).forEach(function(He){if(W[He]&&!Ae(He))throw new Error("(regl): error restoring extension "+He)})}}}function pi(b,P){for(var W=Array(b),Ae=0;Ae<b;++Ae)W[Ae]=P(Ae);return W}var nf=5120,Ml=5121,qh=5122,Rl=5123,ds=5124,Kh=5125,Qh=5126;function af(b){for(var P=16;P<=1<<28;P*=16)if(b<=P)return P;return 0}function vs(b){var P,W;return P=(b>65535)<<4,b>>>=P,W=(b>255)<<3,b>>>=W,P|=W,W=(b>15)<<2,b>>>=W,P|=W,W=(b>3)<<1,b>>>=W,P|=W,P|b>>1}function of(){var b=pi(8,function(){return[]});function P(Ee){var Fe=af(Ee),He=b[vs(Fe)>>2];return He.length>0?He.pop():new ArrayBuffer(Fe)}function W(Ee){b[vs(Ee.byteLength)>>2].push(Ee)}function Ae(Ee,Fe){var He=null;switch(Ee){case nf:He=new Int8Array(P(Fe),0,Fe);break;case Ml:He=new Uint8Array(P(Fe),0,Fe);break;case qh:He=new Int16Array(P(2*Fe),0,Fe);break;case Rl:He=new Uint16Array(P(2*Fe),0,Fe);break;case ds:He=new Int32Array(P(4*Fe),0,Fe);break;case Kh:He=new Uint32Array(P(4*Fe),0,Fe);break;case Qh:He=new Float32Array(P(4*Fe),0,Fe);break;default:return null}return He.length!==Fe?He.subarray(0,Fe):He}function Ue(Ee){W(Ee.buffer)}return{alloc:P,free:W,allocType:Ae,freeType:Ue}}var fn=of();fn.zero=of();var Jh=3408,Ol=3410,uf=3411,sf=3412,lf=3413,Ll=3414,co=3415,Su=33901,Ba=33902,gs=3379,zo=3386,ep=34921,tp=36347,ms=36348,di=35661,fo=35660,ha=34930,pa=36349,Tu=34076,Xi=34024,da=7936,Fl=7937,Il=7938,wu=35724,vi=34047,ys=36063,_s=34852,va=3553,Mu=34067,kl=34069,Ru=33984,ai=6408,Ou=5126,Pl=5121,$o=36160,xs=36053,Dl=36064,Go=16384,F=function(b,P){var W=1;P.ext_texture_filter_anisotropic&&(W=b.getParameter(vi));var Ae=1,Ue=1;P.webgl_draw_buffers&&(Ae=b.getParameter(_s),Ue=b.getParameter(ys));var Ee=!!P.oes_texture_float;if(Ee){var Fe=b.createTexture();b.bindTexture(va,Fe),b.texImage2D(va,0,ai,1,1,0,ai,Ou,null);var He=b.createFramebuffer();if(b.bindFramebuffer($o,He),b.framebufferTexture2D($o,Dl,va,Fe,0),b.bindTexture(va,null),b.checkFramebufferStatus($o)!==xs)Ee=!1;else{b.viewport(0,0,1,1),b.clearColor(1,0,0,1),b.clear(Go);var qe=fn.allocType(Ou,4);b.readPixels(0,0,1,1,ai,Ou,qe),b.getError()?Ee=!1:(b.deleteFramebuffer(He),b.deleteTexture(Fe),Ee=qe[0]===1),fn.freeType(qe)}}var ot=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),lt=!0;if(!ot){var Ke=b.createTexture(),rt=fn.allocType(Pl,36);b.activeTexture(Ru),b.bindTexture(Mu,Ke),b.texImage2D(kl,0,ai,3,3,0,ai,Pl,rt),fn.freeType(rt),b.bindTexture(Mu,null),b.deleteTexture(Ke),lt=!b.getError()}return{colorBits:[b.getParameter(Ol),b.getParameter(uf),b.getParameter(sf),b.getParameter(lf)],depthBits:b.getParameter(Ll),stencilBits:b.getParameter(co),subpixelBits:b.getParameter(Jh),extensions:Object.keys(P).filter(function(Ze){return!!P[Ze]}),maxAnisotropic:W,maxDrawbuffers:Ae,maxColorAttachments:Ue,pointSizeDims:b.getParameter(Su),lineWidthDims:b.getParameter(Ba),maxViewportDims:b.getParameter(zo),maxCombinedTextureUnits:b.getParameter(di),maxCubeMapSize:b.getParameter(Tu),maxRenderbufferSize:b.getParameter(Xi),maxTextureUnits:b.getParameter(ha),maxTextureSize:b.getParameter(gs),maxAttributes:b.getParameter(ep),maxVertexUniforms:b.getParameter(tp),maxVertexTextureUnits:b.getParameter(fo),maxVaryingVectors:b.getParameter(ms),maxFragmentUniforms:b.getParameter(pa),glsl:b.getParameter(wu),renderer:b.getParameter(Fl),vendor:b.getParameter(da),version:b.getParameter(Il),readFloat:Ee,npotTextureCube:lt}};function B(b){return!!b&&typeof b=="object"&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&typeof b.offset=="number"&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||n(b.data))}var te=function(b){return Object.keys(b).map(function(P){return b[P]})},Le={shape:Jn,flatten:Dn};function vt(b,P,W){for(var Ae=0;Ae<P;++Ae)W[Ae]=b[Ae]}function Vt(b,P,W,Ae){for(var Ue=0,Ee=0;Ee<P;++Ee)for(var Fe=b[Ee],He=0;He<W;++He)Ae[Ue++]=Fe[He]}function Sr(b,P,W,Ae,Ue,Ee){for(var Fe=Ee,He=0;He<P;++He)for(var qe=b[He],ot=0;ot<W;++ot)for(var lt=qe[ot],Ke=0;Ke<Ae;++Ke)Ue[Fe++]=lt[Ke]}function An(b,P,W,Ae,Ue){for(var Ee=1,Fe=W+1;Fe<P.length;++Fe)Ee*=P[Fe];var He=P[W];if(P.length-W===4){var qe=P[W+1],ot=P[W+2],lt=P[W+3];for(Fe=0;Fe<He;++Fe)Sr(b[Fe],qe,ot,lt,Ae,Ue),Ue+=Ee}else for(Fe=0;Fe<He;++Fe)An(b[Fe],P,W+1,Ae,Ue),Ue+=Ee}function Dn(b,P,W,Ae){var Ue=1;if(P.length)for(var Ee=0;Ee<P.length;++Ee)Ue*=P[Ee];else Ue=0;var Fe=Ae||fn.allocType(W,Ue);switch(P.length){case 0:break;case 1:vt(b,P[0],Fe);break;case 2:Vt(b,P[0],P[1],Fe);break;case 3:Sr(b,P[0],P[1],P[2],Fe,0);break;default:An(b,P,0,Fe,0)}return Fe}function Jn(b){for(var P=[],W=b;W.length;W=W[0])P.push(W.length);return P}var gi={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Bm=5120,Nm=5122,Um=5124,zm=5121,rp=5123,$m=5125,Gm=5126,Hm=5126,Lu={int8:Bm,int16:Nm,int32:Um,uint8:zm,uint16:rp,uint32:$m,float:Gm,float32:Hm},Vm=35048,hn=35040,nn={dynamic:Vm,stream:hn,static:35044},np=Le.flatten,x0=Le.shape,E0=35044,jm=35040,ip=5121,ap=5126,ho=[];ho[5120]=1,ho[5122]=2,ho[5124]=4,ho[5121]=1,ho[5123]=2,ho[5125]=4,ho[5126]=4;function cf(b){return gi[Object.prototype.toString.call(b)]|0}function Xn(b,P){for(var W=0;W<P.length;++W)b[W]=P[W]}function ff(b,P,W,Ae,Ue,Ee,Fe){for(var He=0,qe=0;qe<W;++qe)for(var ot=0;ot<Ae;++ot)b[He++]=P[Ue*qe+Ee*ot+Fe]}function Fu(b,P,W,Ae){var Ue=0,Ee={};function Fe(ce){this.id=Ue++,this.buffer=b.createBuffer(),this.type=ce,this.usage=E0,this.byteLength=0,this.dimension=1,this.dtype=ip,this.persistentData=null,W.profile&&(this.stats={size:0})}Fe.prototype.bind=function(){b.bindBuffer(this.type,this.buffer)},Fe.prototype.destroy=function(){rt(this)};var He=[];function qe(ce,Re){var it=He.pop();return it||(it=new Fe(ce)),it.bind(),Ke(it,Re,jm,0,1,!1),it}function ot(ce){He.push(ce)}function lt(ce,Re,it){ce.byteLength=Re.byteLength,b.bufferData(ce.type,Re,it)}function Ke(ce,Re,it,bt,We,Tt){var Ct;if(ce.usage=it,Array.isArray(Re)){if(ce.dtype=bt||ap,Re.length>0){var Yt;if(Array.isArray(Re[0])){Ct=x0(Re);for(var ze=1,Be=1;Be<Ct.length;++Be)ze*=Ct[Be];ce.dimension=ze,Yt=np(Re,Ct,ce.dtype),lt(ce,Yt,it),Tt?ce.persistentData=Yt:fn.freeType(Yt)}else if(typeof Re[0]=="number"){ce.dimension=We;var kt=fn.allocType(ce.dtype,Re.length);Xn(kt,Re),lt(ce,kt,it),Tt?ce.persistentData=kt:fn.freeType(kt)}else n(Re[0])?(ce.dimension=Re[0].length,ce.dtype=bt||cf(Re[0])||ap,Yt=np(Re,[Re.length,Re[0].length],ce.dtype),lt(ce,Yt,it),Tt?ce.persistentData=Yt:fn.freeType(Yt)):C.raise("invalid buffer data")}}else if(n(Re))ce.dtype=bt||cf(Re),ce.dimension=We,lt(ce,Re,it),Tt&&(ce.persistentData=new Uint8Array(new Uint8Array(Re.buffer)));else if(B(Re)){Ct=Re.shape;var mt=Re.stride,nt=Re.offset,_t=0,xt=0,ur=0,nr=0;Ct.length===1?(_t=Ct[0],xt=1,ur=mt[0],nr=0):Ct.length===2?(_t=Ct[0],xt=Ct[1],ur=mt[0],nr=mt[1]):C.raise("invalid shape"),ce.dtype=bt||cf(Re.data)||ap,ce.dimension=xt;var Et=fn.allocType(ce.dtype,_t*xt);ff(Et,Re.data,_t,xt,ur,nr,nt),lt(ce,Et,it),Tt?ce.persistentData=Et:fn.freeType(Et)}else Re instanceof ArrayBuffer?(ce.dtype=ip,ce.dimension=We,lt(ce,Re,it),Tt&&(ce.persistentData=new Uint8Array(new Uint8Array(Re)))):C.raise("invalid buffer data")}function rt(ce){P.bufferCount--,Ae(ce);var Re=ce.buffer;C(Re,"buffer must not be deleted already"),b.deleteBuffer(Re),ce.buffer=null,delete Ee[ce.id]}function Ze(ce,Re,it,bt){P.bufferCount++;var We=new Fe(Re);Ee[We.id]=We;function Tt(ze){var Be=E0,kt=null,mt=0,nt=0,_t=1;return Array.isArray(ze)||n(ze)||B(ze)||ze instanceof ArrayBuffer?kt=ze:typeof ze=="number"?mt=ze|0:ze&&(C.type(ze,"object","buffer arguments must be an object, a number or an array"),"data"in ze&&(C(kt===null||Array.isArray(kt)||n(kt)||B(kt),"invalid data for buffer"),kt=ze.data),"usage"in ze&&(C.parameter(ze.usage,nn,"invalid buffer usage"),Be=nn[ze.usage]),"type"in ze&&(C.parameter(ze.type,Lu,"invalid buffer type"),nt=Lu[ze.type]),"dimension"in ze&&(C.type(ze.dimension,"number","invalid dimension"),_t=ze.dimension|0),"length"in ze&&(C.nni(mt,"buffer length must be a nonnegative integer"),mt=ze.length|0)),We.bind(),kt?Ke(We,kt,Be,nt,_t,bt):(mt&&b.bufferData(We.type,mt,Be),We.dtype=nt||ip,We.usage=Be,We.dimension=_t,We.byteLength=mt),W.profile&&(We.stats.size=We.byteLength*ho[We.dtype]),Tt}function Ct(ze,Be){C(Be+ze.byteLength<=We.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ze.byteLength+" starting from offset "+Be+" to a buffer of size "+We.byteLength),b.bufferSubData(We.type,Be,ze)}function Yt(ze,Be){var kt=(Be||0)|0,mt;if(We.bind(),n(ze)||ze instanceof ArrayBuffer)Ct(ze,kt);else if(Array.isArray(ze)){if(ze.length>0)if(typeof ze[0]=="number"){var nt=fn.allocType(We.dtype,ze.length);Xn(nt,ze),Ct(nt,kt),fn.freeType(nt)}else if(Array.isArray(ze[0])||n(ze[0])){mt=x0(ze);var _t=np(ze,mt,We.dtype);Ct(_t,kt),fn.freeType(_t)}else C.raise("invalid buffer data")}else if(B(ze)){mt=ze.shape;var xt=ze.stride,ur=0,nr=0,Et=0,wt=0;mt.length===1?(ur=mt[0],nr=1,Et=xt[0],wt=0):mt.length===2?(ur=mt[0],nr=mt[1],Et=xt[0],wt=xt[1]):C.raise("invalid shape");var Kt=Array.isArray(ze.data)?We.dtype:cf(ze.data),lr=fn.allocType(Kt,ur*nr);ff(lr,ze.data,ur,nr,Et,wt,ze.offset),Ct(lr,kt),fn.freeType(lr)}else C.raise("invalid data for buffer subdata");return Tt}return it||Tt(ce),Tt._reglType="buffer",Tt._buffer=We,Tt.subdata=Yt,W.profile&&(Tt.stats=We.stats),Tt.destroy=function(){rt(We)},Tt}function st(){te(Ee).forEach(function(ce){ce.buffer=b.createBuffer(),b.bindBuffer(ce.type,ce.buffer),b.bufferData(ce.type,ce.persistentData||ce.byteLength,ce.usage)})}return W.profile&&(P.getTotalBufferSize=function(){var ce=0;return Object.keys(Ee).forEach(function(Re){ce+=Ee[Re].stats.size}),ce}),{create:Ze,createStream:qe,destroyStream:ot,clear:function(){te(Ee).forEach(rt),He.forEach(rt)},getBuffer:function(ce){return ce&&ce._buffer instanceof Fe?ce._buffer:null},restore:st,_initBuffer:Ke}}var b0=0,op=0,Yi=1,C0=1,A0=4,S0=4,po={points:b0,point:op,lines:Yi,line:C0,triangles:A0,triangle:S0,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},T0=0,w0=1,ei=4,Wm=5120,ti=5121,M0=5122,Iu=5123,vo=5124,Na=5125,Bl=34963,dn=35040,Ho=35044;function up(b,P,W,Ae){var Ue={},Ee=0,Fe={uint8:ti,uint16:Iu};P.oes_element_index_uint&&(Fe.uint32=Na);function He(st){this.id=Ee++,Ue[this.id]=this,this.buffer=st,this.primType=ei,this.vertCount=0,this.type=0}He.prototype.bind=function(){this.buffer.bind()};var qe=[];function ot(st){var ce=qe.pop();return ce||(ce=new He(W.create(null,Bl,!0,!1)._buffer)),Ke(ce,st,dn,-1,-1,0,0),ce}function lt(st){qe.push(st)}function Ke(st,ce,Re,it,bt,We,Tt){st.buffer.bind();var Ct;if(ce){var Yt=Tt;!Tt&&(!n(ce)||B(ce)&&!n(ce.data))&&(Yt=P.oes_element_index_uint?Na:Iu),W._initBuffer(st.buffer,ce,Re,Yt,3)}else b.bufferData(Bl,We,Re),st.buffer.dtype=Ct||ti,st.buffer.usage=Re,st.buffer.dimension=3,st.buffer.byteLength=We;if(Ct=Tt,!Tt){switch(st.buffer.dtype){case ti:case Wm:Ct=ti;break;case Iu:case M0:Ct=Iu;break;case Na:case vo:Ct=Na;break;default:C.raise("unsupported type for element array")}st.buffer.dtype=Ct}st.type=Ct,C(Ct!==Na||!!P.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var ze=bt;ze<0&&(ze=st.buffer.byteLength,Ct===Iu?ze>>=1:Ct===Na&&(ze>>=2)),st.vertCount=ze;var Be=it;if(it<0){Be=ei;var kt=st.buffer.dimension;kt===1&&(Be=T0),kt===2&&(Be=w0),kt===3&&(Be=ei)}st.primType=Be}function rt(st){Ae.elementsCount--,C(st.buffer!==null,"must not double destroy elements"),delete Ue[st.id],st.buffer.destroy(),st.buffer=null}function Ze(st,ce){var Re=W.create(null,Bl,!0),it=new He(Re._buffer);Ae.elementsCount++;function bt(We){if(!We)Re(),it.primType=ei,it.vertCount=0,it.type=ti;else if(typeof We=="number")Re(We),it.primType=ei,it.vertCount=We|0,it.type=ti;else{var Tt=null,Ct=Ho,Yt=-1,ze=-1,Be=0,kt=0;Array.isArray(We)||n(We)||B(We)?Tt=We:(C.type(We,"object","invalid arguments for elements"),"data"in We&&(Tt=We.data,C(Array.isArray(Tt)||n(Tt)||B(Tt),"invalid data for element buffer")),"usage"in We&&(C.parameter(We.usage,nn,"invalid element buffer usage"),Ct=nn[We.usage]),"primitive"in We&&(C.parameter(We.primitive,po,"invalid element buffer primitive"),Yt=po[We.primitive]),"count"in We&&(C(typeof We.count=="number"&&We.count>=0,"invalid vertex count for elements"),ze=We.count|0),"type"in We&&(C.parameter(We.type,Fe,"invalid buffer type"),kt=Fe[We.type]),"length"in We?Be=We.length|0:(Be=ze,kt===Iu||kt===M0?Be*=2:(kt===Na||kt===vo)&&(Be*=4))),Ke(it,Tt,Ct,Yt,ze,Be,kt)}return bt}return bt(st),bt._reglType="elements",bt._elements=it,bt.subdata=function(We,Tt){return Re.subdata(We,Tt),bt},bt.destroy=function(){rt(it)},bt}return{create:Ze,createStream:ot,destroyStream:lt,getElements:function(st){return typeof st=="function"&&st._elements instanceof He?st._elements:null},clear:function(){te(Ue).forEach(rt)}}}var R0=new Float32Array(1),sp=new Uint32Array(R0.buffer),Xm=5123;function O0(b){for(var P=fn.allocType(Xm,b.length),W=0;W<b.length;++W)if(isNaN(b[W]))P[W]=65535;else if(b[W]===1/0)P[W]=31744;else if(b[W]===-1/0)P[W]=64512;else{R0[0]=b[W];var Ae=sp[0],Ue=Ae>>>31<<15,Ee=(Ae<<1>>>24)-127,Fe=Ae>>13&(1<<10)-1;if(Ee<-24)P[W]=Ue;else if(Ee<-14){var He=-14-Ee;P[W]=Ue+(Fe+(1<<10)>>He)}else Ee>15?P[W]=Ue+31744:P[W]=Ue+(Ee+15<<10)+Fe}return P}function mn(b){return Array.isArray(b)||n(b)}var lp=function(b){return!(b&b-1)&&!!b},hf=34467,mi=3553,cp=34067,Nl=34069,Vo=6408,Ul=6406,Es=6407,bs=6409,pf=6410,df=32854,zl=32855,L0=36194,F0=32819,ki=32820,fp=33635,$l=34042,vf=6402,Gl=34041,hp=35904,pp=35906,Cs=36193,dp=33776,vp=33777,jo=33778,gp=33779,I0=35986,gf=35987,mp=34798,go=35840,Hl=35841,k0=35842,P0=35843,D0=36196,ga=5121,Pi=5123,mf=5125,Vl=5126,Ym=10242,Zm=10243,qm=10497,yp=33071,As=33648,ge=10240,Ye=10241,De=9728,Xt=9729,yr=9984,jr=9985,Fn=9986,an=9987,_p=33170,yf=4352,Zi=4353,_f=4354,Km=34046,Ss=3317,xf=37440,Ef=37441,on=37443,B0=37444,Ts=33984,bf=[yr,Fn,jr,an],Cf=[0,bs,pf,Es,Vo],qi={};qi[bs]=qi[Ul]=qi[vf]=1,qi[Gl]=qi[pf]=2,qi[Es]=qi[hp]=3,qi[Vo]=qi[pp]=4;function ws(b){return"[object "+b+"]"}var jl=ws("HTMLCanvasElement"),mo=ws("OffscreenCanvas"),Wl=ws("CanvasRenderingContext2D"),xp=ws("ImageBitmap"),Xl=ws("HTMLImageElement"),Ep=ws("HTMLVideoElement"),N0=Object.keys(gi).concat([jl,mo,Wl,xp,Xl,Ep]),yo=[];yo[ga]=1,yo[Vl]=4,yo[Cs]=2,yo[Pi]=2,yo[mf]=4;var Bn=[];Bn[df]=2,Bn[zl]=2,Bn[L0]=2,Bn[Gl]=4,Bn[dp]=.5,Bn[vp]=.5,Bn[jo]=1,Bn[gp]=1,Bn[I0]=.5,Bn[gf]=1,Bn[mp]=1,Bn[go]=.5,Bn[Hl]=.25,Bn[k0]=.5,Bn[P0]=.25,Bn[D0]=.5;function Ms(b){return Array.isArray(b)&&(b.length===0||typeof b[0]=="number")}function Wo(b){if(!Array.isArray(b))return!1;var P=b.length;return!(P===0||!mn(b[0]))}function Ua(b){return Object.prototype.toString.call(b)}function U0(b){return Ua(b)===jl}function z0(b){return Ua(b)===mo}function Qm(b){return Ua(b)===Wl}function Af(b){return Ua(b)===xp}function Sf(b){return Ua(b)===Xl}function bp(b){return Ua(b)===Ep}function Cp(b){var P=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(P&&b&&b.getContext)}function Ap(b){var P=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(P&&b&&"src"in b&&"crossOrigin"in b)}function Sp(b){if(!b)return!1;if(Cp(b)||Ap(b))return!0;var P=Ua(b);return N0.indexOf(P)>=0?!0:Ms(b)||Wo(b)||B(b)}function $0(b){return gi[Object.prototype.toString.call(b)]|0}function Nn(b,P){var W=P.length;switch(b.type){case ga:case Pi:case mf:case Vl:var Ae=fn.allocType(b.type,W);Ae.set(P),b.data=Ae;break;case Cs:b.data=O0(P);break;default:C.raise("unsupported texture type, must specify a typed array")}}function ri(b,P){return fn.allocType(b.type===Cs?Vl:b.type,P)}function G0(b,P){b.type===Cs?(b.data=O0(P),fn.freeType(P)):b.data=P}function Jm(b,P,W,Ae,Ue,Ee){for(var Fe=b.width,He=b.height,qe=b.channels,ot=Fe*He*qe,lt=ri(b,ot),Ke=0,rt=0;rt<He;++rt)for(var Ze=0;Ze<Fe;++Ze)for(var st=0;st<qe;++st)lt[Ke++]=P[W*Ze+Ae*rt+Ue*st+Ee];G0(b,lt)}function Yl(b,P,W,Ae,Ue,Ee){var Fe;if(typeof Bn[b]<"u"?Fe=Bn[b]:Fe=qi[b]*yo[P],Ee&&(Fe*=6),Ue){for(var He=0,qe=W;qe>=1;)He+=Fe*qe*qe,qe/=2;return He}else return Fe*W*Ae}function ey(b,P,W,Ae,Ue,Ee,Fe){var He={"don't care":yf,"dont care":yf,nice:_f,fast:Zi},qe={repeat:qm,clamp:yp,mirror:As},ot={nearest:De,linear:Xt},lt=i({mipmap:an,"nearest mipmap nearest":yr,"linear mipmap nearest":jr,"nearest mipmap linear":Fn,"linear mipmap linear":an},ot),Ke={none:0,browser:B0},rt={uint8:ga,rgba4:F0,rgb565:fp,"rgb5 a1":ki},Ze={alpha:Ul,luminance:bs,"luminance alpha":pf,rgb:Es,rgba:Vo,rgba4:df,"rgb5 a1":zl,rgb565:L0},st={};P.ext_srgb&&(Ze.srgb=hp,Ze.srgba=pp),P.oes_texture_float&&(rt.float32=rt.float=Vl),P.oes_texture_half_float&&(rt.float16=rt["half float"]=Cs),P.webgl_depth_texture&&(i(Ze,{depth:vf,"depth stencil":Gl}),i(rt,{uint16:Pi,uint32:mf,"depth stencil":$l})),P.webgl_compressed_texture_s3tc&&i(st,{"rgb s3tc dxt1":dp,"rgba s3tc dxt1":vp,"rgba s3tc dxt3":jo,"rgba s3tc dxt5":gp}),P.webgl_compressed_texture_atc&&i(st,{"rgb atc":I0,"rgba atc explicit alpha":gf,"rgba atc interpolated alpha":mp}),P.webgl_compressed_texture_pvrtc&&i(st,{"rgb pvrtc 4bppv1":go,"rgb pvrtc 2bppv1":Hl,"rgba pvrtc 4bppv1":k0,"rgba pvrtc 2bppv1":P0}),P.webgl_compressed_texture_etc1&&(st["rgb etc1"]=D0);var ce=Array.prototype.slice.call(b.getParameter(hf)||new Uint32Array(0));Object.keys(st).forEach(function(V){var we=st[V];ce.indexOf(we)>=0&&(Ze[V]=we)});var Re=Object.keys(Ze);W.textureFormats=Re;var it=[];Object.keys(Ze).forEach(function(V){var we=Ze[V];it[we]=V});var bt=[];Object.keys(rt).forEach(function(V){var we=rt[V];bt[we]=V});var We=[];Object.keys(ot).forEach(function(V){var we=ot[V];We[we]=V});var Tt=[];Object.keys(lt).forEach(function(V){var we=lt[V];Tt[we]=V});var Ct=[];Object.keys(qe).forEach(function(V){var we=qe[V];Ct[we]=V});var Yt=Re.reduce(function(V,we){var ye=Ze[we];return ye===bs||ye===Ul||ye===bs||ye===pf||ye===vf||ye===Gl||P.ext_srgb&&(ye===hp||ye===pp)?V[ye]=ye:ye===zl||we.indexOf("rgba")>=0?V[ye]=Vo:V[ye]=Es,V},{});function ze(){this.internalformat=Vo,this.format=Vo,this.type=ga,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=B0,this.width=0,this.height=0,this.channels=0}function Be(V,we){V.internalformat=we.internalformat,V.format=we.format,V.type=we.type,V.compressed=we.compressed,V.premultiplyAlpha=we.premultiplyAlpha,V.flipY=we.flipY,V.unpackAlignment=we.unpackAlignment,V.colorSpace=we.colorSpace,V.width=we.width,V.height=we.height,V.channels=we.channels}function kt(V,we){if(!(typeof we!="object"||!we)){if("premultiplyAlpha"in we&&(C.type(we.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),V.premultiplyAlpha=we.premultiplyAlpha),"flipY"in we&&(C.type(we.flipY,"boolean","invalid texture flip"),V.flipY=we.flipY),"alignment"in we&&(C.oneOf(we.alignment,[1,2,4,8],"invalid texture unpack alignment"),V.unpackAlignment=we.alignment),"colorSpace"in we&&(C.parameter(we.colorSpace,Ke,"invalid colorSpace"),V.colorSpace=Ke[we.colorSpace]),"type"in we){var ye=we.type;C(P.oes_texture_float||!(ye==="float"||ye==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),C(P.oes_texture_half_float||!(ye==="half float"||ye==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),C(P.webgl_depth_texture||!(ye==="uint16"||ye==="uint32"||ye==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),C.parameter(ye,rt,"invalid texture type"),V.type=rt[ye]}var Lt=V.width,br=V.height,z=V.channels,L=!1;"shape"in we?(C(Array.isArray(we.shape)&&we.shape.length>=2,"shape must be an array"),Lt=we.shape[0],br=we.shape[1],we.shape.length===3&&(z=we.shape[2],C(z>0&&z<=4,"invalid number of channels"),L=!0),C(Lt>=0&&Lt<=W.maxTextureSize,"invalid width"),C(br>=0&&br<=W.maxTextureSize,"invalid height")):("radius"in we&&(Lt=br=we.radius,C(Lt>=0&&Lt<=W.maxTextureSize,"invalid radius")),"width"in we&&(Lt=we.width,C(Lt>=0&&Lt<=W.maxTextureSize,"invalid width")),"height"in we&&(br=we.height,C(br>=0&&br<=W.maxTextureSize,"invalid height")),"channels"in we&&(z=we.channels,C(z>0&&z<=4,"invalid number of channels"),L=!0)),V.width=Lt|0,V.height=br|0,V.channels=z|0;var Z=!1;if("format"in we){var he=we.format;C(P.webgl_depth_texture||!(he==="depth"||he==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),C.parameter(he,Ze,"invalid texture format");var Te=V.internalformat=Ze[he];V.format=Yt[Te],he in rt&&("type"in we||(V.type=rt[he])),he in st&&(V.compressed=!0),Z=!0}!L&&Z?V.channels=qi[V.format]:L&&!Z?V.channels!==Cf[V.format]&&(V.format=V.internalformat=Cf[V.channels]):Z&&L&&C(V.channels===qi[V.format],"number of channels inconsistent with specified format")}}function mt(V){b.pixelStorei(xf,V.flipY),b.pixelStorei(Ef,V.premultiplyAlpha),b.pixelStorei(on,V.colorSpace),b.pixelStorei(Ss,V.unpackAlignment)}function nt(){ze.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function _t(V,we){var ye=null;if(Sp(we)?ye=we:we&&(C.type(we,"object","invalid pixel data type"),kt(V,we),"x"in we&&(V.xOffset=we.x|0),"y"in we&&(V.yOffset=we.y|0),Sp(we.data)&&(ye=we.data)),C(!V.compressed||ye instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),we.copy){C(!ye,"can not specify copy and data field for the same texture");var Lt=Ue.viewportWidth,br=Ue.viewportHeight;V.width=V.width||Lt-V.xOffset,V.height=V.height||br-V.yOffset,V.needsCopy=!0,C(V.xOffset>=0&&V.xOffset<Lt&&V.yOffset>=0&&V.yOffset<br&&V.width>0&&V.width<=Lt&&V.height>0&&V.height<=br,"copy texture read out of bounds")}else if(!ye)V.width=V.width||1,V.height=V.height||1,V.channels=V.channels||4;else if(n(ye))V.channels=V.channels||4,V.data=ye,!("type"in we)&&V.type===ga&&(V.type=$0(ye));else if(Ms(ye))V.channels=V.channels||4,Nn(V,ye),V.alignment=1,V.needsFree=!0;else if(B(ye)){var z=ye.data;!Array.isArray(z)&&V.type===ga&&(V.type=$0(z));var L=ye.shape,Z=ye.stride,he,Te,ie,ee,oe,D;L.length===3?(ie=L[2],D=Z[2]):(C(L.length===2,"invalid ndarray pixel data, must be 2 or 3D"),ie=1,D=1),he=L[0],Te=L[1],ee=Z[0],oe=Z[1],V.alignment=1,V.width=he,V.height=Te,V.channels=ie,V.format=V.internalformat=Cf[ie],V.needsFree=!0,Jm(V,z,ee,oe,D,ye.offset)}else if(Cp(ye)||U0(ye)||z0(ye)||Qm(ye))Cp(ye)||U0(ye)||z0(ye)?V.element=ye:V.element=ye.canvas,V.width=V.element.width,V.height=V.element.height,V.channels=4;else if(Af(ye))V.element=ye,V.width=ye.width,V.height=ye.height,V.channels=4;else if(Sf(ye))V.element=ye,V.width=ye.naturalWidth,V.height=ye.naturalHeight,V.channels=4;else if(Ap(ye))V.element=ye,V.width=ye.width,V.height=ye.height,V.channels=4;else if(bp(ye))V.element=ye,V.width=ye.videoWidth,V.height=ye.videoHeight,V.channels=4;else if(Wo(ye)){var Q=V.width||ye[0].length,G=V.height||ye.length,fe=V.channels;mn(ye[0][0])?fe=fe||ye[0][0].length:fe=fe||1;for(var me=Le.shape(ye),Ve=1,pt=0;pt<me.length;++pt)Ve*=me[pt];var dt=ri(V,Ve);Le.flatten(ye,me,"",dt),G0(V,dt),V.alignment=1,V.width=Q,V.height=G,V.channels=fe,V.format=V.internalformat=Cf[fe],V.needsFree=!0}V.type===Vl?C(W.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):V.type===Cs&&C(W.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function xt(V,we,ye){var Lt=V.element,br=V.data,z=V.internalformat,L=V.format,Z=V.type,he=V.width,Te=V.height;mt(V),Lt?b.texImage2D(we,ye,L,L,Z,Lt):V.compressed?b.compressedTexImage2D(we,ye,z,he,Te,0,br):V.needsCopy?(Ae(),b.copyTexImage2D(we,ye,L,V.xOffset,V.yOffset,he,Te,0)):b.texImage2D(we,ye,L,he,Te,0,L,Z,br||null)}function ur(V,we,ye,Lt,br){var z=V.element,L=V.data,Z=V.internalformat,he=V.format,Te=V.type,ie=V.width,ee=V.height;mt(V),z?b.texSubImage2D(we,br,ye,Lt,he,Te,z):V.compressed?b.compressedTexSubImage2D(we,br,ye,Lt,Z,ie,ee,L):V.needsCopy?(Ae(),b.copyTexSubImage2D(we,br,ye,Lt,V.xOffset,V.yOffset,ie,ee)):b.texSubImage2D(we,br,ye,Lt,ie,ee,he,Te,L)}var nr=[];function Et(){return nr.pop()||new nt}function wt(V){V.needsFree&&fn.freeType(V.data),nt.call(V),nr.push(V)}function Kt(){ze.call(this),this.genMipmaps=!1,this.mipmapHint=yf,this.mipmask=0,this.images=Array(16)}function lr(V,we,ye){var Lt=V.images[0]=Et();V.mipmask=1,Lt.width=V.width=we,Lt.height=V.height=ye,Lt.channels=V.channels=4}function cr(V,we){var ye=null;if(Sp(we))ye=V.images[0]=Et(),Be(ye,V),_t(ye,we),V.mipmask=1;else if(kt(V,we),Array.isArray(we.mipmap))for(var Lt=we.mipmap,br=0;br<Lt.length;++br)ye=V.images[br]=Et(),Be(ye,V),ye.width>>=br,ye.height>>=br,_t(ye,Lt[br]),V.mipmask|=1<<br;else ye=V.images[0]=Et(),Be(ye,V),_t(ye,we),V.mipmask=1;Be(V,V.images[0]),V.compressed&&(V.internalformat===dp||V.internalformat===vp||V.internalformat===jo||V.internalformat===gp)&&C(V.width%4===0&&V.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Wr(V,we){for(var ye=V.images,Lt=0;Lt<ye.length;++Lt){if(!ye[Lt])return;xt(ye[Lt],we,Lt)}}var pn=[];function _r(){var V=pn.pop()||new Kt;ze.call(V),V.mipmask=0;for(var we=0;we<16;++we)V.images[we]=null;return V}function zn(V){for(var we=V.images,ye=0;ye<we.length;++ye)we[ye]&&wt(we[ye]),we[ye]=null;pn.push(V)}function un(){this.minFilter=De,this.magFilter=De,this.wrapS=yp,this.wrapT=yp,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=yf}function Tn(V,we){if("min"in we){var ye=we.min;C.parameter(ye,lt),V.minFilter=lt[ye],bf.indexOf(V.minFilter)>=0&&!("faces"in we)&&(V.genMipmaps=!0)}if("mag"in we){var Lt=we.mag;C.parameter(Lt,ot),V.magFilter=ot[Lt]}var br=V.wrapS,z=V.wrapT;if("wrap"in we){var L=we.wrap;typeof L=="string"?(C.parameter(L,qe),br=z=qe[L]):Array.isArray(L)&&(C.parameter(L[0],qe),C.parameter(L[1],qe),br=qe[L[0]],z=qe[L[1]])}else{if("wrapS"in we){var Z=we.wrapS;C.parameter(Z,qe),br=qe[Z]}if("wrapT"in we){var he=we.wrapT;C.parameter(he,qe),z=qe[he]}}if(V.wrapS=br,V.wrapT=z,"anisotropic"in we){var Te=we.anisotropic;C(typeof Te=="number"&&Te>=1&&Te<=W.maxAnisotropic,"aniso samples must be between 1 and "),V.anisotropic=we.anisotropic}if("mipmap"in we){var ie=!1;switch(typeof we.mipmap){case"string":C.parameter(we.mipmap,He,"invalid mipmap hint"),V.mipmapHint=He[we.mipmap],V.genMipmaps=!0,ie=!0;break;case"boolean":ie=V.genMipmaps=we.mipmap;break;case"object":C(Array.isArray(we.mipmap),"invalid mipmap type"),V.genMipmaps=!1,ie=!0;break;default:C.raise("invalid mipmap type")}ie&&!("min"in we)&&(V.minFilter=yr)}}function yn(V,we){b.texParameteri(we,Ye,V.minFilter),b.texParameteri(we,ge,V.magFilter),b.texParameteri(we,Ym,V.wrapS),b.texParameteri(we,Zm,V.wrapT),P.ext_texture_filter_anisotropic&&b.texParameteri(we,Km,V.anisotropic),V.genMipmaps&&(b.hint(_p,V.mipmapHint),b.generateMipmap(we))}var In=0,$n={},Yn=W.maxTextureUnits,_n=Array(Yn).map(function(){return null});function dr(V){ze.call(this),this.mipmask=0,this.internalformat=Vo,this.id=In++,this.refCount=1,this.target=V,this.texture=b.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new un,Fe.profile&&(this.stats={size:0})}function Gn(V){b.activeTexture(Ts),b.bindTexture(V.target,V.texture)}function Ur(){var V=_n[0];V?b.bindTexture(V.target,V.texture):b.bindTexture(mi,null)}function wn(V){var we=V.texture;C(we,"must not double destroy texture");var ye=V.unit,Lt=V.target;ye>=0&&(b.activeTexture(Ts+ye),b.bindTexture(Lt,null),_n[ye]=null),b.deleteTexture(we),V.texture=null,V.params=null,V.pixels=null,V.refCount=0,delete $n[V.id],Ee.textureCount--}i(dr.prototype,{bind:function(){var V=this;V.bindCount+=1;var we=V.unit;if(we<0){for(var ye=0;ye<Yn;++ye){var Lt=_n[ye];if(Lt){if(Lt.bindCount>0)continue;Lt.unit=-1}_n[ye]=V,we=ye;break}we>=Yn&&C.raise("insufficient number of texture units"),Fe.profile&&Ee.maxTextureUnits<we+1&&(Ee.maxTextureUnits=we+1),V.unit=we,b.activeTexture(Ts+we),b.bindTexture(V.target,V.texture)}return we},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&wn(this)}});function er(V,we){var ye=new dr(mi);$n[ye.id]=ye,Ee.textureCount++;function Lt(L,Z){var he=ye.texInfo;un.call(he);var Te=_r();return typeof L=="number"?typeof Z=="number"?lr(Te,L|0,Z|0):lr(Te,L|0,L|0):L?(C.type(L,"object","invalid arguments to regl.texture"),Tn(he,L),cr(Te,L)):lr(Te,1,1),he.genMipmaps&&(Te.mipmask=(Te.width<<1)-1),ye.mipmask=Te.mipmask,Be(ye,Te),C.texture2D(he,Te,W),ye.internalformat=Te.internalformat,Lt.width=Te.width,Lt.height=Te.height,Gn(ye),Wr(Te,mi),yn(he,mi),Ur(),zn(Te),Fe.profile&&(ye.stats.size=Yl(ye.internalformat,ye.type,Te.width,Te.height,he.genMipmaps,!1)),Lt.format=it[ye.internalformat],Lt.type=bt[ye.type],Lt.mag=We[he.magFilter],Lt.min=Tt[he.minFilter],Lt.wrapS=Ct[he.wrapS],Lt.wrapT=Ct[he.wrapT],Lt}function br(L,Z,he,Te){C(!!L,"must specify image data");var ie=Z|0,ee=he|0,oe=Te|0,D=Et();return Be(D,ye),D.width=0,D.height=0,_t(D,L),D.width=D.width||(ye.width>>oe)-ie,D.height=D.height||(ye.height>>oe)-ee,C(ye.type===D.type&&ye.format===D.format&&ye.internalformat===D.internalformat,"incompatible format for texture.subimage"),C(ie>=0&&ee>=0&&ie+D.width<=ye.width&&ee+D.height<=ye.height,"texture.subimage write out of bounds"),C(ye.mipmask&1<<oe,"missing mipmap data"),C(D.data||D.element||D.needsCopy,"missing image data"),Gn(ye),ur(D,mi,ie,ee,oe),Ur(),wt(D),Lt}function z(L,Z){var he=L|0,Te=Z|0||he;if(he===ye.width&&Te===ye.height)return Lt;Lt.width=ye.width=he,Lt.height=ye.height=Te,Gn(ye);for(var ie=0;ye.mipmask>>ie;++ie){var ee=he>>ie,oe=Te>>ie;if(!ee||!oe)break;b.texImage2D(mi,ie,ye.format,ee,oe,0,ye.format,ye.type,null)}return Ur(),Fe.profile&&(ye.stats.size=Yl(ye.internalformat,ye.type,he,Te,!1,!1)),Lt}return Lt(V,we),Lt.subimage=br,Lt.resize=z,Lt._reglType="texture2d",Lt._texture=ye,Fe.profile&&(Lt.stats=ye.stats),Lt.destroy=function(){ye.decRef()},Lt}function mr(V,we,ye,Lt,br,z){var L=new dr(cp);$n[L.id]=L,Ee.cubeCount++;var Z=new Array(6);function he(ee,oe,D,Q,G,fe){var me,Ve=L.texInfo;for(un.call(Ve),me=0;me<6;++me)Z[me]=_r();if(typeof ee=="number"||!ee){var pt=ee|0||1;for(me=0;me<6;++me)lr(Z[me],pt,pt)}else if(typeof ee=="object")if(oe)cr(Z[0],ee),cr(Z[1],oe),cr(Z[2],D),cr(Z[3],Q),cr(Z[4],G),cr(Z[5],fe);else if(Tn(Ve,ee),kt(L,ee),"faces"in ee){var dt=ee.faces;for(C(Array.isArray(dt)&&dt.length===6,"cube faces must be a length 6 array"),me=0;me<6;++me)C(typeof dt[me]=="object"&&!!dt[me],"invalid input for cube map face"),Be(Z[me],L),cr(Z[me],dt[me])}else for(me=0;me<6;++me)cr(Z[me],ee);else C.raise("invalid arguments to cube map");for(Be(L,Z[0]),C.optional(function(){W.npotTextureCube||C(lp(L.width)&&lp(L.height),"your browser does not support non power or two texture dimensions")}),Ve.genMipmaps?L.mipmask=(Z[0].width<<1)-1:L.mipmask=Z[0].mipmask,C.textureCube(L,Ve,Z,W),L.internalformat=Z[0].internalformat,he.width=Z[0].width,he.height=Z[0].height,Gn(L),me=0;me<6;++me)Wr(Z[me],Nl+me);for(yn(Ve,cp),Ur(),Fe.profile&&(L.stats.size=Yl(L.internalformat,L.type,he.width,he.height,Ve.genMipmaps,!0)),he.format=it[L.internalformat],he.type=bt[L.type],he.mag=We[Ve.magFilter],he.min=Tt[Ve.minFilter],he.wrapS=Ct[Ve.wrapS],he.wrapT=Ct[Ve.wrapT],me=0;me<6;++me)zn(Z[me]);return he}function Te(ee,oe,D,Q,G){C(!!oe,"must specify image data"),C(typeof ee=="number"&&ee===(ee|0)&&ee>=0&&ee<6,"invalid face");var fe=D|0,me=Q|0,Ve=G|0,pt=Et();return Be(pt,L),pt.width=0,pt.height=0,_t(pt,oe),pt.width=pt.width||(L.width>>Ve)-fe,pt.height=pt.height||(L.height>>Ve)-me,C(L.type===pt.type&&L.format===pt.format&&L.internalformat===pt.internalformat,"incompatible format for texture.subimage"),C(fe>=0&&me>=0&&fe+pt.width<=L.width&&me+pt.height<=L.height,"texture.subimage write out of bounds"),C(L.mipmask&1<<Ve,"missing mipmap data"),C(pt.data||pt.element||pt.needsCopy,"missing image data"),Gn(L),ur(pt,Nl+ee,fe,me,Ve),Ur(),wt(pt),he}function ie(ee){var oe=ee|0;if(oe!==L.width){he.width=L.width=oe,he.height=L.height=oe,Gn(L);for(var D=0;D<6;++D)for(var Q=0;L.mipmask>>Q;++Q)b.texImage2D(Nl+D,Q,L.format,oe>>Q,oe>>Q,0,L.format,L.type,null);return Ur(),Fe.profile&&(L.stats.size=Yl(L.internalformat,L.type,he.width,he.height,!1,!0)),he}}return he(V,we,ye,Lt,br,z),he.subimage=Te,he.resize=ie,he._reglType="textureCube",he._texture=L,Fe.profile&&(he.stats=L.stats),he.destroy=function(){L.decRef()},he}function Xr(){for(var V=0;V<Yn;++V)b.activeTexture(Ts+V),b.bindTexture(mi,null),_n[V]=null;te($n).forEach(wn),Ee.cubeCount=0,Ee.textureCount=0}Fe.profile&&(Ee.getTotalTextureSize=function(){var V=0;return Object.keys($n).forEach(function(we){V+=$n[we].stats.size}),V});function En(){for(var V=0;V<Yn;++V){var we=_n[V];we&&(we.bindCount=0,we.unit=-1,_n[V]=null)}te($n).forEach(function(ye){ye.texture=b.createTexture(),b.bindTexture(ye.target,ye.texture);for(var Lt=0;Lt<32;++Lt)if((ye.mipmask&1<<Lt)!==0)if(ye.target===mi)b.texImage2D(mi,Lt,ye.internalformat,ye.width>>Lt,ye.height>>Lt,0,ye.internalformat,ye.type,null);else for(var br=0;br<6;++br)b.texImage2D(Nl+br,Lt,ye.internalformat,ye.width>>Lt,ye.height>>Lt,0,ye.internalformat,ye.type,null);yn(ye.texInfo,ye.target)})}function Ao(){for(var V=0;V<Yn;++V){var we=_n[V];we&&(we.bindCount=0,we.unit=-1,_n[V]=null),b.activeTexture(Ts+V),b.bindTexture(mi,null),b.bindTexture(cp,null)}}return{create2D:er,createCube:mr,clear:Xr,getTexture:function(V){return null},restore:En,refresh:Ao}}var za=36161,Xo=32854,Tf=32855,ku=36194,Rs=33189,Os=36168,Zl=34041,Pu=35907,H0=34836,V0=34842,j0=34843,ma=[];ma[Xo]=2,ma[Tf]=2,ma[ku]=2,ma[Rs]=2,ma[Os]=1,ma[Zl]=4,ma[Pu]=4,ma[H0]=16,ma[V0]=8,ma[j0]=6;function W0(b,P,W){return ma[b]*P*W}var wf=function(b,P,W,Ae,Ue){var Ee={rgba4:Xo,rgb565:ku,"rgb5 a1":Tf,depth:Rs,stencil:Os,"depth stencil":Zl};P.ext_srgb&&(Ee.srgba=Pu),P.ext_color_buffer_half_float&&(Ee.rgba16f=V0,Ee.rgb16f=j0),P.webgl_color_buffer_float&&(Ee.rgba32f=H0);var Fe=[];Object.keys(Ee).forEach(function(Ze){var st=Ee[Ze];Fe[st]=Ze});var He=0,qe={};function ot(Ze){this.id=He++,this.refCount=1,this.renderbuffer=Ze,this.format=Xo,this.width=0,this.height=0,Ue.profile&&(this.stats={size:0})}ot.prototype.decRef=function(){--this.refCount<=0&&lt(this)};function lt(Ze){var st=Ze.renderbuffer;C(st,"must not double destroy renderbuffer"),b.bindRenderbuffer(za,null),b.deleteRenderbuffer(st),Ze.renderbuffer=null,Ze.refCount=0,delete qe[Ze.id],Ae.renderbufferCount--}function Ke(Ze,st){var ce=new ot(b.createRenderbuffer());qe[ce.id]=ce,Ae.renderbufferCount++;function Re(bt,We){var Tt=0,Ct=0,Yt=Xo;if(typeof bt=="object"&&bt){var ze=bt;if("shape"in ze){var Be=ze.shape;C(Array.isArray(Be)&&Be.length>=2,"invalid renderbuffer shape"),Tt=Be[0]|0,Ct=Be[1]|0}else"radius"in ze&&(Tt=Ct=ze.radius|0),"width"in ze&&(Tt=ze.width|0),"height"in ze&&(Ct=ze.height|0);"format"in ze&&(C.parameter(ze.format,Ee,"invalid renderbuffer format"),Yt=Ee[ze.format])}else typeof bt=="number"?(Tt=bt|0,typeof We=="number"?Ct=We|0:Ct=Tt):bt?C.raise("invalid arguments to renderbuffer constructor"):Tt=Ct=1;if(C(Tt>0&&Ct>0&&Tt<=W.maxRenderbufferSize&&Ct<=W.maxRenderbufferSize,"invalid renderbuffer size"),!(Tt===ce.width&&Ct===ce.height&&Yt===ce.format))return Re.width=ce.width=Tt,Re.height=ce.height=Ct,ce.format=Yt,b.bindRenderbuffer(za,ce.renderbuffer),b.renderbufferStorage(za,Yt,Tt,Ct),C(b.getError()===0,"invalid render buffer format"),Ue.profile&&(ce.stats.size=W0(ce.format,ce.width,ce.height)),Re.format=Fe[ce.format],Re}function it(bt,We){var Tt=bt|0,Ct=We|0||Tt;return Tt===ce.width&&Ct===ce.height||(C(Tt>0&&Ct>0&&Tt<=W.maxRenderbufferSize&&Ct<=W.maxRenderbufferSize,"invalid renderbuffer size"),Re.width=ce.width=Tt,Re.height=ce.height=Ct,b.bindRenderbuffer(za,ce.renderbuffer),b.renderbufferStorage(za,ce.format,Tt,Ct),C(b.getError()===0,"invalid render buffer format"),Ue.profile&&(ce.stats.size=W0(ce.format,ce.width,ce.height))),Re}return Re(Ze,st),Re.resize=it,Re._reglType="renderbuffer",Re._renderbuffer=ce,Ue.profile&&(Re.stats=ce.stats),Re.destroy=function(){ce.decRef()},Re}Ue.profile&&(Ae.getTotalRenderbufferSize=function(){var Ze=0;return Object.keys(qe).forEach(function(st){Ze+=qe[st].stats.size}),Ze});function rt(){te(qe).forEach(function(Ze){Ze.renderbuffer=b.createRenderbuffer(),b.bindRenderbuffer(za,Ze.renderbuffer),b.renderbufferStorage(za,Ze.format,Ze.width,Ze.height)}),b.bindRenderbuffer(za,null)}return{create:Ke,clear:function(){te(qe).forEach(lt)},restore:rt}},Di=36160,Mf=36161,I=3553,_o=34069,ql=36064,Bi=36096,Ir=36128,X0=33306,Y0=36053,ty=36054,Du=36055,ry=36057,ny=36061,iy=36193,ay=5121,oy=5126,$a=6407,Z0=6408,uy=6402,sy=[$a,Z0],Tp=[];Tp[Z0]=4,Tp[$a]=3;var Rf=[];Rf[ay]=1,Rf[oy]=4,Rf[iy]=2;var xo=32854,ly=32855,cy=36194,fy=33189,hy=36168,q0=34041,Bu=35907,py=34836,dy=34842,ya=34843,vy=[xo,ly,cy,Bu,dy,ya,py],Ls={};Ls[Y0]="complete",Ls[ty]="incomplete attachment",Ls[ry]="incomplete dimensions",Ls[Du]="incomplete, missing attachment",Ls[ny]="unsupported";function gy(b,P,W,Ae,Ue,Ee){var Fe={cur:null,next:null,dirty:!1,setFBO:null},He=["rgba"],qe=["rgba4","rgb565","rgb5 a1"];P.ext_srgb&&qe.push("srgba"),P.ext_color_buffer_half_float&&qe.push("rgba16f","rgb16f"),P.webgl_color_buffer_float&&qe.push("rgba32f");var ot=["uint8"];P.oes_texture_half_float&&ot.push("half float","float16"),P.oes_texture_float&&ot.push("float","float32");function lt(nt,_t,xt){this.target=nt,this.texture=_t,this.renderbuffer=xt;var ur=0,nr=0;_t?(ur=_t.width,nr=_t.height):xt&&(ur=xt.width,nr=xt.height),this.width=ur,this.height=nr}function Ke(nt){nt&&(nt.texture&&nt.texture._texture.decRef(),nt.renderbuffer&&nt.renderbuffer._renderbuffer.decRef())}function rt(nt,_t,xt){if(!!nt)if(nt.texture){var ur=nt.texture._texture,nr=Math.max(1,ur.width),Et=Math.max(1,ur.height);C(nr===_t&&Et===xt,"inconsistent width/height for supplied texture"),ur.refCount+=1}else{var wt=nt.renderbuffer._renderbuffer;C(wt.width===_t&&wt.height===xt,"inconsistent width/height for renderbuffer"),wt.refCount+=1}}function Ze(nt,_t){_t&&(_t.texture?b.framebufferTexture2D(Di,nt,_t.target,_t.texture._texture.texture,0):b.framebufferRenderbuffer(Di,nt,Mf,_t.renderbuffer._renderbuffer.renderbuffer))}function st(nt){var _t=I,xt=null,ur=null,nr=nt;typeof nt=="object"&&(nr=nt.data,"target"in nt&&(_t=nt.target|0)),C.type(nr,"function","invalid attachment data");var Et=nr._reglType;return Et==="texture2d"?(xt=nr,C(_t===I)):Et==="textureCube"?(xt=nr,C(_t>=_o&&_t<_o+6,"invalid cube map target")):Et==="renderbuffer"?(ur=nr,_t=Mf):C.raise("invalid regl object for attachment"),new lt(_t,xt,ur)}function ce(nt,_t,xt,ur,nr){if(xt){var Et=Ae.create2D({width:nt,height:_t,format:ur,type:nr});return Et._texture.refCount=0,new lt(I,Et,null)}else{var wt=Ue.create({width:nt,height:_t,format:ur});return wt._renderbuffer.refCount=0,new lt(Mf,null,wt)}}function Re(nt){return nt&&(nt.texture||nt.renderbuffer)}function it(nt,_t,xt){nt&&(nt.texture?nt.texture.resize(_t,xt):nt.renderbuffer&&nt.renderbuffer.resize(_t,xt),nt.width=_t,nt.height=xt)}var bt=0,We={};function Tt(){this.id=bt++,We[this.id]=this,this.framebuffer=b.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ct(nt){nt.colorAttachments.forEach(Ke),Ke(nt.depthAttachment),Ke(nt.stencilAttachment),Ke(nt.depthStencilAttachment)}function Yt(nt){var _t=nt.framebuffer;C(_t,"must not double destroy framebuffer"),b.deleteFramebuffer(_t),nt.framebuffer=null,Ee.framebufferCount--,delete We[nt.id]}function ze(nt){var _t;b.bindFramebuffer(Di,nt.framebuffer);var xt=nt.colorAttachments;for(_t=0;_t<xt.length;++_t)Ze(ql+_t,xt[_t]);for(_t=xt.length;_t<W.maxColorAttachments;++_t)b.framebufferTexture2D(Di,ql+_t,I,null,0);b.framebufferTexture2D(Di,X0,I,null,0),b.framebufferTexture2D(Di,Bi,I,null,0),b.framebufferTexture2D(Di,Ir,I,null,0),Ze(Bi,nt.depthAttachment),Ze(Ir,nt.stencilAttachment),Ze(X0,nt.depthStencilAttachment);var ur=b.checkFramebufferStatus(Di);!b.isContextLost()&&ur!==Y0&&C.raise("framebuffer configuration not supported, status = "+Ls[ur]),b.bindFramebuffer(Di,Fe.next?Fe.next.framebuffer:null),Fe.cur=Fe.next,b.getError()}function Be(nt,_t){var xt=new Tt;Ee.framebufferCount++;function ur(Et,wt){var Kt;C(Fe.next!==xt,"can not update framebuffer which is currently in use");var lr=0,cr=0,Wr=!0,pn=!0,_r=null,zn=!0,un="rgba",Tn="uint8",yn=1,In=null,$n=null,Yn=null,_n=!1;if(typeof Et=="number")lr=Et|0,cr=wt|0||lr;else if(!Et)lr=cr=1;else{C.type(Et,"object","invalid arguments for framebuffer");var dr=Et;if("shape"in dr){var Gn=dr.shape;C(Array.isArray(Gn)&&Gn.length>=2,"invalid shape for framebuffer"),lr=Gn[0],cr=Gn[1]}else"radius"in dr&&(lr=cr=dr.radius),"width"in dr&&(lr=dr.width),"height"in dr&&(cr=dr.height);("color"in dr||"colors"in dr)&&(_r=dr.color||dr.colors,Array.isArray(_r)&&C(_r.length===1||P.webgl_draw_buffers,"multiple render targets not supported")),_r||("colorCount"in dr&&(yn=dr.colorCount|0,C(yn>0,"invalid color buffer count")),"colorTexture"in dr&&(zn=!!dr.colorTexture,un="rgba4"),"colorType"in dr&&(Tn=dr.colorType,zn?(C(P.oes_texture_float||!(Tn==="float"||Tn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),C(P.oes_texture_half_float||!(Tn==="half float"||Tn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Tn==="half float"||Tn==="float16"?(C(P.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),un="rgba16f"):(Tn==="float"||Tn==="float32")&&(C(P.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),un="rgba32f"),C.oneOf(Tn,ot,"invalid color type")),"colorFormat"in dr&&(un=dr.colorFormat,He.indexOf(un)>=0?zn=!0:qe.indexOf(un)>=0?zn=!1:C.optional(function(){zn?C.oneOf(dr.colorFormat,He,"invalid color format for texture"):C.oneOf(dr.colorFormat,qe,"invalid color format for renderbuffer")}))),("depthTexture"in dr||"depthStencilTexture"in dr)&&(_n=!!(dr.depthTexture||dr.depthStencilTexture),C(!_n||P.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in dr&&(typeof dr.depth=="boolean"?Wr=dr.depth:(In=dr.depth,pn=!1)),"stencil"in dr&&(typeof dr.stencil=="boolean"?pn=dr.stencil:($n=dr.stencil,Wr=!1)),"depthStencil"in dr&&(typeof dr.depthStencil=="boolean"?Wr=pn=dr.depthStencil:(Yn=dr.depthStencil,Wr=!1,pn=!1))}var Ur=null,wn=null,er=null,mr=null;if(Array.isArray(_r))Ur=_r.map(st);else if(_r)Ur=[st(_r)];else for(Ur=new Array(yn),Kt=0;Kt<yn;++Kt)Ur[Kt]=ce(lr,cr,zn,un,Tn);C(P.webgl_draw_buffers||Ur.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),C(Ur.length<=W.maxColorAttachments,"too many color attachments, not supported"),lr=lr||Ur[0].width,cr=cr||Ur[0].height,In?wn=st(In):Wr&&!pn&&(wn=ce(lr,cr,_n,"depth","uint32")),$n?er=st($n):pn&&!Wr&&(er=ce(lr,cr,!1,"stencil","uint8")),Yn?mr=st(Yn):!In&&!$n&&pn&&Wr&&(mr=ce(lr,cr,_n,"depth stencil","depth stencil")),C(!!In+!!$n+!!Yn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Xr=null;for(Kt=0;Kt<Ur.length;++Kt)if(rt(Ur[Kt],lr,cr),C(!Ur[Kt]||Ur[Kt].texture&&sy.indexOf(Ur[Kt].texture._texture.format)>=0||Ur[Kt].renderbuffer&&vy.indexOf(Ur[Kt].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Kt+" is invalid"),Ur[Kt]&&Ur[Kt].texture){var En=Tp[Ur[Kt].texture._texture.format]*Rf[Ur[Kt].texture._texture.type];Xr===null?Xr=En:C(Xr===En,"all color attachments much have the same number of bits per pixel.")}return rt(wn,lr,cr),C(!wn||wn.texture&&wn.texture._texture.format===uy||wn.renderbuffer&&wn.renderbuffer._renderbuffer.format===fy,"invalid depth attachment for framebuffer object"),rt(er,lr,cr),C(!er||er.renderbuffer&&er.renderbuffer._renderbuffer.format===hy,"invalid stencil attachment for framebuffer object"),rt(mr,lr,cr),C(!mr||mr.texture&&mr.texture._texture.format===q0||mr.renderbuffer&&mr.renderbuffer._renderbuffer.format===q0,"invalid depth-stencil attachment for framebuffer object"),Ct(xt),xt.width=lr,xt.height=cr,xt.colorAttachments=Ur,xt.depthAttachment=wn,xt.stencilAttachment=er,xt.depthStencilAttachment=mr,ur.color=Ur.map(Re),ur.depth=Re(wn),ur.stencil=Re(er),ur.depthStencil=Re(mr),ur.width=xt.width,ur.height=xt.height,ze(xt),ur}function nr(Et,wt){C(Fe.next!==xt,"can not resize a framebuffer which is currently in use");var Kt=Math.max(Et|0,1),lr=Math.max(wt|0||Kt,1);if(Kt===xt.width&&lr===xt.height)return ur;for(var cr=xt.colorAttachments,Wr=0;Wr<cr.length;++Wr)it(cr[Wr],Kt,lr);return it(xt.depthAttachment,Kt,lr),it(xt.stencilAttachment,Kt,lr),it(xt.depthStencilAttachment,Kt,lr),xt.width=ur.width=Kt,xt.height=ur.height=lr,ze(xt),ur}return ur(nt,_t),i(ur,{resize:nr,_reglType:"framebuffer",_framebuffer:xt,destroy:function(){Yt(xt),Ct(xt)},use:function(Et){Fe.setFBO({framebuffer:ur},Et)}})}function kt(nt){var _t=Array(6);function xt(nr){var Et;C(_t.indexOf(Fe.next)<0,"can not update framebuffer which is currently in use");var wt={color:null},Kt=0,lr=null,cr="rgba",Wr="uint8",pn=1;if(typeof nr=="number")Kt=nr|0;else if(!nr)Kt=1;else{C.type(nr,"object","invalid arguments for framebuffer");var _r=nr;if("shape"in _r){var zn=_r.shape;C(Array.isArray(zn)&&zn.length>=2,"invalid shape for framebuffer"),C(zn[0]===zn[1],"cube framebuffer must be square"),Kt=zn[0]}else"radius"in _r&&(Kt=_r.radius|0),"width"in _r?(Kt=_r.width|0,"height"in _r&&C(_r.height===Kt,"must be square")):"height"in _r&&(Kt=_r.height|0);("color"in _r||"colors"in _r)&&(lr=_r.color||_r.colors,Array.isArray(lr)&&C(lr.length===1||P.webgl_draw_buffers,"multiple render targets not supported")),lr||("colorCount"in _r&&(pn=_r.colorCount|0,C(pn>0,"invalid color buffer count")),"colorType"in _r&&(C.oneOf(_r.colorType,ot,"invalid color type"),Wr=_r.colorType),"colorFormat"in _r&&(cr=_r.colorFormat,C.oneOf(_r.colorFormat,He,"invalid color format for texture"))),"depth"in _r&&(wt.depth=_r.depth),"stencil"in _r&&(wt.stencil=_r.stencil),"depthStencil"in _r&&(wt.depthStencil=_r.depthStencil)}var un;if(lr)if(Array.isArray(lr))for(un=[],Et=0;Et<lr.length;++Et)un[Et]=lr[Et];else un=[lr];else{un=Array(pn);var Tn={radius:Kt,format:cr,type:Wr};for(Et=0;Et<pn;++Et)un[Et]=Ae.createCube(Tn)}for(wt.color=Array(un.length),Et=0;Et<un.length;++Et){var yn=un[Et];C(typeof yn=="function"&&yn._reglType==="textureCube","invalid cube map"),Kt=Kt||yn.width,C(yn.width===Kt&&yn.height===Kt,"invalid cube map shape"),wt.color[Et]={target:_o,data:un[Et]}}for(Et=0;Et<6;++Et){for(var In=0;In<un.length;++In)wt.color[In].target=_o+Et;Et>0&&(wt.depth=_t[0].depth,wt.stencil=_t[0].stencil,wt.depthStencil=_t[0].depthStencil),_t[Et]?_t[Et](wt):_t[Et]=Be(wt)}return i(xt,{width:Kt,height:Kt,color:un})}function ur(nr){var Et,wt=nr|0;if(C(wt>0&&wt<=W.maxCubeMapSize,"invalid radius for cube fbo"),wt===xt.width)return xt;var Kt=xt.color;for(Et=0;Et<Kt.length;++Et)Kt[Et].resize(wt);for(Et=0;Et<6;++Et)_t[Et].resize(wt);return xt.width=xt.height=wt,xt}return xt(nt),i(xt,{faces:_t,resize:ur,_reglType:"framebufferCube",destroy:function(){_t.forEach(function(nr){nr.destroy()})}})}function mt(){Fe.cur=null,Fe.next=null,Fe.dirty=!0,te(We).forEach(function(nt){nt.framebuffer=b.createFramebuffer(),ze(nt)})}return i(Fe,{getFramebuffer:function(nt){if(typeof nt=="function"&&nt._reglType==="framebuffer"){var _t=nt._framebuffer;if(_t instanceof Tt)return _t}return null},create:Be,createCube:kt,clear:function(){te(We).forEach(Yt)},restore:mt})}var yy=5126,K0=34962,Kl=34963,wp=["attributes","elements","offset","count","primitive","instances"];function Mp(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=yy,this.offset=0,this.stride=0,this.divisor=0}function _y(b,P,W,Ae,Ue,Ee,Fe){for(var He=W.maxAttributes,qe=new Array(He),ot=0;ot<He;++ot)qe[ot]=new Mp;var lt=0,Ke={},rt={Record:Mp,scope:{},state:qe,currentVAO:null,targetVAO:null,restore:st()?Ct:function(){},createVAO:Yt,getVAO:Re,destroyBuffer:Ze,setVAO:st()?it:bt,clear:st()?We:function(){}};function Ze(ze){for(var Be=0;Be<qe.length;++Be){var kt=qe[Be];kt.buffer===ze&&(b.disableVertexAttribArray(Be),kt.buffer=null)}}function st(){return P.oes_vertex_array_object}function ce(){return P.angle_instanced_arrays}function Re(ze){return typeof ze=="function"&&ze._vao?ze._vao:null}function it(ze){if(ze!==rt.currentVAO){var Be=st();ze?Be.bindVertexArrayOES(ze.vao):Be.bindVertexArrayOES(null),rt.currentVAO=ze}}function bt(ze){if(ze!==rt.currentVAO){if(ze)ze.bindAttrs();else{for(var Be=ce(),kt=0;kt<qe.length;++kt){var mt=qe[kt];mt.buffer?(b.enableVertexAttribArray(kt),mt.buffer.bind(),b.vertexAttribPointer(kt,mt.size,mt.type,mt.normalized,mt.stride,mt.offfset),Be&&mt.divisor&&Be.vertexAttribDivisorANGLE(kt,mt.divisor)):(b.disableVertexAttribArray(kt),b.vertexAttrib4f(kt,mt.x,mt.y,mt.z,mt.w))}Fe.elements?b.bindBuffer(Kl,Fe.elements.buffer.buffer):b.bindBuffer(Kl,null)}rt.currentVAO=ze}}function We(){te(Ke).forEach(function(ze){ze.destroy()})}function Tt(){this.id=++lt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var ze=st();ze?this.vao=ze.createVertexArrayOES():this.vao=null,Ke[this.id]=this,this.buffers=[]}Tt.prototype.bindAttrs=function(){for(var ze=ce(),Be=this.attributes,kt=0;kt<Be.length;++kt){var mt=Be[kt];mt.buffer?(b.enableVertexAttribArray(kt),b.bindBuffer(K0,mt.buffer.buffer),b.vertexAttribPointer(kt,mt.size,mt.type,mt.normalized,mt.stride,mt.offset),ze&&mt.divisor&&ze.vertexAttribDivisorANGLE(kt,mt.divisor)):(b.disableVertexAttribArray(kt),b.vertexAttrib4f(kt,mt.x,mt.y,mt.z,mt.w))}for(var nt=Be.length;nt<He;++nt)b.disableVertexAttribArray(nt);var _t=Ee.getElements(this.elements);_t?b.bindBuffer(Kl,_t.buffer.buffer):b.bindBuffer(Kl,null)},Tt.prototype.refresh=function(){var ze=st();ze&&(ze.bindVertexArrayOES(this.vao),this.bindAttrs(),rt.currentVAO=null,ze.bindVertexArrayOES(null))},Tt.prototype.destroy=function(){if(this.vao){var ze=st();this===rt.currentVAO&&(rt.currentVAO=null,ze.bindVertexArrayOES(null)),ze.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Ke[this.id]&&(delete Ke[this.id],Ae.vaoCount-=1)};function Ct(){var ze=st();ze&&te(Ke).forEach(function(Be){Be.refresh()})}function Yt(ze){var Be=new Tt;Ae.vaoCount+=1;function kt(mt){var nt;if(Array.isArray(mt))nt=mt,Be.elements&&Be.ownsElements&&Be.elements.destroy(),Be.elements=null,Be.ownsElements=!1,Be.offset=0,Be.count=0,Be.instances=-1,Be.primitive=4;else{if(C(typeof mt=="object","invalid arguments for create vao"),C("attributes"in mt,"must specify attributes for vao"),mt.elements){var _t=mt.elements;Be.ownsElements?typeof _t=="function"&&_t._reglType==="elements"?(Be.elements.destroy(),Be.ownsElements=!1):(Be.elements(_t),Be.ownsElements=!1):Ee.getElements(mt.elements)?(Be.elements=mt.elements,Be.ownsElements=!1):(Be.elements=Ee.create(mt.elements),Be.ownsElements=!0)}else Be.elements=null,Be.ownsElements=!1;nt=mt.attributes,Be.offset=0,Be.count=-1,Be.instances=-1,Be.primitive=4,Be.elements&&(Be.count=Be.elements._elements.vertCount,Be.primitive=Be.elements._elements.primType),"offset"in mt&&(Be.offset=mt.offset|0),"count"in mt&&(Be.count=mt.count|0),"instances"in mt&&(Be.instances=mt.instances|0),"primitive"in mt&&(C(mt.primitive in po,"bad primitive type: "+mt.primitive),Be.primitive=po[mt.primitive]),C.optional(function(){for(var Wr=Object.keys(mt),pn=0;pn<Wr.length;++pn)C(wp.indexOf(Wr[pn])>=0,'invalid option for vao: "'+Wr[pn]+'" valid options are '+wp)}),C(Array.isArray(nt),"attributes must be an array")}C(nt.length<He,"too many attributes"),C(nt.length>0,"must specify at least one attribute");var xt={},ur=Be.attributes;ur.length=nt.length;for(var nr=0;nr<nt.length;++nr){var Et=nt[nr],wt=ur[nr]=new Mp,Kt=Et.data||Et;if(Array.isArray(Kt)||n(Kt)||B(Kt)){var lr;Be.buffers[nr]&&(lr=Be.buffers[nr],n(Kt)&&lr._buffer.byteLength>=Kt.byteLength?lr.subdata(Kt):(lr.destroy(),Be.buffers[nr]=null)),Be.buffers[nr]||(lr=Be.buffers[nr]=Ue.create(Et,K0,!1,!0)),wt.buffer=Ue.getBuffer(lr),wt.size=wt.buffer.dimension|0,wt.normalized=!1,wt.type=wt.buffer.dtype,wt.offset=0,wt.stride=0,wt.divisor=0,wt.state=1,xt[nr]=1}else Ue.getBuffer(Et)?(wt.buffer=Ue.getBuffer(Et),wt.size=wt.buffer.dimension|0,wt.normalized=!1,wt.type=wt.buffer.dtype,wt.offset=0,wt.stride=0,wt.divisor=0,wt.state=1):Ue.getBuffer(Et.buffer)?(wt.buffer=Ue.getBuffer(Et.buffer),wt.size=(+Et.size||wt.buffer.dimension)|0,wt.normalized=!!Et.normalized||!1,"type"in Et?(C.parameter(Et.type,Lu,"invalid buffer type"),wt.type=Lu[Et.type]):wt.type=wt.buffer.dtype,wt.offset=(Et.offset||0)|0,wt.stride=(Et.stride||0)|0,wt.divisor=(Et.divisor||0)|0,wt.state=1,C(wt.size>=1&&wt.size<=4,"size must be between 1 and 4"),C(wt.offset>=0,"invalid offset"),C(wt.stride>=0&&wt.stride<=255,"stride must be between 0 and 255"),C(wt.divisor>=0,"divisor must be positive"),C(!wt.divisor||!!P.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Et?(C(nr>0,"first attribute must not be a constant"),wt.x=+Et.x||0,wt.y=+Et.y||0,wt.z=+Et.z||0,wt.w=+Et.w||0,wt.state=2):C(!1,"invalid attribute spec for location "+nr)}for(var cr=0;cr<Be.buffers.length;++cr)!xt[cr]&&Be.buffers[cr]&&(Be.buffers[cr].destroy(),Be.buffers[cr]=null);return Be.refresh(),kt}return kt.destroy=function(){for(var mt=0;mt<Be.buffers.length;++mt)Be.buffers[mt]&&Be.buffers[mt].destroy();Be.buffers.length=0,Be.ownsElements&&(Be.elements.destroy(),Be.elements=null,Be.ownsElements=!1),Be.destroy()},kt._vao=Be,kt._reglType="vao",kt(ze)}return rt}var Of=35632,Ql=35633,Lf=35718,xy=35721;function Q0(b,P,W,Ae){var Ue={},Ee={};function Fe(ce,Re,it,bt){this.name=ce,this.id=Re,this.location=it,this.info=bt}function He(ce,Re){for(var it=0;it<ce.length;++it)if(ce[it].id===Re.id){ce[it].location=Re.location;return}ce.push(Re)}function qe(ce,Re,it){var bt=ce===Of?Ue:Ee,We=bt[Re];if(!We){var Tt=P.str(Re);We=b.createShader(ce),b.shaderSource(We,Tt),b.compileShader(We),C.shaderError(b,We,Tt,ce,it),bt[Re]=We}return We}var ot={},lt=[],Ke=0;function rt(ce,Re){this.id=Ke++,this.fragId=ce,this.vertId=Re,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ae.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ze(ce,Re,it){var bt,We,Tt=qe(Of,ce.fragId),Ct=qe(Ql,ce.vertId),Yt=ce.program=b.createProgram();if(b.attachShader(Yt,Tt),b.attachShader(Yt,Ct),it)for(bt=0;bt<it.length;++bt){var ze=it[bt];b.bindAttribLocation(Yt,ze[0],ze[1])}b.linkProgram(Yt),C.linkError(b,Yt,P.str(ce.fragId),P.str(ce.vertId),Re);var Be=b.getProgramParameter(Yt,Lf);Ae.profile&&(ce.stats.uniformsCount=Be);var kt=ce.uniforms;for(bt=0;bt<Be;++bt)if(We=b.getActiveUniform(Yt,bt),We)if(We.size>1)for(var mt=0;mt<We.size;++mt){var nt=We.name.replace("[0]","["+mt+"]");He(kt,new Fe(nt,P.id(nt),b.getUniformLocation(Yt,nt),We))}else He(kt,new Fe(We.name,P.id(We.name),b.getUniformLocation(Yt,We.name),We));var _t=b.getProgramParameter(Yt,xy);Ae.profile&&(ce.stats.attributesCount=_t);var xt=ce.attributes;for(bt=0;bt<_t;++bt)We=b.getActiveAttrib(Yt,bt),We&&He(xt,new Fe(We.name,P.id(We.name),b.getAttribLocation(Yt,We.name),We))}Ae.profile&&(W.getMaxUniformsCount=function(){var ce=0;return lt.forEach(function(Re){Re.stats.uniformsCount>ce&&(ce=Re.stats.uniformsCount)}),ce},W.getMaxAttributesCount=function(){var ce=0;return lt.forEach(function(Re){Re.stats.attributesCount>ce&&(ce=Re.stats.attributesCount)}),ce});function st(){Ue={},Ee={};for(var ce=0;ce<lt.length;++ce)Ze(lt[ce],null,lt[ce].attributes.map(function(Re){return[Re.location,Re.name]}))}return{clear:function(){var ce=b.deleteShader.bind(b);te(Ue).forEach(ce),Ue={},te(Ee).forEach(ce),Ee={},lt.forEach(function(Re){b.deleteProgram(Re.program)}),lt.length=0,ot={},W.shaderCount=0},program:function(ce,Re,it,bt){C.command(ce>=0,"missing vertex shader",it),C.command(Re>=0,"missing fragment shader",it);var We=ot[Re];We||(We=ot[Re]={});var Tt=We[ce];if(Tt&&(Tt.refCount++,!bt))return Tt;var Ct=new rt(Re,ce);return W.shaderCount++,Ze(Ct,it,bt),Tt||(We[ce]=Ct),lt.push(Ct),i(Ct,{destroy:function(){if(Ct.refCount--,Ct.refCount<=0){b.deleteProgram(Ct.program);var Yt=lt.indexOf(Ct);lt.splice(Yt,1),W.shaderCount--}We[Ct.vertId].refCount<=0&&(b.deleteShader(Ee[Ct.vertId]),delete Ee[Ct.vertId],delete ot[Ct.fragId][Ct.vertId]),Object.keys(ot[Ct.fragId]).length||(b.deleteShader(Ue[Ct.fragId]),delete Ue[Ct.fragId],delete ot[Ct.fragId])}})},restore:st,shader:qe,frag:-1,vert:-1}}var Ey=6408,Ni=5121,Rp=3333,Ga=5126;function Ki(b,P,W,Ae,Ue,Ee,Fe){function He(lt){var Ke;P.next===null?(C(Ue.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ke=Ni):(C(P.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ke=P.next.colorAttachments[0].texture._texture.type,C.optional(function(){Ee.oes_texture_float?(C(Ke===Ni||Ke===Ga,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ke===Ga&&C(Fe.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):C(Ke===Ni,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var rt=0,Ze=0,st=Ae.framebufferWidth,ce=Ae.framebufferHeight,Re=null;n(lt)?Re=lt:lt&&(C.type(lt,"object","invalid arguments to regl.read()"),rt=lt.x|0,Ze=lt.y|0,C(rt>=0&&rt<Ae.framebufferWidth,"invalid x offset for regl.read"),C(Ze>=0&&Ze<Ae.framebufferHeight,"invalid y offset for regl.read"),st=(lt.width||Ae.framebufferWidth-rt)|0,ce=(lt.height||Ae.framebufferHeight-Ze)|0,Re=lt.data||null),Re&&(Ke===Ni?C(Re instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ke===Ga&&C(Re instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),C(st>0&&st+rt<=Ae.framebufferWidth,"invalid width for read pixels"),C(ce>0&&ce+Ze<=Ae.framebufferHeight,"invalid height for read pixels"),W();var it=st*ce*4;return Re||(Ke===Ni?Re=new Uint8Array(it):Ke===Ga&&(Re=Re||new Float32Array(it))),C.isTypedArray(Re,"data buffer for regl.read() must be a typedarray"),C(Re.byteLength>=it,"data buffer for regl.read() too small"),b.pixelStorei(Rp,4),b.readPixels(rt,Ze,st,ce,Ey,Ke,Re),Re}function qe(lt){var Ke;return P.setFBO({framebuffer:lt.framebuffer},function(){Ke=He(lt)}),Ke}function ot(lt){return!lt||!("framebuffer"in lt)?He(lt):qe(lt)}return ot}function Fs(b){return Array.prototype.slice.call(b)}function Nu(b){return Fs(b).join("")}function J0(){var b=0,P=[],W=[];function Ae(Ke){for(var rt=0;rt<W.length;++rt)if(W[rt]===Ke)return P[rt];var Ze="g"+b++;return P.push(Ze),W.push(Ke),Ze}function Ue(){var Ke=[];function rt(){Ke.push.apply(Ke,Fs(arguments))}var Ze=[];function st(){var ce="v"+b++;return Ze.push(ce),arguments.length>0&&(Ke.push(ce,"="),Ke.push.apply(Ke,Fs(arguments)),Ke.push(";")),ce}return i(rt,{def:st,toString:function(){return Nu([Ze.length>0?"var "+Ze.join(",")+";":"",Nu(Ke)])}})}function Ee(){var Ke=Ue(),rt=Ue(),Ze=Ke.toString,st=rt.toString;function ce(Re,it){rt(Re,it,"=",Ke.def(Re,it),";")}return i(function(){Ke.apply(Ke,Fs(arguments))},{def:Ke.def,entry:Ke,exit:rt,save:ce,set:function(Re,it,bt){ce(Re,it),Ke(Re,it,"=",bt,";")},toString:function(){return Ze()+st()}})}function Fe(){var Ke=Nu(arguments),rt=Ee(),Ze=Ee(),st=rt.toString,ce=Ze.toString;return i(rt,{then:function(){return rt.apply(rt,Fs(arguments)),this},else:function(){return Ze.apply(Ze,Fs(arguments)),this},toString:function(){var Re=ce();return Re&&(Re="else{"+Re+"}"),Nu(["if(",Ke,"){",st(),"}",Re])}})}var He=Ue(),qe={};function ot(Ke,rt){var Ze=[];function st(){var We="a"+Ze.length;return Ze.push(We),We}rt=rt||0;for(var ce=0;ce<rt;++ce)st();var Re=Ee(),it=Re.toString,bt=qe[Ke]=i(Re,{arg:st,toString:function(){return Nu(["function(",Ze.join(),"){",it(),"}"])}});return bt}function lt(){var Ke=['"use strict";',He,"return {"];Object.keys(qe).forEach(function(ce){Ke.push('"',ce,'":',qe[ce].toString(),",")}),Ke.push("}");var rt=Nu(Ke).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Ze=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,st=Ze?r.Function.apply(null,P.concat(rt)):Function.apply(null,P.concat(rt));return st.apply(null,W)}return{global:He,link:Ae,block:Ue,proc:ot,scope:Ee,cond:Fe,compile:lt}}var Ha="xyzw".split(""),Eo=5121,Uu=1,Op=2,Is=0,Lp=1,Ff=2,Un=3,ks=4,Fp=5,_a=6,If="dither",Jl="blend.enable",Yo="blend.color",kf="blend.equation",ni="blend.func",Pf="depth.enable",ev="depth.func",tv="depth.range",rv="depth.mask",ec="colorMask",nv="cull.enable",Ps="cull.face",Df="frontFace",Ip="lineWidth",iv="polygonOffset.enable",zu="polygonOffset.offset",av="sample.alpha",ov="sample.enable",tc="sample.coverage",kp="stencil.enable",uv="stencil.mask",Pp="stencil.func",Dp="stencil.opFront",Ds="stencil.opBack",Bf="scissor.enable",Nf="scissor.box",xa="viewport",Bs="profile",Zo="framebuffer",Ns="vert",qo="frag",$u="elements",Ko="primitive",Qo="count",Uf="offset",rc="instances",nc="vao",ic="Width",zf="Height",Jo=Zo+ic,Us=Zo+zf,Bp=xa+ic,Or=xa+zf,sv="drawingBuffer",lv=sv+ic,zs=sv+zf,cv=[ni,kf,Pp,Dp,Ds,tc,xa,Nf,zu],$s=34962,Np=34963,Qi=35632,by=35633,ac=3553,Up=34067,fv=2884,hv=3042,Ui=3024,eu=2960,zp=2929,pv=3089,$f=32823,dv=32926,$p=32928,Gf=5126,Gs=35664,Hs=35665,Ea=35666,Gp=5124,ba=35667,oc=35668,uc=35669,sc=35670,Hf=35671,Vf=35672,jf=35673,Vs=35674,js=35675,lc=35676,Ws=35678,Xs=35680,oi=4,Mi=1028,Gu=1029,vv=2304,Ys=2305,Zs=32775,gv=32776,mv=519,tu=7680,Hp=0,Hu=1,qs=32774,Cy=513,Vp=36160,yv=36064,zi={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},jp=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],bo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Va={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},cc={frag:Qi,vert:by},Wp={cw:vv,ccw:Ys};function fc(b){return Array.isArray(b)||n(b)||B(b)}function hc(b){return b.sort(function(P,W){return P===xa?-1:W===xa?1:P<W?-1:1})}function Sn(b,P,W,Ae){this.thisDep=b,this.contextDep=P,this.propDep=W,this.append=Ae}function ja(b){return b&&!(b.thisDep||b.contextDep||b.propDep)}function xn(b){return new Sn(!1,!1,!1,b)}function yi(b,P){var W=b.type;if(W===Is){var Ae=b.data.length;return new Sn(!0,Ae>=1,Ae>=2,P)}else if(W===ks){var Ue=b.data;return new Sn(Ue.thisDep,Ue.contextDep,Ue.propDep,P)}else{if(W===Fp)return new Sn(!1,!1,!1,P);if(W===_a){for(var Ee=!1,Fe=!1,He=!1,qe=0;qe<b.data.length;++qe){var ot=b.data[qe];if(ot.type===Lp)He=!0;else if(ot.type===Ff)Fe=!0;else if(ot.type===Un)Ee=!0;else if(ot.type===Is){Ee=!0;var lt=ot.data;lt>=1&&(Fe=!0),lt>=2&&(He=!0)}else ot.type===ks&&(Ee=Ee||ot.data.thisDep,Fe=Fe||ot.data.contextDep,He=He||ot.data.propDep)}return new Sn(Ee,Fe,He,P)}else return new Sn(W===Un,W===Ff,W===Lp,P)}}var Wa=new Sn(!1,!1,!1,function(){});function _v(b,P,W,Ae,Ue,Ee,Fe,He,qe,ot,lt,Ke,rt,Ze,st){var ce=ot.Record,Re={add:32774,subtract:32778,"reverse subtract":32779};W.ext_blend_minmax&&(Re.min=Zs,Re.max=gv);var it=W.angle_instanced_arrays,bt=W.webgl_draw_buffers,We=W.oes_vertex_array_object,Tt={dirty:!0,profile:st.profile},Ct={},Yt=[],ze={},Be={};function kt(z){return z.replace(".","_")}function mt(z,L,Z){var he=kt(z);Yt.push(z),Ct[he]=Tt[he]=!!Z,ze[he]=L}function nt(z,L,Z){var he=kt(z);Yt.push(z),Array.isArray(Z)?(Tt[he]=Z.slice(),Ct[he]=Z.slice()):Tt[he]=Ct[he]=Z,Be[he]=L}mt(If,Ui),mt(Jl,hv),nt(Yo,"blendColor",[0,0,0,0]),nt(kf,"blendEquationSeparate",[qs,qs]),nt(ni,"blendFuncSeparate",[Hu,Hp,Hu,Hp]),mt(Pf,zp,!0),nt(ev,"depthFunc",Cy),nt(tv,"depthRange",[0,1]),nt(rv,"depthMask",!0),nt(ec,ec,[!0,!0,!0,!0]),mt(nv,fv),nt(Ps,"cullFace",Gu),nt(Df,Df,Ys),nt(Ip,Ip,1),mt(iv,$f),nt(zu,"polygonOffset",[0,0]),mt(av,dv),mt(ov,$p),nt(tc,"sampleCoverage",[1,!1]),mt(kp,eu),nt(uv,"stencilMask",-1),nt(Pp,"stencilFunc",[mv,0,-1]),nt(Dp,"stencilOpSeparate",[Mi,tu,tu,tu]),nt(Ds,"stencilOpSeparate",[Gu,tu,tu,tu]),mt(Bf,pv),nt(Nf,"scissor",[0,0,b.drawingBufferWidth,b.drawingBufferHeight]),nt(xa,xa,[0,0,b.drawingBufferWidth,b.drawingBufferHeight]);var _t={gl:b,context:rt,strings:P,next:Ct,current:Tt,draw:Ke,elements:Ee,buffer:Ue,shader:lt,attributes:ot.state,vao:ot,uniforms:qe,framebuffer:He,extensions:W,timer:Ze,isBufferArgs:fc},xt={primTypes:po,compareFuncs:bo,blendFuncs:zi,blendEquations:Re,stencilOps:Va,glTypes:Lu,orientationType:Wp};C.optional(function(){_t.isArrayLike=mn}),bt&&(xt.backBuffer=[Gu],xt.drawBuffer=pi(Ae.maxDrawbuffers,function(z){return z===0?[0]:pi(z,function(L){return yv+L})}));var ur=0;function nr(){var z=J0(),L=z.link,Z=z.global;z.id=ur++,z.batchId="0";var he=L(_t),Te=z.shared={props:"a0"};Object.keys(_t).forEach(function(Q){Te[Q]=Z.def(he,".",Q)}),C.optional(function(){z.CHECK=L(C),z.commandStr=C.guessCommand(),z.command=L(z.commandStr),z.assert=function(Q,G,fe){Q("if(!(",G,"))",this.CHECK,".commandRaise(",L(fe),",",this.command,");")},xt.invalidBlendCombinations=jp});var ie=z.next={},ee=z.current={};Object.keys(Be).forEach(function(Q){Array.isArray(Tt[Q])&&(ie[Q]=Z.def(Te.next,".",Q),ee[Q]=Z.def(Te.current,".",Q))});var oe=z.constants={};Object.keys(xt).forEach(function(Q){oe[Q]=Z.def(JSON.stringify(xt[Q]))}),z.invoke=function(Q,G){switch(G.type){case Is:var fe=["this",Te.context,Te.props,z.batchId];return Q.def(L(G.data),".call(",fe.slice(0,Math.max(G.data.length+1,4)),")");case Lp:return Q.def(Te.props,G.data);case Ff:return Q.def(Te.context,G.data);case Un:return Q.def("this",G.data);case ks:return G.data.append(z,Q),G.data.ref;case Fp:return G.data.toString();case _a:return G.data.map(function(me){return z.invoke(Q,me)})}},z.attribCache={};var D={};return z.scopeAttrib=function(Q){var G=P.id(Q);if(G in D)return D[G];var fe=ot.scope[G];fe||(fe=ot.scope[G]=new ce);var me=D[G]=L(fe);return me},z}function Et(z){var L=z.static,Z=z.dynamic,he;if(Bs in L){var Te=!!L[Bs];he=xn(function(ee,oe){return Te}),he.enable=Te}else if(Bs in Z){var ie=Z[Bs];he=yi(ie,function(ee,oe){return ee.invoke(oe,ie)})}return he}function wt(z,L){var Z=z.static,he=z.dynamic;if(Zo in Z){var Te=Z[Zo];return Te?(Te=He.getFramebuffer(Te),C.command(Te,"invalid framebuffer object"),xn(function(ee,oe){var D=ee.link(Te),Q=ee.shared;oe.set(Q.framebuffer,".next",D);var G=Q.context;return oe.set(G,"."+Jo,D+".width"),oe.set(G,"."+Us,D+".height"),D})):xn(function(ee,oe){var D=ee.shared;oe.set(D.framebuffer,".next","null");var Q=D.context;return oe.set(Q,"."+Jo,Q+"."+lv),oe.set(Q,"."+Us,Q+"."+zs),"null"})}else if(Zo in he){var ie=he[Zo];return yi(ie,function(ee,oe){var D=ee.invoke(oe,ie),Q=ee.shared,G=Q.framebuffer,fe=oe.def(G,".getFramebuffer(",D,")");C.optional(function(){ee.assert(oe,"!"+D+"||"+fe,"invalid framebuffer object")}),oe.set(G,".next",fe);var me=Q.context;return oe.set(me,"."+Jo,fe+"?"+fe+".width:"+me+"."+lv),oe.set(me,"."+Us,fe+"?"+fe+".height:"+me+"."+zs),fe})}else return null}function Kt(z,L,Z){var he=z.static,Te=z.dynamic;function ie(D){if(D in he){var Q=he[D];C.commandType(Q,"object","invalid "+D,Z.commandStr);var G=!0,fe=Q.x|0,me=Q.y|0,Ve,pt;return"width"in Q?(Ve=Q.width|0,C.command(Ve>=0,"invalid "+D,Z.commandStr)):G=!1,"height"in Q?(pt=Q.height|0,C.command(pt>=0,"invalid "+D,Z.commandStr)):G=!1,new Sn(!G&&L&&L.thisDep,!G&&L&&L.contextDep,!G&&L&&L.propDep,function(ht,Bt){var Rt=ht.shared.context,Pt=Ve;"width"in Q||(Pt=Bt.def(Rt,".",Jo,"-",fe));var Dt=pt;return"height"in Q||(Dt=Bt.def(Rt,".",Us,"-",me)),[fe,me,Pt,Dt]})}else if(D in Te){var dt=Te[D],At=yi(dt,function(ht,Bt){var Rt=ht.invoke(Bt,dt);C.optional(function(){ht.assert(Bt,Rt+"&&typeof "+Rt+'==="object"',"invalid "+D)});var Pt=ht.shared.context,Dt=Bt.def(Rt,".x|0"),Nt=Bt.def(Rt,".y|0"),tr=Bt.def('"width" in ',Rt,"?",Rt,".width|0:","(",Pt,".",Jo,"-",Dt,")"),Kr=Bt.def('"height" in ',Rt,"?",Rt,".height|0:","(",Pt,".",Us,"-",Nt,")");return C.optional(function(){ht.assert(Bt,tr+">=0&&"+Kr+">=0","invalid "+D)}),[Dt,Nt,tr,Kr]});return L&&(At.thisDep=At.thisDep||L.thisDep,At.contextDep=At.contextDep||L.contextDep,At.propDep=At.propDep||L.propDep),At}else return L?new Sn(L.thisDep,L.contextDep,L.propDep,function(ht,Bt){var Rt=ht.shared.context;return[0,0,Bt.def(Rt,".",Jo),Bt.def(Rt,".",Us)]}):null}var ee=ie(xa);if(ee){var oe=ee;ee=new Sn(ee.thisDep,ee.contextDep,ee.propDep,function(D,Q){var G=oe.append(D,Q),fe=D.shared.context;return Q.set(fe,"."+Bp,G[2]),Q.set(fe,"."+Or,G[3]),G})}return{viewport:ee,scissor_box:ie(Nf)}}function lr(z,L){var Z=z.static,he=typeof Z[qo]=="string"&&typeof Z[Ns]=="string";if(he){if(Object.keys(L.dynamic).length>0)return null;var Te=L.static,ie=Object.keys(Te);if(ie.length>0&&typeof Te[ie[0]]=="number"){for(var ee=[],oe=0;oe<ie.length;++oe)C(typeof Te[ie[oe]]=="number","must specify all vertex attribute locations when using vaos"),ee.push([Te[ie[oe]]|0,ie[oe]]);return ee}}return null}function cr(z,L,Z){var he=z.static,Te=z.dynamic;function ie(G){if(G in he){var fe=P.id(he[G]);C.optional(function(){lt.shader(cc[G],fe,C.guessCommand())});var me=xn(function(){return fe});return me.id=fe,me}else if(G in Te){var Ve=Te[G];return yi(Ve,function(pt,dt){var At=pt.invoke(dt,Ve),ht=dt.def(pt.shared.strings,".id(",At,")");return C.optional(function(){dt(pt.shared.shader,".shader(",cc[G],",",ht,",",pt.command,");")}),ht})}return null}var ee=ie(qo),oe=ie(Ns),D=null,Q;return ja(ee)&&ja(oe)?(D=lt.program(oe.id,ee.id,null,Z),Q=xn(function(G,fe){return G.link(D)})):Q=new Sn(ee&&ee.thisDep||oe&&oe.thisDep,ee&&ee.contextDep||oe&&oe.contextDep,ee&&ee.propDep||oe&&oe.propDep,function(G,fe){var me=G.shared.shader,Ve;ee?Ve=ee.append(G,fe):Ve=fe.def(me,".",qo);var pt;oe?pt=oe.append(G,fe):pt=fe.def(me,".",Ns);var dt=me+".program("+pt+","+Ve;return C.optional(function(){dt+=","+G.command}),fe.def(dt+")")}),{frag:ee,vert:oe,progVar:Q,program:D}}function Wr(z,L){var Z=z.static,he=z.dynamic,Te={},ie=!1;function ee(){if(nc in Z){var Bt=Z[nc];return Bt!==null&&ot.getVAO(Bt)===null&&(Bt=ot.createVAO(Bt)),ie=!0,Te.vao=Bt,xn(function(Pt){var Dt=ot.getVAO(Bt);return Dt?Pt.link(Dt):"null"})}else if(nc in he){ie=!0;var Rt=he[nc];return yi(Rt,function(Pt,Dt){var Nt=Pt.invoke(Dt,Rt);return Dt.def(Pt.shared.vao+".getVAO("+Nt+")")})}return null}var oe=ee(),D=!1;function Q(){if($u in Z){var Bt=Z[$u];if(Te.elements=Bt,fc(Bt)){var Rt=Te.elements=Ee.create(Bt,!0);Bt=Ee.getElements(Rt),D=!0}else Bt&&(Bt=Ee.getElements(Bt),D=!0,C.command(Bt,"invalid elements",L.commandStr));var Pt=xn(function(Nt,tr){if(Bt){var Kr=Nt.link(Bt);return Nt.ELEMENTS=Kr,Kr}return Nt.ELEMENTS=null,null});return Pt.value=Bt,Pt}else if($u in he){D=!0;var Dt=he[$u];return yi(Dt,function(Nt,tr){var Kr=Nt.shared,Hn=Kr.isBufferArgs,So=Kr.elements,To=Nt.invoke(tr,Dt),wo=tr.def("null"),ui=tr.def(Hn,"(",To,")"),Xa=Nt.cond(ui).then(wo,"=",So,".createStream(",To,");").else(wo,"=",So,".getElements(",To,");");return C.optional(function(){Nt.assert(Xa.else,"!"+To+"||"+wo,"invalid elements")}),tr.entry(Xa),tr.exit(Nt.cond(ui).then(So,".destroyStream(",wo,");")),Nt.ELEMENTS=wo,wo})}else if(ie)return new Sn(oe.thisDep,oe.contextDep,oe.propDep,function(Nt,tr){return tr.def(Nt.shared.vao+".currentVAO?"+Nt.shared.elements+".getElements("+Nt.shared.vao+".currentVAO.elements):null")});return null}var G=Q();function fe(){if(Ko in Z){var Bt=Z[Ko];return Te.primitive=Bt,C.commandParameter(Bt,po,"invalid primitve",L.commandStr),xn(function(Pt,Dt){return po[Bt]})}else if(Ko in he){var Rt=he[Ko];return yi(Rt,function(Pt,Dt){var Nt=Pt.constants.primTypes,tr=Pt.invoke(Dt,Rt);return C.optional(function(){Pt.assert(Dt,tr+" in "+Nt,"invalid primitive, must be one of "+Object.keys(po))}),Dt.def(Nt,"[",tr,"]")})}else{if(D)return ja(G)?G.value?xn(function(Pt,Dt){return Dt.def(Pt.ELEMENTS,".primType")}):xn(function(){return oi}):new Sn(G.thisDep,G.contextDep,G.propDep,function(Pt,Dt){var Nt=Pt.ELEMENTS;return Dt.def(Nt,"?",Nt,".primType:",oi)});if(ie)return new Sn(oe.thisDep,oe.contextDep,oe.propDep,function(Pt,Dt){return Dt.def(Pt.shared.vao+".currentVAO?"+Pt.shared.vao+".currentVAO.primitive:"+oi)})}return null}function me(Bt,Rt){if(Bt in Z){var Pt=Z[Bt]|0;return Rt?Te.offset=Pt:Te.instances=Pt,C.command(!Rt||Pt>=0,"invalid "+Bt,L.commandStr),xn(function(Nt,tr){return Rt&&(Nt.OFFSET=Pt),Pt})}else if(Bt in he){var Dt=he[Bt];return yi(Dt,function(Nt,tr){var Kr=Nt.invoke(tr,Dt);return Rt&&(Nt.OFFSET=Kr,C.optional(function(){Nt.assert(tr,Kr+">=0","invalid "+Bt)})),Kr})}else if(Rt){if(D)return xn(function(Nt,tr){return Nt.OFFSET=0,0});if(ie)return new Sn(oe.thisDep,oe.contextDep,oe.propDep,function(Nt,tr){return tr.def(Nt.shared.vao+".currentVAO?"+Nt.shared.vao+".currentVAO.offset:0")})}else if(ie)return new Sn(oe.thisDep,oe.contextDep,oe.propDep,function(Nt,tr){return tr.def(Nt.shared.vao+".currentVAO?"+Nt.shared.vao+".currentVAO.instances:-1")});return null}var Ve=me(Uf,!0);function pt(){if(Qo in Z){var Bt=Z[Qo]|0;return Te.count=Bt,C.command(typeof Bt=="number"&&Bt>=0,"invalid vertex count",L.commandStr),xn(function(){return Bt})}else if(Qo in he){var Rt=he[Qo];return yi(Rt,function(tr,Kr){var Hn=tr.invoke(Kr,Rt);return C.optional(function(){tr.assert(Kr,"typeof "+Hn+'==="number"&&'+Hn+">=0&&"+Hn+"===("+Hn+"|0)","invalid vertex count")}),Hn})}else if(D)if(ja(G)){if(G)return Ve?new Sn(Ve.thisDep,Ve.contextDep,Ve.propDep,function(tr,Kr){var Hn=Kr.def(tr.ELEMENTS,".vertCount-",tr.OFFSET);return C.optional(function(){tr.assert(Kr,Hn+">=0","invalid vertex offset/element buffer too small")}),Hn}):xn(function(tr,Kr){return Kr.def(tr.ELEMENTS,".vertCount")});var Pt=xn(function(){return-1});return C.optional(function(){Pt.MISSING=!0}),Pt}else{var Dt=new Sn(G.thisDep||Ve.thisDep,G.contextDep||Ve.contextDep,G.propDep||Ve.propDep,function(tr,Kr){var Hn=tr.ELEMENTS;return tr.OFFSET?Kr.def(Hn,"?",Hn,".vertCount-",tr.OFFSET,":-1"):Kr.def(Hn,"?",Hn,".vertCount:-1")});return C.optional(function(){Dt.DYNAMIC=!0}),Dt}else if(ie){var Nt=new Sn(oe.thisDep,oe.contextDep,oe.propDep,function(tr,Kr){return Kr.def(tr.shared.vao,".currentVAO?",tr.shared.vao,".currentVAO.count:-1")});return Nt}return null}var dt=fe(),At=pt(),ht=me(rc,!1);return{elements:G,primitive:dt,count:At,instances:ht,offset:Ve,vao:oe,vaoActive:ie,elementsActive:D,static:Te}}function pn(z,L){var Z=z.static,he=z.dynamic,Te={};return Yt.forEach(function(ie){var ee=kt(ie);function oe(D,Q){if(ie in Z){var G=D(Z[ie]);Te[ee]=xn(function(){return G})}else if(ie in he){var fe=he[ie];Te[ee]=yi(fe,function(me,Ve){return Q(me,Ve,me.invoke(Ve,fe))})}}switch(ie){case nv:case Jl:case If:case kp:case Pf:case Bf:case iv:case av:case ov:case rv:return oe(function(D){return C.commandType(D,"boolean",ie,L.commandStr),D},function(D,Q,G){return C.optional(function(){D.assert(Q,"typeof "+G+'==="boolean"',"invalid flag "+ie,D.commandStr)}),G});case ev:return oe(function(D){return C.commandParameter(D,bo,"invalid "+ie,L.commandStr),bo[D]},function(D,Q,G){var fe=D.constants.compareFuncs;return C.optional(function(){D.assert(Q,G+" in "+fe,"invalid "+ie+", must be one of "+Object.keys(bo))}),Q.def(fe,"[",G,"]")});case tv:return oe(function(D){return C.command(mn(D)&&D.length===2&&typeof D[0]=="number"&&typeof D[1]=="number"&&D[0]<=D[1],"depth range is 2d array",L.commandStr),D},function(D,Q,G){C.optional(function(){D.assert(Q,D.shared.isArrayLike+"("+G+")&&"+G+".length===2&&typeof "+G+'[0]==="number"&&typeof '+G+'[1]==="number"&&'+G+"[0]<="+G+"[1]","depth range must be a 2d array")});var fe=Q.def("+",G,"[0]"),me=Q.def("+",G,"[1]");return[fe,me]});case ni:return oe(function(D){C.commandType(D,"object","blend.func",L.commandStr);var Q="srcRGB"in D?D.srcRGB:D.src,G="srcAlpha"in D?D.srcAlpha:D.src,fe="dstRGB"in D?D.dstRGB:D.dst,me="dstAlpha"in D?D.dstAlpha:D.dst;return C.commandParameter(Q,zi,ee+".srcRGB",L.commandStr),C.commandParameter(G,zi,ee+".srcAlpha",L.commandStr),C.commandParameter(fe,zi,ee+".dstRGB",L.commandStr),C.commandParameter(me,zi,ee+".dstAlpha",L.commandStr),C.command(jp.indexOf(Q+", "+fe)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Q+", "+fe+")",L.commandStr),[zi[Q],zi[fe],zi[G],zi[me]]},function(D,Q,G){var fe=D.constants.blendFuncs;C.optional(function(){D.assert(Q,G+"&&typeof "+G+'==="object"',"invalid blend func, must be an object")});function me(Rt,Pt){var Dt=Q.def('"',Rt,Pt,'" in ',G,"?",G,".",Rt,Pt,":",G,".",Rt);return C.optional(function(){D.assert(Q,Dt+" in "+fe,"invalid "+ie+"."+Rt+Pt+", must be one of "+Object.keys(zi))}),Dt}var Ve=me("src","RGB"),pt=me("dst","RGB");C.optional(function(){var Rt=D.constants.invalidBlendCombinations;D.assert(Q,Rt+".indexOf("+Ve+'+", "+'+pt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var dt=Q.def(fe,"[",Ve,"]"),At=Q.def(fe,"[",me("src","Alpha"),"]"),ht=Q.def(fe,"[",pt,"]"),Bt=Q.def(fe,"[",me("dst","Alpha"),"]");return[dt,ht,At,Bt]});case kf:return oe(function(D){if(typeof D=="string")return C.commandParameter(D,Re,"invalid "+ie,L.commandStr),[Re[D],Re[D]];if(typeof D=="object")return C.commandParameter(D.rgb,Re,ie+".rgb",L.commandStr),C.commandParameter(D.alpha,Re,ie+".alpha",L.commandStr),[Re[D.rgb],Re[D.alpha]];C.commandRaise("invalid blend.equation",L.commandStr)},function(D,Q,G){var fe=D.constants.blendEquations,me=Q.def(),Ve=Q.def(),pt=D.cond("typeof ",G,'==="string"');return C.optional(function(){function dt(At,ht,Bt){D.assert(At,Bt+" in "+fe,"invalid "+ht+", must be one of "+Object.keys(Re))}dt(pt.then,ie,G),D.assert(pt.else,G+"&&typeof "+G+'==="object"',"invalid "+ie),dt(pt.else,ie+".rgb",G+".rgb"),dt(pt.else,ie+".alpha",G+".alpha")}),pt.then(me,"=",Ve,"=",fe,"[",G,"];"),pt.else(me,"=",fe,"[",G,".rgb];",Ve,"=",fe,"[",G,".alpha];"),Q(pt),[me,Ve]});case Yo:return oe(function(D){return C.command(mn(D)&&D.length===4,"blend.color must be a 4d array",L.commandStr),pi(4,function(Q){return+D[Q]})},function(D,Q,G){return C.optional(function(){D.assert(Q,D.shared.isArrayLike+"("+G+")&&"+G+".length===4","blend.color must be a 4d array")}),pi(4,function(fe){return Q.def("+",G,"[",fe,"]")})});case uv:return oe(function(D){return C.commandType(D,"number",ee,L.commandStr),D|0},function(D,Q,G){return C.optional(function(){D.assert(Q,"typeof "+G+'==="number"',"invalid stencil.mask")}),Q.def(G,"|0")});case Pp:return oe(function(D){C.commandType(D,"object",ee,L.commandStr);var Q=D.cmp||"keep",G=D.ref||0,fe="mask"in D?D.mask:-1;return C.commandParameter(Q,bo,ie+".cmp",L.commandStr),C.commandType(G,"number",ie+".ref",L.commandStr),C.commandType(fe,"number",ie+".mask",L.commandStr),[bo[Q],G,fe]},function(D,Q,G){var fe=D.constants.compareFuncs;C.optional(function(){function dt(){D.assert(Q,Array.prototype.join.call(arguments,""),"invalid stencil.func")}dt(G+"&&typeof ",G,'==="object"'),dt('!("cmp" in ',G,")||(",G,".cmp in ",fe,")")});var me=Q.def('"cmp" in ',G,"?",fe,"[",G,".cmp]",":",tu),Ve=Q.def(G,".ref|0"),pt=Q.def('"mask" in ',G,"?",G,".mask|0:-1");return[me,Ve,pt]});case Dp:case Ds:return oe(function(D){C.commandType(D,"object",ee,L.commandStr);var Q=D.fail||"keep",G=D.zfail||"keep",fe=D.zpass||"keep";return C.commandParameter(Q,Va,ie+".fail",L.commandStr),C.commandParameter(G,Va,ie+".zfail",L.commandStr),C.commandParameter(fe,Va,ie+".zpass",L.commandStr),[ie===Ds?Gu:Mi,Va[Q],Va[G],Va[fe]]},function(D,Q,G){var fe=D.constants.stencilOps;C.optional(function(){D.assert(Q,G+"&&typeof "+G+'==="object"',"invalid "+ie)});function me(Ve){return C.optional(function(){D.assert(Q,'!("'+Ve+'" in '+G+")||("+G+"."+Ve+" in "+fe+")","invalid "+ie+"."+Ve+", must be one of "+Object.keys(Va))}),Q.def('"',Ve,'" in ',G,"?",fe,"[",G,".",Ve,"]:",tu)}return[ie===Ds?Gu:Mi,me("fail"),me("zfail"),me("zpass")]});case zu:return oe(function(D){C.commandType(D,"object",ee,L.commandStr);var Q=D.factor|0,G=D.units|0;return C.commandType(Q,"number",ee+".factor",L.commandStr),C.commandType(G,"number",ee+".units",L.commandStr),[Q,G]},function(D,Q,G){C.optional(function(){D.assert(Q,G+"&&typeof "+G+'==="object"',"invalid "+ie)});var fe=Q.def(G,".factor|0"),me=Q.def(G,".units|0");return[fe,me]});case Ps:return oe(function(D){var Q=0;return D==="front"?Q=Mi:D==="back"&&(Q=Gu),C.command(!!Q,ee,L.commandStr),Q},function(D,Q,G){return C.optional(function(){D.assert(Q,G+'==="front"||'+G+'==="back"',"invalid cull.face")}),Q.def(G,'==="front"?',Mi,":",Gu)});case Ip:return oe(function(D){return C.command(typeof D=="number"&&D>=Ae.lineWidthDims[0]&&D<=Ae.lineWidthDims[1],"invalid line width, must be a positive number between "+Ae.lineWidthDims[0]+" and "+Ae.lineWidthDims[1],L.commandStr),D},function(D,Q,G){return C.optional(function(){D.assert(Q,"typeof "+G+'==="number"&&'+G+">="+Ae.lineWidthDims[0]+"&&"+G+"<="+Ae.lineWidthDims[1],"invalid line width")}),G});case Df:return oe(function(D){return C.commandParameter(D,Wp,ee,L.commandStr),Wp[D]},function(D,Q,G){return C.optional(function(){D.assert(Q,G+'==="cw"||'+G+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Q.def(G+'==="cw"?'+vv+":"+Ys)});case ec:return oe(function(D){return C.command(mn(D)&&D.length===4,"color.mask must be length 4 array",L.commandStr),D.map(function(Q){return!!Q})},function(D,Q,G){return C.optional(function(){D.assert(Q,D.shared.isArrayLike+"("+G+")&&"+G+".length===4","invalid color.mask")}),pi(4,function(fe){return"!!"+G+"["+fe+"]"})});case tc:return oe(function(D){C.command(typeof D=="object"&&D,ee,L.commandStr);var Q="value"in D?D.value:1,G=!!D.invert;return C.command(typeof Q=="number"&&Q>=0&&Q<=1,"sample.coverage.value must be a number between 0 and 1",L.commandStr),[Q,G]},function(D,Q,G){C.optional(function(){D.assert(Q,G+"&&typeof "+G+'==="object"',"invalid sample.coverage")});var fe=Q.def('"value" in ',G,"?+",G,".value:1"),me=Q.def("!!",G,".invert");return[fe,me]})}}),Te}function _r(z,L){var Z=z.static,he=z.dynamic,Te={};return Object.keys(Z).forEach(function(ie){var ee=Z[ie],oe;if(typeof ee=="number"||typeof ee=="boolean")oe=xn(function(){return ee});else if(typeof ee=="function"){var D=ee._reglType;D==="texture2d"||D==="textureCube"?oe=xn(function(Q){return Q.link(ee)}):D==="framebuffer"||D==="framebufferCube"?(C.command(ee.color.length>0,'missing color attachment for framebuffer sent to uniform "'+ie+'"',L.commandStr),oe=xn(function(Q){return Q.link(ee.color[0])})):C.commandRaise('invalid data for uniform "'+ie+'"',L.commandStr)}else mn(ee)?oe=xn(function(Q){var G=Q.global.def("[",pi(ee.length,function(fe){return C.command(typeof ee[fe]=="number"||typeof ee[fe]=="boolean","invalid uniform "+ie,Q.commandStr),ee[fe]}),"]");return G}):C.commandRaise('invalid or missing data for uniform "'+ie+'"',L.commandStr);oe.value=ee,Te[ie]=oe}),Object.keys(he).forEach(function(ie){var ee=he[ie];Te[ie]=yi(ee,function(oe,D){return oe.invoke(D,ee)})}),Te}function zn(z,L){var Z=z.static,he=z.dynamic,Te={};return Object.keys(Z).forEach(function(ie){var ee=Z[ie],oe=P.id(ie),D=new ce;if(fc(ee))D.state=Uu,D.buffer=Ue.getBuffer(Ue.create(ee,$s,!1,!0)),D.type=0;else{var Q=Ue.getBuffer(ee);if(Q)D.state=Uu,D.buffer=Q,D.type=0;else if(C.command(typeof ee=="object"&&ee,"invalid data for attribute "+ie,L.commandStr),"constant"in ee){var G=ee.constant;D.buffer="null",D.state=Op,typeof G=="number"?D.x=G:(C.command(mn(G)&&G.length>0&&G.length<=4,"invalid constant for attribute "+ie,L.commandStr),Ha.forEach(function(ht,Bt){Bt<G.length&&(D[ht]=G[Bt])}))}else{fc(ee.buffer)?Q=Ue.getBuffer(Ue.create(ee.buffer,$s,!1,!0)):Q=Ue.getBuffer(ee.buffer),C.command(!!Q,'missing buffer for attribute "'+ie+'"',L.commandStr);var fe=ee.offset|0;C.command(fe>=0,'invalid offset for attribute "'+ie+'"',L.commandStr);var me=ee.stride|0;C.command(me>=0&&me<256,'invalid stride for attribute "'+ie+'", must be integer betweeen [0, 255]',L.commandStr);var Ve=ee.size|0;C.command(!("size"in ee)||Ve>0&&Ve<=4,'invalid size for attribute "'+ie+'", must be 1,2,3,4',L.commandStr);var pt=!!ee.normalized,dt=0;"type"in ee&&(C.commandParameter(ee.type,Lu,"invalid type for attribute "+ie,L.commandStr),dt=Lu[ee.type]);var At=ee.divisor|0;C.optional(function(){"divisor"in ee&&(C.command(At===0||it,'cannot specify divisor for attribute "'+ie+'", instancing not supported',L.commandStr),C.command(At>=0,'invalid divisor for attribute "'+ie+'"',L.commandStr));var ht=L.commandStr,Bt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ee).forEach(function(Rt){C.command(Bt.indexOf(Rt)>=0,'unknown parameter "'+Rt+'" for attribute pointer "'+ie+'" (valid parameters are '+Bt+")",ht)})}),D.buffer=Q,D.state=Uu,D.size=Ve,D.normalized=pt,D.type=dt||Q.dtype,D.offset=fe,D.stride=me,D.divisor=At}}Te[ie]=xn(function(ht,Bt){var Rt=ht.attribCache;if(oe in Rt)return Rt[oe];var Pt={isStream:!1};return Object.keys(D).forEach(function(Dt){Pt[Dt]=D[Dt]}),D.buffer&&(Pt.buffer=ht.link(D.buffer),Pt.type=Pt.type||Pt.buffer+".dtype"),Rt[oe]=Pt,Pt})}),Object.keys(he).forEach(function(ie){var ee=he[ie];function oe(D,Q){var G=D.invoke(Q,ee),fe=D.shared,me=D.constants,Ve=fe.isBufferArgs,pt=fe.buffer;C.optional(function(){D.assert(Q,G+"&&(typeof "+G+'==="object"||typeof '+G+'==="function")&&('+Ve+"("+G+")||"+pt+".getBuffer("+G+")||"+pt+".getBuffer("+G+".buffer)||"+Ve+"("+G+'.buffer)||("constant" in '+G+"&&(typeof "+G+'.constant==="number"||'+fe.isArrayLike+"("+G+".constant))))",'invalid dynamic attribute "'+ie+'"')});var dt={isStream:Q.def(!1)},At=new ce;At.state=Uu,Object.keys(At).forEach(function(Pt){dt[Pt]=Q.def(""+At[Pt])});var ht=dt.buffer,Bt=dt.type;Q("if(",Ve,"(",G,")){",dt.isStream,"=true;",ht,"=",pt,".createStream(",$s,",",G,");",Bt,"=",ht,".dtype;","}else{",ht,"=",pt,".getBuffer(",G,");","if(",ht,"){",Bt,"=",ht,".dtype;",'}else if("constant" in ',G,"){",dt.state,"=",Op,";","if(typeof "+G+'.constant === "number"){',dt[Ha[0]],"=",G,".constant;",Ha.slice(1).map(function(Pt){return dt[Pt]}).join("="),"=0;","}else{",Ha.map(function(Pt,Dt){return dt[Pt]+"="+G+".constant.length>"+Dt+"?"+G+".constant["+Dt+"]:0;"}).join(""),"}}else{","if(",Ve,"(",G,".buffer)){",ht,"=",pt,".createStream(",$s,",",G,".buffer);","}else{",ht,"=",pt,".getBuffer(",G,".buffer);","}",Bt,'="type" in ',G,"?",me.glTypes,"[",G,".type]:",ht,".dtype;",dt.normalized,"=!!",G,".normalized;");function Rt(Pt){Q(dt[Pt],"=",G,".",Pt,"|0;")}return Rt("size"),Rt("offset"),Rt("stride"),Rt("divisor"),Q("}}"),Q.exit("if(",dt.isStream,"){",pt,".destroyStream(",ht,");","}"),dt}Te[ie]=yi(ee,oe)}),Te}function un(z){var L=z.static,Z=z.dynamic,he={};return Object.keys(L).forEach(function(Te){var ie=L[Te];he[Te]=xn(function(ee,oe){return typeof ie=="number"||typeof ie=="boolean"?""+ie:ee.link(ie)})}),Object.keys(Z).forEach(function(Te){var ie=Z[Te];he[Te]=yi(ie,function(ee,oe){return ee.invoke(oe,ie)})}),he}function Tn(z,L,Z,he,Te){var ie=z.static,ee=z.dynamic;C.optional(function(){var Rt=[Zo,Ns,qo,$u,Ko,Uf,Qo,rc,Bs,nc].concat(Yt);function Pt(Dt){Object.keys(Dt).forEach(function(Nt){C.command(Rt.indexOf(Nt)>=0,'unknown parameter "'+Nt+'"',Te.commandStr)})}Pt(ie),Pt(ee)});var oe=lr(z,L),D=wt(z),Q=Kt(z,D,Te),G=Wr(z,Te),fe=pn(z,Te),me=cr(z,Te,oe);function Ve(Rt){var Pt=Q[Rt];Pt&&(fe[Rt]=Pt)}Ve(xa),Ve(kt(Nf));var pt=Object.keys(fe).length>0,dt={framebuffer:D,draw:G,shader:me,state:fe,dirty:pt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(dt.profile=Et(z),dt.uniforms=_r(Z,Te),dt.drawVAO=dt.scopeVAO=G.vao,!dt.drawVAO&&me.program&&!oe&&W.angle_instanced_arrays&&G.static.elements){var At=!0,ht=me.program.attributes.map(function(Rt){var Pt=L.static[Rt];return At=At&&!!Pt,Pt});if(At&&ht.length>0){var Bt=ot.getVAO(ot.createVAO({attributes:ht,elements:G.static.elements}));dt.drawVAO=new Sn(null,null,null,function(Rt,Pt){return Rt.link(Bt)}),dt.useVAO=!0}}return oe?dt.useVAO=!0:dt.attributes=zn(L,Te),dt.context=un(he),dt}function yn(z,L,Z){var he=z.shared,Te=he.context,ie=z.scope();Object.keys(Z).forEach(function(ee){L.save(Te,"."+ee);var oe=Z[ee],D=oe.append(z,L);Array.isArray(D)?ie(Te,".",ee,"=[",D.join(),"];"):ie(Te,".",ee,"=",D,";")}),L(ie)}function In(z,L,Z,he){var Te=z.shared,ie=Te.gl,ee=Te.framebuffer,oe;bt&&(oe=L.def(Te.extensions,".webgl_draw_buffers"));var D=z.constants,Q=D.drawBuffer,G=D.backBuffer,fe;Z?fe=Z.append(z,L):fe=L.def(ee,".next"),he||L("if(",fe,"!==",ee,".cur){"),L("if(",fe,"){",ie,".bindFramebuffer(",Vp,",",fe,".framebuffer);"),bt&&L(oe,".drawBuffersWEBGL(",Q,"[",fe,".colorAttachments.length]);"),L("}else{",ie,".bindFramebuffer(",Vp,",null);"),bt&&L(oe,".drawBuffersWEBGL(",G,");"),L("}",ee,".cur=",fe,";"),he||L("}")}function $n(z,L,Z){var he=z.shared,Te=he.gl,ie=z.current,ee=z.next,oe=he.current,D=he.next,Q=z.cond(oe,".dirty");Yt.forEach(function(G){var fe=kt(G);if(!(fe in Z.state)){var me,Ve;if(fe in ee){me=ee[fe],Ve=ie[fe];var pt=pi(Tt[fe].length,function(At){return Q.def(me,"[",At,"]")});Q(z.cond(pt.map(function(At,ht){return At+"!=="+Ve+"["+ht+"]"}).join("||")).then(Te,".",Be[fe],"(",pt,");",pt.map(function(At,ht){return Ve+"["+ht+"]="+At}).join(";"),";"))}else{me=Q.def(D,".",fe);var dt=z.cond(me,"!==",oe,".",fe);Q(dt),fe in ze?dt(z.cond(me).then(Te,".enable(",ze[fe],");").else(Te,".disable(",ze[fe],");"),oe,".",fe,"=",me,";"):dt(Te,".",Be[fe],"(",me,");",oe,".",fe,"=",me,";")}}}),Object.keys(Z.state).length===0&&Q(oe,".dirty=false;"),L(Q)}function Yn(z,L,Z,he){var Te=z.shared,ie=z.current,ee=Te.current,oe=Te.gl;hc(Object.keys(Z)).forEach(function(D){var Q=Z[D];if(!(he&&!he(Q))){var G=Q.append(z,L);if(ze[D]){var fe=ze[D];ja(Q)?G?L(oe,".enable(",fe,");"):L(oe,".disable(",fe,");"):L(z.cond(G).then(oe,".enable(",fe,");").else(oe,".disable(",fe,");")),L(ee,".",D,"=",G,";")}else if(mn(G)){var me=ie[D];L(oe,".",Be[D],"(",G,");",G.map(function(Ve,pt){return me+"["+pt+"]="+Ve}).join(";"),";")}else L(oe,".",Be[D],"(",G,");",ee,".",D,"=",G,";")}})}function _n(z,L){it&&(z.instancing=L.def(z.shared.extensions,".angle_instanced_arrays"))}function dr(z,L,Z,he,Te){var ie=z.shared,ee=z.stats,oe=ie.current,D=ie.timer,Q=Z.profile;function G(){var Rt=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Rt||typeof performance>"u"?"Date.now()":"performance.now()"}var fe,me;function Ve(Rt){fe=L.def(),Rt(fe,"=",G(),";"),typeof Te=="string"?Rt(ee,".count+=",Te,";"):Rt(ee,".count++;"),Ze&&(he?(me=L.def(),Rt(me,"=",D,".getNumPendingQueries();")):Rt(D,".beginQuery(",ee,");"))}function pt(Rt){Rt(ee,".cpuTime+=",G(),"-",fe,";"),Ze&&(he?Rt(D,".pushScopeStats(",me,",",D,".getNumPendingQueries(),",ee,");"):Rt(D,".endQuery();"))}function dt(Rt){var Pt=L.def(oe,".profile");L(oe,".profile=",Rt,";"),L.exit(oe,".profile=",Pt,";")}var At;if(Q){if(ja(Q)){Q.enable?(Ve(L),pt(L.exit),dt("true")):dt("false");return}At=Q.append(z,L),dt(At)}else At=L.def(oe,".profile");var ht=z.block();Ve(ht),L("if(",At,"){",ht,"}");var Bt=z.block();pt(Bt),L.exit("if(",At,"){",Bt,"}")}function Gn(z,L,Z,he,Te){var ie=z.shared;function ee(D){switch(D){case Gs:case ba:case Hf:return 2;case Hs:case oc:case Vf:return 3;case Ea:case uc:case jf:return 4;default:return 1}}function oe(D,Q,G){var fe=ie.gl,me=L.def(D,".location"),Ve=L.def(ie.attributes,"[",me,"]"),pt=G.state,dt=G.buffer,At=[G.x,G.y,G.z,G.w],ht=["buffer","normalized","offset","stride"];function Bt(){L("if(!",Ve,".buffer){",fe,".enableVertexAttribArray(",me,");}");var Pt=G.type,Dt;if(G.size?Dt=L.def(G.size,"||",Q):Dt=Q,L("if(",Ve,".type!==",Pt,"||",Ve,".size!==",Dt,"||",ht.map(function(tr){return Ve+"."+tr+"!=="+G[tr]}).join("||"),"){",fe,".bindBuffer(",$s,",",dt,".buffer);",fe,".vertexAttribPointer(",[me,Dt,Pt,G.normalized,G.stride,G.offset],");",Ve,".type=",Pt,";",Ve,".size=",Dt,";",ht.map(function(tr){return Ve+"."+tr+"="+G[tr]+";"}).join(""),"}"),it){var Nt=G.divisor;L("if(",Ve,".divisor!==",Nt,"){",z.instancing,".vertexAttribDivisorANGLE(",[me,Nt],");",Ve,".divisor=",Nt,";}")}}function Rt(){L("if(",Ve,".buffer){",fe,".disableVertexAttribArray(",me,");",Ve,".buffer=null;","}if(",Ha.map(function(Pt,Dt){return Ve+"."+Pt+"!=="+At[Dt]}).join("||"),"){",fe,".vertexAttrib4f(",me,",",At,");",Ha.map(function(Pt,Dt){return Ve+"."+Pt+"="+At[Dt]+";"}).join(""),"}")}pt===Uu?Bt():pt===Op?Rt():(L("if(",pt,"===",Uu,"){"),Bt(),L("}else{"),Rt(),L("}"))}he.forEach(function(D){var Q=D.name,G=Z.attributes[Q],fe;if(G){if(!Te(G))return;fe=G.append(z,L)}else{if(!Te(Wa))return;var me=z.scopeAttrib(Q);C.optional(function(){z.assert(L,me+".state","missing attribute "+Q)}),fe={},Object.keys(new ce).forEach(function(Ve){fe[Ve]=L.def(me,".",Ve)})}oe(z.link(D),ee(D.info.type),fe)})}function Ur(z,L,Z,he,Te,ie){for(var ee=z.shared,oe=ee.gl,D,Q=0;Q<he.length;++Q){var G=he[Q],fe=G.name,me=G.info.type,Ve=Z.uniforms[fe],pt=z.link(G),dt=pt+".location",At;if(Ve){if(!Te(Ve))continue;if(ja(Ve)){var ht=Ve.value;if(C.command(ht!==null&&typeof ht<"u",'missing uniform "'+fe+'"',z.commandStr),me===Ws||me===Xs){C.command(typeof ht=="function"&&(me===Ws&&(ht._reglType==="texture2d"||ht._reglType==="framebuffer")||me===Xs&&(ht._reglType==="textureCube"||ht._reglType==="framebufferCube")),"invalid texture for uniform "+fe,z.commandStr);var Bt=z.link(ht._texture||ht.color[0]._texture);L(oe,".uniform1i(",dt,",",Bt+".bind());"),L.exit(Bt,".unbind();")}else if(me===Vs||me===js||me===lc){C.optional(function(){C.command(mn(ht),"invalid matrix for uniform "+fe,z.commandStr),C.command(me===Vs&&ht.length===4||me===js&&ht.length===9||me===lc&&ht.length===16,"invalid length for matrix uniform "+fe,z.commandStr)});var Rt=z.global.def("new Float32Array(["+Array.prototype.slice.call(ht)+"])"),Pt=2;me===js?Pt=3:me===lc&&(Pt=4),L(oe,".uniformMatrix",Pt,"fv(",dt,",false,",Rt,");")}else{switch(me){case Gf:C.commandType(ht,"number","uniform "+fe,z.commandStr),D="1f";break;case Gs:C.command(mn(ht)&&ht.length===2,"uniform "+fe,z.commandStr),D="2f";break;case Hs:C.command(mn(ht)&&ht.length===3,"uniform "+fe,z.commandStr),D="3f";break;case Ea:C.command(mn(ht)&&ht.length===4,"uniform "+fe,z.commandStr),D="4f";break;case sc:C.commandType(ht,"boolean","uniform "+fe,z.commandStr),D="1i";break;case Gp:C.commandType(ht,"number","uniform "+fe,z.commandStr),D="1i";break;case Hf:C.command(mn(ht)&&ht.length===2,"uniform "+fe,z.commandStr),D="2i";break;case ba:C.command(mn(ht)&&ht.length===2,"uniform "+fe,z.commandStr),D="2i";break;case Vf:C.command(mn(ht)&&ht.length===3,"uniform "+fe,z.commandStr),D="3i";break;case oc:C.command(mn(ht)&&ht.length===3,"uniform "+fe,z.commandStr),D="3i";break;case jf:C.command(mn(ht)&&ht.length===4,"uniform "+fe,z.commandStr),D="4i";break;case uc:C.command(mn(ht)&&ht.length===4,"uniform "+fe,z.commandStr),D="4i";break}L(oe,".uniform",D,"(",dt,",",mn(ht)?Array.prototype.slice.call(ht):ht,");")}continue}else At=Ve.append(z,L)}else{if(!Te(Wa))continue;At=L.def(ee.uniforms,"[",P.id(fe),"]")}me===Ws?(C(!Array.isArray(At),"must specify a scalar prop for textures"),L("if(",At,"&&",At,'._reglType==="framebuffer"){',At,"=",At,".color[0];","}")):me===Xs&&(C(!Array.isArray(At),"must specify a scalar prop for cube maps"),L("if(",At,"&&",At,'._reglType==="framebufferCube"){',At,"=",At,".color[0];","}")),C.optional(function(){function ui(ea,Cv){z.assert(L,ea,'bad data or missing for uniform "'+fe+'".  '+Cv)}function Xa(ea){C(!Array.isArray(At),"must not specify an array type for uniform"),ui("typeof "+At+'==="'+ea+'"',"invalid type, expected "+ea)}function Ji(ea,Cv){Array.isArray(At)?C(At.length===ea,"must have length "+ea):ui(ee.isArrayLike+"("+At+")&&"+At+".length==="+ea,"invalid vector, should have length "+ea,z.commandStr)}function Xf(ea){C(!Array.isArray(At),"must not specify a value type"),ui("typeof "+At+'==="function"&&'+At+'._reglType==="texture'+(ea===ac?"2d":"Cube")+'"',"invalid texture type",z.commandStr)}switch(me){case Gp:Xa("number");break;case ba:Ji(2);break;case oc:Ji(3);break;case uc:Ji(4);break;case Gf:Xa("number");break;case Gs:Ji(2);break;case Hs:Ji(3);break;case Ea:Ji(4);break;case sc:Xa("boolean");break;case Hf:Ji(2);break;case Vf:Ji(3);break;case jf:Ji(4);break;case Vs:Ji(4);break;case js:Ji(9);break;case lc:Ji(16);break;case Ws:Xf(ac);break;case Xs:Xf(Up);break}});var Dt=1;switch(me){case Ws:case Xs:var Nt=L.def(At,"._texture");L(oe,".uniform1i(",dt,",",Nt,".bind());"),L.exit(Nt,".unbind();");continue;case Gp:case sc:D="1i";break;case ba:case Hf:D="2i",Dt=2;break;case oc:case Vf:D="3i",Dt=3;break;case uc:case jf:D="4i",Dt=4;break;case Gf:D="1f";break;case Gs:D="2f",Dt=2;break;case Hs:D="3f",Dt=3;break;case Ea:D="4f",Dt=4;break;case Vs:D="Matrix2fv";break;case js:D="Matrix3fv";break;case lc:D="Matrix4fv";break}if(D.charAt(0)==="M"){L(oe,".uniform",D,"(",dt,",");var tr=Math.pow(me-Vs+2,2),Kr=z.global.def("new Float32Array(",tr,")");Array.isArray(At)?L("false,(",pi(tr,function(ui){return Kr+"["+ui+"]="+At[ui]}),",",Kr,")"):L("false,(Array.isArray(",At,")||",At," instanceof Float32Array)?",At,":(",pi(tr,function(ui){return Kr+"["+ui+"]="+At+"["+ui+"]"}),",",Kr,")"),L(");")}else if(Dt>1){for(var Hn=[],So=[],To=0;To<Dt;++To)Array.isArray(At)?So.push(At[To]):So.push(L.def(At+"["+To+"]")),ie&&Hn.push(L.def());ie&&L("if(!",z.batchId,"||",Hn.map(function(ui,Xa){return ui+"!=="+So[Xa]}).join("||"),"){",Hn.map(function(ui,Xa){return ui+"="+So[Xa]+";"}).join("")),L(oe,".uniform",D,"(",dt,",",So.join(","),");"),ie&&L("}")}else{if(C(!Array.isArray(At),"uniform value must not be an array"),ie){var wo=L.def();L("if(!",z.batchId,"||",wo,"!==",At,"){",wo,"=",At,";")}L(oe,".uniform",D,"(",dt,",",At,");"),ie&&L("}")}}}function wn(z,L,Z,he){var Te=z.shared,ie=Te.gl,ee=Te.draw,oe=he.draw;function D(){var Dt=oe.elements,Nt,tr=L;return Dt?((Dt.contextDep&&he.contextDynamic||Dt.propDep)&&(tr=Z),Nt=Dt.append(z,tr),oe.elementsActive&&tr("if("+Nt+")"+ie+".bindBuffer("+Np+","+Nt+".buffer.buffer);")):(Nt=tr.def(),tr(Nt,"=",ee,".",$u,";","if(",Nt,"){",ie,".bindBuffer(",Np,",",Nt,".buffer.buffer);}","else if(",Te.vao,".currentVAO){",Nt,"=",z.shared.elements+".getElements("+Te.vao,".currentVAO.elements);",We?"":"if("+Nt+")"+ie+".bindBuffer("+Np+","+Nt+".buffer.buffer);","}")),Nt}function Q(){var Dt=oe.count,Nt,tr=L;return Dt?((Dt.contextDep&&he.contextDynamic||Dt.propDep)&&(tr=Z),Nt=Dt.append(z,tr),C.optional(function(){Dt.MISSING&&z.assert(L,"false","missing vertex count"),Dt.DYNAMIC&&z.assert(tr,Nt+">=0","missing vertex count")})):(Nt=tr.def(ee,".",Qo),C.optional(function(){z.assert(tr,Nt+">=0","missing vertex count")})),Nt}var G=D();function fe(Dt){var Nt=oe[Dt];return Nt?Nt.contextDep&&he.contextDynamic||Nt.propDep?Nt.append(z,Z):Nt.append(z,L):L.def(ee,".",Dt)}var me=fe(Ko),Ve=fe(Uf),pt=Q();if(typeof pt=="number"){if(pt===0)return}else Z("if(",pt,"){"),Z.exit("}");var dt,At;it&&(dt=fe(rc),At=z.instancing);var ht=G+".type",Bt=oe.elements&&ja(oe.elements)&&!oe.vaoActive;function Rt(){function Dt(){Z(At,".drawElementsInstancedANGLE(",[me,pt,ht,Ve+"<<(("+ht+"-"+Eo+")>>1)",dt],");")}function Nt(){Z(At,".drawArraysInstancedANGLE(",[me,Ve,pt,dt],");")}G&&G!=="null"?Bt?Dt():(Z("if(",G,"){"),Dt(),Z("}else{"),Nt(),Z("}")):Nt()}function Pt(){function Dt(){Z(ie+".drawElements("+[me,pt,ht,Ve+"<<(("+ht+"-"+Eo+")>>1)"]+");")}function Nt(){Z(ie+".drawArrays("+[me,Ve,pt]+");")}G&&G!=="null"?Bt?Dt():(Z("if(",G,"){"),Dt(),Z("}else{"),Nt(),Z("}")):Nt()}it&&(typeof dt!="number"||dt>=0)?typeof dt=="string"?(Z("if(",dt,">0){"),Rt(),Z("}else if(",dt,"<0){"),Pt(),Z("}")):Rt():Pt()}function er(z,L,Z,he,Te){var ie=nr(),ee=ie.proc("body",Te);return C.optional(function(){ie.commandStr=L.commandStr,ie.command=ie.link(L.commandStr)}),it&&(ie.instancing=ee.def(ie.shared.extensions,".angle_instanced_arrays")),z(ie,ee,Z,he),ie.compile().body}function mr(z,L,Z,he){_n(z,L),Z.useVAO?Z.drawVAO?L(z.shared.vao,".setVAO(",Z.drawVAO.append(z,L),");"):L(z.shared.vao,".setVAO(",z.shared.vao,".targetVAO);"):(L(z.shared.vao,".setVAO(null);"),Gn(z,L,Z,he.attributes,function(){return!0})),Ur(z,L,Z,he.uniforms,function(){return!0},!1),wn(z,L,L,Z)}function Xr(z,L){var Z=z.proc("draw",1);_n(z,Z),yn(z,Z,L.context),In(z,Z,L.framebuffer),$n(z,Z,L),Yn(z,Z,L.state),dr(z,Z,L,!1,!0);var he=L.shader.progVar.append(z,Z);if(Z(z.shared.gl,".useProgram(",he,".program);"),L.shader.program)mr(z,Z,L,L.shader.program);else{Z(z.shared.vao,".setVAO(null);");var Te=z.global.def("{}"),ie=Z.def(he,".id"),ee=Z.def(Te,"[",ie,"]");Z(z.cond(ee).then(ee,".call(this,a0);").else(ee,"=",Te,"[",ie,"]=",z.link(function(oe){return er(mr,z,L,oe,1)}),"(",he,");",ee,".call(this,a0);"))}Object.keys(L.state).length>0&&Z(z.shared.current,".dirty=true;"),z.shared.vao&&Z(z.shared.vao,".setVAO(null);")}function En(z,L,Z,he){z.batchId="a1",_n(z,L);function Te(){return!0}Gn(z,L,Z,he.attributes,Te),Ur(z,L,Z,he.uniforms,Te,!1),wn(z,L,L,Z)}function Ao(z,L,Z,he){_n(z,L);var Te=Z.contextDep,ie=L.def(),ee="a0",oe="a1",D=L.def();z.shared.props=D,z.batchId=ie;var Q=z.scope(),G=z.scope();L(Q.entry,"for(",ie,"=0;",ie,"<",oe,";++",ie,"){",D,"=",ee,"[",ie,"];",G,"}",Q.exit);function fe(ht){return ht.contextDep&&Te||ht.propDep}function me(ht){return!fe(ht)}if(Z.needsContext&&yn(z,G,Z.context),Z.needsFramebuffer&&In(z,G,Z.framebuffer),Yn(z,G,Z.state,fe),Z.profile&&fe(Z.profile)&&dr(z,G,Z,!1,!0),he)Z.useVAO?Z.drawVAO?fe(Z.drawVAO)?G(z.shared.vao,".setVAO(",Z.drawVAO.append(z,G),");"):Q(z.shared.vao,".setVAO(",Z.drawVAO.append(z,Q),");"):Q(z.shared.vao,".setVAO(",z.shared.vao,".targetVAO);"):(Q(z.shared.vao,".setVAO(null);"),Gn(z,Q,Z,he.attributes,me),Gn(z,G,Z,he.attributes,fe)),Ur(z,Q,Z,he.uniforms,me,!1),Ur(z,G,Z,he.uniforms,fe,!0),wn(z,Q,G,Z);else{var Ve=z.global.def("{}"),pt=Z.shader.progVar.append(z,G),dt=G.def(pt,".id"),At=G.def(Ve,"[",dt,"]");G(z.shared.gl,".useProgram(",pt,".program);","if(!",At,"){",At,"=",Ve,"[",dt,"]=",z.link(function(ht){return er(En,z,Z,ht,2)}),"(",pt,");}",At,".call(this,a0[",ie,"],",ie,");")}}function V(z,L){var Z=z.proc("batch",2);z.batchId="0",_n(z,Z);var he=!1,Te=!0;Object.keys(L.context).forEach(function(Ve){he=he||L.context[Ve].propDep}),he||(yn(z,Z,L.context),Te=!1);var ie=L.framebuffer,ee=!1;ie?(ie.propDep?he=ee=!0:ie.contextDep&&he&&(ee=!0),ee||In(z,Z,ie)):In(z,Z,null),L.state.viewport&&L.state.viewport.propDep&&(he=!0);function oe(Ve){return Ve.contextDep&&he||Ve.propDep}$n(z,Z,L),Yn(z,Z,L.state,function(Ve){return!oe(Ve)}),(!L.profile||!oe(L.profile))&&dr(z,Z,L,!1,"a1"),L.contextDep=he,L.needsContext=Te,L.needsFramebuffer=ee;var D=L.shader.progVar;if(D.contextDep&&he||D.propDep)Ao(z,Z,L,null);else{var Q=D.append(z,Z);if(Z(z.shared.gl,".useProgram(",Q,".program);"),L.shader.program)Ao(z,Z,L,L.shader.program);else{Z(z.shared.vao,".setVAO(null);");var G=z.global.def("{}"),fe=Z.def(Q,".id"),me=Z.def(G,"[",fe,"]");Z(z.cond(me).then(me,".call(this,a0,a1);").else(me,"=",G,"[",fe,"]=",z.link(function(Ve){return er(Ao,z,L,Ve,2)}),"(",Q,");",me,".call(this,a0,a1);"))}}Object.keys(L.state).length>0&&Z(z.shared.current,".dirty=true;"),z.shared.vao&&Z(z.shared.vao,".setVAO(null);")}function we(z,L){var Z=z.proc("scope",3);z.batchId="a2";var he=z.shared,Te=he.current;yn(z,Z,L.context),L.framebuffer&&L.framebuffer.append(z,Z),hc(Object.keys(L.state)).forEach(function(ee){var oe=L.state[ee],D=oe.append(z,Z);mn(D)?D.forEach(function(Q,G){Z.set(z.next[ee],"["+G+"]",Q)}):Z.set(he.next,"."+ee,D)}),dr(z,Z,L,!0,!0),[$u,Uf,Qo,rc,Ko].forEach(function(ee){var oe=L.draw[ee];!oe||Z.set(he.draw,"."+ee,""+oe.append(z,Z))}),Object.keys(L.uniforms).forEach(function(ee){var oe=L.uniforms[ee].append(z,Z);Array.isArray(oe)&&(oe="["+oe.join()+"]"),Z.set(he.uniforms,"["+P.id(ee)+"]",oe)}),Object.keys(L.attributes).forEach(function(ee){var oe=L.attributes[ee].append(z,Z),D=z.scopeAttrib(ee);Object.keys(new ce).forEach(function(Q){Z.set(D,"."+Q,oe[Q])})}),L.scopeVAO&&Z.set(he.vao,".targetVAO",L.scopeVAO.append(z,Z));function ie(ee){var oe=L.shader[ee];oe&&Z.set(he.shader,"."+ee,oe.append(z,Z))}ie(Ns),ie(qo),Object.keys(L.state).length>0&&(Z(Te,".dirty=true;"),Z.exit(Te,".dirty=true;")),Z("a1(",z.shared.context,",a0,",z.batchId,");")}function ye(z){if(!(typeof z!="object"||mn(z))){for(var L=Object.keys(z),Z=0;Z<L.length;++Z)if(Zr.isDynamic(z[L[Z]]))return!0;return!1}}function Lt(z,L,Z){var he=L.static[Z];if(!he||!ye(he))return;var Te=z.global,ie=Object.keys(he),ee=!1,oe=!1,D=!1,Q=z.global.def("{}");ie.forEach(function(fe){var me=he[fe];if(Zr.isDynamic(me)){typeof me=="function"&&(me=he[fe]=Zr.unbox(me));var Ve=yi(me,null);ee=ee||Ve.thisDep,D=D||Ve.propDep,oe=oe||Ve.contextDep}else{switch(Te(Q,".",fe,"="),typeof me){case"number":Te(me);break;case"string":Te('"',me,'"');break;case"object":Array.isArray(me)&&Te("[",me.join(),"]");break;default:Te(z.link(me));break}Te(";")}});function G(fe,me){ie.forEach(function(Ve){var pt=he[Ve];if(!!Zr.isDynamic(pt)){var dt=fe.invoke(me,pt);me(Q,".",Ve,"=",dt,";")}})}L.dynamic[Z]=new Zr.DynamicVariable(ks,{thisDep:ee,contextDep:oe,propDep:D,ref:Q,append:G}),delete L.static[Z]}function br(z,L,Z,he,Te){var ie=nr();ie.stats=ie.link(Te),Object.keys(L.static).forEach(function(oe){Lt(ie,L,oe)}),cv.forEach(function(oe){Lt(ie,z,oe)});var ee=Tn(z,L,Z,he,ie);return Xr(ie,ee),we(ie,ee),V(ie,ee),i(ie.compile(),{destroy:function(){ee.shader.program.destroy()}})}return{next:Ct,current:Tt,procs:function(){var z=nr(),L=z.proc("poll"),Z=z.proc("refresh"),he=z.block();L(he),Z(he);var Te=z.shared,ie=Te.gl,ee=Te.next,oe=Te.current;he(oe,".dirty=false;"),In(z,L),In(z,Z,null,!0);var D;it&&(D=z.link(it)),W.oes_vertex_array_object&&Z(z.link(W.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Q=0;Q<Ae.maxAttributes;++Q){var G=Z.def(Te.attributes,"[",Q,"]"),fe=z.cond(G,".buffer");fe.then(ie,".enableVertexAttribArray(",Q,");",ie,".bindBuffer(",$s,",",G,".buffer.buffer);",ie,".vertexAttribPointer(",Q,",",G,".size,",G,".type,",G,".normalized,",G,".stride,",G,".offset);").else(ie,".disableVertexAttribArray(",Q,");",ie,".vertexAttrib4f(",Q,",",G,".x,",G,".y,",G,".z,",G,".w);",G,".buffer=null;"),Z(fe),it&&Z(D,".vertexAttribDivisorANGLE(",Q,",",G,".divisor);")}return Z(z.shared.vao,".currentVAO=null;",z.shared.vao,".setVAO(",z.shared.vao,".targetVAO);"),Object.keys(ze).forEach(function(me){var Ve=ze[me],pt=he.def(ee,".",me),dt=z.block();dt("if(",pt,"){",ie,".enable(",Ve,")}else{",ie,".disable(",Ve,")}",oe,".",me,"=",pt,";"),Z(dt),L("if(",pt,"!==",oe,".",me,"){",dt,"}")}),Object.keys(Be).forEach(function(me){var Ve=Be[me],pt=Tt[me],dt,At,ht=z.block();if(ht(ie,".",Ve,"("),mn(pt)){var Bt=pt.length;dt=z.global.def(ee,".",me),At=z.global.def(oe,".",me),ht(pi(Bt,function(Rt){return dt+"["+Rt+"]"}),");",pi(Bt,function(Rt){return At+"["+Rt+"]="+dt+"["+Rt+"];"}).join("")),L("if(",pi(Bt,function(Rt){return dt+"["+Rt+"]!=="+At+"["+Rt+"]"}).join("||"),"){",ht,"}")}else dt=he.def(ee,".",me),At=he.def(oe,".",me),ht(dt,");",oe,".",me,"=",dt,";"),L("if(",dt,"!==",At,"){",ht,"}");Z(ht)}),z.compile()}(),compile:br}}function xv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Ay=34918,Ev=34919,bv=35007,Sy=function(b,P){if(!P.ext_disjoint_timer_query)return null;var W=[];function Ae(){return W.pop()||P.ext_disjoint_timer_query.createQueryEXT()}function Ue(it){W.push(it)}var Ee=[];function Fe(it){var bt=Ae();P.ext_disjoint_timer_query.beginQueryEXT(bv,bt),Ee.push(bt),Ze(Ee.length-1,Ee.length,it)}function He(){P.ext_disjoint_timer_query.endQueryEXT(bv)}function qe(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var ot=[];function lt(){return ot.pop()||new qe}function Ke(it){ot.push(it)}var rt=[];function Ze(it,bt,We){var Tt=lt();Tt.startQueryIndex=it,Tt.endQueryIndex=bt,Tt.sum=0,Tt.stats=We,rt.push(Tt)}var st=[],ce=[];function Re(){var it,bt,We=Ee.length;if(We!==0){ce.length=Math.max(ce.length,We+1),st.length=Math.max(st.length,We+1),st[0]=0,ce[0]=0;var Tt=0;for(it=0,bt=0;bt<Ee.length;++bt){var Ct=Ee[bt];P.ext_disjoint_timer_query.getQueryObjectEXT(Ct,Ev)?(Tt+=P.ext_disjoint_timer_query.getQueryObjectEXT(Ct,Ay),Ue(Ct)):Ee[it++]=Ct,st[bt+1]=Tt,ce[bt+1]=it}for(Ee.length=it,it=0,bt=0;bt<rt.length;++bt){var Yt=rt[bt],ze=Yt.startQueryIndex,Be=Yt.endQueryIndex;Yt.sum+=st[Be]-st[ze];var kt=ce[ze],mt=ce[Be];mt===kt?(Yt.stats.gpuTime+=Yt.sum/1e6,Ke(Yt)):(Yt.startQueryIndex=kt,Yt.endQueryIndex=mt,rt[it++]=Yt)}rt.length=it}}return{beginQuery:Fe,endQuery:He,pushScopeStats:Ze,update:Re,getNumPendingQueries:function(){return Ee.length},clear:function(){W.push.apply(W,Ee);for(var it=0;it<W.length;it++)P.ext_disjoint_timer_query.deleteQueryEXT(W[it]);Ee.length=0,W.length=0},restore:function(){Ee.length=0,W.length=0}}},Co=16384,Xp=256,Yp=1024,Zp=34962,pc="webglcontextlost",Vu="webglcontextrestored",fr=1,Wf=2,qp=3;function ru(b,P){for(var W=0;W<b.length;++W)if(b[W]===P)return W;return-1}function Ty(b){var P=rf(b);if(!P)return null;var W=P.gl,Ae=W.getContextAttributes(),Ue=W.isContextLost(),Ee=Zh(W,P);if(!Ee)return null;var Fe=Xh(),He=xv(),qe=Ee.extensions,ot=Sy(W,qe),lt=Jc(),Ke=W.drawingBufferWidth,rt=W.drawingBufferHeight,Ze={tick:0,time:0,viewportWidth:Ke,viewportHeight:rt,framebufferWidth:Ke,framebufferHeight:rt,drawingBufferWidth:Ke,drawingBufferHeight:rt,pixelRatio:P.pixelRatio},st={},ce={elements:null,primitive:4,count:-1,offset:0,instances:-1},Re=F(W,qe),it=Fu(W,He,P,Tt),bt=up(W,qe,it,He),We=_y(W,qe,Re,He,it,bt,ce);function Tt(er){return We.destroyBuffer(er)}var Ct=Q0(W,Fe,He,P),Yt=ey(W,qe,Re,function(){kt.procs.poll()},Ze,He,P),ze=wf(W,qe,Re,He,P),Be=gy(W,qe,Re,Yt,ze,He),kt=_v(W,Fe,qe,Re,it,bt,Yt,Be,st,We,Ct,ce,Ze,ot,P),mt=Ki(W,Be,kt.procs.poll,Ze,Ae,qe,Re),nt=kt.next,_t=W.canvas,xt=[],ur=[],nr=[],Et=[P.onDestroy],wt=null;function Kt(){if(xt.length===0){ot&&ot.update(),wt=null;return}wt=Da.next(Kt),_n();for(var er=xt.length-1;er>=0;--er){var mr=xt[er];mr&&mr(Ze,null,0)}W.flush(),ot&&ot.update()}function lr(){!wt&&xt.length>0&&(wt=Da.next(Kt))}function cr(){wt&&(Da.cancel(Kt),wt=null)}function Wr(er){er.preventDefault(),Ue=!0,cr(),ur.forEach(function(mr){mr()})}function pn(er){W.getError(),Ue=!1,Ee.restore(),Ct.restore(),it.restore(),Yt.restore(),ze.restore(),Be.restore(),We.restore(),ot&&ot.restore(),kt.procs.refresh(),lr(),nr.forEach(function(mr){mr()})}var _r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!_r&&_t&&(_t.addEventListener(pc,Wr,!1),_t.addEventListener(Vu,pn,!1));function zn(){xt.length=0,cr(),!_r&&_t&&(_t.removeEventListener(pc,Wr),_t.removeEventListener(Vu,pn)),Ct.clear(),Be.clear(),ze.clear(),We.clear(),Yt.clear(),bt.clear(),it.clear(),ot&&ot.clear(),Et.forEach(function(er){er()})}function un(er){C(!!er,"invalid args to regl({...})"),C.type(er,"object","invalid args to regl({...})");function mr(ie){var ee=i({},ie);delete ee.uniforms,delete ee.attributes,delete ee.context,delete ee.vao,"stencil"in ee&&ee.stencil.op&&(ee.stencil.opBack=ee.stencil.opFront=ee.stencil.op,delete ee.stencil.op);function oe(D){if(D in ee){var Q=ee[D];delete ee[D],Object.keys(Q).forEach(function(G){ee[D+"."+G]=Q[G]})}}return oe("blend"),oe("depth"),oe("cull"),oe("stencil"),oe("polygonOffset"),oe("scissor"),oe("sample"),"vao"in ie&&(ee.vao=ie.vao),ee}function Xr(ie,ee){var oe={},D={};return Object.keys(ie).forEach(function(Q){var G=ie[Q];if(Zr.isDynamic(G)){D[Q]=Zr.unbox(G,Q);return}else if(ee&&Array.isArray(G)){for(var fe=0;fe<G.length;++fe)if(Zr.isDynamic(G[fe])){D[Q]=Zr.unbox(G,Q);return}}oe[Q]=G}),{dynamic:D,static:oe}}var En=Xr(er.context||{},!0),Ao=Xr(er.uniforms||{},!0),V=Xr(er.attributes||{},!1),we=Xr(mr(er),!1),ye={gpuTime:0,cpuTime:0,count:0},Lt=kt.compile(we,V,Ao,En,ye),br=Lt.draw,z=Lt.batch,L=Lt.scope,Z=[];function he(ie){for(;Z.length<ie;)Z.push(null);return Z}function Te(ie,ee){var oe;if(Ue&&C.raise("context lost"),typeof ie=="function")return L.call(this,null,ie,0);if(typeof ee=="function")if(typeof ie=="number")for(oe=0;oe<ie;++oe)L.call(this,null,ee,oe);else if(Array.isArray(ie))for(oe=0;oe<ie.length;++oe)L.call(this,ie[oe],ee,oe);else return L.call(this,ie,ee,0);else if(typeof ie=="number"){if(ie>0)return z.call(this,he(ie|0),ie|0)}else if(Array.isArray(ie)){if(ie.length)return z.call(this,ie,ie.length)}else return br.call(this,ie)}return i(Te,{stats:ye,destroy:function(){Lt.destroy()}})}var Tn=Be.setFBO=un({framebuffer:Zr.define.call(null,fr,"framebuffer")});function yn(er,mr){var Xr=0;kt.procs.poll();var En=mr.color;En&&(W.clearColor(+En[0]||0,+En[1]||0,+En[2]||0,+En[3]||0),Xr|=Co),"depth"in mr&&(W.clearDepth(+mr.depth),Xr|=Xp),"stencil"in mr&&(W.clearStencil(mr.stencil|0),Xr|=Yp),C(!!Xr,"called regl.clear with no buffer specified"),W.clear(Xr)}function In(er){if(C(typeof er=="object"&&er,"regl.clear() takes an object as input"),"framebuffer"in er)if(er.framebuffer&&er.framebuffer_reglType==="framebufferCube")for(var mr=0;mr<6;++mr)Tn(i({framebuffer:er.framebuffer.faces[mr]},er),yn);else Tn(er,yn);else yn(null,er)}function $n(er){C.type(er,"function","regl.frame() callback must be a function"),xt.push(er);function mr(){var Xr=ru(xt,er);C(Xr>=0,"cannot cancel a frame twice");function En(){var Ao=ru(xt,En);xt[Ao]=xt[xt.length-1],xt.length-=1,xt.length<=0&&cr()}xt[Xr]=En}return lr(),{cancel:mr}}function Yn(){var er=nt.viewport,mr=nt.scissor_box;er[0]=er[1]=mr[0]=mr[1]=0,Ze.viewportWidth=Ze.framebufferWidth=Ze.drawingBufferWidth=er[2]=mr[2]=W.drawingBufferWidth,Ze.viewportHeight=Ze.framebufferHeight=Ze.drawingBufferHeight=er[3]=mr[3]=W.drawingBufferHeight}function _n(){Ze.tick+=1,Ze.time=Gn(),Yn(),kt.procs.poll()}function dr(){Yt.refresh(),Yn(),kt.procs.refresh(),ot&&ot.update()}function Gn(){return(Jc()-lt)/1e3}dr();function Ur(er,mr){C.type(mr,"function","listener callback must be a function");var Xr;switch(er){case"frame":return $n(mr);case"lost":Xr=ur;break;case"restore":Xr=nr;break;case"destroy":Xr=Et;break;default:C.raise("invalid event, must be one of frame,lost,restore,destroy")}return Xr.push(mr),{cancel:function(){for(var En=0;En<Xr.length;++En)if(Xr[En]===mr){Xr[En]=Xr[Xr.length-1],Xr.pop();return}}}}var wn=i(un,{clear:In,prop:Zr.define.bind(null,fr),context:Zr.define.bind(null,Wf),this:Zr.define.bind(null,qp),draw:un({}),buffer:function(er){return it.create(er,Zp,!1,!1)},elements:function(er){return bt.create(er,!1)},texture:Yt.create2D,cube:Yt.createCube,renderbuffer:ze.create,framebuffer:Be.create,framebufferCube:Be.createCube,vao:We.createVAO,attributes:Ae,frame:$n,on:Ur,limits:Re,hasExtension:function(er){return Re.extensions.indexOf(er.toLowerCase())>=0},read:mt,destroy:zn,_gl:W,_refresh:dr,poll:function(){_n(),ot&&ot.update()},now:Gn,stats:He});return P.onDone(null,wn),wn}return Ty})})(S7);const TQ=S7.exports;var wQ=function(){function e(t,r){ke(this,e);var n=r.buffer,i=r.offset,a=r.stride,o=r.normalized,u=r.size,s=r.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:a||0,normalized:o||!1,divisor:s||0},u&&(this.attribute.size=u)}return Pe(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(r){this.buffer.subData(r)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Zu,dd,qu,Ja,vd,ol,gd,ag,au,Sc,xi,ou,uu,og,MQ=(Zu={},T(Zu,w.POINTS,"points"),T(Zu,w.LINES,"lines"),T(Zu,w.LINE_LOOP,"line loop"),T(Zu,w.LINE_STRIP,"line strip"),T(Zu,w.TRIANGLES,"triangles"),T(Zu,w.TRIANGLE_FAN,"triangle fan"),T(Zu,w.TRIANGLE_STRIP,"triangle strip"),Zu),r6=(dd={},T(dd,w.STATIC_DRAW,"static"),T(dd,w.DYNAMIC_DRAW,"dynamic"),T(dd,w.STREAM_DRAW,"stream"),dd),XE=(qu={},T(qu,w.BYTE,"int8"),T(qu,w.UNSIGNED_INT,"int16"),T(qu,w.INT,"int32"),T(qu,w.UNSIGNED_BYTE,"uint8"),T(qu,w.UNSIGNED_SHORT,"uint16"),T(qu,w.UNSIGNED_INT,"uint32"),T(qu,w.FLOAT,"float"),qu),RQ=(Ja={},T(Ja,w.ALPHA,"alpha"),T(Ja,w.LUMINANCE,"luminance"),T(Ja,w.LUMINANCE_ALPHA,"luminance alpha"),T(Ja,w.RGB,"rgb"),T(Ja,w.RGBA,"rgba"),T(Ja,w.RGBA4,"rgba4"),T(Ja,w.RGB5_A1,"rgb5 a1"),T(Ja,w.RGB565,"rgb565"),T(Ja,w.DEPTH_COMPONENT,"depth"),T(Ja,w.DEPTH_STENCIL,"depth stencil"),Ja),OQ=(vd={},T(vd,w.DONT_CARE,"dont care"),T(vd,w.NICEST,"nice"),T(vd,w.FASTEST,"fast"),vd),Mw=(ol={},T(ol,w.NEAREST,"nearest"),T(ol,w.LINEAR,"linear"),T(ol,w.LINEAR_MIPMAP_LINEAR,"mipmap"),T(ol,w.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),T(ol,w.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),T(ol,w.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),ol),Rw=(gd={},T(gd,w.REPEAT,"repeat"),T(gd,w.CLAMP_TO_EDGE,"clamp"),T(gd,w.MIRRORED_REPEAT,"mirror"),gd),LQ=(ag={},T(ag,w.NONE,"none"),T(ag,w.BROWSER_DEFAULT_WEBGL,"browser"),ag),FQ=(au={},T(au,w.NEVER,"never"),T(au,w.ALWAYS,"always"),T(au,w.LESS,"less"),T(au,w.LEQUAL,"lequal"),T(au,w.GREATER,"greater"),T(au,w.GEQUAL,"gequal"),T(au,w.EQUAL,"equal"),T(au,w.NOTEQUAL,"notequal"),au),Ow=(Sc={},T(Sc,w.FUNC_ADD,"add"),T(Sc,w.MIN_EXT,"min"),T(Sc,w.MAX_EXT,"max"),T(Sc,w.FUNC_SUBTRACT,"subtract"),T(Sc,w.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Sc),ug=(xi={},T(xi,w.ZERO,"zero"),T(xi,w.ONE,"one"),T(xi,w.SRC_COLOR,"src color"),T(xi,w.ONE_MINUS_SRC_COLOR,"one minus src color"),T(xi,w.SRC_ALPHA,"src alpha"),T(xi,w.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),T(xi,w.DST_COLOR,"dst color"),T(xi,w.ONE_MINUS_DST_COLOR,"one minus dst color"),T(xi,w.DST_ALPHA,"dst alpha"),T(xi,w.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),T(xi,w.CONSTANT_COLOR,"constant color"),T(xi,w.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),T(xi,w.CONSTANT_ALPHA,"constant alpha"),T(xi,w.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),T(xi,w.SRC_ALPHA_SATURATE,"src alpha saturate"),xi),IQ=(ou={},T(ou,w.NEVER,"never"),T(ou,w.ALWAYS,"always"),T(ou,w.LESS,"less"),T(ou,w.LEQUAL,"lequal"),T(ou,w.GREATER,"greater"),T(ou,w.GEQUAL,"gequal"),T(ou,w.EQUAL,"equal"),T(ou,w.NOTEQUAL,"notequal"),ou),uh=(uu={},T(uu,w.ZERO,"zero"),T(uu,w.KEEP,"keep"),T(uu,w.REPLACE,"replace"),T(uu,w.INVERT,"invert"),T(uu,w.INCR,"increment"),T(uu,w.DECR,"decrement"),T(uu,w.INCR_WRAP,"increment wrap"),T(uu,w.DECR_WRAP,"decrement wrap"),uu),kQ=(og={},T(og,w.FRONT,"front"),T(og,w.BACK,"back"),og),PQ=function(){function e(t,r){ke(this,e);var n=r.data,i=r.usage,a=r.type;this.buffer=t.buffer({data:n,usage:r6[i||w.STATIC_DRAW],type:XE[a||w.UNSIGNED_BYTE]})}return Pe(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(r){var n=r.data,i=r.offset;this.buffer.subdata(n,i)}}]),e}(),DQ=function(){function e(t,r){ke(this,e);var n=r.data,i=r.usage,a=r.type,o=r.count;this.elements=t.elements({data:n,usage:r6[i||w.STATIC_DRAW],type:XE[a||w.UNSIGNED_BYTE],count:o})}return Pe(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(r){var n=r.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),BQ=function(){function e(t,r){ke(this,e);var n=r.width,i=r.height,a=r.color,o=r.colors,u={width:n,height:i};Array.isArray(o)&&(u.colors=o.map(function(s){return s.get()})),a&&typeof a!="boolean"&&(u.color=a.get()),this.framebuffer=t.framebuffer(u)}return Pe(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(r){var n=r.width,i=r.height;this.framebuffer.resize(n,i)}}]),e}(),NQ=function(){function e(t,r){ke(this,e),T(this,"destroyed",!1),T(this,"uniforms",{}),this.reGl=t;var n=r.pick,i=n===void 0?!0:n,a=r.vs,o=r.fs,u=r.attributes,s=r.uniforms,l=r.primitive,f=r.count,h=r.elements,d=r.depth,v=r.blend,m=r.stencil,y=r.cull,_=r.instances,E={};this.options=r,s&&(this.uniforms=this.extractUniforms(s),Object.keys(s).forEach(function(O){E[O]=t.prop(O)}));var S={};Object.keys(u).forEach(function(O){S[O]=u[O].get()});var A={attributes:S,frag:o,uniforms:E,vert:a,blend:{},primitive:MQ[l===void 0?w.TRIANGLES:l]};if(_&&(A.instances=_),f?A.count=f:h&&(A.elements=h.get()),this.initDepthDrawParams({depth:d},A),this.initBlendDrawParams({blend:v},A),this.initStencilDrawParams({stencil:m},A),this.initCullDrawParams({cull:y},A),this.drawCommand=t(A),i){var M=tt.exports.cloneDeep(A);M.blend=be(be({},M.blend),{},{enable:!1}),this.drawPickCommand=t(M)}this.drawParams=A}return Pe(e,[{key:"updateAttributesAndElements",value:function(r,n){var i={};if(Object.keys(r).forEach(function(o){i[o]=r[o].get()}),this.drawParams.attributes=i,this.drawParams.elements=n.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var a=tt.exports.cloneDeep(this.drawParams);a.blend=be(be({},a.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(a)}}},{key:"updateAttributes",value:function(r){var n={};if(Object.keys(r).forEach(function(a){n[a]=r[a].get()}),this.drawParams.attributes=n,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var i=tt.exports.cloneDeep(this.drawParams);i.blend=be(be({},i.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(i)}}},{key:"addUniforms",value:function(r){this.uniforms=be(be({},this.uniforms),this.extractUniforms(r))}},{key:"draw",value:function(r,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var i=be(be({},this.uniforms),this.extractUniforms(r.uniforms||{})),a={};Object.keys(i).forEach(function(o){var u=Th(i[o]);u==="boolean"||u==="number"||Array.isArray(i[o])||i[o].BYTES_PER_ELEMENT?a[o]=i[o]:a[o]=i[o].get()}),n?this.drawPickCommand&&this.drawPickCommand(a):this.drawCommand(a)}}},{key:"destroy",value:function(){var r,n;(r=this.drawParams)===null||r===void 0||(n=r.elements)===null||n===void 0||n.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i==null||i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(r,n){var i=r.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:FQ[i.func||w.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(r,n){var i=r.blend;if(i){var a=i.enable,o=i.func,u=i.equation,s=i.color,l=s===void 0?[0,0,0,0]:s;n.blend={enable:!!a,func:{srcRGB:ug[o&&o.srcRGB||w.SRC_ALPHA],srcAlpha:ug[o&&o.srcAlpha||w.SRC_ALPHA],dstRGB:ug[o&&o.dstRGB||w.ONE_MINUS_SRC_ALPHA],dstAlpha:ug[o&&o.dstAlpha||w.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Ow[u&&u.rgb||w.FUNC_ADD],alpha:Ow[u&&u.alpha||w.FUNC_ADD]},color:l}}}},{key:"initStencilDrawParams",value:function(r,n){var i=r.stencil;if(i){var a=i.enable,o=i.mask,u=o===void 0?-1:o,s=i.func,l=s===void 0?{cmp:w.ALWAYS,ref:0,mask:-1}:s,f=i.opFront,h=f===void 0?{fail:w.KEEP,zfail:w.KEEP,zpass:w.KEEP}:f,d=i.opBack,v=d===void 0?{fail:w.KEEP,zfail:w.KEEP,zpass:w.KEEP}:d;n.stencil={enable:!!a,mask:u,func:be(be({},l),{},{cmp:IQ[l.cmp]}),opFront:{fail:uh[h.fail],zfail:uh[h.zfail],zpass:uh[h.zpass]},opBack:{fail:uh[v.fail],zfail:uh[v.zfail],zpass:uh[v.zpass]}}}}},{key:"initCullDrawParams",value:function(r,n){var i=r.cull;if(i){var a=i.enable,o=i.face,u=o===void 0?w.BACK:o;n.cull={enable:!!a,face:kQ[u]}}}},{key:"extractUniforms",value:function(r){var n=this,i={};return Object.keys(r).forEach(function(a){n.extractUniformsRecursively(a,r[a],i,"")}),i}},{key:"extractUniformsRecursively",value:function(r,n,i,a){var o=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||tt.exports.isTypedArray(n)||n===""||"resize"in n){i["".concat(a&&a+".").concat(r)]=n;return}tt.exports.isPlainObject(n)&&Object.keys(n).forEach(function(u){o.extractUniformsRecursively(u,n[u],i,"".concat(a&&a+".").concat(r))}),Array.isArray(n)&&n.forEach(function(u,s){Object.keys(u).forEach(function(l){o.extractUniformsRecursively(l,u[l],i,"".concat(a&&a+".").concat(r,"[").concat(s,"]"))})})}}]),e}(),UQ=function(){function e(t,r){ke(this,e),T(this,"isDestroy",!1);var n=r.data,i=r.type,a=i===void 0?w.UNSIGNED_BYTE:i,o=r.width,u=r.height,s=r.flipY,l=s===void 0?!1:s,f=r.format,h=f===void 0?w.RGBA:f,d=r.mipmap,v=d===void 0?!1:d,m=r.wrapS,y=m===void 0?w.CLAMP_TO_EDGE:m,_=r.wrapT,E=_===void 0?w.CLAMP_TO_EDGE:_,S=r.aniso,A=S===void 0?0:S,M=r.alignment,O=M===void 0?1:M,j=r.premultiplyAlpha,q=j===void 0?!1:j,Y=r.mag,ne=Y===void 0?w.NEAREST:Y,X=r.min,$=X===void 0?w.NEAREST:X,K=r.colorSpace,ue=K===void 0?w.BROWSER_DEFAULT_WEBGL:K,de=r.x,pe=de===void 0?0:de,le=r.y,ve=le===void 0?0:le,Me=r.copy,Ne=Me===void 0?!1:Me;this.width=o,this.height=u;var Xe={width:o,height:u,type:XE[a],format:RQ[h],wrapS:Rw[y],wrapT:Rw[E],mag:Mw[ne],min:Mw[$],alignment:O,flipY:l,colorSpace:LQ[ue],premultiplyAlpha:q,aniso:A,x:pe,y:ve,copy:Ne};n&&(Xe.data=n),typeof v=="number"?Xe.mipmap=OQ[v]:typeof v=="boolean"&&(Xe.mipmap=v),this.texture=t.texture(Xe)}return Pe(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(r)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(r){var n=r.width,i=r.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"destroy",value:function(){if(!this.isDestroy){var r;(r=this.texture)===null||r===void 0||r.destroy()}this.isDestroy=!0}}]),e}(),Lw,Fw,zQ=(Lw=xr(),Lw(Fw=function(){function e(){var t=this;ke(this,e),T(this,"createModel",function(r){return new NQ(t.gl,r)}),T(this,"createAttribute",function(r){return new wQ(t.gl,r)}),T(this,"createBuffer",function(r){return new PQ(t.gl,r)}),T(this,"createElements",function(r){return new DQ(t.gl,r)}),T(this,"createTexture2D",function(r){return new UQ(t.gl,r)}),T(this,"createFramebuffer",function(r){return new BQ(t.gl,r)}),T(this,"useFramebuffer",function(r,n){t.gl({framebuffer:r?r.get():null})(n)}),T(this,"clear",function(r){var n,i=r.color,a=r.depth,o=r.stencil,u=r.framebuffer,s=u===void 0?null:u,l={color:i,depth:a,stencil:o};l.framebuffer=s===null?s:s.get(),(n=t.gl)===null||n===void 0||n.clear(l)}),T(this,"viewport",function(r){var n=r.x,i=r.y,a=r.width,o=r.height;t.gl._gl.viewport(n,i,a,o),t.width=a,t.height=o,t.gl._refresh()}),T(this,"readPixels",function(r){var n=r.framebuffer,i=r.x,a=r.y,o=r.width,u=r.height,s={x:i,y:a,width:o,height:u};return n&&(s.framebuffer=n.get()),t.gl.read(s)}),T(this,"getViewportSize",function(){return{width:t.gl._gl.drawingBufferWidth,height:t.gl._gl.drawingBufferHeight}}),T(this,"getContainer",function(){if(Fa)return t.canvas;var r;return(r=t.canvas)===null||r===void 0?void 0:r.parentElement}),T(this,"getCanvas",function(){return t.canvas}),T(this,"getGLContext",function(){return t.gl._gl}),T(this,"destroy",function(){var r,n,i;t.canvas=null,(r=t.gl)===null||r===void 0||(n=r._gl)===null||n===void 0||(i=n.getExtension("WEBGL_lose_context"))===null||i===void 0||i.loseContext(),t.gl.destroy(),t.gl=null})}return Pe(e,[{key:"init",value:function(){var t=Ie(H.mark(function n(i,a,o){var u=this;return H.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.canvas=i,!o){l.next=5;break}this.gl=o,l.next=8;break;case 5:return l.next=7,new Promise(function(f,h){TQ({canvas:u.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(v,m){(v||!m)&&h(v),f(m)}})});case 7:this.gl=l.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return l.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(r){return!!this.getGLContext().getExtension(r)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var r=this.getGLContext();r.disable(r.CULL_FACE)}},{key:"setDirty",value:function(r){this.isDirty=r}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||Fw);function $Q(e){var t=GQ();return function(){var n=Ce(e),i;if(t){var a=Ce(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zt(this,i)}}function GQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var W_=["selectstart","selecting","selectend"],HQ=function(e){Ut(r,e);var t=$Q(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ke(this,r),i=t.call(this),T(re(i),"isEnable",!1),T(re(i),"onDragStart",function(o){i.box.style.display="block",i.startEvent=i.endEvent=o,i.syncBoxBound(),i.emit("selectstart",i.getLngLatBox(),i.startEvent,i.endEvent)}),T(re(i),"onDragging",function(o){i.endEvent=o,i.syncBoxBound(),i.emit("selecting",i.getLngLatBox(),i.startEvent,i.endEvent)}),T(re(i),"onDragEnd",function(o){i.endEvent=o,i.box.style.display="none",i.emit("selectend",i.getLngLatBox(),i.startEvent,i.endEvent)}),i.scene=n,i.options=a,i}return Pe(r,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var i=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var a=ca("div",void 0,this.container);a.classList.add("l7-select-box"),i&&a.classList.add(i),a.style.display="none",this.box=a}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){!this.isEnable||(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var i=this.startEvent,a=i.x,o=i.y,u=this.endEvent,s=u.x,l=u.y,f=Math.min(a,s),h=Math.min(o,l),d=Math.abs(a-s),v=Math.abs(o-l);this.box.style.top="".concat(h,"px"),this.box.style.left="".concat(f,"px"),this.box.style.width="".concat(d,"px"),this.box.style.height="".concat(v,"px")}},{key:"getLngLatBox",value:function(){var i=this.startEvent.lngLat,a=i.lng,o=i.lat,u=this.endEvent.lngLat,s=u.lng,l=u.lat;return Xk([[a,o],[s,l]])}}]),r}(Pa.exports.EventEmitter),VQ=function(){function e(t){ke(this,e);var r=t.id,n=t.map,i=t.canvas,a=t.hasBaseMap,o=rG();this.container=o,n.setContainer(o,r,i,a),o.bind(Oe.IRendererService).to(zQ).inSingletonScope(),this.sceneService=o.get(Oe.ISceneService),this.mapService=o.get(Oe.IMapService),this.iconService=o.get(Oe.IIconService),this.fontService=o.get(Oe.IFontService),this.controlService=o.get(Oe.IControlService),this.layerService=o.get(Oe.ILayerService),this.markerService=o.get(Oe.IMarkerService),this.interactionService=o.get(Oe.IInteractionService),this.popupService=o.get(Oe.IPopupService),this.boxSelect=new HQ(this,{}),Fa?this.sceneService.initMiniScene(t):(this.initComponent(r),this.sceneService.init(t),this.initControl())}return Pe(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(r){return this.sceneService.exportPng(r)}},{key:"exportMap",value:function(r){return this.sceneService.exportPng(r)}},{key:"registerRenderService",value:function(r){var n=this;if(this.sceneService.loaded){var i=new r(this);i.init()}else this.on("loaded",function(){var a=new r(n);a.init()})}},{key:"setBgColor",value:function(r){this.mapService.setBgColor(r)}},{key:"addLayer",value:function(r){var n=this,i=Dg(this.container);if(r.setContainer(i,this.container),this.sceneService.addLayer(r),r.inited){var a=this.initMask(r);this.addMask(a,r.id)}else r.on("inited",function(){var o=n.initMask(r);n.addMask(o,r.id)})}},{key:"initMask",value:function(r){var n=r.getLayerConfig(),i=n.mask,a=n.maskfence,o=n.maskColor,u=o===void 0?"#000":o,s=n.maskOpacity,l=s===void 0?0:s;if(!(!i||!a)){var f=new CE().source(a).shape("fill").style({color:u,opacity:l});return f}}},{key:"addMask",value:function(r,n){if(!!r){var i=this.getLayer(n);if(i){var a=Dg(this.container);r.setContainer(a,this.container),i.addMaskLayer(r),this.sceneService.addMask(r)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(r){return this.layerService.getLayer(r)}},{key:"getLayerByName",value:function(r){return this.layerService.getLayerByName(r)}},{key:"removeLayer",value:function(r,n){this.layerService.remove(r,n)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(r){this.layerService.setEnableRender(r)}},{key:"addIconFont",value:function(r,n){this.fontService.addIconFont(r,n)}},{key:"addIconFonts",value:function(r){var n=this;r.forEach(function(i){var a=ir(i,2),o=a[0],u=a[1];n.fontService.addIconFont(o,u)})}},{key:"addFontFace",value:function(r,n){var i=this;this.fontService.once("fontloaded",function(a){i.emit("fontloaded",a)}),this.fontService.addFontFace(r,n)}},{key:"addImage",value:function(){var t=Ie(H.mark(function n(i,a){return H.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(Fa){u.next=5;break}return u.next=3,this.iconService.addImage(i,a);case 3:u.next=6;break;case 5:this.iconService.addImageMini(i,a,this.sceneService);case 6:case"end":return u.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"hasImage",value:function(r){return this.iconService.hasImage(r)}},{key:"removeImage",value:function(r){this.iconService.removeImage(r)}},{key:"addIconFontGlyphs",value:function(r,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(r){this.controlService.addControl(r,this.container)}},{key:"removeControl",value:function(r){this.controlService.removeControl(r)}},{key:"getControlByName",value:function(r){return this.controlService.getControlByName(r)}},{key:"addMarker",value:function(r){this.markerService.addMarker(r)}},{key:"addMarkerLayer",value:function(r){this.markerService.addMarkerLayer(r)}},{key:"removeMarkerLayer",value:function(r){this.markerService.removeMarkerLayer(r)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(r){this.popupService.addPopup(r)}},{key:"removePopup",value:function(r){this.popupService.removePopup(r)}},{key:"on",value:function(r,n){if(W_.includes(r)){var i;(i=this.boxSelect)===null||i===void 0||i.on(r,n)}else Zv.includes(r)?this.sceneService.on(r,n):this.mapService.on(r,n)}},{key:"once",value:function(r,n){if(W_.includes(r)){var i;(i=this.boxSelect)===null||i===void 0||i.once(r,n)}else Zv.includes(r)?this.sceneService.once(r,n):this.mapService.once(r,n)}},{key:"emit",value:function(r,n){Zv.indexOf(r)===-1?this.mapService.on(r,n):this.sceneService.emit(r,n)}},{key:"off",value:function(r,n){if(W_.includes(r)){var i;(i=this.boxSelect)===null||i===void 0||i.off(r,n)}else Zv.includes(r)?this.sceneService.off(r,n):this.mapService.off(r,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(r){return this.mapService.getCenter(r)}},{key:"setCenter",value:function(r,n){return this.mapService.setCenter(r,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(r){return this.mapService.setPitch(r)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(r){this.mapService.setRotation(r)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(r){this.mapService.panTo(r)}},{key:"panBy",value:function(r,n){this.mapService.panBy(r,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(r){this.mapService.setZoom(r)}},{key:"fitBounds",value:function(r,n){var i=this.sceneService.getSceneConfig(),a=i.fitBoundsOptions,o=i.animate;this.mapService.fitBounds(r,n||be(be({},a),{},{animate:o}))}},{key:"setZoomAndCenter",value:function(r,n){this.mapService.setZoomAndCenter(r,n)}},{key:"setMapStyle",value:function(r){this.mapService.setMapStyle(r)}},{key:"setMapStatus",value:function(r){this.mapService.setMapStatus(r)}},{key:"pixelToLngLat",value:function(r){return this.mapService.pixelToLngLat(r)}},{key:"lngLatToPixel",value:function(r){return this.mapService.lngLatToPixel(r)}},{key:"containerToLngLat",value:function(r){return this.mapService.containerToLngLat(r)}},{key:"lngLatToContainer",value:function(r){return this.mapService.lngLatToContainer(r)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(r,n){this.container.bind(Oe.IPostProcessingPass).to(r).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),n&&this.boxSelect.once("selectend",function(){r.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(r){this.controlService.init({container:mk(r)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var r=this.sceneService.getSceneConfig(),n=r.logoVisible,i=r.logoPosition;n&&this.addControl(new XG({position:i}))}}]),e}();function jQ(e,t,r,n){n===void 0&&(n={});var i=gI(e),a=Qy(i[0]),o=Qy(i[1]),u=Qy(r),s=vI(t,n.units),l=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(u)),f=a+Math.atan2(Math.sin(u)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(l)),h=tb(f),d=tb(l);return l1([h,d],n.properties)}function Iw(e,t,r){r===void 0&&(r={});for(var n=r.steps||64,i=r.properties?r.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},a=[],o=0;o<n;o++)a.push(jQ(e,t,o*-360/n,r).geometry.coordinates);return a.push(a[0]),cm([a],i)}const WQ={id:"map",style:{width:"100vw",height:"100vh",position:"relative"}},XQ=DL({__name:"App",setup(e){const t=new VQ({id:"map",map:new FH({style:"dark",center:[120.104697,30.260704],pitch:0,zoom:15})});return t.on("loaded",()=>{const r=new Bg({name:"pointLayer"});r.source(pg([l1([120.105697,30.260704],{name:"\u6D4B\u8BD5\u70B91",lng:120.104697,lat:30.260704}),l1([120.103697,30.260704],{name:"\u6D4B\u8BD5\u70B91",lng:120.104697,lat:30.260704})])).color("#ffffff").shape("circle").size(10);const n=new GM({name:"polygonLayer"});n.source(pg([Iw([120.104697,30.260704],30,{units:"meters",properties:{name:"\u6D4B\u8BD5\u70B91",lng:120.104697,lat:30.260704}}),Iw([120.104697,30.261715],30,{units:"meters",properties:{name:"\u6D4B\u8BD5\u70B91",lng:120.104697,lat:30.260704}})])).color("#ff0000").shape("fill");const i=new EE({name:"lineLayer"});i.source(pg([{type:"Feature",properties:{name:"\u6D4B\u8BD5\u7EBF3"},geometry:{type:"LineString",coordinates:[[120.103615,30.262026],[120.103172,30.261771],[120.102697,30.261934]]}}])).size(6).color("#00ff00"),t.addLayer(r),t.addLayer(n),t.addLayer(i)}),(r,n)=>(fF(),dF("div",WQ))}});JF(XQ).mount("#app");
